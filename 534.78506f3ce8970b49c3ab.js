(self.webpackChunksyncfusion=self.webpackChunksyncfusion||[]).push([[534],{534:(e,t,i)=>{"use strict";i.r(t),i.d(t,{TablasModule:()=>Gc});var s=i(8583),o=i(639),l=i(1177),a=i(9232),r=i(8865),n=i(7417),h=i(7538),d=i(2664),c=i(52),p=i(3479),u=i(8475),g=i(7889),m=i(5760),b=i(9231),f=i(1510);class y{constructor(e){this.svgLink="http://www.w3.org/2000/svg",this.rootId=e}getOptionValue(e,t){return e[t]}createSvg(e){return(0,a.le)(e.id)&&(e.id=this.rootId+"_svg"),this.svgObj=document.getElementById(e.id),(0,a.le)(document.getElementById(e.id))&&(this.svgObj=document.createElementNS(this.svgLink,"svg")),this.svgObj=this.setElementAttributes(e,this.svgObj),this.setSVGSize(e.width,e.height),this.svgObj}setSVGSize(e,t){const i=document.getElementById(this.rootId),s=(0,a.le)(i)?null:i.getBoundingClientRect();(0,a.le)(this.width)||this.width<=0?this.svgObj.setAttribute("width",e?e.toString():s.width.toString()):this.svgObj.setAttribute("width",this.width.toString()),(0,a.le)(this.height)||this.height<=0?this.svgObj.setAttribute("height",t?t.toString():"450"):this.svgObj.setAttribute("height",this.height.toString())}drawPath(e){let t=document.getElementById(e.id);return null===t&&(t=document.createElementNS(this.svgLink,"path")),t=this.setElementAttributes(e,t),t}drawLine(e){let t=document.getElementById(e.id);return null===t&&(t=document.createElementNS(this.svgLink,"line")),t=this.setElementAttributes(e,t),t}drawRectangle(e){let t=document.getElementById(e.id);return null===t&&(t=document.createElementNS(this.svgLink,"rect")),t=this.setElementAttributes(e,t),t}drawCircle(e){let t=document.getElementById(e.id);return null===t&&(t=document.createElementNS(this.svgLink,"circle")),t=this.setElementAttributes(e,t),t}drawPolyline(e){let t=document.getElementById(e.id);return null===t&&(t=document.createElementNS(this.svgLink,"polyline")),t=this.setElementAttributes(e,t),t}drawEllipse(e){let t=document.getElementById(e.id);return null===t&&(t=document.createElementNS(this.svgLink,"ellipse")),t=this.setElementAttributes(e,t),t}drawPolygon(e){let t=document.getElementById(e.id);return null===t&&(t=document.createElementNS(this.svgLink,"polygon")),t=this.setElementAttributes(e,t),t}drawImage(e){const t=document.createElementNS(this.svgLink,"image");return t.setAttributeNS(null,"height",e.height.toString()),t.setAttributeNS(null,"width",e.width.toString()),t.setAttributeNS("http://www.w3.org/1999/xlink","href",e.href),t.setAttributeNS(null,"x",e.x.toString()),t.setAttributeNS(null,"y",e.y.toString()),t.setAttributeNS(null,"id",e.id),t.setAttributeNS(null,"visibility",e.visibility),(0,a.le)(this.getOptionValue(e,"clip-path"))||t.setAttributeNS(null,"clip-path",this.getOptionValue(e,"clip-path")),(0,a.le)(e.preserveAspectRatio)||t.setAttributeNS(null,"preserveAspectRatio",e.preserveAspectRatio),t}createText(e,t){let i=document.createElementNS(this.svgLink,"text");return i=this.setElementAttributes(e,i),(0,a.le)(t)||(i.textContent=t),i}createTSpan(e,t){let i=document.createElementNS(this.svgLink,"tspan");return i=this.setElementAttributes(e,i),(0,a.le)(t)||(i.textContent=t),i}createTitle(e){const t=document.createElementNS(this.svgLink,"title");return t.textContent=e,t}createDefs(){return document.createElementNS(this.svgLink,"defs")}createClipPath(e){let t=document.createElementNS(this.svgLink,"clipPath");return t=this.setElementAttributes(e,t),t}createForeignObject(e){let t=document.createElementNS(this.svgLink,"foreignObject");return t=this.setElementAttributes(e,t),t}createGroup(e){let t=document.createElementNS(this.svgLink,"g");return t=this.setElementAttributes(e,t),t}createPattern(e,t){let i=document.createElementNS(this.svgLink,t);return i=this.setElementAttributes(e,i),i}createRadialGradient(e,t,i){let s;return(0,a.le)(e[0].colorStop)?s=e[0].color.toString():(this.drawGradient("radialGradient",{id:this.rootId+"_"+t+"radialGradient",cx:i.cx+"%",cy:i.cy+"%",r:i.r+"%",fx:i.fx+"%",fy:i.fy+"%"},e),s="url(#"+this.rootId+"_"+t+"radialGradient)"),s}createLinearGradient(e,t,i){let s;return(0,a.le)(e[0].colorStop)?s=e[0].color.toString():(this.drawGradient("linearGradient",{id:this.rootId+"_"+t+"linearGradient",x1:i.x1+"%",y1:i.y1+"%",x2:i.x2+"%",y2:i.y2+"%"},e),s="url(#"+this.rootId+"_"+t+"linearGradient)"),s}drawGradient(e,t,i){const s=this.createDefs();let o=document.createElementNS(this.svgLink,e);o=this.setElementAttributes(t,o);for(let l=0;l<i.length;l++){const e=document.createElementNS(this.svgLink,"stop");e.setAttribute("offset",i[l].colorStop),e.setAttribute("stop-color",i[l].color),e.setAttribute("stop-opacity",i[l].opacity?i[l].opacity:"1"),(0,a.le)(i[l].style)||e.setAttribute("style",i[l].style),o.appendChild(e)}return s.appendChild(o),s}drawClipPath(e){const t=this.createDefs(),i=this.createClipPath({id:e.id});e.id=e.id+"_Rect";const s=this.drawRectangle(e);return i.appendChild(s),t.appendChild(i),t}drawCircularClipPath(e){const t=this.createDefs(),i=this.createClipPath({id:e.id});e.id=e.id+"_Circle";const s=this.drawCircle(e);return i.appendChild(s),t.appendChild(i),t}setElementAttributes(e,t){const i=Object.keys(e);for(let s=0;s<i.length;s++)t.setAttribute(i[s],e[i[s]]);return t}createCanvas(){return null}}class v{constructor(e){this.rootId=e}getOptionValue(e,t){return e[t]}createCanvas(e){const t=document.createElement("canvas");return t.setAttribute("id",this.rootId+"_canvas"),this.ctx=t.getContext("2d"),this.canvasObj=t,this.setCanvasSize(e.width,e.height),this.canvasObj}setCanvasSize(e,t){const i=document.getElementById(this.rootId),s=(0,a.le)(i)?null:i.getBoundingClientRect();(0,a.le)(this.width)?this.canvasObj.setAttribute("width",e?e.toString():s.width.toString()):this.canvasObj.setAttribute("width",this.width.toString()),(0,a.le)(this.height)?this.canvasObj.setAttribute("height",t?t.toString():"450"):this.canvasObj.setAttribute("height",this.height.toString())}setAttributes(e){this.ctx.lineWidth=this.getOptionValue(e,"stroke-width");const t=this.getOptionValue(e,"stroke-dasharray");if(!(0,a.le)(t)){const e=t.split(",");this.ctx.setLineDash([parseInt(e[0],10),parseInt(e[1],10)])}this.ctx.strokeStyle=this.getOptionValue(e,"stroke")}drawLine(e){this.ctx.save(),this.ctx.beginPath(),this.ctx.lineWidth=this.getOptionValue(e,"stroke-width"),this.ctx.strokeStyle=e.stroke,this.ctx.moveTo(e.x1,e.y1),this.ctx.lineTo(e.x2,e.y2),this.ctx.stroke(),this.ctx.restore()}drawRectangle(e,t){const i=this.ctx,s=e.rx;return this.ctx.save(),this.ctx.beginPath(),t&&this.ctx.translate(t[0],t[1]),this.ctx.globalAlpha=this.getOptionValue(e,"opacity"),this.setAttributes(e),this.ctx.rect(e.x,e.y,e.width,e.height),null!==s&&s>=0?this.drawCornerRadius(e):("none"===e.fill&&(e.fill="transparent"),this.ctx.fillStyle=e.fill,this.ctx.fillRect(e.x,e.y,e.width,e.height),this.ctx.stroke()),this.ctx.restore(),this.ctx=i,this.canvasObj}drawCornerRadius(e){let t=e.rx;const i=e.x,s=e.y,o=e.width,l=e.height;"none"===e.fill&&(e.fill="transparent"),this.ctx.fillStyle=e.fill,o<2*t&&(t=o/2),l<2*t&&(t=l/2),this.ctx.beginPath(),this.ctx.moveTo(i+o-t,s),this.ctx.arcTo(i+o,s,i+o,s+l,t),this.ctx.arcTo(i+o,s+l,i,s+l,t),this.ctx.arcTo(i,s+l,i,s,t),this.ctx.arcTo(i,s,i+o,s,t),this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke()}drawPath(e,t){const i=e.d.split(" "),s=this.getOptionValue(e,"stroke-width"),o=this.ctx;let l=!0;this.ctx.save(),this.ctx.beginPath(),t&&this.ctx.translate(t[0],t[1]),this.ctx.globalAlpha=e.opacity?e.opacity:this.getOptionValue(e,"fill-opacity"),this.setAttributes(e);for(let a=0;a<i.length;a+=3){const t=parseFloat(i[a+1]),s=parseFloat(i[a+2]);switch(i[a]){case"M":e.innerR||e.cx||this.ctx.moveTo(t,s);break;case"L":e.innerR||this.ctx.lineTo(t,s);break;case"Q":const o=parseFloat(i[a+3]),r=parseFloat(i[a+4]);this.ctx.quadraticCurveTo(t,s,o,r),a+=2;break;case"C":const n=parseFloat(i[a+3]),h=parseFloat(i[a+4]),d=parseFloat(i[a+5]),c=parseFloat(i[a+6]);this.ctx.bezierCurveTo(t,s,n,h,d,c),a+=4;break;case"A":e.innerR?l&&(this.ctx.arc(e.x,e.y,e.radius,e.start,e.end,e.counterClockWise),this.ctx.arc(e.x,e.y,e.innerR,e.end,e.start,!e.counterClockWise),l=!1):e.cx?this.ctx.arc(e.cx,e.cy,e.radius,0,2*Math.PI,e.counterClockWise):(this.ctx.moveTo(e.x,e.y),this.ctx.arc(e.x,e.y,e.radius,e.start,e.end,e.counterClockWise),this.ctx.lineTo(e.x,e.y)),a+=5;break;case"z":case"Z":this.ctx.closePath(),a-=2}}return"none"!==e.fill&&void 0!==e.fill&&(this.ctx.fillStyle=e.fill,this.ctx.fill()),s>0&&this.ctx.stroke(),this.ctx.restore(),this.ctx=o,this.canvasObj}createText(e,t,i,s,o,l){let r=this.getOptionValue(e,"font-weight");(0,a.le)(r)||"regular"!==r.toLowerCase()||(r="normal");const n=this.getOptionValue(e,"font-size"),h=this.getOptionValue(e,"font-family"),d=this.getOptionValue(e,"font-style").toLowerCase()+" "+r+" "+n+" "+h;let c=this.getOptionValue(e,"text-anchor");const p=void 0!==e.opacity?e.opacity:1;return"middle"===c&&(c="center"),this.ctx.save(),this.ctx.fillStyle=e.fill,this.ctx.font=d,this.ctx.textAlign=c,this.ctx.globalAlpha=p,e.baseline&&(this.ctx.textBaseline=e.baseline),l||(this.ctx.translate(e.x+0+(i||0),e.y+(s||0)),this.ctx.rotate(e.labelRotation*Math.PI/180)),this.ctx.fillText(t,l?e.x:0,l?o:0),this.ctx.restore(),this.canvasObj}drawCircle(e,t){const i=this.ctx;return this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(e.cx,e.cy,e.r,0,2*Math.PI),this.ctx.fillStyle=e.fill,this.ctx.globalAlpha=e.opacity,this.ctx.fill(),t&&this.ctx.translate(t[0],t[1]),this.setAttributes(e),this.ctx.stroke(),this.ctx.restore(),this.ctx=i,this.canvasObj}drawPolyline(e){this.ctx.save(),this.ctx.beginPath();const t=e.points.split(" ");for(let i=0;i<t.length-1;i++){const e=t[i].split(","),s=parseFloat(e[0]),o=parseFloat(e[1]);0===i?this.ctx.moveTo(s,o):this.ctx.lineTo(s,o)}this.ctx.lineWidth=this.getOptionValue(e,"stroke-width"),this.ctx.strokeStyle=e.stroke,this.ctx.stroke(),this.ctx.restore()}drawEllipse(e,t){const i=this.ctx,s=Math.max(e.rx,e.ry),o=e.rx/s,l=e.ry/s;this.ctx.save(),this.ctx.beginPath(),this.ctx.translate(e.cx,e.cy),t&&this.ctx.translate(t[0],t[1]),this.ctx.save(),this.ctx.scale(o,l),this.ctx.arc(0,0,s,0,2*Math.PI,!1),this.ctx.fillStyle=e.fill,this.ctx.fill(),this.ctx.restore(),this.ctx.lineWidth=this.getOptionValue(e,"stroke-width"),this.ctx.strokeStyle=e.stroke,this.ctx.stroke(),this.ctx.restore(),this.ctx=i}drawImage(e){this.ctx.save();const t=new Image;(0,a.le)(e.href)||(t.src=e.href,this.ctx.drawImage(t,e.x,e.y,e.width,e.height)),this.ctx.restore()}createLinearGradient(e){let t;return(0,a.le)(e[0].colorStop)||(t=this.ctx.createLinearGradient(0,0,0,this.canvasObj.height)),this.setGradientValues(e,t)}createRadialGradient(e){let t;return(0,a.le)(e[0].colorStop)||(t=this.ctx.createRadialGradient(0,0,0,0,0,this.canvasObj.height)),this.setGradientValues(e,t)}setGradientValues(e,t){let i;if((0,a.le)(e[0].colorStop))i=e[0].color.toString();else{for(let i=0;i<=e.length-1;i++){const s=e[i].color,o=e[i].colorStop.slice(0,-1),l=parseInt(o,10)/100;t.addColorStop(l,s)}i=t.toString()}return i}setElementAttributes(e,t){const i=Object.keys(e),s=Object.keys(e).map(t=>e[t]);for(let o=0;o<i.length;o++)t.setAttribute(i[o],s[o]);return null}updateCanvasAttributes(e){this.setElementAttributes(e,this.canvasObj);const t=this.ctx;if(!(0,a.le)(this.dataUrl)){const e=new Image;e.onload=()=>{t.drawImage(e,0,0)},e.src=this.dataUrl}}clearRect(e){this.ctx.restore(),this.ctx.clearRect(e.x,e.y,e.width,e.height)}createGroup(){return null}drawClipPath(){return null}canvasClip(e){this.ctx.save(),this.ctx.fillStyle="transparent",this.ctx.rect(e.x,e.y,e.width,e.height),this.ctx.fill(),this.ctx.clip()}canvasRestore(){this.ctx.restore()}drawPolygon(){return null}createDefs(){return null}createClipPath(){return null}createSvg(){return null}}function S(e,t){const i=e||"";let s=document.getElementById("chartmeasuretext");if(null===s&&(s=(0,a.az)("text",{id:"chartmeasuretext"}),document.body.appendChild(s)),"string"==typeof e&&(e.indexOf("<")>-1||e.indexOf(">")>-1)){const t=e.split(" ");for(let e=0;e<t.length;e++)-1===t[e].indexOf("<br/>")&&(t[e]=t[e].replace(/[<>]/g,"&"));e=t.join(" ")}return s.innerHTML=i.indexOf("<br>")>-1||i.indexOf("<br/>")>-1?i:e,s.style.position="fixed",s.style.fontSize=t.size,s.style.fontWeight=t.fontWeight,s.style.fontStyle=t.fontStyle,s.style.fontFamily=t.fontFamily,s.style.visibility="hidden",s.style.top="-100",s.style.left="0",s.style.whiteSpace="nowrap",s.style.lineHeight="normal",new w(s.clientWidth,s.clientHeight)}function x(e,t,i,s,o,l,a,r,n,h,d){let c="";const p=i.x,u=i.y,g=i.x+i.width,m=i.y+i.height;return d=d||0,l?(c=c.concat("M "+p+" "+(u+t)+" Q "+p+" "+u+" "+(p+e)+" "+u+"  L "+(g-e)+" "+u+" Q "+g+" "+u+" "+g+" "+(u+t)),c=c.concat(" L "+g+" "+(m-t)+" Q "+g+" "+m+" "+(g-e)+" "+m),0!==o&&(c=c.concat(" L "+(s.x+o/2)+" "+m),c=c.concat(" L "+(n+d)+" "+(m+o-d)),c+=" Q "+n+" "+(m+o)+" "+(n-d)+" "+(m+o-d)),c=c.concat(s.x-o/2>p?" L "+(s.x-o/2)+" "+m+" L "+(p+e)+" "+m+" Q "+p+" "+m+" "+p+" "+(m-t)+" z":0===o?" L "+(p+e)+" "+m+" Q "+p+" "+m+" "+p+" "+(m-t)+" z":" L "+p+" "+(m+t)+" z")):a?(c=c.concat("M "+p+" "+(u+t)+" Q "+p+" "+u+" "+(p+e)+" "+u+" L "+(s.x-o/2)+" "+u),c=c.concat(" L "+(n-d)+" "+(s.y+d)),c+=" Q "+n+" "+s.y+" "+(n+d)+" "+(s.y+d),c=c.concat(" L "+(s.x+o/2)+" "+u+" L "+(g-e)+" "+u+" Q "+g+" "+u+" "+g+" "+(u+t)),c=c.concat(" L "+g+" "+(m-t)+" Q "+g+" "+m+" "+(g-e)+" "+m+" L "+(p+e)+" "+m+" Q "+p+" "+m+" "+p+" "+(m-t)+" z")):r?(c=c.concat("M "+p+" "+(u+t)+" Q "+p+" "+u+" "+(p+e)+" "+u),c=c.concat(" L "+(g-e)+" "+u+" Q "+g+" "+u+" "+g+" "+(u+t)+" L "+g+" "+(s.y-o/2)),c=c.concat(" L "+(g+o-d)+" "+(h-d)),c+=" Q "+(g+o)+" "+h+" "+(g+o-d)+" "+(h+d),c=c.concat(" L "+g+" "+(s.y+o/2)+" L "+g+" "+(m-t)+" Q "+g+" "+m+" "+(g-e)+" "+m),c=c.concat(" L "+(p+e)+" "+m+" Q "+p+" "+m+" "+p+" "+(m-t)+" z")):(c=c.concat("M "+(p+e)+" "+u+" Q "+p+" "+u+" "+p+" "+(u+t)+" L "+p+" "+(s.y-o/2)),c=c.concat(" L "+(p-o+d)+" "+(h-d)),c+=" Q "+(p-o)+" "+h+" "+(p-o+d)+" "+(h+d),c=c.concat(" L "+p+" "+(s.y+o/2)+" L "+p+" "+(m-t)+" Q "+p+" "+m+" "+(p+e)+" "+m),c=c.concat(" L "+(g-e)+" "+m+" Q "+g+" "+m+" "+g+" "+(m-t)+" L "+g+" "+(u+t)+" Q "+g+" "+u+" "+(g-e)+" "+u+" z")),c}class w{constructor(e,t){this.width=e,this.height=t}}class C{constructor(e,t,i,s){this.x=e,this.y=t,this.width=i,this.height=s}}class M{constructor(e,t){this.isRight=t,this.isBottom=e}}class T{constructor(e){this.id=e}}class L extends T{constructor(e,t,i,s,o,l="",a,r){super(e),this.transform="",this.baseLine="auto",this.labelRotation=0,this.x=t,this.y=i,this.anchor=s,this.text=o,this.transform=l,this.baseLine=a,this.labelRotation=r}}function A(e){return document.getElementById(e)}function D(e){const t=A(e);t&&(0,a.Od)(t)}function R(e,t,i,s,o,l){const r=new y(""),n=function(e,t,i,s,o){let l,r="Path";const n=t.width,h=t.height,d=e.x,c=e.y,p=e.x+-n/2,u=e.y+-h/2;switch(i){case"Circle":case"Bubble":r="Ellipse",(0,a.TS)(s,{rx:n/2,ry:h/2,cx:d,cy:c});break;case"Cross":l="M "+p+" "+c+" L "+(d+n/2)+" "+c+" M "+d+" "+(c+h/2)+" L "+d+" "+(c+-h/2),(0,a.TS)(s,{d:l});break;case"HorizontalLine":l="M "+p+" "+c+" L "+(d+n/2)+" "+c,(0,a.TS)(s,{d:l});break;case"VerticalLine":l="M "+d+" "+(c+h/2)+" L "+d+" "+(c+-h/2),(0,a.TS)(s,{d:l});break;case"Diamond":l="M "+p+" "+c+" L "+d+" "+(c+-h/2)+" L "+(d+n/2)+" "+c+" L "+d+" "+(c+h/2)+" L "+p+" "+c+" z",(0,a.TS)(s,{d:l});break;case"Rectangle":l="M "+p+" "+(c+-h/2)+" L "+(d+n/2)+" "+(c+-h/2)+" L "+(d+n/2)+" "+(c+h/2)+" L "+p+" "+(c+h/2)+" L "+p+" "+(c+-h/2)+" z",(0,a.TS)(s,{d:l});break;case"Triangle":l="M "+p+" "+(c+h/2)+" L "+d+" "+(c+-h/2)+" L "+(d+n/2)+" "+(c+h/2)+" L "+p+" "+(c+h/2)+" z",(0,a.TS)(s,{d:l});break;case"InvertedTriangle":l="M "+(d+n/2)+" "+(c-h/2)+" L "+d+" "+(c+h/2)+" L "+(d-n/2)+" "+(c-h/2)+" L "+(d+n/2)+" "+(c-h/2)+" z",(0,a.TS)(s,{d:l});break;case"Pentagon":const e=72;let t,i;for(let s=0;s<=5;s++)t=n/2*Math.cos(Math.PI/180*(s*e)),i=h/2*Math.sin(Math.PI/180*(s*e)),l=0===s?"M "+(d+t)+" "+(c+i)+" ":l.concat("L "+(d+t)+" "+(c+i)+" ");l=l.concat("Z"),(0,a.TS)(s,{d:l});break;case"Image":r="Image",(0,a.TS)(s,{href:o,height:h,width:n,x:p,y:u})}return{renderOption:s,functionName:r}}(e,i,t,o,s),h=r["draw"+n.functionName](n.renderOption);return h.setAttribute("aria-label",l),h}class I extends T{constructor(e,t,i,s,o,l,a){super(e),this.opacity=o,this.fill=t,this.stroke=s,this["stroke-width"]=i,this["stroke-dasharray"]=l,this.d=a}}function P(e,t,i,s){let o={};const l=new y("");o={id:e.id,x:e.x,y:e.y,fill:i,"font-size":t.size,"font-style":t.fontStyle,"font-family":t.fontFamily,"font-weight":t.fontWeight,"text-anchor":e.anchor,transform:e.transform,opacity:t.opacity,"dominant-baseline":e.baseLine};const a=l.createText(o,"string"==typeof e.text?e.text:e.text[0]);return a.style.fontFamily=t.fontFamily,a.style.fontStyle=t.fontStyle,a.style.fontSize=t.size,a.style.fontWeight=t.fontWeight,a.style.color=t.color,s.appendChild(a),a}class k{constructor(e,t){this.x=e,this.y=t}}var E=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class F extends a.rt{}E([(0,a.Z9)(null)],F.prototype,"size",void 0),E([(0,a.Z9)("")],F.prototype,"color",void 0),E([(0,a.Z9)("Segoe UI")],F.prototype,"fontFamily",void 0),E([(0,a.Z9)("Normal")],F.prototype,"fontWeight",void 0),E([(0,a.Z9)("Normal")],F.prototype,"fontStyle",void 0),E([(0,a.Z9)(1)],F.prototype,"opacity",void 0);class O extends a.rt{}E([(0,a.Z9)("")],O.prototype,"color",void 0),E([(0,a.Z9)(1)],O.prototype,"width",void 0);class N extends a.rt{}E([(0,a.Z9)(0)],N.prototype,"x",void 0),E([(0,a.Z9)(0)],N.prototype,"y",void 0),E([(0,a.Z9)(0)],N.prototype,"width",void 0),E([(0,a.Z9)(0)],N.prototype,"height",void 0);class z extends a.rt{}E([(0,a.Z9)(0)],z.prototype,"x",void 0),E([(0,a.Z9)(0)],z.prototype,"y",void 0);let _=class extends a.wA{constructor(e,t){super(e,t)}preRender(){this.allowServerDataBinding=!1,this.initPrivateVariable(),this.isCanvas||this.removeSVG(),this.createTooltipElement()}initPrivateVariable(){this.renderer=new y(this.element.id),this.themeStyle=function(e){let t;switch(e){case"Highcontrast":case"HighContrast":t={tooltipFill:"#ffffff",tooltipBoldLabel:"#000000",tooltipLightLabel:"#000000",tooltipHeaderLine:"#969696"};break;case"MaterialDark":case"FabricDark":case"BootstrapDark":t={tooltipFill:"#F4F4F4",tooltipBoldLabel:"#282727",tooltipLightLabel:"#333232",tooltipHeaderLine:"#9A9A9A"};break;case"Bootstrap4":t={tooltipFill:"rgba(0, 0, 0, 0.9)",tooltipBoldLabel:"rgba(255, 255, 255)",tooltipLightLabel:"rgba(255, 255, 255, 0.9)",tooltipHeaderLine:"rgba(255, 255, 255, 0.2)"};break;case"Tailwind":t={tooltipFill:"#111827",tooltipBoldLabel:"#D1D5DB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280"};break;case"TailwindDark":t={tooltipFill:"#F9FAFB",tooltipBoldLabel:"#6B7280",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#9CA3AF"};break;default:t={tooltipFill:"rgba(0, 8, 22, 0.75)",tooltipBoldLabel:"#ffffff",tooltipLightLabel:"#dbdbdb",tooltipHeaderLine:"#ffffff"}}return t}(this.theme),this.formattedText=[],this.padding=5,this.isFirst=!0,this.markerPoint=[]}removeSVG(){const e=document.getElementById(this.element.id+"_svg"),t=document.getElementById(this.element.id+"parent_template");this.blazorTemplate&&(0,a.oL)(this.element.id+"parent_template_blazorTemplate"),e&&e.parentNode&&(0,a.Od)(e),t&&t.parentNode&&(0,a.Od)(t)}render(){if(this.fadeOuted=!1,this.template)this.updateTemplateFn(),this.createTemplate(this.areaBounds,this.location);else{this.renderText(this.isFirst),this.trigger("tooltipRender",{cancel:!1,name:"tooltipRender",tooltip:this});const e=this.renderTooltipElement(this.areaBounds,this.location);this.drawMarker(e.isBottom,e.isRight,this.markerSize)}this.trigger("loaded",{tooltip:this});const e=document.getElementById("chartmeasuretext");e&&(0,a.Od)(e),this.allowServerDataBinding=!0}createTooltipElement(){if(this.textElements=[],!this.template||this.shared){const e=this.renderer.createSvg({id:this.element.id+"_svg"});this.element.appendChild(e);let t=document.getElementById(this.element.id+"_group");t||(t=this.renderer.createGroup({id:this.element.id+"_group"}),t.setAttribute("transform","translate(0,0)")),e.appendChild(t);const i=this.renderer.drawPath({id:this.element.id+"_path","stroke-width":this.border.width,fill:this.fill||this.themeStyle.tooltipFill,opacity:"TailwindDark"!==this.theme&&"Tailwind"!==this.theme||.75!==this.opacity?this.opacity:1,stroke:this.border.color});t.appendChild(i)}}drawMarker(e,t,i){if(this.shapes.length<=0)return null;let s,o=0;const l=this.renderer.createGroup({id:this.element.id+"_trackball_group"}),a=A(this.element.id+"_group"),r=2*this.marginX+i/2+(t?this.arrowPadding:0);for(const n of this.shapes)"None"!==n&&(s=new I(this.element.id+"_Trackball_"+o,this.palette[o],1,"#cccccc",1,null),this.markerPoint[o]&&l.appendChild(R(new k(r,this.markerPoint[o]-this.padding+(e?this.arrowPadding:0)),n,new w(i,i),"",s,null)),o++);a.appendChild(l)}renderTooltipElement(e,t){const i=A(this.element.id),s=new k(0,0),o=new k(0,0),l=A(this.element.id+"_svg"),r=A(this.element.id+"_group"),n=A(this.element.id+"_path");let h,d=!1,c=!1,p=!1,u=0,g=0;if(this.tipRadius=1,""!==this.header&&(this.elementSize.height+=this.marginY),this.content.length>1?(h=this.sharedTooltipLocation(e,this.location.x,this.location.y),d=!0):(h=this.tooltipLocation(e,t,s,o),this.inverted?(c=h.x<t.x+this.clipBounds.x,u=c?0:this.arrowPadding):(d=h.y<t.y+this.clipBounds.y,p=!d,g=d?0:this.arrowPadding)),""!==this.header){const e=S(this.isWrap?this.wrappedText:this.header,this.textStyle).height+2*this.marginY+(p?this.arrowPadding:0)+(this.isWrap?5:0),t=this.renderer.drawPath({id:this.element.id+"_header_path","stroke-width":1,fill:null,opacity:.8,stroke:this.themeStyle.tooltipHeaderLine,d:"M "+(3*this.marginX+(c||d||p?0:this.arrowPadding))+" "+e+"L "+(h.width+(c||d||p?0:this.arrowPadding)-2*this.marginX)+" "+e});r.appendChild(t)}const m=this.border.width/2,b=new C(m+u,m+g,h.width-m,h.height-m);if(r.setAttribute("opacity","1"),!this.enableAnimation||this.shared||this.isFirst?this.updateDiv(i,h.x,h.y):this.animateTooltipDiv(i,h),l.setAttribute("height",(h.height+this.border.width+(this.inverted?0:this.arrowPadding)+5).toString()),l.setAttribute("width",(h.width+this.border.width+(this.inverted?this.arrowPadding:0)+5).toString()),l.setAttribute("opacity","1"),(0,a.le)(this.tooltipPlacement)||(d=this.tooltipPlacement.indexOf("Top")>-1,p=this.tooltipPlacement.indexOf("Bottom")>-1,c=this.tooltipPlacement.indexOf("Left")>-1),n.setAttribute("d",x(this.rx,this.ry,b,s,this.arrowPadding,d,p,c,o.x,o.y,this.tipRadius)),this.enableShadow&&"Bootstrap4"!==this.theme){const e=this.element.id+"_shadow";"Tailwind"===this.theme||"TailwindDark"===this.theme?n.setAttribute("box-shadow","0px 1px 2px rgba(0, 0, 0, 0.06), 0px 1px 3px rgba(0, 0, 0, 0.1)"):n.setAttribute("filter",a.AR.isIE?"":"url(#"+e+")");let t='<filter id="'+e+'" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="3"/>';t+='<feOffset dx="3" dy="3" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="0.5"/>',t+='</feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';const i=this.renderer.createDefs();i.setAttribute("id",this.element.id+"SVG_tooltip_definition"),r.appendChild(i),i.innerHTML=t}return n.setAttribute("stroke",this.border.color),this.changeText(new k(u,g),p,!c&&!d&&!p),new M(p,!c&&!d&&!p)}changeText(e,t,i){const s=document.getElementById(this.element.id+"_text");t&&s.setAttribute("transform","translate(0,"+this.arrowPadding+")"),i&&s.setAttribute("transform","translate("+this.arrowPadding+" 0)")}findFormattedText(){this.formattedText=[],""!==this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()&&(this.formattedText=this.formattedText.concat(this.header)),this.formattedText=this.formattedText.concat(this.content)}renderText(e){let t,i=0,s=0,o=0;const l=(0,a.l7)({},this.textStyle,null,!0).properties,r=A(this.element.id+"_group");let n,h,d,c,p="";this.findFormattedText();const u="rtl"===document.body.getAttribute("dir")?"end":"start";this.leftSpace=this.areaBounds.x+this.location.x,this.rightSpace=this.areaBounds.x+this.areaBounds.width-this.leftSpace;const g=this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim(),m=this.header.indexOf("<b>")>-1&&this.header.indexOf("</b>")>-1,b=S(this.formattedText[0],l).width+2*this.marginX+this.arrowPadding,f=this.location.x-b<this.location.x,y=this.areaBounds.x+this.areaBounds.width<this.location.x+b;let v,x=""!==g?this.marginY:0,C=!0,M=!0;this.markerPoint=[];const T=this.shapes.length>0?10:0,R=this.shapes.length>0?5:0;let I,k="Normal",E=this.themeStyle.tooltipLightLabel;const F=22/parseFloat("13px")*parseFloat(l.size);e&&!this.isCanvas||(D(this.element.id+"_text"),D(this.element.id+"_header_path"),D(this.element.id+"_trackball_group"),D(this.element.id+"SVG_tooltip_definition"));const O=new L(this.element.id+"_text",2*this.marginX,2*this.marginY+2*this.padding+(2===this.marginY?3:0),u,""),N=P(O,l,null,r),z=1===this.formattedText.length&&this.formattedText[0].indexOf(" : <b>")>-1,_=""!==this.header,B=_&&m?16:13;for(let a=0,w=this.formattedText.length;a<w;a++)if(h=this.formattedText[a].replace(/<(b|strong)>/g,"<b>").replace(/<\/(b|strong)>/g,"</b>").split(/<br.*?>/g),0===a&&!z&&this.isTextWrap&&(this.leftSpace<b||f)&&(this.rightSpace<b||y)&&(I=Math.round(this.leftSpace>this.rightSpace?this.leftSpace/B:this.rightSpace/B),v=""!==g?g:this.formattedText[a],h=v.match(new RegExp(".{1,"+I+"}","g")),this.wrappedText=m?"<b>"+h.join("<br>")+"</b>":h.join("<br>"),this.isWrap=h.length>1),""!==h[0]){0===a&&""!==g||this.markerPoint.push((""!==g?this.marginY:0)+O.y+i);for(let e=0,r=h.length;e<r;e++){t=h[e].replace(/<b>/g,"<br><b>").replace(/<\/b>/g,"</b><br>").replace(/:/g,"<br>\u200e:<br>").split("<br>"),o=0,M=!0,i+=F;for(let e=0,i=t.length;e<i;e++)d=t[e],/\S/.test(d)||""===d||(d=" "),(!M&&" "===d||""!==d.replace(/<b>/g,"").replace(/<\/b>/g,"").trim())&&(o+=" "!==d?4:0,M&&!C?(c={x:2*this.marginX+(T+R),dy:F+(M?x:0),fill:""},x=null):c=C&&M?{x:""===g?2*this.marginX+(T+R):2*this.marginX+(this.isWrap?T+R:0)}:{},M=!1,n=this.renderer.createTSpan(c,""),N.appendChild(n),d.indexOf("<b>")>-1||m&&0===e&&0===a&&(_||this.isWrap)?(k="bold",E=this.themeStyle.tooltipBoldLabel,p="font-weight:"+k,l.fontWeight=k,n.setAttribute("fill",this.textStyle.color||E)):(p="bold"===k?"font-weight:"+k:"",l.fontWeight=k,n.setAttribute("fill",this.textStyle.color||E)),(d.indexOf("</b>")>-1||m&&e===i-1&&0===a&&(_||this.isWrap))&&(k="Normal",E=this.themeStyle.tooltipLightLabel),n.textContent=d=this.getTooltipTextContent(d),o+=S(d,l).width,""!==p&&(n.style.fontWeight=p.split("font-weight:")[1],n.style.color=n.getAttribute("fill")),n.style.fontFamily="inherit",n.style.fontStyle="inherit",n.style.fontSize="inherit",C=!1);o-=4,s=Math.max(s,o)}}this.elementSize=new w(s+(s>0?2*this.marginX:0),i),this.elementSize.width+=T+R;const Z=N.childNodes[0];if(""!==g&&Z&&!this.isWrap){l.fontWeight="bold";const e=(this.elementSize.width+2*this.padding)/2-S(g,l).width/2;Z.setAttribute("x",e.toString())}}getTooltipTextContent(e){let t=e.match(/<[a-zA-Z\/](.|\n)*?>/g);if((0,a.le)(t))return e;const i=/[\u0590-\u07FF\u200F\u202B\u202E\uFB1D-\uFDFD\uFE70-\uFEFC]/.test(e);for(let s=0;s<t.length;s++)this.isValidHTMLElement(t[s].replace("<","").replace("/","").replace(">","").trim())&&(e=e.replace(t[s],i?"\u200e":""));return e}isValidHTMLElement(e){return"[object HTMLUnknownElement]"!=document.createElement(e).toString()}createTemplate(e,t){const i={cancel:!1,name:"tooltipRender",tooltip:this};this.trigger("tooltipRender",i);const s=document.getElementById(this.element.id);this.isCanvas&&this.removeSVG();const o=s.firstElementChild;if(o&&(0,a.Od)(o),i.cancel)(0,a.Od)(A(this.element.id+"_tooltip"));else{const i=(0,a.az)("div",{id:this.element.id+"parent_template"});let o=this.templateFn(this.data,this.controlInstance,i.id,i.id+"_blazorTemplate","");for(;o&&o.length>0;)(0,a.xr)()||1===o.length?(i.appendChild(o[0]),o=null):i.appendChild(o[0]);s.appendChild(i);const l=this.isCanvas?i:this.element,r=l.getBoundingClientRect();this.padding=0,this.elementSize=new w(r.width,r.height);const n=this.shared?this.sharedTooltipLocation(e,this.location.x,this.location.y):this.tooltipLocation(e,t,new k(0,0),new k(0,0));if(!this.enableAnimation||this.shared||this.isFirst?this.updateDiv(l,n.x,n.y):this.animateTooltipDiv(this.element,n),this.blazorTemplate){const i=()=>{const i=A(s.element.id).getBoundingClientRect();s.elementSize=new w(i.width,i.height);const o=s.tooltipLocation(e,t,new k(0,0),new k(0,0));s.updateDiv(A(s.element.id),o.x,o.y)},s=this;i.bind(s,e,t),(0,a.tx)(this.element.id+"parent_template_blazorTemplate",this.blazorTemplate.name,this.blazorTemplate.parent,void 0,i)}}}sharedTooltipLocation(e,t,i){const s=this.elementSize.height+2*this.marginY,o=new C(t+2*this.padding,i-s-this.padding,this.elementSize.width+2*this.marginX,s);return o.y<e.y&&(o.y+=o.height+2*this.padding),o.x+o.width>e.x+e.width&&(o.x-=o.width+4*this.padding),o}getCurrentPosition(e,t,i,s){const o=this.tooltipPlacement,l=this.clipBounds.x,a=this.clipBounds.y,r=this.offset,n=this.elementSize.width+2*this.marginX,h=this.elementSize.height+2*this.marginY;let d=new k(t.x,t.y);return"Top"===o||"Bottom"===o?(d=new k(d.x+l-this.elementSize.width/2-this.padding,d.y+a-this.elementSize.height-2*this.padding-this.arrowPadding-r),i.x=s.x=n/2,"Bottom"===o&&(d.y=t.y+a+r),e.x+e.width<d.x+n?(d.x=e.width>n?e.x+e.width-n+6:e.x,i.x=s.x=e.width>n?e.x+t.x-d.x:t.x):e.x>d.x&&(d.x=e.x,i.x=s.x=t.x)):(d=new k(d.x+l+r,d.y+a-this.elementSize.height/2-this.padding),i.y=s.y=h/2,"Left"===o&&(d.x=t.x+l-r-(n+this.arrowPadding)),e.y+e.height<d.y+h?(d.y=e.height>h?e.y+e.height-h+6:e.y,i.y=s.y=e.height>h?e.y+t.y-d.y:t.y):e.y>d.y&&(d.y=e.y,i.y=s.y=t.y)),new C(d.x,d.y,n,h)}tooltipLocation(e,t,i,s){if(!(0,a.le)(this.tooltipPlacement))return this.getCurrentPosition(e,t,i,s);let o=new k(t.x,t.y);const l=this.elementSize.width+2*this.marginX,r=this.elementSize.height+2*this.marginY,n=this.offset,h=this.clipBounds.x,d=this.clipBounds.y,c=e.x,p=e.y;return this.inverted?(o=new k(o.x+h+n,o.y+d-this.elementSize.height/2-this.padding),i.y=s.y=r/2,(o.x+l+this.arrowPadding>c+e.width||this.isNegative)&&(o.x=(t.x>e.width?e.width:t.x)+h-n-(l+this.arrowPadding)),o.x<c&&(o.x=(t.x<0?0:t.x)+h+n),o.y<=p&&(i.y-=p-o.y,s.y-=p-o.y,o.y=p),o.y+r>=p+e.height&&(i.y+=o.y+r-(p+e.height),s.y+=o.y+r-(p+e.height),o.y-=o.y+r-(p+e.height)),i.y+this.arrowPadding/2>r-this.ry&&(i.y=r-this.ry-this.arrowPadding/2,s.y=r,this.tipRadius=0),i.y-this.arrowPadding/2<this.ry&&(i.y=this.ry+this.arrowPadding/2,s.y=0,this.tipRadius=0)):(o=new k(o.x+h-this.elementSize.width/2-this.padding,o.y+d-this.elementSize.height-2*this.padding-this.arrowPadding-n),i.x=s.x=l/2,(o.y<p||this.isNegative)&&(o.y=(t.y<0?0:t.y)+d+n),o.y+r+this.arrowPadding>p+e.height&&(o.y=Math.min(t.y,p+e.height)+d-this.elementSize.height-2*this.padding-this.arrowPadding-n),s.x=l/2,o.x<c&&(i.x-=c-o.x,s.x-=c-o.x,o.x=c),o.x+l>c+e.width&&(i.x+=o.x+l-(c+e.width),s.x+=o.x+l-(c+e.width),o.x-=o.x+l-(c+e.width)),i.x+this.arrowPadding/2>l-this.rx&&(i.x=l-this.rx-this.arrowPadding/2,s.x=l,this.tipRadius=0),i.x-this.arrowPadding/2<this.rx&&(i.x=this.rx+this.arrowPadding/2,s.x=0,this.tipRadius=0)),new C(o.x,o.y,l,r)}animateTooltipDiv(e,t){const i=parseFloat(e.style.left),s=parseFloat(e.style.top);let o;new a.fw({}).animate(e,{duration:this.duration,progress:l=>{o=l.timeStamp/l.duration,e.style.animation=null,e.style.left=i+o*(t.x-i)+"px",e.style.top=s+o*(t.y-s)+"px"},end:i=>{this.updateDiv(e,t.x,t.y),this.trigger("animationComplete",{tooltip:this})}})}updateDiv(e,t,i){e.style.left=t+"px",e.style.top=i+"px"}updateTemplateFn(){if(this.template)try{document.querySelectorAll(this.template).length&&(this.templateFn=(0,a.MY)(document.querySelector(this.template).innerHTML.trim()))}catch(e){this.templateFn=(0,a.MY)(this.template)}}fadeOut(){const e=A(this.isCanvas&&!this.template?this.element.id+"_svg":this.element.id);if(e){let t=e.firstChild;if(this.isCanvas&&!this.template&&(t=document.getElementById(this.element.id+"_group")?document.getElementById(this.element.id+"_group"):t),!t)return null;const i=parseFloat(t.getAttribute("opacity"))||1;new a.fw({}).animate(t,{duration:200,progress:e=>{this.progressAnimation(t,i,e.timeStamp/e.duration)},end:()=>{this.fadeOuted=!0,this.endAnimation(t)}})}}progressAnimation(e,t,i){e.style.animation="",e.setAttribute("opacity",(t-i).toString())}endAnimation(e){e.setAttribute("opacity","0"),this.template&&(e.style.display="none"),this.trigger("animationComplete",{tooltip:this})}getPersistData(){return this.addOnPersist([])}getModuleName(){return"tooltip"}destroy(){super.destroy(),this.element.classList.remove("e-tooltip")}onPropertyChanged(e,t){this.blazorTemplate&&(0,a.oL)(this.element.id+"parent_template_blazorTemplate"),this.isFirst=!1,this.render()}};E([(0,a.Z9)(!1)],_.prototype,"enable",void 0),E([(0,a.Z9)(!1)],_.prototype,"shared",void 0),E([(0,a.Z9)(!0)],_.prototype,"enableShadow",void 0),E([(0,a.Z9)(null)],_.prototype,"fill",void 0),E([(0,a.Z9)("")],_.prototype,"header",void 0),E([(0,a.Z9)(.75)],_.prototype,"opacity",void 0),E([(0,a.Zz)({size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},F)],_.prototype,"textStyle",void 0),E([(0,a.Z9)(null)],_.prototype,"template",void 0),E([(0,a.Z9)(!0)],_.prototype,"enableAnimation",void 0),E([(0,a.Z9)(300)],_.prototype,"duration",void 0),E([(0,a.Z9)(!1)],_.prototype,"inverted",void 0),E([(0,a.Z9)(!1)],_.prototype,"isNegative",void 0),E([(0,a.Zz)({color:"#cccccc",width:.5},O)],_.prototype,"border",void 0),E([(0,a.Z9)([])],_.prototype,"content",void 0),E([(0,a.Z9)(10)],_.prototype,"markerSize",void 0),E([(0,a.Zz)({x:0,y:0},z)],_.prototype,"clipBounds",void 0),E([(0,a.Z9)([])],_.prototype,"palette",void 0),E([(0,a.Z9)([])],_.prototype,"shapes",void 0),E([(0,a.Zz)({x:0,y:0},z)],_.prototype,"location",void 0),E([(0,a.Z9)(0)],_.prototype,"offset",void 0),E([(0,a.Z9)(2)],_.prototype,"rx",void 0),E([(0,a.Z9)(2)],_.prototype,"ry",void 0),E([(0,a.Z9)(5)],_.prototype,"marginX",void 0),E([(0,a.Z9)(5)],_.prototype,"marginY",void 0),E([(0,a.Z9)(12)],_.prototype,"arrowPadding",void 0),E([(0,a.Z9)(null)],_.prototype,"data",void 0),E([(0,a.Z9)("Material")],_.prototype,"theme",void 0),E([(0,a.Zz)({x:0,y:0,width:0,height:0},N)],_.prototype,"areaBounds",void 0),E([(0,a.Z9)(null)],_.prototype,"availableSize",void 0),E([(0,a.Z9)()],_.prototype,"blazorTemplate",void 0),E([(0,a.Z9)(!1)],_.prototype,"isCanvas",void 0),E([(0,a.Z9)(!1)],_.prototype,"isTextWrap",void 0),E([(0,a.Z9)(null)],_.prototype,"tooltipPlacement",void 0),E([(0,a.Z9)(null)],_.prototype,"controlInstance",void 0),E([(0,a.ju)()],_.prototype,"tooltipRender",void 0),E([(0,a.ju)()],_.prototype,"loaded",void 0),E([(0,a.ju)()],_.prototype,"animationComplete",void 0),_=E([a.Zl],_);var B=(()=>(function(e){e.axisLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.axisTitleFont={size:"14px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.chartTitleFont={size:"15px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.chartSubTitleFont={size:"11px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.crosshairLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.tooltipLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.legendLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.legendTitleFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.stripLineLabelFont={size:"12px",fontWeight:"Regular",color:"#353535",fontStyle:"Normal",fontFamily:"Segoe UI"},e.stockEventFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"}}(B||(B={})),B))();function Z(e){let t;switch(e){case"Fabric":t=["#4472c4","#ed7d31","#ffc000","#70ad47","#5b9bd5","#c1c1c1","#6f6fe2","#e269ae","#9e480e","#997300"];break;case"Bootstrap4":case"Bootstrap":t=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"HighContrastLight":case"Highcontrast":case"HighContrast":t=["#79ECE4","#E98272","#DFE6B6","#C6E773","#BA98FF","#FA83C3","#00C27A","#43ACEF","#D681EF","#D8BC6E"];break;case"MaterialDark":t=["#00bdae","#404041","#357cd2","#e56590","#f8b883","#70ad47","#dd8abd","#7f84e8","#7bb4eb","#ea7a57"];break;case"FabricDark":t=["#4472c4","#ed7d31","#ffc000","#70ad47","#5b9bd5","#c1c1c1","#6f6fe2","#e269ae","#9e480e","#997300"];break;case"BootstrapDark":t=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"Tailwind":t=["#5A61F6","#65A30D","#334155","#14B8A6","#8B5CF6","#0369A1","#F97316","#9333EA","#F59E0B","#15803D"];break;case"TailwindDark":t=["#8B5CF6","#22D3EE","#F87171","#4ADE80","#E879F9","#FCD34D","#F97316","#2DD4BF","#F472B6","#10B981"];break;default:t=["#00bdae","#404041","#357cd2","#e56590","#f8b883","#70ad47","#dd8abd","#7f84e8","#7bb4eb","#ea7a57"]}return t}function V(e){let t;const i="MaterialDark"===e?"#303030":"FabricDark"===e?"#201F1F":"1A1A1A";switch(e){case"HighContrastLight":case"Highcontrast":case"HighContrast":t={axisLabel:"#ffffff",axisTitle:"#ffffff",axisLine:"#ffffff",majorGridLine:"#BFBFBF",minorGridLine:"#969696",majorTickLine:"#BFBFBF",minorTickLine:"#969696",chartTitle:"#ffffff",legendLabel:"#ffffff",background:"#000000",areaBorder:"#ffffff",errorBar:"#ffffff",crosshairLine:"#ffffff",crosshairFill:"#ffffff",crosshairLabel:"#000000",tooltipFill:"#ffffff",tooltipBoldLabel:"#000000",tooltipLightLabel:"#000000",tooltipHeaderLine:"#969696",markerShadow:"#BFBFBF",selectionRectFill:"rgba(255, 217, 57, 0.3)",selectionRectStroke:"#ffffff",selectionCircleStroke:"#FFD939"};break;case"MaterialDark":case"FabricDark":case"BootstrapDark":t={axisLabel:"#DADADA",axisTitle:"#ffffff",axisLine:" #6F6C6C",majorGridLine:"#414040",minorGridLine:"#514F4F",majorTickLine:"#414040",minorTickLine:" #4A4848",chartTitle:"#ffffff",legendLabel:"#DADADA",background:i,areaBorder:" #9A9A9A",errorBar:"#ffffff",crosshairLine:"#F4F4F4",crosshairFill:"#F4F4F4",crosshairLabel:"#282727",tooltipFill:"#F4F4F4",tooltipBoldLabel:"#282727",tooltipLightLabel:"#333232",tooltipHeaderLine:"#9A9A9A",markerShadow:null,selectionRectFill:"rgba(56,169,255, 0.1)",selectionRectStroke:"#38A9FF",selectionCircleStroke:"#282727"};break;case"Bootstrap4":t={axisLabel:"#212529",axisTitle:"#212529",axisLine:"#CED4DA",majorGridLine:"#CED4DA",minorGridLine:"#DEE2E6",majorTickLine:"#ADB5BD",minorTickLine:"#CED4DA",chartTitle:"#212529",legendLabel:"#212529",background:"#FFFFFF",areaBorder:"#DEE2E6",errorBar:"#000000",crosshairLine:"#6C757D",crosshairFill:"#495057",crosshairLabel:"#FFFFFF",tooltipFill:"rgba(0, 0, 0, 0.9)",tooltipBoldLabel:"rgba(255,255,255)",tooltipLightLabel:"rgba(255,255,255, 0.9)",tooltipHeaderLine:"rgba(255,255,255, 0.2)",markerShadow:null,selectionRectFill:"rgba(255,255,255, 0.1)",selectionRectStroke:"rgba(0, 123, 255)",selectionCircleStroke:"#495057"};break;case"Tailwind":t={axisLabel:"#6B728",axisTitle:"#374151",axisLine:" #D1D5DB",majorGridLine:"#E5E7EB",minorGridLine:"#E5E7EB",majorTickLine:"#D1D5DB",minorTickLine:" #D1D5DB",chartTitle:"#374151",legendLabel:"#374151",background:"rgba(255,255,255, 0.0)",areaBorder:" #E5E7EB",errorBar:"#374151",crosshairLine:"#1F2937",crosshairFill:"#111827",crosshairLabel:"#F9FAFB",tooltipFill:"#111827",tooltipBoldLabel:"#D1D5DB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280"};break;case"TailwindDark":t={axisLabel:"#9CA3AF",axisTitle:"#9CA3AF",axisLine:" #4B5563",majorGridLine:"#374151",minorGridLine:"#374151",majorTickLine:"#4B5563",minorTickLine:" #4B5563",chartTitle:"#D1D5DB",legendLabel:"#D1D5DB",background:"rgba(255,255,255, 0.0)",areaBorder:" #374151",errorBar:"#374151",crosshairLine:"#9CA3AF",crosshairFill:"#F9FAFB",crosshairLabel:"#1F2937",tooltipFill:"#F9FAFB",tooltipBoldLabel:"#6B7280",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#9CA3AF",markerShadow:null,selectionRectFill:"rgba(34,211,238, 0.1)",selectionRectStroke:"#22D3EE",selectionCircleStroke:"#282727"};break;default:t={axisLabel:"#686868",axisTitle:"#424242",axisLine:"#b5b5b5",majorGridLine:"#dbdbdb",minorGridLine:"#eaeaea",majorTickLine:"#b5b5b5",minorTickLine:"#d6d6d6",chartTitle:"#424242",legendLabel:"#353535",background:"#FFFFFF",areaBorder:"Gray",errorBar:"#000000",crosshairLine:"#4f4f4f",crosshairFill:"#4f4f4f",crosshairLabel:"#e5e5e5",tooltipFill:"rgba(0, 8, 22, 0.75)",tooltipBoldLabel:"#ffffff",tooltipLightLabel:"#dbdbdb",tooltipHeaderLine:"#ffffff",markerShadow:null,selectionRectFill:"rgba(41, 171, 226, 0.1)",selectionRectStroke:"#29abe2",selectionCircleStroke:"#29abe2"}}return t}var j=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class H extends a.rt{}j([(0,a.Z9)("Line")],H.prototype,"type",void 0),j([(0,a.Z9)(null)],H.prototype,"color",void 0),j([(0,a.Z9)(1)],H.prototype,"width",void 0),j([(0,a.Z9)(null)],H.prototype,"length",void 0),j([(0,a.Z9)("")],H.prototype,"dashArray",void 0);class q extends a.rt{}j([(0,a.Z9)("Normal")],q.prototype,"fontStyle",void 0),j([(0,a.Z9)("16px")],q.prototype,"size",void 0),j([(0,a.Z9)("Normal")],q.prototype,"fontWeight",void 0),j([(0,a.Z9)("")],q.prototype,"color",void 0),j([(0,a.Z9)("Center")],q.prototype,"textAlignment",void 0),j([(0,a.Z9)("Segoe UI")],q.prototype,"fontFamily",void 0),j([(0,a.Z9)(1)],q.prototype,"opacity",void 0),j([(0,a.Z9)("Trim")],q.prototype,"textOverflow",void 0);class G extends a.rt{}j([(0,a.Z9)("")],G.prototype,"color",void 0),j([(0,a.Z9)(1)],G.prototype,"width",void 0);class Y extends a.rt{}j([(0,a.Z9)(0)],Y.prototype,"x",void 0),j([(0,a.Z9)(0)],Y.prototype,"y",void 0);class W extends a.rt{}j([(0,a.Zz)({},G)],W.prototype,"border",void 0),j([(0,a.Z9)("transparent")],W.prototype,"background",void 0),j([(0,a.Z9)(1)],W.prototype,"opacity",void 0),j([(0,a.Z9)(null)],W.prototype,"backgroundImage",void 0);class U extends a.rt{}j([(0,a.Z9)(10)],U.prototype,"left",void 0),j([(0,a.Z9)(10)],U.prototype,"right",void 0),j([(0,a.Z9)(10)],U.prototype,"top",void 0),j([(0,a.Z9)(10)],U.prototype,"bottom",void 0);class X extends a.rt{}j([(0,a.Z9)(0)],X.prototype,"left",void 0),j([(0,a.Z9)(0)],X.prototype,"right",void 0),j([(0,a.Z9)(0)],X.prototype,"top",void 0),j([(0,a.Z9)(0)],X.prototype,"bottom",void 0);class Q extends a.rt{}j([(0,a.Z9)(!0)],Q.prototype,"enable",void 0),j([(0,a.Z9)(1e3)],Q.prototype,"duration",void 0),j([(0,a.Z9)(0)],Q.prototype,"delay",void 0);class J extends a.rt{}j([(0,a.Z9)(0)],J.prototype,"series",void 0),j([(0,a.Z9)(0)],J.prototype,"point",void 0);class K extends a.rt{}j([(0,a.Z9)(0)],K.prototype,"topLeft",void 0),j([(0,a.Z9)(0)],K.prototype,"topRight",void 0),j([(0,a.Z9)(0)],K.prototype,"bottomLeft",void 0),j([(0,a.Z9)(0)],K.prototype,"bottomRight",void 0);class ${constructor(e,t){this.series=e,this.point=t}}class ee extends a.rt{}j([(0,a.Z9)(null)],ee.prototype,"fill",void 0),j([(0,a.Zz)({color:"transparent",width:0},G)],ee.prototype,"border",void 0),j([(0,a.Z9)("Gap")],ee.prototype,"mode",void 0);class te extends a.rt{}j([(0,a.Z9)(!1)],te.prototype,"enable",void 0),j([(0,a.Z9)(null)],te.prototype,"minY",void 0),j([(0,a.Z9)(null)],te.prototype,"maxY",void 0),j([(0,a.Z9)(null)],te.prototype,"fill",void 0);class ie extends a.rt{}j([(0,a.Z9)(!1)],ie.prototype,"enable",void 0),j([(0,a.Z9)(!0)],ie.prototype,"enableMarker",void 0),j([(0,a.Z9)(!1)],ie.prototype,"shared",void 0),j([(0,a.Z9)(null)],ie.prototype,"fill",void 0),j([(0,a.Z9)(null)],ie.prototype,"header",void 0),j([(0,a.Z9)(.75)],ie.prototype,"opacity",void 0),j([(0,a.Zz)(B.tooltipLabelFont,q)],ie.prototype,"textStyle",void 0),j([(0,a.Z9)(null)],ie.prototype,"format",void 0),j([(0,a.Z9)(null)],ie.prototype,"template",void 0),j([(0,a.Z9)(!0)],ie.prototype,"enableAnimation",void 0),j([(0,a.Z9)(300)],ie.prototype,"duration",void 0),j([(0,a.Z9)(1e3)],ie.prototype,"fadeOutDuration",void 0),j([(0,a.Z9)(!1)],ie.prototype,"enableTextWrap",void 0),j([(0,a.Zz)({color:"#cccccc",width:.5},G)],ie.prototype,"border",void 0);class se extends a.rt{}j([(0,a.Z9)("Years")],se.prototype,"intervalType",void 0),j([(0,a.Z9)(1)],se.prototype,"interval",void 0),j([(0,a.Z9)(null)],se.prototype,"text",void 0),j([(0,a.Z9)(!1)],se.prototype,"selected",void 0);class oe extends a.rt{}j([(0,a.Z9)(43)],oe.prototype,"height",void 0),j([(0,a.Z9)("Bottom")],oe.prototype,"position",void 0),j([(0,a.FE)([],se)],oe.prototype,"periods",void 0);class le{get start(){return this.mStart}get end(){return this.mEnd}get delta(){return this.mEnd-this.mStart}get median(){return this.mStart+(this.mEnd-this.mStart)/2}constructor(e,t){e<t?(this.mStart=e,this.mEnd=t):(this.mStart=t,this.mEnd=e)}}class ae{constructor(e){this.isColumn=0,this.chart=e}calculateNumericNiceInterval(e,t,i){const s=jt(i,e);let o=t/s;if(!(0,a.le)(e.desiredIntervals))return o;const l=Math.pow(10,Math.floor(ht(o,10)));for(const a of e.intervalDivs){const e=l*a;if(s<t/e)break;o=e}return o}getActualRange(e,t){this.initializeDoubleRange(e),!e.startFromZero&&this.isColumn>0?(e.actualRange.interval=e.interval||this.calculateNumericNiceInterval(e,e.doubleRange.delta,t),e.actualRange.max=e.doubleRange.end+e.actualRange.interval,e.actualRange.min=e.doubleRange.start-e.actualRange.interval<0&&e.doubleRange.start>0?0:e.doubleRange.start-e.actualRange.interval):(e.actualRange.interval=e.interval||this.calculateNumericNiceInterval(e,e.doubleRange.delta,t),e.actualRange.min=e.doubleRange.start,e.actualRange.max=e.doubleRange.end)}initializeDoubleRange(e){null!==e.minimum?this.min=e.minimum:null!==this.min&&this.min!==Number.POSITIVE_INFINITY||(this.min=0),null!==e.maximum?this.max=e.maximum:null!==this.max&&this.max!==Number.NEGATIVE_INFINITY||(this.max=5),this.min===this.max&&(this.max=e.valueType.indexOf("Category")>-1?this.max:this.min+1),e.doubleRange=new le(this.min,this.max),e.actualRange={}}calculateRangeAndInterval(e,t){this.calculateRange(t),this.getActualRange(t,e),this.applyRangePadding(t,e),this.calculateVisibleLabels(t,this.chart)}calculateRange(e){if(this.min=null,this.max=null,!Zt(e))for(const t of e.series)t.visible&&(this.paddingInterval=0,e.maxPointLength=t.points.length,((t.type.indexOf("Column")>-1||t.type.indexOf("Histogram")>-1)&&"Horizontal"===e.orientation||t.type.indexOf("Bar")>-1&&"Vertical"===e.orientation)&&("Double"!==t.xAxis.valueType&&"DateTime"!==t.xAxis.valueType||"Auto"!==t.xAxis.rangePadding||(this.paddingInterval=.5*Et(t.xAxis,e.series))),"Horizontal"===e.orientation&&(this.chart.requireInvertedAxis?this.yAxisRange(e,t):this.findMinMax(t.xMin-this.paddingInterval,t.xMax+this.paddingInterval)),"Vertical"===e.orientation&&(this.isColumn+="Column"===t.type||"Bar"===t.type||"Column"===t.drawType?1:0,this.chart.requireInvertedAxis?this.findMinMax(t.xMin-this.paddingInterval,t.xMax+this.paddingInterval):this.yAxisRange(e,t)))}yAxisRange(e,t){t.dragSettings.enable&&this.chart.dragY&&(this.chart.dragY>=e.visibleRange.max&&(t.yMax=this.chart.dragY+e.visibleRange.interval),this.chart.dragY<=e.visibleRange.min&&(t.yMin=this.chart.dragY-e.visibleRange.interval)),this.findMinMax(t.yMin,t.yMax)}findMinMax(e,t){(null===this.min||this.min>e)&&(this.min=e),(null===this.max||this.max<t)&&(this.max=t),this.max===this.min&&this.max<0&&this.min<0&&(this.max=0)}applyRangePadding(e,t){const i=e.actualRange.min,s=e.actualRange.max;if(!Zt(e)){const o=e.actualRange.interval,l=e.getRangePadding(this.chart);"Additional"===l||"Round"===l?this.findAdditional(e,i,s,o):"Normal"===l?this.findNormal(e,i,s,o,t):this.updateActualRange(e,i,s,o)}e.actualRange.delta=e.actualRange.max-e.actualRange.min,this.calculateVisibleRange(t,e)}updateActualRange(e,t,i,s){e.actualRange={min:null!=e.minimum?e.minimum:t,max:null!=e.maximum?e.maximum:i,interval:null!=e.interval?e.interval:s,delta:e.actualRange.delta}}findAdditional(e,t,i,s){let o,l;o=Math.floor(t/s)*s,l=Math.ceil(i/s)*s,"Additional"===e.rangePadding&&(o-=s,l+=s),this.updateActualRange(e,o,l,s)}findNormal(e,t,i,s,o){let l,a,r,n=t;t<0?(n=0,a=t+.05*t,l=s+a%s,.365*s>=l&&(a-=s),a%s<0&&(a=a-s-a%s)):(a=t<5/6*i?0:t-.5*(i-t),a%s>0&&(a-=a%s)),r=i>0?i+.05*(i-n):i-.05*(i-n),l=s-r%s,.365*s>=l&&(r+=s),r%s>0&&(r=r+s-r%s),e.doubleRange=new le(a,r),0===a&&(s=this.calculateNumericNiceInterval(e,e.doubleRange.delta,o),r=Math.ceil(r/s)*s),this.updateActualRange(e,a,r,s)}calculateVisibleRange(e,t){if(t.visibleRange={max:t.actualRange.max,min:t.actualRange.min,delta:t.actualRange.delta,interval:t.actualRange.interval},"Cartesian"===this.chart.chartAreaType){const i=!(0,a.le)(t.zoomingScrollBar)&&t.zoomingScrollBar.isLazyLoad;(t.zoomFactor<1||t.zoomPosition>0)&&!i&&(t.calculateVisibleRangeOnZooming(this.chart),t.calculateAxisRange(e,this.chart),t.visibleRange.interval=t.enableAutoIntervalOnZooming&&"Category"!==t.valueType?this.calculateNumericNiceInterval(t,t.doubleRange.delta,e):t.visibleRange.interval)}t.triggerRangeRender(this.chart,t.visibleRange.min,t.visibleRange.max,t.visibleRange.interval)}calculateVisibleLabels(e,t){e.visibleLabels=[];let i,s=e.visibleRange.min;("chart"!==t.getModuleName()||"PolarRadar"!==t.chartAreaType)&&(e.zoomFactor<1||e.zoomPosition>0||this.paddingInterval)&&(s=e.visibleRange.min-e.visibleRange.min%e.visibleRange.interval);const o=this.getFormat(e),l=null!==o.match("{value}");let r,n=0,h=0;for(e.labelFormat&&e.labelFormat.indexOf("n")>-1&&(h=parseInt(e.labelFormat.substring(1,e.labelFormat.length),10)),e.format=t.intl.getNumberFormat({format:l?"":o,useGrouping:t.useGroupingSeparator}),e.startLabel=e.format(e.visibleRange.min),e.endLabel=e.format(e.visibleRange.max),e.visibleRange.interval&&(e.visibleRange.interval+"").indexOf(".")>=0&&(n=(e.visibleRange.interval+"").split(".")[1].length);s<=e.visibleRange.max&&r!==s;s+=e.visibleRange.interval)r=s,i=(0,a.l7)({},(0,a.NA)("properties",e.labelStyle),null,!0),pt(s,e.visibleRange)&&Bt(t,s,this.formatValue(e,l,o,s),i,e);s&&(s+"").indexOf(".")>=0&&(s+"").split(".")[1].length>10&&(s=(s+"").split(".")[1].length>(h||n)?+s.toFixed(h||n):s,s<=e.visibleRange.max&&Bt(t,s,this.formatValue(e,l,o,s),i,e)),e.getMaxLabelWidth&&e.getMaxLabelWidth(this.chart)}getFormat(e){return e.labelFormat?0===e.labelFormat.indexOf("p")&&-1===e.labelFormat.indexOf("{value}")&&e.isStack100?"{value}%":e.labelFormat:e.isStack100?"{value}%":""}formatValue(e,t,i,s){return t?i.replace("{value}",e.format(s)):e.format(s)}}const re="legendClick",ne="load",he="legendRender",de="textRender",ce="pointRender",pe="sharedTooltipRender",ue="seriesRender",ge="axisLabelRender",me="axisRangeCalculated",be="axisMultiLabelRender",fe="tooltipRender",ye="chartMouseMove",ve="chartMouseClick",Se="pointClick",xe="pointMove",we="chartMouseLeave",Ce="chartMouseDown",Me="chartMouseUp",Te="zoomComplete",Le="dragComplete",Ae="selectionComplete",De="resized",Re="beforeResize",Ie="beforePrint",Pe="scrollStart",ke="scrollEnd",Ee="scrollChanged",Fe="stockEventRender",Oe="multiLevelLabelClick",Ne=/~\d+~/g,ze=/\^\d+\^/g,_e="beforeExport",Be="afterExport",Ze="onZooming";var Ve=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class je extends a.rt{}Ve([(0,a.Z9)("0")],je.prototype,"x",void 0),Ve([(0,a.Z9)("0")],je.prototype,"y",void 0),Ve([(0,a.Z9)(null)],je.prototype,"content",void 0),Ve([(0,a.Z9)("Center")],je.prototype,"horizontalAlignment",void 0),Ve([(0,a.Z9)("Pixel")],je.prototype,"coordinateUnits",void 0),Ve([(0,a.Z9)("Chart")],je.prototype,"region",void 0),Ve([(0,a.Z9)("Middle")],je.prototype,"verticalAlignment",void 0),Ve([(0,a.Z9)(null)],je.prototype,"xAxisName",void 0),Ve([(0,a.Z9)(null)],je.prototype,"yAxisName",void 0),Ve([(0,a.Z9)(null)],je.prototype,"description",void 0);class He extends a.rt{}Ve([(0,a.Z9)("")],He.prototype,"color",void 0),Ve([(0,a.Z9)(1)],He.prototype,"width",void 0),Ve([(0,a.Z9)("Rectangle")],He.prototype,"type",void 0);class qe extends a.rt{}Ve([(0,a.Z9)(null)],qe.prototype,"start",void 0),Ve([(0,a.Z9)(null)],qe.prototype,"end",void 0),Ve([(0,a.Z9)("")],qe.prototype,"text",void 0),Ve([(0,a.Z9)(null)],qe.prototype,"maximumTextWidth",void 0),Ve([(0,a.Z9)(null)],qe.prototype,"customAttributes",void 0),Ve([(0,a.Z9)("")],qe.prototype,"type",void 0);class Ge extends a.rt{}Ve([(0,a.Z9)(!0)],Ge.prototype,"visible",void 0),Ve([(0,a.Z9)(!1)],Ge.prototype,"startFromAxis",void 0),Ve([(0,a.Z9)(null)],Ge.prototype,"start",void 0),Ve([(0,a.Z9)(null)],Ge.prototype,"end",void 0),Ve([(0,a.Z9)(null)],Ge.prototype,"size",void 0),Ve([(0,a.Z9)("#808080")],Ge.prototype,"color",void 0),Ve([(0,a.Z9)(null)],Ge.prototype,"dashArray",void 0),Ve([(0,a.Z9)("Auto")],Ge.prototype,"sizeType",void 0),Ve([(0,a.Z9)(!1)],Ge.prototype,"isRepeat",void 0),Ve([(0,a.Z9)(null)],Ge.prototype,"repeatEvery",void 0),Ve([(0,a.Z9)(null)],Ge.prototype,"repeatUntil",void 0),Ve([(0,a.Z9)(!1)],Ge.prototype,"isSegmented",void 0),Ve([(0,a.Z9)(null)],Ge.prototype,"segmentStart",void 0),Ve([(0,a.Z9)(null)],Ge.prototype,"segmentEnd",void 0),Ve([(0,a.Z9)(null)],Ge.prototype,"segmentAxisName",void 0),Ve([(0,a.Zz)({color:"transparent",width:1},G)],Ge.prototype,"border",void 0),Ve([(0,a.Z9)("")],Ge.prototype,"text",void 0),Ve([(0,a.Z9)(null)],Ge.prototype,"rotation",void 0),Ve([(0,a.Z9)("Middle")],Ge.prototype,"horizontalAlignment",void 0),Ve([(0,a.Z9)("Middle")],Ge.prototype,"verticalAlignment",void 0),Ve([(0,a.Zz)(B.stripLineLabelFont,q)],Ge.prototype,"textStyle",void 0),Ve([(0,a.Z9)("Behind")],Ge.prototype,"zIndex",void 0),Ve([(0,a.Z9)(1)],Ge.prototype,"opacity",void 0);class Ye extends a.rt{}Ve([(0,a.Z9)("Center")],Ye.prototype,"alignment",void 0),Ve([(0,a.Z9)("Wrap")],Ye.prototype,"overflow",void 0),Ve([(0,a.Zz)(B.axisLabelFont,q)],Ye.prototype,"textStyle",void 0),Ve([(0,a.Zz)({color:null,width:1,type:"Rectangle"},He)],Ye.prototype,"border",void 0),Ve([(0,a.FE)([],qe)],Ye.prototype,"categories",void 0);class We extends a.rt{}Ve([(0,a.Z9)(null)],We.prototype,"minimum",void 0),Ve([(0,a.Z9)(null)],We.prototype,"maximum",void 0);class Ue extends a.rt{}Ve([(0,a.Z9)(!1)],Ue.prototype,"enable",void 0),Ve([(0,a.Z9)(null)],Ue.prototype,"pointsLength",void 0),Ve([(0,a.Zz)({},We)],Ue.prototype,"range",void 0);var Xe=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class Qe extends a.rt{constructor(){super(...arguments),this.axes=[],this.nearSizes=[],this.farSizes=[]}computeSize(e,t){let i=0;e.visible&&e.internalVisibility&&(i+=e.findTickSize(e.crossInAxis)+t+e.findLabelSize(e.crossInAxis,5)+.5*e.lineStyle.width),e.opposedPosition?this.farSizes.push(i):this.nearSizes.push(i)}}Xe([(0,a.Z9)("100%")],Qe.prototype,"height",void 0),Xe([(0,a.Zz)({},G)],Qe.prototype,"border",void 0);class Je extends a.rt{constructor(){super(...arguments),this.axes=[],this.nearSizes=[],this.farSizes=[],this.padding=0}computeSize(e,t){let i=0;e.visible&&e.internalVisibility&&(i+=e.findTickSize(e.crossInAxis)+t+e.findLabelSize(e.crossInAxis,5)+.5*e.lineStyle.width),e.opposedPosition?this.farSizes.push(i):this.nearSizes.push(i)}}Xe([(0,a.Z9)("100%")],Je.prototype,"width",void 0),Xe([(0,a.Zz)({},G)],Je.prototype,"border",void 0);class Ke extends a.rt{}Xe([(0,a.Z9)(1)],Ke.prototype,"width",void 0),Xe([(0,a.Z9)("")],Ke.prototype,"dashArray",void 0),Xe([(0,a.Z9)(null)],Ke.prototype,"color",void 0);class $e extends a.rt{}Xe([(0,a.Z9)(.7)],$e.prototype,"width",void 0),Xe([(0,a.Z9)("")],$e.prototype,"dashArray",void 0),Xe([(0,a.Z9)(null)],$e.prototype,"color",void 0);class et extends a.rt{}Xe([(0,a.Z9)(1)],et.prototype,"width",void 0),Xe([(0,a.Z9)("")],et.prototype,"dashArray",void 0),Xe([(0,a.Z9)(null)],et.prototype,"color",void 0);class tt extends a.rt{}Xe([(0,a.Z9)(1)],tt.prototype,"width",void 0),Xe([(0,a.Z9)(5)],tt.prototype,"height",void 0),Xe([(0,a.Z9)(null)],tt.prototype,"color",void 0);class it extends a.rt{}Xe([(0,a.Z9)(.7)],it.prototype,"width",void 0),Xe([(0,a.Z9)(5)],it.prototype,"height",void 0),Xe([(0,a.Z9)(null)],it.prototype,"color",void 0);class st extends a.rt{}Xe([(0,a.Z9)(!1)],st.prototype,"enable",void 0),Xe([(0,a.Z9)(null)],st.prototype,"fill",void 0),Xe([(0,a.Zz)(B.crosshairLabelFont,q)],st.prototype,"textStyle",void 0);class ot extends a.rt{constructor(e,t,i,s){super(e,t,i,s),this.visibleLabels=[],this.series=[],this.rect=new C(void 0,void 0,0,0),this.axisBottomLine=null,this.intervalDivs=[10,5,2,1],this.isStack100=!1,this.crossAt=null,this.updatedRect=null,this.multiLevelLabelHeight=0,this.isChart=!0,this.isIntervalInDecimal=!0,this.titleCollection=[],this.titleSize=new w(0,0),this.internalVisibility=!0,this.angle=this.labelRotation}findTickSize(e){return"Inside"===this.tickPosition?0:!e||e.visibleRange&&!this.isInside(e.visibleRange)?this.majorTickLines.height:0}isInside(e){return ct(this.crossAt,e)||!this.opposedPosition&&this.crossAt>=e.max||this.opposedPosition&&this.crossAt<=e.min}findLabelSize(e,t){let i=0;const s="Horizontal"===this.orientation;if(this.title&&(this.titleSize=S(this.title,this.titleStyle),i=this.titleSize.height+t,this.rect.width||this.rect.height)&&(this.titleCollection=vi(this.title,this.titleStyle,s?this.rect.width:this.rect.height),i*=this.titleCollection.length),"Inside"===this.labelPosition)return i+t;let o,l,a=i+t+this.titlePadding+this.labelPadding+("Vertical"===this.orientation?this.maxLabelSize.width:this.maxLabelSize.height)+this.multiLevelLabelHeight;if(e&&this.placeNextToAxisLine){const t=e.visibleRange,i="Horizontal"===e.orientation?e.rect.width:e.rect.height;if(!t||!i)return 0;this.isInside(t)&&(l=this.findDifference(e),o=l*(i/t.delta),o=l*((i-(o<a?a-o:0))/t.delta),a=o<a?a-o:0)}return a}updateCrossValue(){let e=this.crossAt;if(null===e||!this.isInside(this.crossInAxis.visibleRange))return this.updatedRect=this.rect,null;const t=this.crossInAxis.visibleRange;this.opposedPosition?this.crossAt<t.min&&(e=t.min):this.crossAt>t.max&&(e=t.max),this.updatedRect=(0,a.l7)({},this.rect,null,!0),"Horizontal"===this.orientation?(e=this.crossInAxis.rect.height-wt(e,this.crossInAxis)*this.crossInAxis.rect.height,this.updatedRect.y=this.crossInAxis.rect.y+e):(e=wt(e,this.crossInAxis)*this.crossInAxis.rect.width,this.updatedRect.x=this.crossInAxis.rect.x+e)}findDifference(e){let t=0;return t=this.opposedPosition?e.isInversed?e.visibleRange.min:e.visibleRange.max:e.isInversed?e.visibleRange.max:e.visibleRange.min,Math.abs(this.crossAt-t)}calculateVisibleRangeOnZooming(e){if(Vt(this)){const t=this.actualRange;let i,s;!this.isInversed||e.zoomModule?(i=this.actualRange.min+this.zoomPosition*this.actualRange.delta,s=i+this.zoomFactor*this.actualRange.delta):(i=this.actualRange.max-this.zoomPosition*this.actualRange.delta,s=i-this.zoomFactor*this.actualRange.delta),i<t.min&&(s+=t.min-i,i=t.min),s>t.max&&(i-=s-t.max,s=t.max),this.doubleRange=new le(i,s),this.visibleRange={min:this.doubleRange.start,max:this.doubleRange.end,delta:this.doubleRange.delta,interval:this.visibleRange.interval}}}calculateAxisRange(e,t){if(t.enableAutoIntervalOnBothAxis){if("Horizontal"===this.orientation&&"X"===t.zoomSettings.mode)for(let i=0;i<this.series.length;i++){const s=[];for(const e of this.series[i].visiblePoints)e.xValue>this.visibleRange.min&&e.xValue<this.visibleRange.max&&s.push(e.yValue);for(const o of t.axisCollections)"Vertical"!==o.orientation||(0,a.le)(o.series[i])||(o.series[i].yMin=Math.min(...s),o.series[i].yMax=Math.max(...s),o.baseModule.calculateRangeAndInterval(e,o))}if("Vertical"===this.orientation&&"Y"===t.zoomSettings.mode)for(let i=0;i<this.series.length;i++){const s=[];for(const e of this.series[i].visiblePoints)e.yValue>this.visibleRange.min&&e.yValue<this.visibleRange.max&&s.push(e.xValue);for(const o of t.axisCollections)"Horizontal"!==o.orientation||(0,a.le)(o.series[i])||(o.series[i].xMin=Math.min(...s),o.series[i].xMax=Math.max(...s),o.baseModule.calculateRangeAndInterval(e,o))}}}triggerRangeRender(e,t,i,s){const o={cancel:!1,name:me,axis:this,minimum:t,maximum:i,interval:s};e.trigger(me,o),o.cancel||(this.visibleRange={min:o.minimum,max:o.maximum,interval:o.interval,delta:o.maximum-o.minimum})}getRangePadding(e){let t=this.rangePadding;if("Auto"!==t)return t;switch(this.orientation){case"Horizontal":t=e.requireInvertedAxis?this.isStack100||this.baseModule.chart.stockChart?"Round":"Normal":"None";break;case"Vertical":t=e.requireInvertedAxis?"None":this.isStack100||this.baseModule.chart.stockChart?"Round":"Normal"}return t}getMaxLabelWidth(e){let t,i,s=0,o=!1;this.angle=this.labelRotation,this.maxLabelSize=new w(0,0);const l=this.labelIntersectAction;let r;for(let a=0,n=this.visibleLabels.length;a<n;a++){r=this.visibleLabels[a],i=at(r.originalText),i?(r.size=S(r.originalText.replace(/<br>/g," "),this.labelStyle),r.breakLabelSize=S(this.enableTrim?r.text.join("<br>"):r.originalText,this.labelStyle)):r.size=S(r.text,this.labelStyle);const e=i?r.breakLabelSize.width:r.size.width;e>this.maxLabelSize.width&&(this.maxLabelSize.width=e,this.rotatedLabel=r.text);const n=i?r.breakLabelSize.height:r.size.height;if(n>this.maxLabelSize.height&&(this.maxLabelSize.height=n),i&&(r.text=this.enableTrim?r.text:r.originalText.split("<br>")),"None"!==l&&"Hide"!==l&&"Trim"!==l&&("None"!==l||this.angle%360==0)&&"Horizontal"===this.orientation&&this.rect.width>0&&!o){const e=i?r.breakLabelSize.width:r.size.width;switch(t=wt(r.value,this)*this.rect.width+this.rect.x,t-=e/2,"Shift"===this.edgeLabelPlacement&&(0===a&&t<this.rect.x&&(t=this.rect.x),a===this.visibleLabels.length-1&&t+e>this.rect.x+this.rect.width&&(t=this.rect.x+this.rect.width-e)),l){case"MultipleRows":a>0&&this.findMultiRows(a,t,r,i);break;case"Rotate45":case"Rotate90":a>0&&(this.isInversed?t+e>=s:t<=s)&&(this.angle="Rotate45"===l?45:90,o=!0);break;default:if(i){let e;const t=[];let i;for(let s=0;s<r.text.length;s++)if(e=xi(r.text[s],this.rect.width/this.visibleLabels.length,this.labelStyle),e.length>1)for(let o=0;o<e.length;o++)i=e[o],t.push(i);else t.push(e[0]);r.text=t}else r.text=xi(r.text,this.rect.width/this.visibleLabels.length,this.labelStyle);const n=r.size.height*r.text.length;n>this.maxLabelSize.height&&(this.maxLabelSize.height=n)}s=this.isInversed?t:t+e}}if(0!==this.angle&&"Horizontal"===this.orientation){this.rotatedLabel=(0,a.le)(this.rotatedLabel)?"":this.rotatedLabel;const t=-360===this.angle||0===this.angle||-180===this.angle||180===this.angle||360===this.angle;this.maxLabelSize="Outside"===this.labelPosition&&!t&&at(this.rotatedLabel)?new w(this.maxLabelSize.height,this.maxLabelSize.width):function(e,t,i,s){const o=new y(s.element.id);let l,r,n,h,d,c=[];const p={id:"rotate_text",x:s.initialClipRect.x,y:s.initialClipRect.y,"font-size":e.size,"font-style":e.fontStyle,"font-family":e.fontFamily,"font-weight":e.fontWeight,transform:"rotate("+i+", 0, 0)","text-anchor":"middle"};at(t)?(c=t.split("<br>"),l=c[0]):l=t;const u=o.createText(p,l);if(s.delayRedraw||s.redraw||s.element.appendChild(s.svgObject),"string"!=typeof c&&c.length>1)for(let a=1,m=c.length;a<m;a++)r=S(c[a],e).height,n=p.y+a*r,h=c[a],d=o.createTSpan({x:p.x,id:p.id,y:n},h),u.appendChild(d);s.svgObject.appendChild(u);const g=u.getBoundingClientRect();return(0,a.Od)(u),s.delayRedraw||s.redraw||(0,a.Od)(s.svgObject),new w(g.right-g.left,g.bottom-g.top)}(this.labelStyle,this.rotatedLabel,this.angle,e)}e.multiLevelLabelModule&&this.multiLevelLabels.length>0&&e.multiLevelLabelModule.getMultilevelLabelsHeight(this)}findMultiRows(e,t,i,s){let o,l,a;const r=[];let n;for(let d=e-1;d>=0;d--)o=this.visibleLabels[d],a=s?o.breakLabelSize.width:o.size.width,l=wt(o.value,this)*this.rect.width+this.rect.x,n=this.isInversed?t+i.size.width>l-.5*a:t<l+.5*a,n?(r.push(o.index),i.index=i.index>o.index?i.index:o.index+1):i.index=r.indexOf(o.index)>-1?i.index:o.index;const h=(s?i.breakLabelSize.height:i.size.height)*i.index+5*(i.index-1);h>this.maxLabelSize.height&&(this.maxLabelSize.height=h)}getModule(e){this.baseModule="Double"===this.valueType?new ae(e):e[kt(this.valueType)+"Module"]}}Xe([(0,a.Zz)(B.axisLabelFont,q)],ot.prototype,"labelStyle",void 0),Xe([(0,a.Zz)({},st)],ot.prototype,"crosshairTooltip",void 0),Xe([(0,a.Z9)("")],ot.prototype,"title",void 0),Xe([(0,a.Zz)(B.axisTitleFont,q)],ot.prototype,"titleStyle",void 0),Xe([(0,a.Z9)("")],ot.prototype,"labelFormat",void 0),Xe([(0,a.Z9)("")],ot.prototype,"skeleton",void 0),Xe([(0,a.Z9)("DateTime")],ot.prototype,"skeletonType",void 0),Xe([(0,a.Z9)("Center")],ot.prototype,"lineBreakAlignment",void 0),Xe([(0,a.Z9)(0)],ot.prototype,"plotOffset",void 0),Xe([(0,a.Z9)(null)],ot.prototype,"plotOffsetLeft",void 0),Xe([(0,a.Z9)(null)],ot.prototype,"plotOffsetTop",void 0),Xe([(0,a.Z9)(null)],ot.prototype,"plotOffsetRight",void 0),Xe([(0,a.Z9)(null)],ot.prototype,"plotOffsetBottom",void 0),Xe([(0,a.Z9)(!1)],ot.prototype,"isIndexed",void 0),Xe([(0,a.Z9)(10)],ot.prototype,"logBase",void 0),Xe([(0,a.Z9)(0)],ot.prototype,"columnIndex",void 0),Xe([(0,a.Z9)(0)],ot.prototype,"rowIndex",void 0),Xe([(0,a.Z9)(1)],ot.prototype,"span",void 0),Xe([(0,a.Z9)(null)],ot.prototype,"desiredIntervals",void 0),Xe([(0,a.Z9)(3)],ot.prototype,"maximumLabels",void 0),Xe([(0,a.Z9)(1)],ot.prototype,"zoomFactor",void 0),Xe([(0,a.Z9)(0)],ot.prototype,"zoomPosition",void 0),Xe([(0,a.Z9)(!0)],ot.prototype,"enableScrollbarOnZooming",void 0),Xe([(0,a.Z9)(!1)],ot.prototype,"opposedPosition",void 0),Xe([(0,a.Z9)(!0)],ot.prototype,"enableAutoIntervalOnZooming",void 0),Xe([(0,a.Z9)("Auto")],ot.prototype,"rangePadding",void 0),Xe([(0,a.Z9)("Double")],ot.prototype,"valueType",void 0),Xe([(0,a.Z9)("None")],ot.prototype,"edgeLabelPlacement",void 0),Xe([(0,a.Z9)("Auto")],ot.prototype,"intervalType",void 0),Xe([(0,a.Z9)("BetweenTicks")],ot.prototype,"labelPlacement",void 0),Xe([(0,a.Z9)("Outside")],ot.prototype,"tickPosition",void 0),Xe([(0,a.Z9)("Outside")],ot.prototype,"labelPosition",void 0),Xe([(0,a.Z9)("")],ot.prototype,"name",void 0),Xe([(0,a.Z9)(!0)],ot.prototype,"visible",void 0),Xe([(0,a.Z9)(0)],ot.prototype,"minorTicksPerInterval",void 0),Xe([(0,a.Z9)(0)],ot.prototype,"labelRotation",void 0),Xe([(0,a.Z9)(null)],ot.prototype,"crossesAt",void 0),Xe([(0,a.Z9)(!0)],ot.prototype,"placeNextToAxisLine",void 0),Xe([(0,a.Z9)(null)],ot.prototype,"crossesInAxis",void 0),Xe([(0,a.Z9)(null)],ot.prototype,"minimum",void 0),Xe([(0,a.Z9)(null)],ot.prototype,"maximum",void 0),Xe([(0,a.Z9)(null)],ot.prototype,"interval",void 0),Xe([(0,a.Z9)(34)],ot.prototype,"maximumLabelWidth",void 0),Xe([(0,a.Z9)(!1)],ot.prototype,"enableTrim",void 0),Xe([(0,a.Z9)(5)],ot.prototype,"labelPadding",void 0),Xe([(0,a.Z9)(5)],ot.prototype,"titlePadding",void 0),Xe([(0,a.Zz)({},tt)],ot.prototype,"majorTickLines",void 0),Xe([(0,a.Zz)({},it)],ot.prototype,"minorTickLines",void 0),Xe([(0,a.Zz)({},Ke)],ot.prototype,"majorGridLines",void 0),Xe([(0,a.Zz)({},$e)],ot.prototype,"minorGridLines",void 0),Xe([(0,a.Zz)({},et)],ot.prototype,"lineStyle",void 0),Xe([(0,a.Z9)("Trim")],ot.prototype,"labelIntersectAction",void 0),Xe([(0,a.Z9)(!1)],ot.prototype,"isInversed",void 0),Xe([(0,a.Z9)(100)],ot.prototype,"coefficient",void 0),Xe([(0,a.Z9)(0)],ot.prototype,"startAngle",void 0),Xe([(0,a.Z9)(!0)],ot.prototype,"startFromZero",void 0),Xe([(0,a.Z9)(null)],ot.prototype,"description",void 0),Xe([(0,a.Z9)(2)],ot.prototype,"tabIndex",void 0),Xe([(0,a.FE)([],Ge)],ot.prototype,"stripLines",void 0),Xe([(0,a.FE)([],Ye)],ot.prototype,"multiLevelLabels",void 0),Xe([(0,a.Zz)({color:null,width:0,type:"Rectangle"},He)],ot.prototype,"border",void 0),Xe([(0,a.Zz)({},Ue)],ot.prototype,"scrollbarSettings",void 0);class lt{constructor(e,t,i,s,o=new w(0,0),l=new w(0,0),a=1){this.text=e,this.originalText=s,this.value=t,this.labelStyle=i,this.size=o,this.breakLabelSize=l,this.index=a}}function at(e){return-1!==e.indexOf("<br>")}function rt(e){const t=(0,a.l7)([],e.points,null,!0),i=[];let s,o=0;for(let l=0;l<t.length;l++)s=t[l],(0,a.le)(s.x)||""===s.x||(s.index=o++,i.push(s));return i}function nt(e){if(!e)return null;const t="string"==typeof e?Yt(e):e;t&&(0,a.Od)(t)}function ht(e,t){return Math.log(e)/Math.log(t)}function dt(e,t,i,s,o,l,r,n){let h=document.getElementById(o);const d=S(e,{fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"Regular"}),c=d.width+5;t=t+c>s?t-(c+15):t,i=n?i-d.height/2:i+15,h?(h.innerHTML=e,h.style.top=i.toString()+"px",h.style.left=(t+15).toString()+"px"):(h=(0,a.az)("div",{innerHTML:e,id:o,styles:"top:"+i.toString()+"px;left:"+(t+15).toString()+'px;background-color: rgb(255, 255, 255) !important; color:black !important; position:absolute;border:1px solid rgb(112, 112, 112); padding-left : 3px; padding-right : 2px;padding-bottom : 2px; padding-top : 2px; font-size:12px; font-family: "Segoe UI"'}),l.appendChild(h),parseInt(h.style.left.replace("px",""),10)<0&&(h.style.left="0px")),r&&setTimeout(()=>{nt(o)},1500)}function ct(e,t){return e<t.max&&e>t.min}function pt(e,t){return e<=t.max&&e>=t.min}function ut(e,t){return"Logarithmic"===t.valueType?ht(e,t.logBase):e}function gt(e,t,i,s){const o=ut(t.xValue,s.xAxis),l=e?ut(e.xValue,s.xAxis):o,a=i?ut(i.xValue,s.xAxis):o,r=Math.floor(s.xAxis.visibleRange.min),n=Math.ceil(s.xAxis.visibleRange.max);return l>=r&&l<=n||o>=r&&o<=n||a>=r&&a<=n||r>=l&&r<=a}function mt(e){let t=0;for(const i of e)t+=i;return t}function bt(e,t){return e.x+=t.left,e.y+=t.top,e.width-=t.left+t.right,e.height-=t.top+t.bottom,e}function ft(e,t,i){const s=e*Math.PI/180;return new Ri(Math.cos(s)*t+i.x,Math.sin(s)*t+i.y)}function yt(e){return e*(Math.PI/180)}function vt(e,t,i,s){const o=[];for(let l=0;l<4;l++){const a=e[l],r=a.x-t,n=a.y-i,h=r*Math.cos(yt(s))-n*Math.sin(yt(s)),d=r*Math.sin(yt(s))+n*Math.cos(yt(s));a.x=h+t,a.y=d+i,o.push(new Ri(a.x,a.y))}return o}function St(e,t){const i=[e,t];let s,o,l,r,n,h,d,c;for(r=0;r<i.length;r++){const p=i[r];for(n=0;n<p.length;n++){const i=p[n],r=p[(n+1)%p.length],u=new Ri(r.y-i.y,i.x-r.x);for(s=o=void 0,h=0;h<e.length;h++)l=u.x*e[h].x+u.y*e[h].y,((0,a.le)(s)||l<s)&&(s=l),((0,a.le)(o)||l>o)&&(o=l);for(d=c=void 0,h=0;h<t.length;h++)l=u.x*t[h].x+u.y*t[h].y,((0,a.le)(d)||l<d)&&(d=l),((0,a.le)(c)||l>c)&&(c=l);if(o<d||c<s)return!1}}return!0}function xt(e,t){const i=[];for(let s=0;s<=t-1;s++)i.push(e[s]);return i}function wt(e,t){const i=t.visibleRange,s=(e-i.min)/i.delta;return t.isInversed?1-s:s}function Ct(e,t,i,s,o,l){e="Logarithmic"===i.valueType?ht(e>1?e:1,i.logBase):e,t="Logarithmic"===s.valueType?ht(t>1?t:1,s.logBase):t,e+="Category"===i.valueType&&"BetweenTicks"===i.labelPlacement&&"Radar"!==l.type?.5:0;const a=l.chart.radius*wt(t,s),r=Tt(Lt(e,i),l.chart.primaryXAxis.startAngle);return{x:l.clipRect.width/2+l.clipRect.x+a*r.x,y:l.clipRect.height/2+l.clipRect.y+a*r.y}}function Mt(e,t=!1){let i=["NaN","NaN"];return e.indexOf("_Point_")>-1?i=e.split("_Series_")[1].split("_Point_"):e.indexOf("_shape_")>-1&&(!t||t&&-1===e.indexOf("_legend_"))?(i=e.split("_shape_"),i[0]="0"):e.indexOf("_text_")>-1&&(!t||t&&-1===e.indexOf("_legend_"))&&(i=e.split("_text_"),i[0]="0"),new $(parseInt(i[0],10),parseInt(i[1],10))}function Tt(e,t){t=t<0?t+360:t;let i=Math.PI*(1.5-2*e);return i+=t*Math.PI/180,{x:Math.cos(i),y:Math.sin(i)}}function Lt(e,t){const i=t.visibleRange;let s,o;return"Category"!==t.valueType?(s=i.max-("DateTime"===t.valueType?t.dateTimeInterval:i.interval)-i.min,o=t.visibleLabels.length-1,s=0===s?1:s):(s=1===t.visibleLabels.length?1:t.visibleLabels[t.visibleLabels.length-1].value-t.visibleLabels[0].value,o=t.visibleLabels.length),t.isInversed?(e-i.min)/s*(1-1/o):1-(e-i.min)/s*(1-1/o)}class At{constructor(e,t,i,s,o){this.startAngle=e,this.endAngle=t,this.innerRadius=i,this.radius=s,this.currentXPosition=o}}function Dt(e,t,i,s=0,o=0){return e>=i.x-s&&e<=i.x+i.width+s&&t>=i.y-o&&t<=i.y+i.height+o}function Rt(e,t,i){return(i.isInversed?1-e/t:e/t)*i.visibleRange.delta+i.visibleRange.min}function It(e,t,i){return(i.isInversed?e/t:1-e/t)*i.visibleRange.delta+i.visibleRange.min}function Pt(e){const t=e.clipRect;e.chart.requireInvertedAxis?(t.x=e.yAxis.rect.x,t.y=e.xAxis.rect.y,t.width=e.yAxis.rect.width,t.height=e.xAxis.rect.height):(t.x=e.xAxis.rect.x,t.y=e.yAxis.rect.y,t.width=e.xAxis.rect.width,t.height=e.yAxis.rect.height)}function kt(e){return e.substr(0,1).toLowerCase()+e.substr(1)}function Et(e,t){let i,s,o,l=Number.MAX_VALUE;for(let r=0;r<t.length;r++){const n=t[r];if(i=[],n.visible&&(e.name===n.xAxisName||"primaryXAxis"===e.name&&null===n.xAxisName||e.name===n.chart.primaryXAxis.name&&!n.xAxisName))if(i=n.points.map(e=>e.xValue),i.sort((e,t)=>e-t),1===i.length)o="DateTime"===e.valueType&&n.xMin===n.xMax?n.xMin-2592e6:n.xMin,s=i[0]-((0,a.le)(o)?e.visibleRange.min:o),0!==s&&(l=Math.min(l,s));else for(let e=0;e<i.length;e++){const t=i[e];e>0&&t&&(s=t-i[e-1],0!==s&&(l=Math.min(l,s)))}}return l===Number.MAX_VALUE&&(l=1),l}function Ft(e){let t;switch(e){case"Linear":t=Ot}return t}function Ot(e,t,i,s){return-i*Math.cos(e/s*(Math.PI/2))+i+t}function Nt(e,t,i,s,o,l,r){const n=l.x,h=l.y;let d=0;e.style.visibility="hidden",new a.fw({}).animate(e,{duration:i,delay:t,progress:t=>{t.timeStamp>t.delay&&(t.element.style.visibility="visible",d=(t.timeStamp-t.delay)/t.duration,e.setAttribute("transform","translate("+n+" "+h+") scale("+d+") translate("+-n+" "+-h+")"))},end:()=>{e.style.visibility="","Scatter"!==s.type&&"Bubble"!==s.type||r||o!==s.points.length-1||s.chart.trigger("animationComplete",{series:s.chart.isBlazor?{}:s})}})}function zt(e,t,i,s,o){if(!i||!s&&!e)return null;let l=300;o&&(l=o);const r=s||e.getAttribute("d"),n=r.split(/(?=[LMCZAQ])/),h=t.split(/(?=[LMCZAQ])/);let d,c,p,u=[],g=[];e.setAttribute("d",r),new a.fw({}).animate((0,a.az)("div"),{duration:l,progress:t=>{d="",n.map((e,i)=>{if(u=e.split(" "),g=h[i]?h[i].split(" "):u,d+="Z"===u[0]?"Z ":u[0]+" "+Ot(t.timeStamp,+u[1],+g[1]-+u[1],t.duration)+" "+Ot(t.timeStamp,+u[2],+g[2]-+u[2],t.duration)+" ","C"===u[0]||"Q"===u[0])for(c=3,p="Q"===u[0]?4:6;c<p;)d+=Ot(t.timeStamp,+u[c],+g[c]-+u[c],t.duration)+" "+Ot(t.timeStamp,+u[++c],+g[c]-+u[c],t.duration)+" ",++c;"A"===u[0]&&(d+="0 0 1 "+Ot(t.timeStamp,+u[6],+g[6]-+u[6],t.duration)+" "+Ot(t.timeStamp,+u[7],+g[7]-+u[7],t.duration)+" ")}),e.setAttribute("d",d)},end:()=>{e.setAttribute("d",t)}})}function _t(e,t,i,s="drawClipPath"){const o=gi(e,t.id,t,i);if(o){const e=i.createDefs();return e.appendChild(o),e}return i[s](t)}function Bt(e,t,i,s,o){const l={cancel:!1,name:ge,axis:o,text:i,value:t,labelStyle:s};if(e.trigger(ge,l),!l.cancel){const e=-1!==l.text.indexOf("<br>"),t=o.enableTrim?e?function(e,t,i){const s=[],o=t.split("<br>");for(let l=0;l<o.length;l++){let a=S(t=o[l],i).width;if(a>e){for(let o=t.length-1;o>=0;--o)if(a=S(t=t.substring(0,o)+"...",i).width,a<=e){s.push(t);break}}else s.push(t)}return s}(o.maximumLabelWidth,l.text,o.labelStyle):pi(o.maximumLabelWidth,l.text,o.labelStyle):l.text;o.visibleLabels.push(new lt(t,l.value,l.labelStyle,l.text))}}function Zt(e){return null!=e.minimum&&null!=e.maximum}function Vt(e){return e.zoomFactor<1&&e.zoomPosition>=0}function jt(e,t){const i="Horizontal"===t.orientation?e.width:e.height;if((0,a.le)(t.desiredIntervals)){let e=("Horizontal"===t.orientation?.533:1)*t.maximumLabels;return e=Math.max(i*(e/100),1),e}return t.desiredIntervals}function Ht(e,t,i,s,o){new a.fw({}).animate(e,{duration:i,delay:t,name:s,progress:e=>{e.element.style.visibility="visible"},end:e=>{o?(0,a.Od)(e.element):e.element.style.visibility="visible"}})}function qt(e,t,i,s,o,l,r,n,h,d){const c=r||new y(""),p=function(e,t,i,s,o,l,r){let n,h="Path";const d=l&&"Circle"===i?t.width-2:t.width,c=l&&"Circle"===i?t.height-2:t.height,p=l?r.targetWidth:0,u=e.x,g=e.y,m=e.y+-c/2,b=e.x+-d/2;let f,y;switch(i){case"Bubble":case"Circle":h="Ellipse",(0,a.TS)(s,{rx:d/2,ry:c/2,cx:u,cy:g});break;case"Cross":n="M "+b+" "+g+" L "+(u+d/2)+" "+g+" M "+u+" "+(g+c/2)+" L "+u+" "+(g+-c/2),(0,a.TS)(s,{d:n,stroke:s.fill});break;case"Multiply":n="M "+(u-p)+" "+(g-p)+" L "+(u+p)+" "+(g+p)+" M "+(u-p)+" "+(g+p)+" L "+(u+p)+" "+(g-p),(0,a.TS)(s,{d:n,stroke:s.fill});break;case"HorizontalLine":n="M "+b+" "+g+" L "+(u+d/2)+" "+g,(0,a.TS)(s,{d:n});break;case"VerticalLine":n="M "+u+" "+(g+c/2)+" L "+u+" "+(g+-c/2),(0,a.TS)(s,{d:n});break;case"Diamond":n="M "+b+" "+g+" L "+u+" "+(g+-c/2)+" L "+(u+d/2)+" "+g+" L "+u+" "+(g+c/2)+" L "+b+" "+g+" z",(0,a.TS)(s,{d:n});break;case"ActualRect":n="M "+b+" "+(g+-c/8)+" L "+(u+p)+" "+(g+-c/8)+" L "+(u+p)+" "+(g+c/8)+" L "+b+" "+(g+c/8)+" L "+b+" "+(g+-c/8)+" z",(0,a.TS)(s,{d:n});break;case"TargetRect":n="M "+(b+p)+" "+(g+-c/2)+" L "+(u+p/2)+" "+(g+-c/2)+" L "+(u+p/2)+" "+(g+c/2)+" L "+(b+p)+" "+(g+c/2)+" L "+(b+p)+" "+(g+-c/2)+" z",(0,a.TS)(s,{d:n});break;case"Rectangle":case"Hilo":case"HiloOpenClose":case"Candle":case"Waterfall":case"BoxAndWhisker":case"StepArea":case"StackingStepArea":case"Square":case"Flag":n="M "+b+" "+(g+-c/2)+" L "+(u+d/2)+" "+(g+-c/2)+" L "+(u+d/2)+" "+(g+c/2)+" L "+b+" "+(g+c/2)+" L "+b+" "+(g+-c/2)+" z",(0,a.TS)(s,{d:n});break;case"Pyramid":case"Triangle":n="M "+b+" "+(g+c/2)+" L "+u+" "+(g+-c/2)+" L "+(u+d/2)+" "+(g+c/2)+" L "+b+" "+(g+c/2)+" z",(0,a.TS)(s,{d:n});break;case"Funnel":case"InvertedTriangle":n="M "+(u+d/2)+" "+(g-c/2)+" L "+u+" "+(g+c/2)+" L "+(u-d/2)+" "+(g-c/2)+" L "+(u+d/2)+" "+(g-c/2)+" z",(0,a.TS)(s,{d:n});break;case"Pentagon":for(let e=0;e<=5;e++)f=d/2*Math.cos(Math.PI/180*(72*e)),y=c/2*Math.sin(Math.PI/180*(72*e)),n=0===e?"M "+(u+f)+" "+(g+y)+" ":n.concat("L "+(u+f)+" "+(g+y)+" ");n=n.concat("Z"),(0,a.TS)(s,{d:n});break;case"Image":h="Image",(0,a.TS)(s,{href:o,height:c,width:d,x:b,y:m})}return{renderOption:s=function(e,t,i,s){let o="";const l=t.height,r=t.width,n=e.x,h=e.y;switch(i){case"MultiColoredLine":case"Line":case"StackingLine":case"StackingLine100":o="M "+(n+-r/2)+" "+h+" L "+(n+r/2)+" "+h,(0,a.TS)(s,{d:o});break;case"StepLine":s.fill="transparent",o="M "+(n+-r/2-2.5)+" "+(h+l/2)+" L "+(n+-r/2+r/10)+" "+(h+l/2)+" L "+(n+-r/2+r/10)+" "+h+" L "+(n+-r/10)+" "+h+" L "+(n+-r/10)+" "+(h+l/2)+" L "+(n+r/5)+" "+(h+l/2)+" L "+(n+r/5)+" "+(h+-l/2)+" L "+(n+r/2)+" "+(h+-l/2)+"L "+(n+r/2)+" "+(h+l/2)+" L"+(n+r/2+2.5)+" "+(h+l/2),(0,a.TS)(s,{d:o});break;case"UpArrow":s.fill=s.stroke,s.stroke="transparent",o="M "+(n+-r/2)+" "+(h+l/2)+" L "+n+" "+(h-l/2)+" L "+(n+r/2)+" "+(h+l/2)+"L "+(n+r/2-2)+" "+(h+l/2)+" L "+n+" "+(h-l/2+4)+"L"+(n-r/2+2)+" "+(h+l/2)+" Z",(0,a.TS)(s,{d:o});break;case"DownArrow":o="M "+(n-r/2)+" "+(h-l/2)+" L "+n+" "+(h+l/2)+" L "+(n+r/2)+" "+(h-l/2)+"L "+(n+r/2-2)+" "+(h-l/2)+" L "+n+" "+(h+l/2-4)+"L"+(n-r/2+2)+" "+(h-l/2)+" Z",(0,a.TS)(s,{d:o});break;case"RightArrow":o="M "+(n+-r/2)+" "+(h-l/2)+" L "+(n+r/2)+" "+h+" L "+(n+-r/2)+" "+(h+l/2)+" L "+(n+-r/2)+" "+(h+l/2-2)+" L "+(n+r/2-4)+" "+h+" L"+(n+-r/2)+" "+(h-l/2+2)+" Z",(0,a.TS)(s,{d:o});break;case"LeftArrow":s.fill=s.stroke,s.stroke="transparent",o="M "+(n+r/2)+" "+(h-l/2)+" L "+(n+-r/2)+" "+h+" L "+(n+r/2)+" "+(h+l/2)+" L "+(n+r/2)+" "+(h+l/2-2)+" L "+(n+-r/2+4)+" "+h+" L"+(n+r/2)+" "+(h-l/2+2)+" Z",(0,a.TS)(s,{d:o});break;case"Column":case"Pareto":case"StackingColumn":case"StackingColumn100":case"RangeColumn":case"Histogram":o="M "+(n-r/5*3)+" "+(h-l/5)+" L "+(n+-r/10*3)+" "+(h-l/5)+" L "+(n+-r/10*3)+" "+(h+l/2)+" L "+(n-r/5*3)+" "+(h+l/2)+" Z M "+(n+-r/10-r/20)+" "+(h-l/4-5)+" L "+(n+r/10+r/20)+" "+(h-l/4-5)+" L "+(n+r/10+r/20)+" "+(h+l/2)+" L "+(n+-r/10-r/20)+" "+(h+l/2)+" Z M "+(n+r/10*3)+" "+h+" L "+(n+r/5*3)+" "+h+" L "+(n+r/5*3)+" "+(h+l/2)+" L "+(n+r/10*3)+" "+(h+l/2)+" Z",(0,a.TS)(s,{d:o});break;case"Bar":case"StackingBar":case"StackingBar100":o="M "+(n+-r/2+-2.5)+" "+(h-l/5*3)+" L "+(n+r/10*3)+" "+(h-l/5*3)+" L "+(n+r/10*3)+" "+(h-l/10*3)+" L "+(n-r/2-2.5)+" "+(h-l/10*3)+" Z M "+(n+-r/2+-2.5)+" "+(h-l/5+.5)+" L "+(n+r/2+2.5)+" "+(h-l/5+.5)+" L "+(n+r/2+2.5)+" "+(h+l/10+.5)+" L "+(n-r/2-2.5)+" "+(h+l/10+.5)+" Z M "+(n-r/2-2.5)+" "+(h+l/5+1)+" L "+(n+-r/4)+" "+(h+l/5+1)+" L "+(n+-r/4)+" "+(h+l/2+1)+" L "+(n-r/2-2.5)+" "+(h+l/2+1)+" Z",(0,a.TS)(s,{d:o});break;case"Spline":s.fill="transparent",o="M "+(n-r/2)+" "+(h+l/5)+" Q "+n+" "+(h-l)+" "+n+" "+(h+l/5)+" M "+n+" "+(h+l/5)+" Q "+(n+r/2)+" "+(h+l/2)+" "+(n+r/2)+" "+(h-l/2),(0,a.TS)(s,{d:o});break;case"Area":case"MultiColoredArea":case"RangeArea":case"StackingArea":case"StackingArea100":o="M "+(n-r/2-2.5)+" "+(h+l/2)+" L "+(n+-r/4+-1.25)+" "+(h-l/2)+" L "+n+" "+(h+l/4)+" L "+(n+r/4+1.25)+" "+(h+-l/2+l/4)+" L "+(n+l/2+2.5)+" "+(h+l/2)+" Z",(0,a.TS)(s,{d:o});break;case"SplineArea":case"SplineRangeArea":o="M "+(n-r/2)+" "+(h+l/5)+" Q "+n+" "+(h-l)+" "+n+" "+(h+l/5)+" Z M "+n+" "+(h+l/5)+" Q "+(n+r/2)+" "+(h+l/2)+" "+(n+r/2)+" "+(h-l/2)+"  Z",(0,a.TS)(s,{d:o});break;case"Pie":case"Doughnut":s.stroke="transparent",o=function(e,t,i,s,o,l){const a=ft(270,i,new Ri(e,t)),r=ft(270,i,new Ri(e+o/10,t));return"M "+e+" "+t+" L "+(e+i)+" "+t+" A "+i+" "+i+" 0 1 1 "+a.x+" "+a.y+" Z M "+(e+o/10)+" "+(t-s/10)+" L"+(e+i)+" "+(t-s/10)+" A "+i+" "+i+" 0 0 0 "+r.x+" "+r.y+" Z"}(n,h,Math.min(l,r)/2,l,r),(0,a.TS)(s,{d:o})}return{renderOption:s}}(e,new w(d,c),i,s).renderOption,functionName:h}}(e,i,t,o,s,h,d);return c["draw"+p.functionName](p.renderOption,n?new Int32Array([n.x,n.y]):null)}function Gt(e,t,i){return e>i?i:e<t?t:e}function Yt(e){return document.getElementById(e)}function Wt(e,t,i,s,o,l,a,r,n,h){let d=e.getBoundingClientRect();t.accumulationDataLabelModule.calculateLabelSize(i,e,l,s,o,a,r,n,h,d,!0)}function Ut(e,t,i,s,o,l){let a=document.getElementById(t.element.id+"_Series_"+(void 0===s.index?s.category:s.index)+"_DataLabelCollections");a&&(0===i.index&&(t.dataLabelCollections=[]),t.dataLabelModule.calculateTemplateLabelSize(a,e,i,s,s.marker.dataLabel,o,s.clipRect,l,!0))}function Xt(e,t,i,s,o,l,r,n,h,d,c,p,u,g,m){const b=function(e){let t=null;try{document.querySelectorAll(e).length&&(t=(0,a.MY)(document.querySelector(e).innerHTML.trim()))}catch(i){t=(0,a.MY)(e)}return t}(i);let f;try{const i=window.Blazor?r?o:{point:o}:{chart:s,series:l,point:o},a=r?r+"_template":"template",y=b?b(i,s,a,r||e.id.replace(/[^a-zA-Z0-9]/g,"")):[];if(y.length){f=Array.prototype.slice.call(y);const t=f.length;for(let i=0;i<t;i++)e.appendChild(f[i])}let v;"accumulationchart"===s.getModuleName()?(v=Wt.bind(this,e,s,d,c,h,c[t],p,u,g,m),s.isReact&&s.renderReactTemplates(v)):"chart"===s.getModuleName()&&(v=o&&l?Ut.bind(this,e,s,o,l,n,m):v,s.isReact&&s.renderReactTemplates(v))}catch(y){return e}return e}function Qt(e){let t="";return t="font-size:"+e.size+"; font-style:"+e.fontStyle+"; font-weight:"+e.fontWeight+"; font-family:"+e.fontFamily+";opacity:"+e.opacity+"; color:"+e.color+";",t}function Jt(e,t=!1,i){i||document.body.appendChild(e);const s=e.getBoundingClientRect();return t?(0,a.Od)(e):i||nt(e.id),s}function Kt(e,t,i,s,o){e="Logarithmic"===i.valueType?ht(e>0?e:Math.pow(i.logBase,i.visibleRange.min),i.logBase):e,t="Logarithmic"===s.valueType?ht(t>0?t:Math.pow(s.logBase,s.visibleRange.min),s.logBase):t,e=wt(e,i),t=wt(t,s);const l=o?i.rect.height:i.rect.width,a=o?s.rect.width:s.rect.height;return new Ri(o?t*a:e*l,o?(1-e)*l:(1-t)*a)}function $t(e,t,i,s,o=!1,l="x",r="y",n,h,d=!1,c=!1,p=null,u){if(e)return null;const g=t.querySelector("#"+i.id),m=g||Yt(i.id),b=i,f=u||300;if(s&&o&&m)if(n=n||("DIV"===m.tagName?new Ri(+m.style[l].split("px")[0],+m.style[r].split("px")[0]):new Ri(+m.getAttribute(l),+m.getAttribute(r))),h&&"undefined"!==h)zt(i,i.getAttribute("d"),s,h,f);else if(c&&p)!function(e,t,i,s,o){const l=t=>{e.setAttribute("x",t.x+""),e.setAttribute("y",t.y+""),e.setAttribute("width",t.width+""),e.setAttribute("height",t.height+"")};new a.fw({}).animate((0,a.az)("div"),{duration:i,delay:0,progress:e=>{l(new C(Ot(e.timeStamp,o.x,s.x-o.x,e.duration),Ot(e.timeStamp,o.y,s.y-o.y,e.duration),Ot(e.timeStamp,o.width,s.width-o.width,e.duration),Ot(e.timeStamp,o.height,s.height-o.height,e.duration)))},end:()=>{l(s)}})}(b,0,f,new C(+m.getAttribute("x"),+m.getAttribute("y"),+m.getAttribute("width"),+m.getAttribute("height")),p);else{const e="DIV"===b.tagName?new Ri(+b.style[l].split("px")[0],+b.style[r].split("px")[0]):new Ri(+b.getAttribute(l),+b.getAttribute(r));mi(b,f,n,e,l,r)}else s&&o&&!m&&d&&Ht(b,0,600,"FadeIn");g?t.replaceChild(b,m):t.appendChild(b)}function ei(e,t,i,s,o){const l=Math.abs(e-i),a=Math.abs(t-s),r=Math.max(ti(Math.min(e,i),l,o.x,o.width),o.x),n=Math.max(ti(Math.min(t,s),a,o.y,o.height),o.y);return new C(r,n,Math.min(l,o.width),Math.min(a,o.height))}function ti(e,t,i,s){return e<i?e=i:e+t>s+i&&(e=s+i-t),e}function ii(e,t,i){const s=t.yAxis.labelFormat,o=[],l=null!==s.match("{value}");switch(t.seriesType){case"XY":"PolarRadar"===t.chart.chartAreaType?-1!==t.drawType.indexOf("Stacking")?("Logarithmic"===t.yAxis.valueType&&ut(t.stackedValues.endValues[e.index],t.yAxis)||pt(t.stackedValues.endValues[e.index],t.yAxis.visibleRange))&&o.push(e.text||e.yValue.toString()):("Logarithmic"===t.yAxis.valueType&&ut(e.yValue,t.yAxis)||pt(e.yValue,t.yAxis.visibleRange))&&o.push(e.text||e.yValue.toString()):o.push(e.text||e.yValue.toString());break;case"HighLow":o.push(e.text||Math.max(e.high,e.low).toString()),o.push(e.text||Math.min(e.high,e.low).toString());break;case"HighLowOpenClose":o.push(e.text||Math.max(e.high,e.low).toString()),o.push(e.text||Math.min(e.high,e.low).toString()),o.push(e.text||Math.max(e.open,e.close).toString()),o.push(e.text||Math.min(e.open,e.close).toString());break;case"BoxPlot":o.push(e.text||e.median.toString()),o.push(e.text||e.maximum.toString()),o.push(e.text||e.minimum.toString()),o.push(e.text||e.upperQuartile.toString()),o.push(e.text||e.lowerQuartile.toString());for(const t of e.outliers)o.push(e.text||t.toString())}if(s&&!e.text){t.yAxis.format=i.intl.getNumberFormat({format:l?"":s,useGrouping:i.useGroupingSeparator});for(let e=0;e<o.length;e++)o[e]=l?s.replace("{value}",t.yAxis.format(parseFloat(o[e]))):t.yAxis.format(parseFloat(o[e]))}return o}function si(e){window.clearInterval(e)}function oi(e,t,i){const s=new C(e.x+i.x,e.y+i.y,e.width,e.height);return t.some(e=>s.x<e.x+e.width&&s.x+s.width>e.x&&s.y<e.y+e.height&&s.height+s.y>e.y)}function li(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.height+e.y>t.y}function ai(e,t,i){return new C(e.x-t.width/2-i.left,e.y-t.height/2-i.top,t.width+i.left+i.right,t.height+i.top+i.bottom)}function ri(e){return"#"+ni(e.r)+ni(e.g)+ni(e.b)}function ni(e){const t=e.toString(16);return 1===t.length?"0"+t:t}function hi(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?new Pi(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)):new Pi(255,255,255)}function di(e){e="transparent"===e?"white":e,document.body.appendChild((0,a.az)("text",{id:"chartmeasuretext"}));const t=document.getElementById("chartmeasuretext");t.style.color=e,e=window.getComputedStyle(t).color,(0,a.Od)(t);const i=/^(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/.exec(e);return ri(new Pi(parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10)))}function ci(e,t){(e=(e=di(e)).replace(/[^0-9a-f]/gi,"")).length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;let i,s="#";for(let o=0;o<3;o++)i=parseInt(e.substr(2*o,2),16),i=Math.round(Math.min(Math.max(0,i+i*t),255)),s+=("00"+i.toString(16)).substr(i.toString(16).length);return s}function pi(e,t,i){let s=t,o=S(t,i).width;if(o>e)for(let l=t.length-1;l>=0;--l)if(s=t.substring(0,l)+"...",o=S(s,i).width,o<=e)return s;return s}function ui(e,t){return null!=e?-1!==e.indexOf("%")?t/100*parseInt(e,10):parseInt(e,10):null}function gi(e,t,i,s){if(!e)return null;const o=Yt(t);return o&&i&&s.setElementAttributes(i,"clipPath"===o.tagName?o.childNodes[0]:o),o}function mi(e,t,i,s,o="x",l="y"){const r="DIV"===e.tagName,n=(t,i)=>{r?(e.style[o]=t+"px",e.style[l]=i+"px"):(e.setAttribute(o,t+""),e.setAttribute(l,i+""))};n(i.x,i.y),new a.fw({}).animate((0,a.az)("div"),{duration:t,progress:e=>{n(Ot(e.timeStamp,i.x,s.x-i.x,e.duration),Ot(e.timeStamp,i.y,s.y-i.y,e.duration))},end:()=>{n(s.x,s.y)}})}function bi(e,t,i,s,o,l=!1,a,r,n=!1,h,d,c,p,u){let g,m,b,f,y={};y={id:t.id,x:t.x,y:t.y,fill:s||"black","font-size":i.size,"font-style":i.fontStyle,"font-family":i.fontFamily,"font-weight":i.fontWeight,"text-anchor":t.anchor,labelRotation:t.labelRotation,transform:t.transform,opacity:i.opacity,"dominant-baseline":t.baseLine};const x=e.createText(y,"string"==typeof t.text?t.text:l?t.text[t.text.length-1]:t.text[0],d?d.x:0,d?d.y:0);if(x.style.fontFamily=i.fontFamily,x.style.fontStyle=i.fontStyle,x.style.fontSize=i.size,x.style.fontWeight=i.fontWeight,x.style.color=i.color,x.style.textAnchor=t.anchor,"string"!=typeof t.text&&t.text.length>1)for(let v=1,w=t.text.length;v<w;v++)m=S(t.text[v],i).height,b=t.y+(l?-v*m:v*m),f=l?t.text[t.text.length-(v+1)]:t.text[v],u?g=e.createText(y,f,null,null,b,!0):(g=e.createTSpan({x:t.x,id:t.id,y:b},f),x.appendChild(g));return p||$t(e instanceof v,o,x,a,r,"x","y",null,null,n,!1,null,h),x}function fi(e){let t=e.element.clientWidth||e.element.offsetWidth,i=e.element.clientHeight;e.stockChart&&(t=e.stockChart.availableSize.width,i=e.stockChart.availableSize.height);let s,o=450;if("rangeNavigator"===e.getModuleName()){const t=e,i=t.periodSelectorSettings.periods.length?t.periodSelectorSettings.height:0;s=t.margin.top+t.margin.bottom+(t.tooltip.enable?35:0);const l=S("tempString",t.labelStyle).height,r=15;o=(e.series.length?a.AR.isDevice?80:120:(t.enableGrouping?40+r+l:40)+s)+i,t.disableRangeSelector&&(o=i)}e.availableSize=new w(ui(e.width,t)||t||600,ui(e.height,i||o)||i||o)}function yi(e){e.canvasRender=new v(e.element.id),e.renderer=e.enableCanvas?e.canvasRender:new y(e.element.id),fi(e),e.svgObject=e.stockChart&&"chart"===e.getModuleName()?e.stockChart.chartObject:e.stockChart&&"rangeNavigator"===e.getModuleName()?e.stockChart.selectorObject:e.enableCanvas?e.renderer.createCanvas({id:e.element.id+"_canvas",width:e.availableSize.width,height:e.availableSize.height}):e.renderer.createSvg({id:e.element.id+"_svg",width:e.availableSize.width,height:e.availableSize.height})}function vi(e,t,i){let s=[];switch(t.textOverflow){case"Wrap":s=xi(e,i,t);break;case"Trim":s.push(pi(i,e,t));break;default:s.push(e)}return s}function Si(e,t){let i;return i="Near"===t.textAlignment?e.x:"Center"===t.textAlignment?e.x+e.width/2:e.x+e.width,i}function xi(e,t,i){const s=e.split(" ");let o="";const l=[];let a;for(let r=0,n=s.length;r<n;r++)a=s[r],S(o.concat(a),i).width<t?o=o.concat((""===o?"":" ")+a):""!==o?(l.push(pi(t,o,i)),o=a):(l.push(pi(t,a,i)),a=""),o&&r===n-1&&l.push(pi(t,o,i));return l}function wi(e,t){const i=e.replace(t," "),s=e.match(t);let o=" ",l=" ",a=0;const r={0:"\u2080",1:"\u2081",2:"\u2082",3:"\u2083",4:"\u2084",5:"\u2085",6:"\u2086",7:"\u2087",8:"\u2088",9:"\u2089"},n={0:"\u2070",1:"\xb9",2:"\xb2",3:"\xb3",4:"\u2074",5:"\u2075",6:"\u2076",7:"\u2077",8:"\u2078",9:"\u2079"};for(let h=0;h<=i.length-1;h++)if(" "===i[h]){o=s[a].replace(t===Ne?/~/g:/\^/g,"");for(let e=0;e<o.length;e++)l+=t===Ne?r[o[e]]:n[o[e]];a++}else l+=i[h];return l.trim()}function Ci(e){for(let t=0;t<e.annotations.length;t++)(0,a.oL)((e.element.id+"_Annotation_"+t).replace(/[^a-zA-Z0-9]/g,""),"ContentTemplate");(0,a.oL)(e.element.id+"_tooltipparent_template_blazorTemplate","Template"),(0,a.oL)(e.element.id+"_DataLabel")}class Mi{constructor(e,t){this.startValues=e,this.endValues=t}}class Ti extends I{constructor(e,t,i,s,o,l,a,r,n){super(e,t,i.width,i.color,s,n),this.y=o.y,this.x=o.x,this.height=o.height,this.width=o.width,this.rx=l||0,this.ry=a||0,this.transform=r||"",this.stroke=0!==i.width&&""!==this.stroke?i.color:"transparent"}}class Li{constructor(e,t,i,s,o,l,a,r){this.height=e,this.width=t,this.href=i,this.x=s,this.y=o,this.id=l,this.visibility=a,this.preserveAspectRatio=r}}class Ai extends I{constructor(e,t,i,s,o,l,a){super(e,t,i.width,i.color,s),this.cy=l,this.cx=o,this.r=a}}class Di{constructor(e,t,i){this.id=e,this.points=t,this.fill=i}}class Ri{constructor(e,t){this.x=e,this.y=t}}class Ii{constructor(e,t,i,s){this.left=e,this.right=t,this.top=i,this.bottom=s}}class Pi{constructor(e,t,i){this.r=e,this.g=t,this.b=i}}class ki{constructor(e,t,i=0){this.point=e,this.series=t,this.lierIndex=i}}class Ei{constructor(e,t,i=0){this.point=e,this.series=t,this.index=i}}class Fi{constructor(e,t){this.controlPoint1=e,this.controlPoint2=t}}function Oi(e,t){let i,s="";return Number(t)===e.start?s=e.colors[0]:Number(t)===e.end?s=e.colors[e.colors.length-1]:(i=function(e,t){const i=t.start,s=t.end;let o=0;const l=s-i;let a,r,n;if(o=(e-i)/l,t.colors.length<=2)r="#"===t.colors[0].charAt(0)?t.colors[0]:di(t.colors[0]),n="#"===t.colors[t.colors.length-1].charAt(0)?t.colors[t.colors.length-1]:di(t.colors[t.colors.length-1]);else{r="#"===t.colors[0].charAt(0)?t.colors[0]:di(t.colors[0]),n="#"===t.colors[t.colors.length-1].charAt(0)?t.colors[t.colors.length-1]:di(t.colors[t.colors.length-1]);const h=l/(t.colors.length-1);let d,c;const p=t.colors.length-1,u=[];let g={};for(let e=1;e<p;e++)c=e*h,d=i+c,g={b:d,color:t.colors[e]},u.push(g);for(let t=0;t<u.length;t++)i<=e&&e<=u[t].b&&0===t?(a="#"===u[t].color.charAt(0)?u[t].color:di(u[t].color),n=a,o=e<=u[t].b?1-Math.abs((e-u[t].b)/h):(e-u[t].b)/h):u[t].b<=e&&e<=s&&t===u.length-1&&(a="#"===u[t].color.charAt(0)?u[t].color:di(u[t].color),r=a,o=e<u[t].b?1-Math.abs((e-u[t].b)/h):(e-u[t].b)/h),t!==u.length-1&&t<u.length&&u[t].b<=e&&e<=u[t+1].b&&(a="#"===u[t].color.charAt(0)?u[t].color:di(u[t].color),r=a,n="#"===u[t+1].color.charAt(0)?u[t+1].color:di(u[t+1].color),o=Math.abs(e-u[t+1].b)/h)}return function(e,t,i){const s=i.split("#")[1],o=t.split("#")[1],l=Ni(e,parseInt(o.substr(0,2),16),parseInt(s.substr(0,2),16)),a=Ni(e,parseInt(o.substr(2,2),16),parseInt(s.substr(2,2),16)),r=Ni(e,parseInt(o.substr(4,2),16),parseInt(s.substr(4,2),16));return new Pi(l,a,r)}(o,r,n)}(Number(t),e),s=ri(i)),s}function Ni(e,t,i){return Math.round(t+(i-t)*e)}class zi{constructor(e){this.chart=e,this.padding=5}measureAxis(e){const t=this.chart;this.crossAt(t),this.seriesClipRect=new C(e.x,e.y,e.width,e.height),this.initialClipRect=e,this.leftSize=0,this.rightSize=0,this.topSize=0,this.bottomSize=0,this.measureRowAxis(t,this.initialClipRect),this.initialClipRect=bt(this.initialClipRect,new Ii(this.leftSize,this.rightSize,0,0)),this.measureColumnAxis(t,this.initialClipRect),this.initialClipRect=bt(this.initialClipRect,new Ii(0,0,this.topSize,this.bottomSize)),this.chart.delayRedraw||this.calculateAxisSize(this.initialClipRect),this.leftSize=0,this.rightSize=0,this.topSize=0,this.bottomSize=0,this.measureRowAxis(t,this.initialClipRect),this.seriesClipRect=bt(this.seriesClipRect,new Ii(this.leftSize,this.rightSize,0,0)),this.measureColumnAxis(t,this.initialClipRect),this.seriesClipRect=bt(this.seriesClipRect,new Ii(0,0,this.topSize,this.bottomSize)),this.chart.delayRedraw||(t.refreshAxis(),this.calculateAxisSize(this.seriesClipRect))}measureRowAxis(e,t){let i;this.calculateRowSize(t);for(const s of e.rows)i=s,i.nearSizes=[],i.farSizes=[],this.arrangeAxis(i),this.measureDefinition(i,e,new w(e.availableSize.width,i.computedHeight)),this.leftSize<mt(i.nearSizes)&&(this.leftSize=mt(i.nearSizes)),this.rightSize<mt(i.farSizes)&&(this.rightSize=mt(i.farSizes))}measureColumnAxis(e,t){let i;this.calculateColumnSize(t);for(const s of e.columns)i=s,i.farSizes=[],i.nearSizes=[],this.arrangeAxis(i),this.measureDefinition(i,e,new w(i.computedWidth,e.availableSize.height)),this.bottomSize<mt(i.nearSizes)&&(this.bottomSize=mt(i.nearSizes)),this.topSize<mt(i.farSizes)&&(this.topSize=mt(i.farSizes))}measureDefinition(e,t,i){for(const s of e.axes)s.scrollBarHeight=t.scrollBarModule&&t.zoomModule&&t.zoomSettings.enableScrollbar&&s.enableScrollbarOnZooming&&t.zoomModule.isZoomed&&(s.zoomFactor<1||s.zoomPosition>0)?16:0,s.scrollBarHeight=t.scrollBarModule&&(t.zoomModule&&t.zoomSettings.enableScrollbar&&s.enableScrollbarOnZooming&&t.zoomModule.isZoomed&&(s.zoomFactor<1||s.zoomPosition>0)||s.scrollbarSettings.enable)?16:0,s.getModule(t),s.baseModule.calculateRangeAndInterval(i,s),e.computeSize(s,s.scrollBarHeight);e.farSizes.length>0&&(e.farSizes[e.farSizes.length-1]-=10),e.nearSizes.length>0&&(e.nearSizes[e.nearSizes.length-1]-=10)}calculateAxisSize(e){const t=this.chart;let i,s,o,l,a,r,n,h=0,d=0,c=0;this.calculateRowSize(e);for(let p=0,u=t.rows.length;p<u;p++){i=t.rows[p],h=0,d=0;for(let s=0,r=i.axes.length;s<r;s++){if(l=i.axes[s],n=l.plotOffset,0===l.rect.height){l.rect.height=i.computedHeight,c=0;for(let e=p+1,i=p+l.span;e<i;e++)o=t.rows[e],c+=o.computedHeight;l.rect.y=i.computedTop-c+(l.plotOffsetTop?l.plotOffsetTop:n),l.rect.height=l.rect.height+c-this.getAxisOffsetValue(l.plotOffsetTop,l.plotOffsetBottom,l.plotOffset),l.rect.width=0}l.opposedPosition?(a=e.x+e.width+mt(xt(i.farSizes,d)),l.rect.x=l.rect.x>=a?l.rect.x:a,d++):(a=e.x-mt(xt(i.nearSizes,h)),l.rect.x=l.rect.x<=a?l.rect.x:a,h++)}}this.calculateColumnSize(e);for(let p=0,u=t.columns.length;p<u;p++){s=t.columns[p],h=0,d=0;for(let i=0,a=s.axes.length;i<a;i++){if(l=s.axes[i],n=l.plotOffset,0===l.rect.width){for(let e=p,i=p+l.span;e<i;e++)o=t.columns[e],l.rect.width+=o.computedWidth;l.rect.x=s.computedLeft+(l.plotOffsetLeft?l.plotOffsetLeft:n),l.rect.width-=this.getAxisOffsetValue(l.plotOffsetLeft,l.plotOffsetRight,l.plotOffset),l.rect.height=0}l.opposedPosition?(r=e.y-mt(xt(s.farSizes,d)),l.rect.y=l.rect.y<=r?l.rect.y:r,d++):(r=e.y+e.height+mt(xt(s.nearSizes,h)),l.rect.y=l.rect.y>=r?l.rect.y:r,h++)}}}measure(){const e=this.chart;let t,i,s,o,l;for(const a of e.axisCollections)if("Vertical"===a.orientation){e.verticalAxes.push(a),o=this.getActualRow(a),t=e.rows[o],this.pushAxis(t,a),l=o+a.span>e.rows.length?e.rows.length:o+a.span;for(let i=o+1;i<l;i++)s=e.rows[i],s.axes[t.axes.length-1]=a,e.rows[i]=s;e.rows[o]=t}else{e.horizontalAxes.push(a),o=this.getActualColumn(a),i=e.columns[o],this.pushAxis(i,a),l=o+a.span>e.columns.length?e.columns.length:o+a.span;for(let t=o+1;t<l;t++)s=e.columns[t],s.axes[i.axes.length-1]=a,e.columns[t]=s;e.columns[o]=i}}getAxisOffsetValue(e,t,i){return e?e+(t||i):t?t+i:2*i}crossAt(e){for(const t of e.axisCollections)if(null!==t.crossesAt)if(t.crossesInAxis)for(let i=2,s=e.axisCollections.length;i<s;i++)t.crossesInAxis!==e.axisCollections[i].name||(t.crossInAxis=e.axisCollections[i],t.crossAt=this.updateCrossAt(t.crossInAxis,t.crossesAt));else t.crossInAxis=e.requireInvertedAxis?"Horizontal"===t.orientation?e.primaryXAxis:e.primaryYAxis:"Horizontal"===t.orientation?e.primaryYAxis:e.primaryXAxis,t.crossAt=this.updateCrossAt(t.crossInAxis,t.crossesAt)}updateCrossAt(e,t){switch(e.valueType){case"DateTime":const i={skeleton:"full",type:"dateTime"},s=this.chart.intl.getDateParser(i),o=this.chart.intl.getDateFormat(i);return Date.parse(s(o(new Date(r.j4.parse.parseJson({val:t}).val))));case"Category":return parseFloat(t)?parseFloat(t):e.labels.indexOf(t);case"Logarithmic":return ht(t,e.logBase);default:return t}}pushAxis(e,t){for(let i=0,s=e.axes.length;i<=s;i++)if(!e.axes[i]){e.axes[i]=t;break}}arrangeAxis(e){const t=[];for(let i=0,s=e.axes.length;i<=s;i++)e.axes[i]&&t.push(e.axes[i]);e.axes=t}getActualColumn(e){const t=this.chart.columns.length,i=e.columnIndex;return i>=t?t-1:i<0?0:i}getActualRow(e){const t=this.chart.rows.length,i=e.rowIndex;return i>=t?t-1:i<0?0:i}calculateRowSize(e){const t=this.chart;let i,s=e.y+e.height,o=0,l=Math.max(0,e.height);for(let a=0,r=t.rows.length;a<r;a++)i=t.rows[a],o=-1!==i.height.indexOf("%")?Math.min(l,e.height*parseInt(i.height,10)/100):Math.min(l,parseInt(i.height,10)),o=a!==r-1?o:l,i.computedHeight=o,s-=o,i.computedTop=s,l-=o}calculateColumnSize(e){const t=this.chart;let i,s=e.x,o=0,l=Math.max(0,e.width);for(let a=0,r=t.columns.length;a<r;a++)i=t.columns[a],o=-1!==i.width.indexOf("%")?Math.min(l,e.width*parseInt(i.width,10)/100):Math.min(l,parseInt(i.width,10)),o=a!==r-1?o:l,i.computedWidth=o,i.computedLeft=s,s+=o,l-=o}renderAxes(){const e=this.chart;let t;const i=e.renderer.createGroup({id:e.element.id+"AxisInsideCollection"}),s=e.renderer.createGroup({id:e.element.id+"AxisOutsideCollection"});let o,l;for(let a=0,r=e.axisCollections.length;a<r;a++)t=e.axisCollections[a],this.element=e.renderer.createGroup({id:e.element.id+"AxisGroup"+a+"Inside"}),o=e.renderer.createGroup({id:e.element.id+"AxisGroup"+a+"Outside"}),l=this.findAxisPosition(t),"Horizontal"===t.orientation?(t.updateCrossValue(),t.visible&&t.internalVisibility&&t.lineStyle.width>0&&this.drawAxisLine(t,a,t.plotOffset,0,l?o:this.element,t.updatedRect),(t.majorGridLines.width>0||t.majorTickLines.width>0)&&this.drawXAxisGridLine(t,a,l||"Inside"===t.tickPosition?o:this.element,t.updatedRect),t.visible&&t.internalVisibility&&(this.drawXAxisLabels(t,a,l||"Inside"===t.labelPosition?o:this.element,t.placeNextToAxisLine?t.updatedRect:t.rect),this.drawXAxisBorder(t,a,l||"Inside"===t.labelPosition?o:this.element,t.placeNextToAxisLine?t.updatedRect:t.rect),this.drawXAxisTitle(t,a,l?o:this.element,t.placeNextToAxisLine?t.updatedRect:t.rect))):(t.updateCrossValue(),t.visible&&t.internalVisibility&&t.lineStyle.width>0&&this.drawAxisLine(t,a,0,t.plotOffset,l?o:this.element,t.updatedRect),(t.majorGridLines.width>0||t.majorTickLines.width>0)&&this.drawYAxisGridLine(t,a,l||"Inside"===t.tickPosition?o:this.element,t.updatedRect),t.visible&&t.internalVisibility&&(this.drawYAxisLabels(t,a,l||"Inside"===t.labelPosition?o:this.element,t.placeNextToAxisLine?t.updatedRect:t.rect),this.drawYAxisBorder(t,a,l||"Inside"===t.labelPosition?o:this.element,t.placeNextToAxisLine?t.updatedRect:t.rect),this.drawYAxisTitle(t,a,l?o:this.element,t.placeNextToAxisLine?t.updatedRect:t.rect))),this.chart.enableCanvas||(i.appendChild(this.element),o&&o.childNodes.length>0&&s.appendChild(o)),e.scrollBarModule&&(e.zoomSettings.enableScrollbar&&t.enableScrollbarOnZooming||t.scrollbarSettings.enable)&&this.renderScrollbar(e,t);this.element=e.renderer.createGroup({id:e.element.id+"DefinitionLine"});for(let a=0,r=e.rows.length;a<r;a++){const t=e.rows[a];t.border.color&&this.drawBottomLine(t,a,!0)}for(let a=0,r=e.columns.length;a<r;a++){const t=e.columns[a];t.border.color&&this.drawBottomLine(t,a,!1)}return this.chart.enableCanvas||i.appendChild(this.element),$t(e.enableCanvas,e.svgObject,i,e.redraw),s}renderScrollbar(e,t){(!(0,a.le)(e.zoomModule)&&e.zoomModule.isZoomed&&(t.zoomFactor<1||t.zoomPosition>0)||t.scrollbarSettings.enable&&(t.zoomFactor<=1||t.zoomPosition>=0))&&(!t.zoomingScrollBar.isScrollUI||e.visibleSeries[0].type.indexOf("Bar")>=0)?(e.scrollElement||(e.scrollElement=gi(e.redraw,e.element.id+"_scrollElement")||(0,a.az)("div",{id:e.element.id+"_scrollElement"})),$t(!1,e.scrollElement,t.zoomingScrollBar.render(!0),!0)):1===t.zoomFactor&&0===t.zoomPosition&&t.zoomingScrollBar.svgObject&&!t.scrollbarSettings.enable&&t.zoomingScrollBar.destroy(),t.zoomingScrollBar.isScrollUI&&(t.zoomingScrollBar.isScrollUI=!1)}findAxisPosition(e){return null!==e.crossAt&&e.isInside(e.crossInAxis.visibleRange)}drawBottomLine(e,t,i){const s=this.chart;let o,l,a,r,n,h={};i?(a=r=(e=e).computedTop+e.computedHeight,o=this.seriesClipRect.x,l=o+this.seriesClipRect.width,n="Row"):(o=l=(e=e).computedLeft,a=this.seriesClipRect.y,r=a+this.seriesClipRect.height,n="Column"),h={id:s.element.id+"_AxisBottom_"+n+t,x1:o,y1:a,x2:l,y2:r,"stroke-width":e.border.width,stroke:e.border.color},this.htmlObject=s.renderer.drawLine(h),this.element.appendChild(this.htmlObject)}drawAxisLine(e,t,i,s,o,l){const a=this.chart;let r={},n=Yt(a.element.id+"AxisLine_"+t);const h=n?n.getAttribute("d"):"";n=null,r={id:a.element.id+"AxisLine_"+t,d:"M "+(l.x-i)+" "+(l.y-s)+" L "+(l.x+l.width+i)+" "+(l.y+l.height+s),"stroke-dasharray":e.lineStyle.dashArray,"stroke-width":e.lineStyle.width,stroke:e.lineStyle.color||a.themeStyle.axisLine},this.htmlObject=a.renderer.drawPath(r),$t(a.enableCanvas,o,this.htmlObject,a.redraw,!0,"x","y",null,h)}drawYAxisGridLine(e,t,i,s){const o="Logarithmic"===e.valueType,l=e.valueType.indexOf("Category")>-1;let r,n,h=0,d="",c="";const p=e.opposedPosition?e.majorTickLines.height:-e.majorTickLines.height,u=e.opposedPosition?.5*e.lineStyle.width:.5*-e.lineStyle.width,g="Category"===e.valueType&&"BetweenTicks"===e.labelPlacement?.5:0,m=(0,a.le)(e.crossesAt)?e.opposedPosition?e.scrollBarHeight:-e.scrollBarHeight:0,b="Inside"===e.tickPosition,f=b?s.x-p-u:s.x+p+u+m;let y=e.visibleLabels.length;const v=this.chart.themeStyle;e.valueType.indexOf("Category")>-1&&"BetweenTicks"===e.labelPlacement&&y>0&&(y+=1);const S=e.minorGridLines,x=e.minorTickLines;for(let a=0;a<y;a++)r=e.visibleLabels[a]?e.visibleLabels[a].value-g:e.visibleLabels[a-1].value+e.visibleRange.interval-g,h=wt(r,e)*s.height,h=-1*h+(s.y+s.height),h>=s.y&&s.y+s.height>=h&&((ct(r,e.visibleRange)||this.isBorder(e,a,h))&&(d="M "+this.seriesClipRect.x+" "+h+" L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+h,this.renderGridLine(e,t,d,e.majorGridLines,"_MajorGridLine_",a,this.element,v.majorGridLine,e.majorGridLines.dashArray)),c="M "+(s.x+u+(b?m:0))+" "+h+" L "+f+" "+h,this.renderGridLine(e,t,c,e.majorTickLines,"_MajorTickLine_",a,i,v.majorTickLine),(S.width>0||x.width>0)&&e.minorTicksPerInterval>0&&(0!==a||!Vt(e)||o||l||this.renderMinorGridOnZooming(e,r,s,a,t,v,i),n=this.drawAxisMinorLine(e,r,s,a),this.renderGridLine(e,t,n[0],S,"_MinorGridLine_",a,this.element,v.minorGridLine,S.dashArray),this.renderGridLine(e,t,n[1],x,"_MinorTickLine_",a,i,v.minorTickLine),a===y-1&&Vt(e)&&o&&!l&&this.renderMinorGridOnZooming(e,r+e.visibleRange.interval,s,a,t,v,i)))}isBorder(e,t,i){const s=this.chart.chartArea.border,o=this.seriesClipRect,l=e.orientation,a="Horizontal"===l?o.x:o.y,r="Horizontal"===l?o.width:o.height;return e.plotOffset>0||(i===a||i===a+r)&&(s.width<=0||"transparent"===s.color)||i!==a&&t===("Horizontal"===l?0:e.visibleLabels.length-1)||i!==a+r&&t===("Horizontal"===l?e.visibleLabels.length-1:0)}drawYAxisLabels(e,t,i,s){const o=this.chart;let l,r,n,h=0,d=0;const c="Inside"===e.labelPosition,p=e.opposedPosition;let u=(e.labelPosition===e.tickPosition?e.majorTickLines.height:0)+e.labelPadding+.5*e.lineStyle.width;u=e.opposedPosition?u:-u;let g=p&&c||!p&&!c?"end":"start";g=o.isRtlEnabled?e.opposedPosition?"end":"start":g;const m=o.renderer.createGroup({id:o.element.id+"AxisLabels"+t}),b=(0,a.le)(e.crossesAt)?e.scrollBarHeight*(p?1:-1):0;let f,y,v;for(let a=0,S=e.visibleLabels.length;a<S;a++){n=at(e.visibleLabels[a].originalText),h=c?s.x-u:s.x+u+b,l=n?e.visibleLabels[a].breakLabelSize:e.visibleLabels[a].size,d=wt(e.visibleLabels[a].value,e)*s.height+(o.stockChart?7:0),d=Math.floor(-1*d+(s.y+s.height)),f=l.height/8*e.visibleLabels[a].text.length/2,y=l.height/4*3+3,d=n?"Inside"===e.labelPosition?d-l.height/2-f+y:d-f:"Inside"===e.labelPosition?d+y:d+l.height/4,v=e.majorGridLines.width>e.majorTickLines.width?e.majorGridLines.width:e.majorTickLines.width,"Far"===e.labelStyle.textAlignment?d=d-v-10:"Near"===e.labelStyle.textAlignment?d=d+v+10:"Center"===e.labelStyle.textAlignment&&(d=d),h=n?this.getAxisLabelXvalue(h,e,l.width):h;const i=n?this.getAnchor(e):g;if(r=new L(o.element.id+t+"_AxisLabel_"+a,h,d,i,e.visibleLabels[a].text),e.edgeLabelPlacement)switch(e.edgeLabelPlacement){case"None":break;case"Hide":((0===a||e.isInversed&&a===S-1)&&r.y>s.y+s.height||(a===S-1||e.isInversed&&0===a)&&r.y-.5*l.height<s.y)&&(r.text="");break;case"Shift":(0===a||e.isInversed&&a===S-1)&&r.y>s.y+s.height?r.y=d=s.y+s.height:(a===S-1||e.isInversed&&0===a)&&r.y-.5*l.height<s.y&&(r.y=d=s.y+.5*l.height)}bi(o.renderer,r,e.labelStyle,e.labelStyle.color||o.themeStyle.axisLabel,m,!1,o.redraw,!0,!0,null,null,0,null,o.enableCanvas)}this.chart.enableCanvas||(o.delayRedraw?e.visible&&e.internalVisibility&&this.createZoomingLabel(this.chart,m,e,t,s):$t(o.enableCanvas,i,m,o.redraw))}getAxisLabelXvalue(e,t,i){const s=t.lineBreakAlignment,o="Inside"===t.labelPosition,l=t.opposedPosition;return l&&o||!l&&!o?"Right"===s?e:"Center"===s?e-i/2:e-i:"Left"===s?e:"Center"===s?e+i/2:e+i}drawYAxisBorder(e,t,i,s){if(e.border.width>0){let o,l,a="Outside"===e.labelPosition?e.scrollBarHeight:0;a*=e.opposedPosition?1:-1;const r=s.height/e.visibleRange.delta*("DateTime"===e.valueType?e.dateTimeInterval:e.visibleRange.interval);let n;const h=e.maxLabelSize.width+10+(e.tickPosition===e.labelPosition?e.majorTickLines.height:0);let d="";const c="Category"===e.valueType&&"BetweenTicks"===e.labelPlacement?-.5:0,p=e.opposedPosition&&"Inside"===e.labelPosition||!e.opposedPosition&&"Outside"===e.labelPosition?s.x-h+a:s.x+h+a;for(let t=0,i=e.visibleLabels.length;t<i;t++)switch(l=wt(e.visibleLabels[t].value+c,e),l=(e.isInversed?1-l:l)*s.height,"Category"===e.valueType&&"BetweenTicks"===e.labelPlacement?(o=-1*l+(s.y+s.height),n=-1*l-r+(s.y+s.height)):(o=-1*l+r/2+(s.y+s.height),n=-1*l-r/2+(s.y+s.height)),e.border.type){case"Rectangle":case"WithoutTopBorder":o>s.y+s.height?d+="M "+p+" "+(s.y+s.height)+" L "+p+" "+n+" ":Math.floor(s.y)>n?d+="M "+(s.x+a)+" "+o+" L "+p+" "+o+" L "+p+" "+s.y+" ":(d+="M "+(s.x+a)+" "+o+" L "+p+" "+o+" L "+p+" "+n+" ",t===e.visibleLabels.length-1&&(d+="M "+(s.x+a)+" "+n+" L "+p+" "+n+" "));break;case"WithoutTopandBottomBorder":o>s.y+s.height||n<Math.floor(s.y)||(d+="M "+(s.x+a)+" "+o+" L "+p+" "+o+" M "+p+" "+n+" L "+(s.x+a)+" "+n)}d+="Rectangle"===e.border.type?"M "+(s.x+a)+" "+s.y+" L "+(s.x+a)+" "+(s.y+s.height)+" ":"",""!==d&&this.createAxisBorderElement(e,t,d,i)}e.multiLevelLabels.length>0&&this.chart.multiLevelLabelModule&&this.chart.multiLevelLabelModule.renderYAxisMultiLevelLabels(e,t,i,s)}drawYAxisTitle(e,t,i,s){if(e.title){const o=this.chart,l=e.opposedPosition?90:-90;let a=("Inside"===e.tickPosition?0:e.majorTickLines.height+e.titlePadding)+("Inside"===e.labelPosition?0:e.maxLabelSize.width+e.multiLevelLabelHeight+this.padding);a=e.opposedPosition?a+e.scrollBarHeight:-a-e.scrollBarHeight;const r=s.x+a,n=s.y+.5*s.height,h=new L(o.element.id+"_AxisTitle_"+t,r,n-e.labelPadding-e.titleSize.height*(e.titleCollection.length-1),"middle",e.titleCollection,"rotate("+l+","+r+","+n+")",null,l),d=bi(o.renderer,h,e.titleStyle,e.titleStyle.color||o.themeStyle.axisTitle,i,null,null,null,null,null,null,0,null,o.enableCanvas);d.setAttribute("tabindex",e.tabIndex.toString()),d.setAttribute("aria-label",e.description||e.title)}}drawXAxisGridLine(e,t,i,s){const o="Logarithmic"===e.valueType,l=e.valueType.indexOf("Category")>-1;let r,n,h=0,d="",c="";const p=e.opposedPosition?-e.majorTickLines.height:e.majorTickLines.height,u=e.opposedPosition?.5*-e.lineStyle.width:.5*e.lineStyle.width,g=(0,a.le)(e.crossesAt)?e.opposedPosition?-e.scrollBarHeight:e.scrollBarHeight:0,m=e.valueType.indexOf("Category")>-1&&"BetweenTicks"===e.labelPlacement?.5:0;let b=e.visibleLabels.length;const f="Inside"===e.tickPosition,y=f?s.y-p-u:s.y+p+u+g,v=this.chart.themeStyle;e.valueType.indexOf("Category")>-1&&b>0&&"BetweenTicks"===e.labelPlacement&&(b+=1);for(let a=0;a<b;a++)r="DateTimeCategory"!==e.valueType?e.visibleLabels[a]?e.visibleLabels[a].value-m:e.visibleLabels[a-1].value+e.visibleRange.interval-m:e.visibleLabels[a]?e.visibleLabels[a].value-m:e.visibleRange.max,h=wt(r,e)*s.width+s.x,h>=s.x&&s.x+s.width>=h&&((ct(r,e.visibleRange)||this.isBorder(e,a,h))&&(d="M "+h+" "+(this.seriesClipRect.y+this.seriesClipRect.height)+" L "+h+" "+this.seriesClipRect.y,this.renderGridLine(e,t,d,e.majorGridLines,"_MajorGridLine_",a,this.element,v.majorGridLine,e.majorGridLines.dashArray)),c="M "+h+" "+(s.y+u+(f?g:0))+" L "+h+" "+y,this.renderGridLine(e,t,c,e.majorTickLines,"_MajorTickLine_",a,i,v.majorTickLine),e.minorTicksPerInterval>0&&(e.minorGridLines.width>0||e.minorTickLines.width>0)&&(0!==a||!Vt(e)||o||l||this.renderMinorGridOnZooming(e,r,s,a,t,v,i),n=this.drawAxisMinorLine(e,r,s,a),this.renderGridLine(e,t,n[0],e.minorGridLines,"_MinorGridLine_",a,this.element,v.minorGridLine,e.minorGridLines.dashArray),this.renderGridLine(e,t,n[1],e.minorTickLines,"_MinorTickLine_",a,i,v.minorTickLine),a===b-1&&Vt(e)&&o&&!l&&this.renderMinorGridOnZooming(e,r+e.visibleRange.interval,s,a,t,v,i)))}renderMinorGridOnZooming(e,t,i,s,o,l,a){const r=this.drawAxisMinorLine(e,t,i,s,!0);this.renderGridLine(e,o,r[0],e.minorGridLines,"_MinorGridLine_",-1,this.element,l.minorGridLine,e.minorGridLines.dashArray),this.renderGridLine(e,o,r[1],e.minorTickLines,"_MinorTickLine_",-1,a,l.minorTickLine)}drawAxisMinorLine(e,t,i,s,o){let l=t,a=0,r=0;const n=e.visibleRange,h="Inside"===e.tickPosition,d=[],c=e.opposedPosition?-e.minorTickLines.height:e.minorTickLines.height;let p,u,g=1,m=1;const b=h?i.y-c:i.y+c,f=h?i.x+c:i.x-c;let y="",v="";if("Logarithmic"===e.valueType&&(p=Math.pow(e.logBase,l-n.interval),u=Math.pow(e.logBase,l),g=(u-p)/(e.minorTicksPerInterval+1),m=p+g),"Horizontal"===e.orientation)for(let S=0;S<e.minorTicksPerInterval;S++)l=this.findLogNumeric(e,m,l,s,o),m+=g,ct(l,n)&&(r=(l-n.min)/(n.max-n.min),r=Math.ceil((e.isInversed?1-r:r)*i.width),a=Math.floor(r+i.x),y=y.concat("M "+a+" "+this.seriesClipRect.y+"L "+a+" "+(this.seriesClipRect.y+this.seriesClipRect.height)),a=Math.floor(r+i.x),v=v.concat("M "+a+" "+i.y+"L "+a+" "+(b+e.scrollBarHeight)));else for(let S=0;S<e.minorTicksPerInterval;S++)l=this.findLogNumeric(e,m,l,s,o),ct(l,n)&&(r=(l-n.min)/(n.max-n.min),r=-1*Math.ceil((e.isInversed?1-r:r)*i.height),a=Math.floor(r+i.y+i.height),y=y.concat("M "+this.seriesClipRect.x+" "+a+"L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+a+" "),a=Math.floor(r+i.y+i.height),v=v.concat("M "+i.x+" "+a+"L "+(f-e.scrollBarHeight)+" "+a+" ")),m+=g;return d.push(y),d.push(v),d}findLogNumeric(e,t,i,s,o){const l=e.visibleRange;let a;if("Logarithmic"===e.valueType)i=ht(t,e.logBase);else if("DateTime"===e.valueType)a=e.dateTimeInterval/(e.minorTicksPerInterval+1),i=o?i-a:i+a;else if("DateTimeCategory"===e.valueType){const t="BetweenTicks"===e.labelPlacement?.5:0;i+=((e.visibleLabels[s+1]?e.visibleLabels[s+1].value-t:e.visibleRange.max)-(e.visibleLabels[s]?e.visibleLabels[s].value-t:e.visibleRange.min))/(e.minorTicksPerInterval+1)}else a=l.interval/(e.minorTicksPerInterval+1),i=o?i-a:i+a;return i}drawXAxisLabels(e,t,i,s){const o=this.chart;let l=0,r=0;const n=e.labelPadding;let h,d,c,p;const u=o.renderer.createGroup({id:o.element.id+"AxisLabels"+t}),g="Inside"===e.labelPosition,m=e.opposedPosition,b=e.labelPosition===e.tickPosition?e.majorTickLines.height:0;let f=b+n+.5*e.lineStyle.width;const y=e.angle%360,v=0===y||-180===y||180===y;let S,x,w=e.isInversed?s.x+s.width:s.x,M=0;const T=e.visibleLabels.length;let A,D,R;const I=e.scrollbarSettings.enable||!g&&(0,a.le)(e.crossesAt)&&(e.zoomFactor<1||e.zoomPosition>0)?e.scrollBarHeight:0,P=[];let k=!1;f+=90===y||270===y||-90===y||-270===y?g?5:-5:0;const E=!m&&!g||m&&g,F=E?360>=y&&y>=180||-1>=y&&y>=-180:1<=y&&y<=180||-181>=y&&y>=-360;for(let a=0,O=T;a<O;a++){D=e.visibleLabels[a],R=at(D.originalText),l=wt(D.value,e)*s.width+s.x,d=D.size,A=s.width/T,x=R?D.breakLabelSize.width:d.width,M=("Trim"===e.labelIntersectAction||"Wrap"===e.labelIntersectAction)&&0===y&&x>A?A:x,h=d.height/4,l-=R||0!==y?0:M/2,0!==y&&(l-=R?"Left"===e.lineBreakAlignment?D.breakLabelSize.width/2:"Right"===e.lineBreakAlignment?-D.breakLabelSize.width/2:0:-90===y||270===y?-h:90===y||-270===y?h:0),"Far"===e.labelStyle.textAlignment?l=l+M-10:"Near"===e.labelStyle.textAlignment?l=l-M+10:"Center"===e.labelStyle.textAlignment&&(l=l),R&&"Center"!==e.lineBreakAlignment&&0===y&&(l+="Left"===e.lineBreakAlignment?-M/2:M/2);const i=R?v?d.height:D.breakLabelSize.width/2:0;if(f=R?b+n+.5*e.lineStyle.width:f,g&&y?r=R?m?s.y+f+i:s.y-f-i:m?s.y+f+h:s.y-f-h:(c=R?E?f+I+(y?i:3*h):-(f+I+i):E?f+I+(y?1:3)*h:-(f+I+(y?h:D.index>1?2*h:0)),r=s.y+c*D.index),p=R?this.getAnchor(e):o.isRtlEnabled||F?"end":"",S=new L(o.element.id+t+"_AxisLabel_"+a,l,r,p),e.edgeLabelPlacement&&0===y)switch(e.edgeLabelPlacement){case"None":break;case"Hide":if((0===a||e.isInversed&&a===O-1)&&S.x<s.x||(a===O-1||e.isInversed&&0===a)&&S.x+M>s.x+s.width)continue;break;case"Shift":(0===a||e.isInversed&&a===O-1)&&S.x<s.x?(A-=s.x-S.x,S.x=l=s.x):(a===O-1||e.isInversed&&0===a)&&S.x+M>s.x+s.width&&(d.width>A&&"Trim"===e.labelIntersectAction?A-=S.x+M-(s.x+s.width):A=M,S.x=l=s.x+s.width-A)}let N,z;if(S.text=this.getLabelText(D,e,A),R&&0===y?"Right"===e.lineBreakAlignment?(N=S.x-M,z=S.x):"Center"===e.lineBreakAlignment?(N=S.x-M/2,z=S.x+M/2):(N=S.x,z=S.x+M):(N=S.x,z=S.x+M),0!==y||"Hide"!==e.labelIntersectAction||0===a||!(e.isInversed?z>=w:N<=w)){if(w=R?"Right"===e.lineBreakAlignment?e.isInversed?S.x-M:S.x:"Center"===e.lineBreakAlignment?e.isInversed?S.x-M/2:S.x+M/2:e.isInversed?S.x:S.x+M:e.isInversed?S.x:S.x+M,0!==y){let t,i;if(R){let s=0,o=0;t=D.breakLabelSize.height,o=D.breakLabelSize.height-4,"Center"===e.lineBreakAlignment?s=-D.breakLabelSize.width/2:"Right"===e.lineBreakAlignment&&(s=-D.breakLabelSize.width),E&&(o=D.breakLabelSize.height/(S.text.length+1)),i=new C(S.x+s,S.y-o,D.breakLabelSize.width,t)}else t=r-(S.y-(D.size.height/2+10)),i=new C(S.x,S.y-(D.size.height/2-5),D.size.width,t);const s=this.getRectanglePoints(i),o=R?i.x+i.width/2:l,n=R?i.y+i.height/2:r-t/2;S.transform=R?"rotate("+y+","+o+","+n+")":"rotate("+y+","+l+","+r+")",P.push(vt(s,o,n,y)),k=!1;for(let e=a;e>0;e--)if(P[a]&&P[e-1]&&St(P[a],P[e-1])){k=!0,P[a]=null;break}}bi(o.renderer,S,D.labelStyle,D.labelStyle.color||o.themeStyle.axisLabel,u,e.opposedPosition!==("Inside"===e.labelPosition),o.redraw,!0,null,null,null,0,k,o.enableCanvas)}}this.chart.enableCanvas||(o.delayRedraw?e.visible&&e.internalVisibility&&this.createZoomingLabel(this.chart,u,e,t,s):i.appendChild(u))}getAnchor(e){return"Center"===e.lineBreakAlignment?"middle":"Left"===e.lineBreakAlignment?"start":"end"}getRectanglePoints(e){return[new Ri(e.x,e.y),new Ri(e.x+e.width,e.y),new Ri(e.x+e.width,e.y+e.height),new Ri(e.x,e.y+e.height)]}getLabelText(e,t,i){if(at(e.originalText)){const s=[];let o;for(let l=0;l<e.text.length;l++)o=this.findAxisLabel(t,e.text[l],i),s.push(o);return s}return this.findAxisLabel(t,e.text,i)}drawXAxisBorder(e,t,i,s){if(e.border.width>0){const o="Outside"===e.labelPosition?e.scrollBarHeight:0;let l;const a=s.y+(e.opposedPosition?-1:1)*o,r=10;let n;const h=s.width/e.visibleRange.delta*("DateTime"===e.valueType?e.dateTimeInterval:e.visibleRange.interval);let d;const c=e.maxLabelSize.height+(e.tickPosition===e.labelPosition?e.majorTickLines.height:0);let p="";const u="Category"===e.valueType&&"BetweenTicks"===e.labelPlacement?-.5:0,g=e.opposedPosition&&"Inside"===e.labelPosition||!e.opposedPosition&&"Outside"===e.labelPosition?s.y+c+r+o:s.y-c-r-o;for(let t=0,i=e.visibleLabels.length;t<i;t++)switch(n=wt(e.visibleLabels[t].value+u,e),n=(e.isInversed?1-n:n)*s.width,"Category"===e.valueType&&"BetweenTicks"===e.labelPlacement?(l=n+s.x,d=n+h+s.x):(l=n-.5*h+s.x,d=n+.5*h+s.x),e.border.type){case"Rectangle":case"WithoutTopBorder":l<s.x?p+="M "+s.x+" "+g+" L "+d+" "+g+" ":Math.floor(d)>s.width+s.x&&1!==e.visibleLabels.length?p+="M "+l+" "+a+" L "+l+" "+g+" L "+(s.width+s.x)+" "+g+" ":(p+="M "+l+" "+a+" L "+l+" "+g+" L "+d+" "+g+" ",0===t&&(p+="M "+l+" "+a+" L "+l+" "+g+" M "+l+" "+g+" L "+s.x+" "+g),t===e.visibleLabels.length-1&&(p+="M "+d+" "+a+" L "+d+" "+g+" M "+d+" "+g+" L "+(s.width+s.x)+" "+g));break;case"WithoutTopandBottomBorder":l<s.x||Math.floor(d)>s.width+s.x||(p+="M "+l+" "+a+" L "+l+" "+g+" M "+d+" "+a+" L "+d+" "+g)}p+="Rectangle"===e.border.type?"M  "+s.x+" "+a+"L "+(s.x+s.width)+" "+a:"",""!==p&&this.createAxisBorderElement(e,t,p,i)}this.chart.multiLevelLabelModule&&e.multiLevelLabels.length>0&&this.chart.multiLevelLabelModule.renderXAxisMultiLevelLabels(e,t,i,s)}createAxisBorderElement(e,t,i,s){const o=Yt(this.chart.element.id+"_BorderLine_"+t),l=o?o.getAttribute("d"):"",a=this.chart.renderer.drawPath(new I(this.chart.element.id+"_BorderLine_"+t,"transparent",e.border.width,e.border.color||this.chart.themeStyle.axisLine,1,"",i));a.setAttribute("style","pointer-events: none"),$t(this.chart.enableCanvas,s,a,this.chart.redraw,!0,"x","y",null,l,!0)}findAxisLabel(e,t,i){return"Trim"===e.labelIntersectAction?e.angle%360!=0||e.enableTrim?t:pi(i,t,e.labelStyle):t}drawXAxisTitle(e,t,i,s){if(e.title){const o=this.chart,l=S(e.title,e.titleStyle),r=(0,a.le)(e.crossesAt)?e.scrollBarHeight:0;let n=("Inside"===e.tickPosition?0:e.majorTickLines.height+e.titlePadding)+("Inside"===e.labelPosition?0:e.maxLabelSize.height+e.multiLevelLabelHeight+e.labelPadding);const h=e.titleSize.height*(e.titleCollection.length-1);n=e.opposedPosition?-(n+l.height/4+r+h):n+3*l.height/4+r;const d=new L(o.element.id+"_AxisTitle_"+t,s.x+.5*s.width,s.y+n,"middle",e.titleCollection),c=bi(o.renderer,d,e.titleStyle,e.titleStyle.color||o.themeStyle.axisTitle,i,null,null,null,null,null,null,0,null,o.enableCanvas);c.setAttribute("aria-label",e.description||e.title),c.setAttribute("tabindex",e.tabIndex.toString())}}renderGridLine(e,t,i,s,o,l,a,r,n=null){const h=this.chart;let d,c;s.width>0&&e.visible&&e.internalVisibility&&i&&(c=Yt(h.element.id+o+t+"_"+l),d=c?c.getAttribute("d"):null,c=null,this.htmlObject=h.renderer.drawPath(new I(h.element.id+o+t+"_"+l,"transparent",s.width,s.color||r,null,n,i)),$t(h.enableCanvas,a,this.htmlObject,h.redraw,!0,"x","y",null,d,!0))}findParentNode(e,t,i){return document.getElementById(e+"AxisGroup"+i+"Inside").contains(document.getElementById(t.id))?document.getElementById(e+"AxisGroup"+i+"Inside"):document.getElementById(e+"AxisGroup"+i+"Outside")}createZoomingLabel(e,t,i,s,o){const l=this.findParentNode(e.element.id,t,s);t.setAttribute("opacity","0.3");let a=e.renderer.createGroup({id:e.element.id+"AxisLabels_Zoom"+s});a=function(e,t,i,s,o,l){const a=t.opposedPosition,r=o?"start":"auto";let n;const h=e.availableSize.width;let d,c,p,u;const g=t.scrollbarSettings.enable||t.zoomingScrollBar&&t.zoomingScrollBar.svgObject?t.scrollBarHeight:0;for(let m=0;m<2;m++)n=S(m?t.endLabel:t.startLabel,t.labelStyle),o?(p=m?new Ri(l.x-g,l.y+3):new Ri(t.rect.x-g,l.y+l.height-3),d=l.x+(a?l.width+5+g:-(n.width+5+5+g)),c=l.y+(m?0:l.height-n.height-5),d+=d<0||h<d+n.width+5?a?-n.width/2:n.width/2:0,u=x(3,3,new C(d,c,n.width+5,n.height+5),p,5,!1,!1,!a,p.x,p.y+(m?-3:3))):(p=new Ri(m?l.x+l.width-3:l.x+3,l.y+l.height+g),d=l.x+(m?l.width-n.width-5:0),c=a?l.y-n.height-10-g:l.y+l.height+5+g,u=x(3,3,new C(d,c,n.width+5,n.height+5),p,5,a,!a,!1,p.x+(m?3:-3),p.y)),d+=2.5,c=c+n.height/4*3+2.5,i.appendChild(e.renderer.drawPath(new I(e.element.id+"_Zoom_"+s+"_AxisLabel_Shape_"+m,e.themeStyle.crosshairFill,2,e.themeStyle.crosshairFill,1,null,u))),bi(e.renderer,new L(e.element.id+"_Zoom_"+s+"_AxisLabel_"+m,d,c,r,m?t.endLabel:t.startLabel),{color:e.themeStyle.crosshairLabel,fontFamily:"Segoe UI",fontWeight:"Regular",size:"11px"},e.themeStyle.crosshairLabel,i);return i}(e,i,a,s,"Vertical"===i.orientation,o),l.replaceChild(t,document.getElementById(t.id)),Yt(e.element.id+"AxisLabels_Zoom"+s)?l.replaceChild(a,document.getElementById(a.id)):l.appendChild(a)}}class _i{constructor(e){this.currentPoints=[],this.previousPoints=[],this.insideRegion=!1,this.chart=e,this.lierIndex=0}getData(){const e=this.chart;let t,i,s,o,l=null,a=null;for(let r=e.visibleSeries.length-1;r>=0;r--){if(a=e.visibleSeries[r],t="Scatter"===a.type||"Scatter"===a.drawType||a.marker.visible?(a.marker.height+5)/2:0,i="Scatter"===a.type||"Scatter"===a.drawType||a.marker.visible?(a.marker.width+5)/2:0,s=e.mouseX,o=e.mouseY,a.dragSettings.enable&&a.isRectSeries)if("Bar"===a.type&&e.isTransposed||!e.isTransposed&&"Bar"!==a.type){const e=a.marker.height/2;o=a.yAxis.isInversed?o-e:o+e}else{const e=a.marker.width/2;s=a.yAxis.isInversed?s+e:s-e}if(a.visible&&Dt(s,o,a.clipRect,t,i)&&(l=this.getRectPoint(a,a.clipRect,s,o)),l)return new ki(l,a)}return new ki(l,a)}isSelected(e){return(e.selectionMode.indexOf("Drag")>-1||e.selectionMode.indexOf("Lasso")>-1)&&e.selectionModule&&null!==e.selectionModule.rectPoints}getRectPoint(e,t,i,s){let o,l,a,r,n,h,d=0;if(this.chart.isScrolling)return null;for(const c of e.points)if(c.regionData||c.regions&&c.regions.length){if(c.regionData&&"PolarRadar"===this.chart.chartAreaType&&e.drawType.indexOf("Column")>-1&&(o=i-(e.clipRect.width/2+e.clipRect.x),l=s-(e.clipRect.height/2+e.clipRect.y),d=2*Math.PI*(c.regionData.currentXPosition<0?1+c.regionData.currentXPosition:c.regionData.currentXPosition),a=(Math.atan2(l,o)+.5*Math.PI-d)%(2*Math.PI),a=a<0?2*Math.PI+a:a,a+=2*Math.PI*e.chart.primaryXAxis.startAngle,r=c.regionData.startAngle,r-=d,r=r<0?2*Math.PI+r:r,n=c.regionData.endAngle,n-=d,n=n<0?2*Math.PI+n:n,h=Math.sqrt(Math.pow(Math.abs(o),2)+Math.pow(Math.abs(l),2)),a>=r&&a<=n&&(h>=c.regionData.innerRadius&&h<=c.regionData.radius||h<=c.regionData.innerRadius&&h>=c.regionData.radius)&&h<=e.chart.radius))return c;if((e.dragSettings.enable&&e.isRectSeries||e.isRectSeries&&e.marker.visible)&&this.isPointInThresholdRegion(i,s,c,t,e))return this.insideRegion=!0,c;if(!this.insideRegion&&this.checkRegionContainsPoint(c.regions,t,i,s))return c;if(this.insideRegion&&this.checkRegionContainsPoint(c.regions,t,i,s))return c}return null}checkRegionContainsPoint(e,t,i,s){return e.some((e,o)=>(this.lierIndex=o,Dt(i,s,new C(("Cartesian"===this.chart.chartAreaType?t.x:0)+e.x,("Cartesian"===this.chart.chartAreaType?t.y:0)+e.y,e.width,e.height))))}isPointInThresholdRegion(e,t,i,s,o){const l="Bar"===o.type,a=o.yAxis.isInversed,r=o.chart.isTransposed;let n,h=0,d=0,c=n=20;return a&&r?l?(h=i.regions[0].height-10,n=i.regions[0].width):(d=-10,c=i.regions[0].height):a||i.yValue<0?l?(d=-10,c=i.regions[0].height):(h=i.regions[0].height-10,n=i.regions[0].width):r?l?(h=-10,n=i.regions[0].width):(d=i.regions[0].width-10,c=i.regions[0].height):l?(d=i.regions[0].width-10,c=i.regions[0].height):(h=-10,n=i.regions[0].width),i.regions.some(i=>Dt(e,t,new C(("Cartesian"===this.chart.chartAreaType?s.x:0)+i.x+d,("Cartesian"===this.chart.chartAreaType?s.y:0)+i.y+h,n,c)))}getClosest(e,t,i){let s,o;const l=i||e.xData;if(t>=e.xAxis.visibleRange.min&&t<=e.xAxis.visibleRange.max)for(let a=0;a<l.length;a++)o=l[a],(null==s||Math.abs(o-t)<Math.abs(s-t))&&(s=o);return-1!==e.xData.indexOf(s)?s:null}getClosestX(e,t,i){let s;const o=t.clipRect;s=e.requireInvertedAxis?It(e.mouseY-o.y,o.height,t.xAxis):Rt(e.mouseX-o.x,o.width,t.xAxis);const l=this.getClosest(t,s,i);for(const a of t.points)if(l===a.xValue&&a.visible)return new ki(a,t);return null}mergeXvalues(e){let t=[];for(let i=0;i<e.length;i++)t=t.concat(e[i].xData);return t.filter((e,i)=>i===t.indexOf(e))}}var Bi=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class Zi extends a.rt{}Bi([(0,a.Z9)(!1)],Zi.prototype,"visible",void 0),Bi([(0,a.Z9)(!0)],Zi.prototype,"showZero",void 0),Bi([(0,a.Z9)(null)],Zi.prototype,"name",void 0),Bi([(0,a.Z9)("transparent")],Zi.prototype,"fill",void 0),Bi([(0,a.Z9)(1)],Zi.prototype,"opacity",void 0),Bi([(0,a.Z9)(0)],Zi.prototype,"angle",void 0),Bi([(0,a.Z9)(!1)],Zi.prototype,"enableRotation",void 0),Bi([(0,a.Z9)("Auto")],Zi.prototype,"position",void 0),Bi([(0,a.Z9)(5)],Zi.prototype,"rx",void 0),Bi([(0,a.Z9)(5)],Zi.prototype,"ry",void 0),Bi([(0,a.Z9)("Center")],Zi.prototype,"alignment",void 0),Bi([(0,a.Zz)({width:null,color:null},G)],Zi.prototype,"border",void 0),Bi([(0,a.Zz)({left:5,right:5,top:5,bottom:5},U)],Zi.prototype,"margin",void 0),Bi([(0,a.Zz)({size:"11px",color:"",fontStyle:"Normal",fontWeight:"Normal",fontFamily:"Segoe UI"},q)],Zi.prototype,"font",void 0),Bi([(0,a.Z9)(null)],Zi.prototype,"template",void 0),Bi([(0,a.Z9)("Hide")],Zi.prototype,"labelIntersectAction",void 0);class Vi extends a.rt{}Bi([(0,a.Z9)(!1)],Vi.prototype,"visible",void 0),Bi([(0,a.Z9)("Circle")],Vi.prototype,"shape",void 0),Bi([(0,a.Z9)("")],Vi.prototype,"imageUrl",void 0),Bi([(0,a.Z9)(5)],Vi.prototype,"height",void 0),Bi([(0,a.Z9)(5)],Vi.prototype,"width",void 0),Bi([(0,a.Zz)({width:2,color:null},G)],Vi.prototype,"border",void 0),Bi([(0,a.Zz)({x:0,y:0},Y)],Vi.prototype,"offset",void 0),Bi([(0,a.Z9)(null)],Vi.prototype,"fill",void 0),Bi([(0,a.Z9)(1)],Vi.prototype,"opacity",void 0),Bi([(0,a.Zz)({},Zi)],Vi.prototype,"dataLabel",void 0);class ji{constructor(){this.symbolLocations=null,this.regions=null,this.percentage=null,this.regionData=null,this.isSelect=!1,this.marker={visible:!1},this.isPointInRange=!0}}class Hi extends a.rt{constructor(){super(...arguments),this.clipRect=new C(0,0,0,0)}setDataSource(e,t){e&&(this.points=e.points),t.trendLineModule.initDataSource(this),t.visibleSeriesCount++}}Bi([(0,a.Z9)("")],Hi.prototype,"name",void 0),Bi([(0,a.Z9)("0")],Hi.prototype,"dashArray",void 0),Bi([(0,a.Z9)(!0)],Hi.prototype,"visible",void 0),Bi([(0,a.Z9)("Linear")],Hi.prototype,"type",void 0),Bi([(0,a.Z9)(2)],Hi.prototype,"period",void 0),Bi([(0,a.Z9)(2)],Hi.prototype,"polynomialOrder",void 0),Bi([(0,a.Z9)(0)],Hi.prototype,"backwardForecast",void 0),Bi([(0,a.Z9)(0)],Hi.prototype,"forwardForecast",void 0),Bi([(0,a.Zz)({},Q)],Hi.prototype,"animation",void 0),Bi([(0,a.Zz)({},Vi)],Hi.prototype,"marker",void 0),Bi([(0,a.Z9)(!0)],Hi.prototype,"enableTooltip",void 0),Bi([(0,a.Z9)(null)],Hi.prototype,"intercept",void 0),Bi([(0,a.Z9)("")],Hi.prototype,"fill",void 0),Bi([(0,a.Z9)(1)],Hi.prototype,"width",void 0),Bi([(0,a.Z9)("SeriesType")],Hi.prototype,"legendShape",void 0);class qi extends a.rt{}Bi([(0,a.Z9)(1)],qi.prototype,"width",void 0),Bi([(0,a.Z9)(10)],qi.prototype,"length",void 0),Bi([(0,a.Z9)(null)],qi.prototype,"color",void 0),Bi([(0,a.Z9)(1)],qi.prototype,"opacity",void 0);class Gi extends a.rt{}Bi([(0,a.Z9)(null)],Gi.prototype,"value",void 0),Bi([(0,a.Z9)(null)],Gi.prototype,"color",void 0),Bi([(0,a.Z9)("0")],Gi.prototype,"dashArray",void 0);class Yi extends a.rt{}Bi([(0,a.Z9)(!1)],Yi.prototype,"visible",void 0),Bi([(0,a.Z9)("Fixed")],Yi.prototype,"type",void 0),Bi([(0,a.Z9)("Both")],Yi.prototype,"direction",void 0),Bi([(0,a.Z9)("Vertical")],Yi.prototype,"mode",void 0),Bi([(0,a.Z9)(null)],Yi.prototype,"color",void 0),Bi([(0,a.Z9)(1)],Yi.prototype,"verticalError",void 0),Bi([(0,a.Z9)(1)],Yi.prototype,"width",void 0),Bi([(0,a.Z9)(1)],Yi.prototype,"horizontalError",void 0),Bi([(0,a.Z9)(3)],Yi.prototype,"verticalPositiveError",void 0),Bi([(0,a.Z9)(3)],Yi.prototype,"verticalNegativeError",void 0),Bi([(0,a.Z9)(1)],Yi.prototype,"horizontalPositiveError",void 0),Bi([(0,a.Z9)(1)],Yi.prototype,"horizontalNegativeError",void 0),Bi([(0,a.Zz)(null,qi)],Yi.prototype,"errorBarCap",void 0);class Wi extends a.rt{constructor(){super(...arguments),this.currentViewData=[],this.clipRect=new C(0,0,0,0),this.seriesType="XY",this.isRectTypeSeries=!1}processJsonData(){let e=0,t=new ji;const i=this instanceof Ui&&"Histogram"===this.type?"x":this.xName,s=this instanceof Ui&&this.marker.dataLabel.name?this.marker.dataLabel.name:"";this instanceof Ui&&("Waterfall"!==this.type&&"Histogram"!==this.type||(this.currentViewData=this.chart[kt(this.type)+"SeriesModule"].processInternalData((0,a.l7)([],this.currentViewData,null,!0),this)),"Pareto"===this.category&&(this.currentViewData=function(e,t,i){const s=(0,a.l7)([],e,null);return s.sort((e,i)=>{let s=0,o=0;for(let l=0;l<t.length;l++)s+=e[t[l]],o+=i[t[l]];return s>o?-1:s===o?0:1}),s}((0,a.l7)([],this.currentViewData,null,!0),[this.yName]),"Line"===this.type&&(this.currentViewData=this.chart.paretoSeriesModule.performCumulativeCalculation(this.currentViewData,this))),this.isRectTypeSeries=this.type.indexOf("Column")>-1||this.type.indexOf("Bar")>-1||this.type.indexOf("Histogram")>-1);const o=Object.keys(this.currentViewData).length;if(this.points=[],this.xMin=1/0,this.xMax=-1/0,this.yMin=1/0,this.yMax=-1/0,this.sizeMax=-1/0,this.getSeriesType(),"Category"===this.xAxis.valueType)for(;e<o;)t=this.dataPoint(e,s,i),this.pushCategoryData(t,e,t.x),this.pushData(t,e),this.setEmptyPoint(t,e),e++;else if(this.xAxis.valueType.indexOf("DateTime")>-1){const l={skeleton:"full",type:"dateTime"},n=this.chart.intl.getDateParser(l),h=this.chart.intl.getDateFormat(l);for(;e<o;)t=this.dataPoint(e,s,i),(0,a.le)(t.x)||""===t.x?t.visible=!1:(t.x=new Date(r.j4.parse.parseJson({val:t.x}).val),"DateTime"===this.xAxis.valueType?t.xValue=Date.parse(t.x.toString()):this.pushCategoryData(t,e,this.chart.isBlazor?Date.parse(t.x.toString()).toString():Date.parse(n(h(t.x))).toString()),this.pushData(t,e),this.setEmptyPoint(t,e)),e++}else for(;e<o;)t=this.dataPoint(e,s,i),t.xValue=t.x,this.pushData(t,e),this.setEmptyPoint(t,e),e++;if(this instanceof Ui)if(this.type.indexOf("Spline")>-1||this.drawType.indexOf("Spline")>-1&&"PolarRadar"===this.chart.chartAreaType){const e=this.type.indexOf("Area")>-1||this.drawType.indexOf("Area")>-1,t=this.type.indexOf("Range")>-1;this.chart["spline"+(e?t?"RangeArea":"Area":"")+"SeriesModule"].findSplinePoint(this)}else this.type.indexOf("Histogram")>-1&&(this.xAxis.maximum||this.xAxis.minimum)&&this.chart.histogramSeriesModule.calculateBinValues(this)}pushData(e,t){e.index=t,e.yValue=e.y,this.xMin=Math.min(this.xMin,e.xValue),this.xMax=Math.max(this.xMax,e.xValue),this.xData.push(e.xValue)}dataPoint(e,t,i){this.points[e]=new ji;const s=this.points[e],o=this.currentViewData,l=this.enableComplexProperty?a.NA:this.getObjectValue;return s.x=l(i,o[e]),s.high=l(this.high,o[e]),s.low=l(this.low,o[e]),s.open=l(this.open,o[e]),s.close=l(this.close,o[e]),s.volume=l(this.volume,o[e]),s.interior=l(this.pointColorMapping,o[e]),this instanceof Ui&&(s.y=l(this.yName,o[e]),s.size=l(this.size,o[e]),s.text=l(t,o[e]),s.tooltip=l(this.tooltipMappingName,o[e]),this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0&&this.isAdvancedColorSupported()&&(s.colorValue=l(this.colorName&&this.colorName.length>0?this.colorName:this.yName,o[e]),s.interior=this.getPointFillColor(s.interior,s.colorValue))),s}isAdvancedColorSupported(){return 1===this.chart.visibleSeries.length&&("Column"===this.chart.series[0].type||"Bar"===this.chart.series[0].type||"Scatter"===this.chart.series[0].type||"Bubble"===this.chart.series[0].type)}getPointFillColor(e,t){let i=e;if(t&&this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0)for(const s of this.chart.rangeColorSettings)t>=s.start&&t<=s.end&&(i=s.colors.length>1?Oi(s,t):s.colors[0]);return i}getObjectValue(e,t){return t[e]}setEmptyPoint(e,t){if(!this.findVisibility(e))return e.visible=!0,null;switch(e.isEmpty=!0,this instanceof Ui&&e.isPointInRange?this.emptyPointSettings.mode:"Drop"){case"Zero":e.visible=!0,this instanceof Ui&&this.seriesType.indexOf("HighLow")>-1?(e.high=e.low=0,this.seriesType.indexOf("HighLowOpenClose")>-1&&(e.open=e.close=0)):e.y=e.yValue=this.yData[t]=0;break;case"Average":this instanceof Ui&&(this.seriesType.indexOf("HighLow")>-1?(e.high=(0,a.le)(e.high)||isNaN(+e.high)?this.getAverage(this.high,t):e.high,e.low=(0,a.le)(e.low)||isNaN(+e.low)?this.getAverage(this.low,t):e.low,this.seriesType.indexOf("HighLowOpenClose")>-1&&(e.open=(0,a.le)(e.open)||isNaN(+e.open)?this.getAverage(this.open,t):e.open,e.close=(0,a.le)(e.close)||isNaN(+e.close)?this.getAverage(this.close,t):e.close)):e.y=e.yValue=this.yData[t]=this.getAverage(this.yName,t)),e.visible=!0;break;case"Drop":case"Gap":this.yData[t]=null,e.visible=!1}}findVisibility(e){let t;const i=this.yAxis.minimum,s=this.yAxis.maximum;switch(this instanceof Ui?this.seriesType:"HighLowOpenClose"){case"XY":return"PolarRadar"===this.chart.chartAreaType&&(!(0,a.le)(i)&&e.yValue<i||!(0,a.le)(s)&&e.yValue>s)?(e.isPointInRange=!1,!0):(this.setXYMinMax(e.yValue),this.yData.push(e.yValue),this instanceof Ui&&"Bubble"===this.type&&(this.sizeMax=Math.max(this.sizeMax,(0,a.le)(e.size)||isNaN(+e.size)?this.sizeMax:e.size)),(0,a.le)(e.x)||(0,a.le)(e.y)||isNaN(+e.y));case"HighLow":return this.setHiloMinMax(e.high,e.low),(0,a.le)(e.x)||(0,a.le)(e.low)||isNaN(+e.low)||(0,a.le)(e.high)||isNaN(+e.high);case"HighLowOpenClose":return this.setHiloMinMax(e.high,e.low),(0,a.le)(e.x)||(0,a.le)(e.low)||isNaN(+e.low)||(0,a.le)(e.open)||isNaN(+e.open)||(0,a.le)(e.close)||isNaN(+e.close)||(0,a.le)(e.high)||isNaN(+e.high);case"BoxPlot":return t=(e.y||[null]).filter(e=>!(0,a.le)(e)&&!isNaN(e)).sort((e,t)=>e-t),e.y=t,this.yMin=Math.min(this.yMin,Math.min(...t)),this.yMax=Math.max(this.yMax,Math.max(...t)),!t.length}}setXYMinMax(e){const t="Logarithmic"===this.yAxis.valueType||"Logarithmic"===this.xAxis.valueType,i=e<0;let s;s=this.isRectTypeSeries&&!Zt(this.yAxis)?t||i?e:0:e,this.yMin=t?Math.min(this.yMin,(0,a.le)(s)||isNaN(s)||0===s?this.yMin:s):Math.min(this.yMin,(0,a.le)(s)||isNaN(s)?this.yMin:s),this.yMax=Math.max(this.yMax,(0,a.le)(e)||isNaN(e)?this.yMax:e)}setHiloMinMax(e,t){this.yMin=Math.min(this.yMin,Math.min((0,a.le)(t)||isNaN(t)?this.yMin:t,(0,a.le)(e)||isNaN(e)?this.yMin:e)),this.yMax=Math.max(this.yMax,Math.max((0,a.le)(t)||isNaN(t)?this.yMax:t,(0,a.le)(e)||isNaN(e)?this.yMax:e))}getSeriesType(){let e;if(this instanceof Ui){const t="PolarRadar"===this.chart.chartAreaType?this.drawType:this.type;if(t)switch(t){case"RangeColumn":case"RangeArea":case"SplineRangeArea":case"Hilo":e="HighLow";break;case"HiloOpenClose":case"Candle":e="HighLowOpenClose";break;case"BoxAndWhisker":e="BoxPlot";break;default:e="XY"}}this.seriesType=e}pushCategoryData(e,t,i){if(!this.chart.tooltip.shared&&!this.visible)return null;this.xAxis.isIndexed?(this.xAxis.labels[t]?this.xAxis.labels[t]+=", "+i:this.xAxis.labels.push(i),e.xValue=t):(this.xAxis.labels.indexOf(i)<0&&this.xAxis.labels.push(i),e.xValue=this.xAxis.labels.indexOf(i))}getAverage(e,t,i=this.currentViewData){return((i[t-1]&&i[t-1][e]||0)+(i[t+1]&&i[t+1][e]||0))/2}refreshDataManager(e){let t;this.chart=e,t=e.isAngular?Object.keys(this.dataSource).length?this.dataSource:e.dataSource:this.dataSource||e.dataSource,t instanceof r.hm||!(0,a.le)(this.query)?this.dataModule.getData(this.dataModule.generateQuery().requiresCount()).then(e=>this.dataManagerSuccess(e)):this.dataManagerSuccess({result:t,count:t.length},!1)}dataManagerSuccess(e,t=!0){if(this.currentViewData=e.count?e.result:[],this.chart.allowServerDataBinding=!1,this instanceof Ui){this.chart.stockChart&&(this.chart.stockChart.series[this.index].localData=this.currentViewData);const e={name:ue,series:this,data:this.currentViewData,fill:this.interior};this.chart.trigger(ue,e),this.interior=e.fill,this.currentViewData=e.data}!this.chart.stockChart||this instanceof Ui||(this.currentViewData=this.chart.stockChart.findCurrentData(this.chart.stockChart.series[0].localData,this.chart.stockChart.series[0].xName)),this.processJsonData(),this.recordsCount=e.count,this.refreshChart(t),this.currentViewData=null}refreshChart(e){const t=this.chart;if(this instanceof Ui&&(t.visibleSeriesCount+=e?1:0),t.refreshTechnicalIndicator(this),this instanceof Ui&&"TrendLine"!==this.category)for(const i of this.trendlines)i.setDataSource(this,t);t.visibleSeries.length===t.visibleSeriesCount&&(t.refreshBound(),t.trigger("loaded",{chart:t.isBlazor?{}:t}),this.chart.stockChart&&this.chart.stockChart.initialRender&&(this.chart.stockChart.initialRender=!1,this.chart.stockChart.stockChartDataManagerSuccess())),this instanceof Ui&&(t.visibleSeriesCount+=e?0:1)}}Bi([(0,a.Z9)("")],Wi.prototype,"xName",void 0),Bi([(0,a.Z9)("")],Wi.prototype,"colorName",void 0),Bi([(0,a.Z9)("")],Wi.prototype,"high",void 0),Bi([(0,a.Z9)("")],Wi.prototype,"low",void 0),Bi([(0,a.Z9)("")],Wi.prototype,"open",void 0),Bi([(0,a.Z9)("")],Wi.prototype,"close",void 0),Bi([(0,a.Z9)("")],Wi.prototype,"volume",void 0),Bi([(0,a.Z9)("")],Wi.prototype,"pointColorMapping",void 0),Bi([(0,a.Z9)(!0)],Wi.prototype,"visible",void 0),Bi([(0,a.Z9)(null)],Wi.prototype,"xAxisName",void 0),Bi([(0,a.Z9)(null)],Wi.prototype,"yAxisName",void 0),Bi([(0,a.Zz)(null,Q)],Wi.prototype,"animation",void 0),Bi([(0,a.Z9)(null)],Wi.prototype,"fill",void 0),Bi([(0,a.Z9)(1)],Wi.prototype,"width",void 0),Bi([(0,a.Z9)("0")],Wi.prototype,"dashArray",void 0),Bi([(0,a.Z9)("")],Wi.prototype,"dataSource",void 0),Bi([(0,a.Z9)()],Wi.prototype,"query",void 0),Bi([(0,a.FE)([],Gi)],Wi.prototype,"segments",void 0),Bi([(0,a.Z9)("X")],Wi.prototype,"segmentAxis",void 0),Bi([(0,a.Z9)(!1)],Wi.prototype,"enableComplexProperty",void 0);class Ui extends Wi{constructor(e,t,i,s){super(e,t,i,s),this.visibleSeriesCount=0,this.category="Series",this.isRectSeries=!1,this.drawPoints=[],this.lowDrawPoints=[],this.delayedAnimation=!1}refreshAxisLabel(){if("Category"!==this.xAxis.valueType)return null;this.xAxis.labels=[];for(const e of this.xAxis.series)if(e.visible&&"TrendLine"!==e.category){e.xMin=1/0,e.xMax=-1/0;for(const t of e.points)e.pushCategoryData(t,t.index,t.x),e.xMin=Math.min(e.xMin,t.xValue),e.xMax=Math.max(e.xMax,t.xValue)}}findSeriesCollection(e,t,i){const s=[];for(const o of t.axes)for(const t of o.series)for(const o of e.axes)for(const e of o.series)e===t&&e.visible&&this.rectSeriesInChart(e,i)&&s.push(e);return s}rectSeriesInChart(e,t){const i=e.type.toLowerCase();return-1!==i.indexOf("column")||-1!==i.indexOf("bar")||-1!==i.indexOf("histogram")||-1!==i.indexOf("hiloopenclose")||-1!==i.indexOf("candle")||-1!==i.indexOf("pareto")||-1!==i.indexOf("hilo")||-1!==e.drawType.indexOf("Column")||-1!==i.indexOf("waterfall")||-1!==i.indexOf("boxandwhisker")||t}calculateStackedValue(e,t){for(const i of t.columns)for(const s of t.rows)this.calculateStackingValues(this.findSeriesCollection(i,s,!0),e)}calculateStackingValues(e,t){let i,s,o=[];const l=[],a=[];let r,n,h,d=[];t&&(d=this.findFrequencies(e));const c=[],p=[];let u=[];for(const g of e)if(-1!==g.type.indexOf("Stacking")||-1!==g.drawType.indexOf("Stacking")&&"PolarRadar"===g.chart.chartAreaType){r=-1!==g.type.indexOf("StackingArea")?"StackingArea100":-1!==g.type.indexOf("StackingLine")?"StackingLine100":g.stackingGroup,l[r]||(l[r]=[],a[r]=[]),o=g.yData,i=[],s=[],c.push(g),u=rt(g);for(let c=0,g=u.length;c<g;c++)n=0,h=+o[c],void 0===l[r][u[c].xValue]&&(l[r][u[c].xValue]=0),void 0===a[r][u[c].xValue]&&(a[r][u[c].xValue]=0),t?(h=h/d[r][u[c].xValue]*100,h=isNaN(h)?0:h,u[c].percentage=+h.toFixed(2)):p[c]=p[c]?p[c]+Math.abs(h):Math.abs(h),h>=0?(n=l[r][u[c].xValue],l[r][u[c].xValue]+=h):(n=a[r][u[c].xValue],a[r][u[c].xValue]+=h),i.push(n),s.push(h+n),t&&s[c]>100&&(s[c]=100);g.stackedValues=new Mi(i,s);let e="Logarithmic"===g.yAxis.valueType,m=-1!==g.type.indexOf("Column")||-1!==g.type.indexOf("Bar");g.yMin=e&&m&&g.yMin<1?g.yMin:Math.min.apply(0,i),g.yMax=Math.max.apply(0,s),g.yMin>Math.min.apply(0,s)&&(g.yMin=t?-100:e&&m&&g.yMin<1?g.yMin:Math.min.apply(0,s)),g.yMax<Math.max.apply(0,i)&&(g.yMax=0)}this.findPercentageOfStacking(c,p,t)}findPercentageOfStacking(e,t,i){for(const s of e){if(i)return null;for(const e of rt(s))e.percentage=Math.abs(+(e.y/t[e.index]*100).toFixed(2))}}findFrequencies(e){const t=[];let i,s=[];for(const o of e)if(o.yAxis.isStack100=-1!==o.type.indexOf("100"),s=rt(o),-1!==o.type.indexOf("Stacking")){i=-1!==o.type.indexOf("StackingArea")?"StackingArea100":-1!==o.type.indexOf("StackingLine")?"StackingLine100":o.stackingGroup,t[i]||(t[i]=[]);for(let e=0,l=s.length;e<l;e++)void 0===t[i][s[e].xValue]&&(t[i][s[e].xValue]=0),o.yData[e]>0?t[i][s[e].xValue]+=o.yData[e]:t[i][s[e].xValue]-=o.yData[e]}return t}renderSeries(e){let t=kt(this.type);t=t.replace("100",""),e[t+"SeriesModule"]&&("Indicator"!==this.category&&"TrendLine"!==this.category&&this.createSeriesElements(e),this.visiblePoints=rt(this),e[t+"SeriesModule"].render(this,this.xAxis,this.yAxis,e.requireInvertedAxis),"Indicator"!==this.category&&(this.errorBar.visible&&this.chart.errorBarModule.render(this),this.marker.dataLabel.visible&&e.dataLabelModule.render(this,this.chart,this.marker.dataLabel),this.appendSeriesElement(e.seriesElements,e)),this.chart.enableCanvas||this.performAnimation(e,t,this.errorBar,this.marker,this.marker.dataLabel))}createSeriesElements(e){if("Indicator"!==this.category){const t=e.element.id,i=this.marker.border.width+8+5,s="Scatter"===this.type||"Bubble"===this.type?e.svgRenderer:e.renderer,o=void 0===this.index?this.category:this.index;let l,a,r;if("Scatter"===this.type?(l=e.primaryYAxis.maximum||e.primaryXAxis.maximum?0:(this.marker.height+i)/2,a=e.primaryYAxis.maximum||e.primaryXAxis.maximum?0:(this.marker.width+i)/2):(l=0,a=0),"PolarRadar"===e.chartAreaType){const i="Scatter"===this.drawType?Math.max(this.marker.width,this.marker.height):0;r=new Ai(t+"_ChartSeriesClipRect_"+o,"transparent",{width:1,color:"Gray"},1,this.clipRect.width/2+this.clipRect.x,this.clipRect.height/2+this.clipRect.y,e.radius+i),this.clipRectElement=_t(e.redraw,r,s,"drawCircularClipPath")}else r=new Ti(t+"_ChartSeriesClipRect_"+o,"transparent",{width:1,color:"Gray"},1,{x:-a,y:-l,width:this.clipRect.width+2*a,height:this.clipRect.height+2*l}),this.clipRectElement=_t(e.redraw,r,s);const n="Cartesian"===e.chartAreaType?"translate("+this.clipRect.x+","+this.clipRect.y+")":"";this.symbolElement=null,this.seriesElement=s.createGroup({id:t+"SeriesGroup"+o,transform:n,"clip-path":"url(#"+t+"_ChartSeriesClipRect_"+o+")"}),this.chart.enableCanvas&&"Scatter"!==this.type&&"Bubble"!==this.type||this.seriesElement.appendChild(this.clipRectElement)}}appendSeriesElement(e,t){const i=this.marker,s=i.dataLabel,o=t.redraw;"TrendLine"!==this.category&&($t(t.enableCanvas,t.seriesElements,this.seriesElement,o),this.errorBar.visible&&$t(t.enableCanvas,t.seriesElements,"PolarRadar"===t.chartAreaType?this.seriesElement:this.errorBarElement,o),"Scatter"!==this.type&&"Bubble"!==this.type||$t(!1,t.seriesElements,this.seriesElement,o)),i.visible&&("Cartesian"===t.chartAreaType||"Scatter"!==this.drawType&&"PolarRadar"===t.chartAreaType)&&"Scatter"!==this.type&&"Bubble"!==this.type&&"Candle"!==this.type&&"Hilo"!==this.type&&"HiloOpenClose"!==this.type&&this.symbolElement&&$t(t.enableCanvas,t.seriesElements,this.symbolElement,o),s.visible&&this.textElement&&($t(t.enableCanvas,t.dataLabelElements,this.shapeElement,o),$t(t.enableCanvas,t.dataLabelElements,this.textElement,o)),!t.enableCanvas&&t.dataLabelElements.hasChildNodes()&&t.seriesElements.appendChild(t.dataLabelElements)}performAnimation(e,t,i,s,o){this.animation.enable&&e.animateSeries&&(e[t+"SeriesModule"].doAnimation(this),i.visible&&e.errorBarModule.doErrorBarAnimation(this),s.visible&&e.markerRender.doMarkerAnimation(this),o.visible&&"edge"!==a.AR.info.name&&!a.AR.isIE&&e.dataLabelModule.doDataLabelAnimation(this))}setPointColor(e,t){return t=e.interior||t,e.isEmpty&&this.emptyPointSettings.fill||t}setBorderColor(e,t){return t.width=e.isEmpty&&this.emptyPointSettings.border.width||t.width,t.color=e.isEmpty&&this.emptyPointSettings.border.color||t.color,t}}Bi([(0,a.Z9)("")],Ui.prototype,"name",void 0),Bi([(0,a.Z9)("")],Ui.prototype,"yName",void 0),Bi([(0,a.Z9)("Line")],Ui.prototype,"drawType",void 0),Bi([(0,a.Z9)(!0)],Ui.prototype,"isClosed",void 0),Bi([(0,a.Z9)("#2ecd71")],Ui.prototype,"bearFillColor",void 0),Bi([(0,a.Z9)("#e74c3d")],Ui.prototype,"bullFillColor",void 0),Bi([(0,a.Z9)(!1)],Ui.prototype,"enableSolidCandles",void 0),Bi([(0,a.Z9)("")],Ui.prototype,"size",void 0),Bi([(0,a.Z9)(null)],Ui.prototype,"binInterval",void 0),Bi([(0,a.Z9)(!1)],Ui.prototype,"showNormalDistribution",void 0),Bi([(0,a.Z9)("")],Ui.prototype,"stackingGroup",void 0),Bi([(0,a.Zz)({color:"transparent",width:0},G)],Ui.prototype,"border",void 0),Bi([(0,a.Z9)(1)],Ui.prototype,"opacity",void 0),Bi([(0,a.Z9)(0)],Ui.prototype,"zOrder",void 0),Bi([(0,a.Z9)("Line")],Ui.prototype,"type",void 0),Bi([(0,a.Zz)(null,Yi)],Ui.prototype,"errorBar",void 0),Bi([(0,a.Zz)(null,Vi)],Ui.prototype,"marker",void 0),Bi([(0,a.Zz)({},te)],Ui.prototype,"dragSettings",void 0),Bi([(0,a.FE)([],Hi)],Ui.prototype,"trendlines",void 0),Bi([(0,a.Z9)(!0)],Ui.prototype,"enableTooltip",void 0),Bi([(0,a.Z9)("")],Ui.prototype,"tooltipFormat",void 0),Bi([(0,a.Z9)("")],Ui.prototype,"tooltipMappingName",void 0),Bi([(0,a.Z9)("SeriesType")],Ui.prototype,"legendShape",void 0),Bi([(0,a.Z9)("")],Ui.prototype,"legendImageUrl",void 0),Bi([(0,a.Z9)(null)],Ui.prototype,"selectionStyle",void 0),Bi([(0,a.Z9)(null)],Ui.prototype,"unSelectedStyle",void 0),Bi([(0,a.Z9)(null)],Ui.prototype,"nonHighlightStyle",void 0),Bi([(0,a.Z9)(1)],Ui.prototype,"minRadius",void 0),Bi([(0,a.Z9)(3)],Ui.prototype,"maxRadius",void 0),Bi([(0,a.Z9)("Natural")],Ui.prototype,"splineType",void 0),Bi([(0,a.Z9)(.5)],Ui.prototype,"cardinalSplineTension",void 0),Bi([(0,a.Zz)(null,ee)],Ui.prototype,"emptyPointSettings",void 0),Bi([(0,a.Z9)(!0)],Ui.prototype,"showMean",void 0),Bi([(0,a.Z9)("Normal")],Ui.prototype,"boxPlotMode",void 0),Bi([(0,a.Z9)(null)],Ui.prototype,"columnWidth",void 0),Bi([(0,a.Z9)(0)],Ui.prototype,"columnSpacing",void 0),Bi([(0,a.Z9)("#C64E4A")],Ui.prototype,"negativeFillColor",void 0),Bi([(0,a.Z9)("#4E81BC")],Ui.prototype,"summaryFillColor",void 0),Bi([(0,a.Z9)()],Ui.prototype,"intermediateSumIndexes",void 0),Bi([(0,a.Z9)()],Ui.prototype,"sumIndexes",void 0),Bi([(0,a.Zz)({color:"black",width:2},H)],Ui.prototype,"connector",void 0),Bi([(0,a.Zz)(null,K)],Ui.prototype,"cornerRadius",void 0);class Xi{constructor(e,t){this.initDataManager(e,t)}initDataManager(e,t){this.dataManager=e instanceof r.hm?e:new r.hm(e),this.query=t instanceof r.AE?t:new r.AE}generateQuery(){return this.query.clone()}getData(e){if(this.dataManager.ready){const t=new r.BH;return this.dataManager.ready.then(()=>{this.dataManager.executeQuery(e).then(e=>{t.resolve(e)})}).catch(e=>{t.reject(e)}),t.promise}return this.dataManager.executeQuery(e)}}class Qi extends _i{constructor(e){super(e),this.elementId=e.element.id}addEventListener(){this.chart.isDestroyed||(this.chart.on(a.AR.touchMoveEvent,this.mouseMoveHandler,this),this.chart.on(a.AR.touchEndEvent,this.mouseUpHandler,this))}removeEventListener(){this.chart.isDestroyed||(this.chart.off(a.AR.touchMoveEvent,this.mouseMoveHandler),this.chart.off(a.AR.touchEndEvent,this.mouseUpHandler))}mouseUpHandler(){const e=this.chart;!e.isTouch||e.crosshair.enable||this.isSelected(e)||this.markerMove(!0)}mouseMoveHandler(){const e=this.chart;e.crosshair.enable&&!e.tooltip.enable||e.isTouch&&!e.startMove||this.isSelected(e)||this.markerMove(!1)}markerMove(e){const t=this.chart;let i,s,o,l;if(this.currentPoints=[],t.tooltip.shared&&t.tooltip.enable){if(!Dt(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect))return null;if(t.tooltip.enable){const e="PolarRadar"===t.chartAreaType?this.getData():null,s=this.mergeXvalues(this.chart.visibleSeries);for(const o of t.visibleSeries)o.enableTooltip&&"Indicator"!==o.category&&("Cartesian"===t.chartAreaType&&o.visible?i=this.getClosestX(t,o,s):"PolarRadar"===t.chartAreaType&&o.visible&&null!==e.point&&(i=new ki(o.points[e.point.index],o)),i&&(this.currentPoints.push(i),i=null))}}else i=this.getData(),l=i.series,s=this.previousPoints[0],o=l&&("Bubble"===l.type||"Scatter"===l.drawType||"Scatter"===l.type||"Candle"!==l.type&&"Hilo"!==l.type&&"HiloOpenClose"!==l.type&&l.marker.visible&&0!==l.marker.width&&0!==l.marker.height),i.lierIndex=this.lierIndex,i.point&&o&&(!s||s.point!==i.point||s&&s.lierIndex>3&&s.lierIndex!==this.lierIndex)&&this.currentPoints.push(i),i.point&&o&&t.isPointMouseDown&&this.currentPoints.push(i);const r=this.previousPoints.length;if(this.currentPoints.length>0&&(0===r||t.isPointMouseDown||r>0&&this.previousPoints[0].point!==this.currentPoints[0].point)){this.previousPoints.length>0&&this.removeHighlightedMarker();for(const e of this.currentPoints)(e&&e.point||"Candle"!==l.type&&"Hilo"!==l.type&&"HiloOpenClose"!==l.type)&&(si(this.markerExplode),this.isRemove=!0,e.point.symbolLocations.map((t,i)=>{e.series.isRectSeries&&!e.point.marker.visible||this.drawTrackBall(e.series,e.point,t,i)}));this.previousPoints=(0,a.l7)([],this.currentPoints,null,!0)}t.tooltip.enable||!(0===this.currentPoints.length&&this.isRemove||e&&this.isRemove)&&Dt(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect)||(this.isRemove=!1,this.markerExplode=+setTimeout(()=>{this.removeHighlightedMarker()},2e3)),this.currentPoints=[]}drawTrackBall(e,t,i,s){const o=t.marker,l=e.marker,r=o.shape||l.shape;if("None"===r)return null;const n=e.symbolElement||e.seriesElement;let h;this.chart.highlightModule&&"None"!==this.chart.highlightMode&&(h=this.chart.highlightModule.generateStyle(e)),this.chart.selectionModule&&"None"!==this.chart.selectionMode&&(h=this.chart.selectionModule.generateStyle(e));const d=this.elementId+"_Series_"+e.index+"_Point_"+t.index+"_Trackball"+(s||""),c=new w((o.width||l.width)+5,(o.height||l.height)+5),p=o.border||e.border,u="BoxAndWhisker"===e.type||"Bubble"===e.type||"Scatter"===e.type,g=p.color&&"transparent"!==p.color?p.color:o.fill||t.interior||(u?t.color:e.interior),m=hi(di(g)),b=o.border?o.border.width:l.border.width,f=e.chart.themeStyle.markerShadow||"rgba("+m.r+","+m.g+","+m.b+",0.2)";for(let y=0;y<2;y++){const s=new I(d+"_"+y,y?o.fill||t.color||(u?e.interior:"#ffffff"):"transparent",b+(y?0:8),y?g:f,o.opacity||l.opacity,null,null),p=qt(i,r,c,o.imageUrl,s,0,this.chart.svgRenderer,e.clipRect);p.setAttribute("class","EJ2-Trackball");const m=-1!==n.id.indexOf("Symbol")?"_Symbol":"",v=document.getElementById(this.elementId+"_Series_"+e.index+"_Point_"+t.index+m);""===h||(0,a.le)(h)||(0,a.le)(v)||!v.hasAttribute("class")||h!==v.getAttribute("class")||p.classList.add(h),p.setAttribute("clip-path",n.getAttribute("clip-path")),p.setAttribute("transform",n.getAttribute("transform")),this.chart.svgObject.appendChild(p)}}removeHighlightedMarker(){const e=document.getElementsByClassName("EJ2-Trackball");for(let t=0,i=e.length;t<i;t++)(0,a.Od)(e[0]);this.previousPoints=[]}}class Ji extends Qi{constructor(e){super(e),this.addEventListener()}render(e){const t=e.chart.redraw;this.createElement(e,t);for(const i of e.points)i.visible&&i.symbolLocations&&i.symbolLocations.length&&i.symbolLocations.map((s,o)=>{"None"!==e.marker.shape&&this.renderMarker(e,i,s,o,t)})}renderMarker(e,t,i,s,o){const l=void 0===e.index?e.category:e.index,r=e.marker,n={color:r.border.color,width:r.border.width},h=r.border.color;let d,c,p,u;i.x=i.x+r.offset.x,i.y=i.y-r.offset.y;const g="BoxAndWhisker"===e.type,m=r.fill||(g?t.interior||e.interior:"#ffffff");let b;const f=g?function(e,t){let i;for(let s=0,o=e.length;s<o;s++)e[s].id.indexOf(t)>-1&&(i=e[s]);return i}(e.seriesElement.childNodes,"Series_"+e.index+"_Point_"+t.index):e.symbolElement;n.color=h||e.setPointColor(t,e.interior);const y=this.elementId+"_Series_"+l+"_Point_"+t.index+"_Symbol"+(s||""),v={cancel:!1,name:ce,series:e,point:t,fill:t.isEmpty&&e.emptyPointSettings.fill||m,border:{color:"BoxAndWhisker"===e.type?(0,a.le)(h)||"transparent"===h?ci(m,-.6):h:n.color,width:n.width},height:r.height,width:r.width,shape:r.shape};if(v.border=e.setBorderColor(t,{width:v.border.width,color:v.border.color}),e.isRectSeries&&"BoxAndWhisker"!==e.type||(this.chart.trigger(ce,v),t.color=v.fill),t.color=v.fill,v.cancel)i=null,t.marker={visible:!1};else{let l;l="RangeArea"===e.type||"RangeColumn"===e.type||"RangeColumn"===e.drawType||"SplineRangeArea"===e.type?s?t.low:t.high:g?t.outliers[s]:t.y;const n=v.point.marker.fill||v.fill;let h;h=(0,a.le)(v.point.marker.border)?{color:v.border.color,width:v.border.width}:{color:v.point.marker.border.color||v.border.color,width:v.point.marker.border.width||v.border.width};const m=v.point.marker.width||v.width,S=v.point.marker.height||v.height,x=v.point.marker.shape||v.shape,C=v.point.marker.imageUrl||r.imageUrl;u=new I(y,n,h.width,h.color,v.point.marker.opacity||r.opacity,null),(null!=f||this.chart.enableCanvas)&&(o&&Yt(u.id)&&(b=Yt(u.id),p="Circle"===x?"c":"",d={x:+b.getAttribute(p+"x"),y:+b.getAttribute(p+"y")},c=b.getAttribute("d")),b=qt(i,x,new w(m,S),C,u,(t.x.toString(),l.toString()),this.chart.renderer,e.clipRect),$t(this.chart.enableCanvas,f,b,o,!0,p+"x",p+"y",d,c,!1,!1,null,e.chart.duration)),t.marker={border:h,fill:n,height:S,visible:!0,shape:x,width:m,imageUrl:C}}}createElement(e,t){let i;const s=e.marker,o=s.border.width+8+5,l=e.chart.svgRenderer,a=void 0===e.index?e.category:e.index;let r;const n="Cartesian"===e.chart.chartAreaType?"translate("+e.clipRect.x+","+e.clipRect.y+")":"";if(s.visible){const h=(s.height+o)/2,d=(s.width+o)/2;"Cartesian"===e.chart.chartAreaType?(r=new Ti(this.elementId+"_ChartMarkerClipRect_"+a,"transparent",{width:1,color:"Gray"},1,{x:-d,y:-h,width:e.clipRect.width+2*d,height:e.clipRect.height+2*h}),i=_t(t,r,l)):(r=new Ai(this.elementId+"_ChartMarkerClipRect_"+a,"transparent",{width:1,color:"Gray"},1,e.clipRect.width/2+e.clipRect.x,e.clipRect.height/2+e.clipRect.y,e.chart.radius+Math.max(h,d)),i=_t(t,r,l,"drawCircularClipPath")),r={id:this.elementId+"SymbolGroup"+a,transform:n,"clip-path":"url(#"+this.elementId+"_ChartMarkerClipRect_"+a+")"},e.symbolElement=l.createGroup(r),e.symbolElement.appendChild(i),this.chart.enableCanvas&&document.getElementById(this.chart.element.id+"_tooltip_svg").appendChild(e.symbolElement)}}getRangeLowPoint(e,t){let i=e.x,s=e.y;return t.chart.requireInvertedAxis?(s+=e.height/2,i+=t.yAxis.isInversed?e.width:0):(s+=t.yAxis.isInversed?0:e.height,i+=e.width/2),{x:i,y:s}}doMarkerAnimation(e){if("Scatter"!==e.type&&"Bubble"!==e.type&&"Candle"!==e.type&&"Hilo"!==e.type&&"HiloOpenClose"!==e.type&&("PolarRadar"!==e.chart.chartAreaType||"Scatter"!==e.drawType)){const t=e.symbolElement.childNodes,i=e.animation.delay+e.animation.duration,s=e.chart.animated?e.chart.duration:200;let o=1;const l="RangeArea"===e.type||"RangeColumn"===e.type||"SplineRangeArea"===e.type?2:1;for(let a=0;a<e.points.length;a++)if(e.points[a].symbolLocations){if(!e.points[a].symbolLocations.length||!t[o])continue;if(Nt(t[o],i,s,e,a,e.points[a].symbolLocations[0],!1),2===l){const l=this.getRangeLowPoint(e.points[a].regions[0],e);Nt(t[o+1],i,s,e,a,l,!1)}o+=l}}}}var Ki=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class $i extends a.rt{}Ki([(0,a.Z9)(0)],$i.prototype,"x",void 0),Ki([(0,a.Z9)(0)],$i.prototype,"y",void 0);class es extends a.rt{}Ki([(0,a.Z9)(!0)],es.prototype,"visible",void 0),Ki([(0,a.Z9)(null)],es.prototype,"height",void 0),Ki([(0,a.Z9)(null)],es.prototype,"width",void 0),Ki([(0,a.Zz)({x:0,y:0},$i)],es.prototype,"location",void 0),Ki([(0,a.Z9)("Auto")],es.prototype,"position",void 0),Ki([(0,a.Z9)("Series")],es.prototype,"mode",void 0),Ki([(0,a.Z9)(8)],es.prototype,"padding",void 0),Ki([(0,a.Z9)("Center")],es.prototype,"alignment",void 0),Ki([(0,a.Zz)(B.legendLabelFont,q)],es.prototype,"textStyle",void 0),Ki([(0,a.Z9)(10)],es.prototype,"shapeHeight",void 0),Ki([(0,a.Z9)(10)],es.prototype,"shapeWidth",void 0),Ki([(0,a.Zz)({},G)],es.prototype,"border",void 0),Ki([(0,a.Zz)({left:0,right:0,top:0,bottom:0},U)],es.prototype,"margin",void 0),Ki([(0,a.Zz)({left:0,right:0,top:0,bottom:0},X)],es.prototype,"containerPadding",void 0),Ki([(0,a.Z9)(5)],es.prototype,"shapePadding",void 0),Ki([(0,a.Z9)("transparent")],es.prototype,"background",void 0),Ki([(0,a.Z9)(1)],es.prototype,"opacity",void 0),Ki([(0,a.Z9)(!0)],es.prototype,"toggleVisibility",void 0),Ki([(0,a.Z9)(null)],es.prototype,"description",void 0),Ki([(0,a.Z9)(3)],es.prototype,"tabIndex",void 0),Ki([(0,a.Z9)(null)],es.prototype,"title",void 0),Ki([(0,a.Zz)(B.legendTitleFont,q)],es.prototype,"titleStyle",void 0),Ki([(0,a.Z9)("Top")],es.prototype,"titlePosition",void 0),Ki([(0,a.Z9)(100)],es.prototype,"maximumTitleWidth",void 0),Ki([(0,a.Z9)(!0)],es.prototype,"enablePages",void 0),Ki([(0,a.Z9)(!1)],es.prototype,"isInversed",void 0);class ts{constructor(e){this.pageXCollections=[],this.legendTitleCollections=[],this.legendRegions=[],this.pagingRegions=[],this.chart=e,this.legend=e.legendSettings,this.legendID=e.element.id+"_chart_legend",this.isChartControl="chart"===e.getModuleName(),this.isBulletChartControl="bulletChart"===e.getModuleName(),this.isStockChartControl="stockChart"===e.getModuleName(),this.bulletChart=this.chart,this.fivePixel=5,this.rowCount=0,this.pageButtonSize=8,this.maxColumns=0,this.maxWidth=0,this.currentPage=1,this.backwardArrowOpacity=0,this.forwardArrowOpacity=1,this.arrowWidth=2*(this.fivePixel+this.pageButtonSize+this.fivePixel),this.arrowHeight=this.arrowWidth,this.isTop=!1,this.isTitle=!1,this.currentPageNumber=1}calculateLegendBounds(e,t,i){const s=this.legend,o=this.isBulletChartControl?"40%":"20%";this.getPosition(s.position,t),this.legendBounds=new C(e.x,e.y,0,0),this.isVertical="Left"===this.position||"Right"===this.position,this.isVertical?(this.legendBounds.height=ui(s.height,t.height-(e.y-this.chart.margin.top))||e.height,this.legendBounds.width=ui(s.width||o,t.width)):(this.legendBounds.width=ui(s.width,t.width)||e.width,this.legendBounds.height=ui(s.height||o,t.height)),this.library.getLegendBounds(t,this.legendBounds,s),this.isBulletChartControl||(this.legendBounds.width+=this.legend.containerPadding.left+this.legend.containerPadding.right,this.legendBounds.height+=this.legend.containerPadding.top+this.legend.containerPadding.bottom),this.getLocation(this.position,s.alignment,this.legendBounds,e,t,i)}getPosition(e,t){const i=this.chart,s=this.chart;this.isChartControl||this.isBulletChartControl||this.isStockChartControl?this.position="Auto"!==e?e:"Bottom":("Auto"===e&&((i||s).visibleSeries&&"Funnel"===(i||s).visibleSeries[0].type||"Pyramid"===(i||s).visibleSeries[0].type)&&(e="Top"),this.position="Auto"!==e?e:t.width>t.height?"Right":"Bottom")}setBounds(e,t,i,s){let o=i.title&&"Top"===i.titlePosition?this.legendTitleSize.height+this.fivePixel:0;this.isVertical&&this.isPaging&&!i.enablePages&&!this.isBulletChartControl&&(o=i.title&&"Top"===i.titlePosition?this.legendTitleSize.height+this.fivePixel:0,o+=this.pageButtonSize+this.fivePixel),e=Math.min(e,s.width),t=Math.min(t,s.height),"Gradient"===i.mode?(s.width=i.width?s.width:this.isVertical?e:.75*s.width,s.height=i.height?s.height:this.isVertical?.75*s.height:t):(s.width=i.width?s.width:e,s.height=i.height?s.height:t),this.isBulletChartControl||this.isTop&&"None"!==i.titleStyle.textOverflow&&(this.calculateLegendTitle(i,s),s.height+="Wrap"===i.titleStyle.textOverflow&&this.legendTitleCollections.length>1?this.legendTitleSize.height-this.legendTitleSize.height/this.legendTitleCollections.length:0),this.rowCount=Math.max(1,Math.ceil((s.height-i.padding-o)/(this.maxItemHeight+i.padding)))}getLocation(e,t,i,s,o,l){const a=this.legend.border.width,r=this.isBulletChartControl,n=this.bulletChart,h="Inside"===n.labelPosition,d="Inside"===n.tickPosition,c="Vertical"===n.orientation,p=r&&""!==n.categoryField?l.width+this.chart.border.width+3*a:0,u=this.chart.margin.bottom;let g=i.height+a+this.legend.margin.top+this.legend.margin.bottom,m=i.width+a+this.legend.margin.left+this.legend.margin.right;"Bottom"===e?(i.x=this.alignLegend(i.x,o.width,i.width,t),i.y=s.y+(s.height-g)+a+this.legend.margin.top,i.y+=!r||n.opposedPosition||h||d||c?c&&""!==n.categoryField?l.height+2*a:0:n.majorTickLines.height+u+this.legend.border.width+2*a,bt(s,new Ii(0,0,0,g))):"Top"===e?(i.x=this.alignLegend(i.x,o.width,i.width,t),i.y=s.y+a+this.legend.margin.top,i.y-=!r||!n.opposedPosition||h||d||c?0:n.majorTickLines.height+this.chart.margin.top,g-=r?2*-a:0,bt(s,new Ii(0,0,g,0))):"Right"===e?(i.x=s.x+(s.width-i.width)-this.legend.margin.right,i.y=s.y+this.alignLegend(0,o.height-(s.y+u),i.height,t),m+=r&&n.opposedPosition&&!h&&!d&&c?this.chart.margin.left+this.chart.margin.right+n.majorTickLines.height:0,bt(s,new Ii(0,m,0,0))):"Left"===e?(i.x=i.x+this.legend.margin.left,i.y=s.y+this.alignLegend(0,o.height-(s.y+u),i.height,t),m+=!r||n.opposedPosition||h||d||!c?"Vertical"!==n.orientation&&""!==n.categoryField?p:0:i.x-this.chart.margin.left+a+n.majorTickLines.height,bt(s,new Ii(m,0,0,0))):(i.x=this.legend.location.x,i.y=this.legend.location.y,bt(s,new Ii(0,0,0,0)))}alignLegend(e,t,i,s){switch(s){case"Far":e=t-i-e;break;case"Center":e=(t-i)/2}return e}renderLegend(e,t,i,s){let o=0,l=0,a=new C(0,0,0,0),r=new C(0,0,0,0);const n=this.findFirstLegendPosition(this.legendCollections),h=t.padding,d=t.enablePages,c=t.titlePosition,p=this.isPaging&&!t.enablePages&&this.isVertical?this.pageButtonSize:0,u=e.renderer.createGroup({id:this.legendID+"_g"}),g=this.createLegendElements(e,i,u,t,this.legendID,s);this.legendRegions=[];let m=0;for(let b=0;b<this.legendCollections.length;b++)if(""!==this.legendCollections[b].text){m=Math.max(this.legendCollections[b].textSize.height,m);break}if(this.maxItemHeight=Math.max(m,t.shapeHeight),d||!this.isPaging||this.isVertical?this.isPaging||this.isVertical||(l=this.isTitle&&"Left"===c?this.fivePixel+this.legendTitleSize.width:0):(l=this.isTitle&&"Left"===c?this.legendTitleSize.width:0,l+=this.pageButtonSize+2*this.fivePixel),o=this.isTitle&&(this.isTop||this.isVertical)?this.legendTitleSize.height:0,"Gradient"===e.legendSettings.mode&&this.legendCollections.length>1)this.getLinearLegend(i,e,t,g),this.totalPages=1;else if(n!==this.legendCollections.length){let s,d=0,m=this.legendCollections[n];const b=new Ri(this.isBulletChartControl?i.x+l+h+t.shapeWidth/2:i.x+l+h+t.shapeWidth/2+t.containerPadding.left,this.isBulletChartControl?i.y+o+p+h+this.maxItemHeight/2:i.y+o+p+h+this.maxItemHeight/2+t.containerPadding.top),f=new L("",b.x,b.y,e.isRtlEnabled?"end":"start"),y=t.shapePadding+h+t.shapeWidth;if(this.totalPages=this.totalPages=this.isChartControl||this.isBulletChartControl||this.isStockChartControl?this.totalPages:0,this.pageXCollections=[],this.legendCollections[n].location=b,!t.enablePages&&this.isPaging){const e=b.x-this.fivePixel,t=b.y-this.fivePixel,s=this.isTitle&&!this.isVertical&&"Left"===c?this.legendTitleSize.width+this.fivePixel:0,o=this.isVertical?this.pageButtonSize+Math.abs(t-i.y):0;let l=this.isTitle&&!this.isVertical&&"Right"===c?this.legendTitleSize.width+this.fivePixel:0;l+=this.isVertical?0:this.fivePixel+this.pageButtonSize+this.fivePixel,a=new C(e,t,i.width-l-s,i.height-o),r=a}else r=i;for(const i of this.legendCollections)"accumulationchart"===this.chart.getModuleName()&&(i.fill=(this.chart||this.chart||this.chart).visibleSeries[0].points[i.pointIndex].color),"stockChart"===this.chart.getModuleName()&&(i.type=this.chart.visibleSeries[d].type),this.accessbilityText=this.isBulletChartControl?"Legend of bullet chart"+i.text:"Click to show or hide the "+i.text+" series",i.render&&""!==i.text&&(s=e.renderer.createGroup({id:this.legendID+this.generateId(i,"_g_",d)}),s&&(s.setAttribute("tabindex",t.tabIndex.toString()),s.setAttribute("aria-label",t.description||this.accessbilityText)),this.library.getRenderPoint(i,b,y,m,r,d,n),this.renderSymbol(i,s,d),this.renderText(e,i,s,f,d),s&&s.setAttribute("style","outline: none; cursor: "+(!t.toggleVisibility&&("None"===e.selectionMode||"None"===e.highlightMode||"None"===e.selectionMode)||this.isBulletChartControl?"auto":"pointer")),g&&g.appendChild(s),m=i),d++;this.isPaging?this.renderPagingElements(e,i,f,u):this.totalPages=1}$t(e.enableCanvas,e.svgObject,u,s)}getLinearLegend(e,t,i,s){const o="http://www.w3.org/2000/svg",l=this.legendCollections[0],a=this.legendCollections[1],r=this.chart.renderer.createDefs(),n=document.createElementNS(o,"linearGradient"),h=[],d=[];i.title&&(this.isVertical?(e.y+=this.legendTitleSize.height,e.height-=this.legendTitleSize.height):"Left"===i.titlePosition?(e.x+=this.legendTitleSize.width,e.width-=this.legendTitleSize.width):"Right"===i.titlePosition?e.width-=this.legendTitleSize.width:"Top"===i.titlePosition&&(e.y+=this.legendTitleSize.height,e.height-=this.legendTitleSize.height));for(const S of this.chart.rangeColorSettings){if(d.indexOf(S.start)<0&&d.push(S.start),S.colors.length>2){let e=S.end-S.start;const t=S.colors.length-1;if(e>0){e/=t;for(let i=1;i<t;i++)d.push(S.start+e*i)}else for(let i=1;i<t;i++)d.push(S.start)}d.indexOf(S.end)<0&&d.push(S.end);for(const e of S.colors)h.indexOf(e)<0&&h.push(e);S.colors.length>0&&S.colors.length<2&&h.push(S.colors[0])}const c=this.isVertical?"0":"100",p=this.isVertical?"100":"0";n.setAttribute("id",this.generateId(l,"linearGradient",0)),n.setAttribute("x1","0%"),n.setAttribute("y1","0%"),n.setAttribute("x2",c+"%"),n.setAttribute("y2",p+"%");const u=d[d.length-1]-d[0];for(let S=0;S<h.length;S++){let e=d[S]-d[0];e/=u;const t=document.createElementNS(o,"stop");t.setAttribute("offset",e.toString()),t.setAttribute("stop-color",h[S]),t.setAttribute("stop-opacity",1..toString()),n.appendChild(t)}const g=l.text.toString(),m=a.text.toString(),b=S(g,i.textStyle),f=S(m,i.textStyle),y=b.width>f.width?b.width:f.width,v=b.height>f.height?b.height:f.height;let x,w,M,T,A=2*y+4*i.padding,D=e.width,R=e.height,I=e.x+y+2*i.padding,P=e.y+i.padding;if(this.isVertical){if(A=2*v+4*i.padding,D=e.width-2*i.padding,R=e.height-A,I=e.x+i.padding,P=e.y+v+2*i.padding,x=e.y+i.padding+v,w=P+R+v,M=e.x+.5*e.width-.5*y,T=M,D>30){const e=D-30;D=30,I+=e/2}}else if(D=e.width-A,R=e.height-2*i.padding,M=e.x+i.padding+(y-b.width),T=e.x+D+3*i.padding+y,x=e.y+.5*e.height+.25*v,w=x,R>30){const e=R-30;R=30,P+=e/2}let k=new L("",M,x,"",g);k.id=this.legendID+this.generateId(l,"_text_",1);const E=l.visible?i.textStyle.color||t.themeStyle.legendLabel:"#D3D3D3",F=!this.isStockChartControl&&this.chart.enableCanvas;bi(t.renderer,k,i.textStyle,E,s,!1,!1,!1,!1,null,this.currentPageNumber&&F?new C(0,-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),0,0):null),k=new L("",T,w,"",m),k.id=this.legendID+this.generateId(l,"_text_",2),bi(t.renderer,k,i.textStyle,E,s,!1,!1,!1,!1,null,this.currentPageNumber&&F?new C(0,-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),0,0):null);const O=t.renderer.drawRectangle({width:D,height:R,x:I,y:P,fill:"url(#"+this.generateId(l,"linearGradient",0)+")"});r.appendChild(n),s.appendChild(r),s.appendChild(O)}findFirstLegendPosition(e){let t=0;for(const i of e){if(i.render&&""!==i.text)break;t++}return t}calculateLegendTitle(e,t){if(e.title){this.isTop="Top"===e.titlePosition;const i="Trim"===e.titleStyle.textOverflow?2*e.padding:0;this.isTop||this.isVertical?this.legendTitleCollections=vi(e.title,e.titleStyle,t.width-i):this.legendTitleCollections[0]=pi(e.maximumTitleWidth,e.title,e.titleStyle),this.legendTitleSize=S(this.isTop?e.title:this.legendTitleCollections[0],e.titleStyle),this.legendTitleSize.height*=this.legendTitleCollections.length}else this.legendTitleSize=new w(0,0)}renderLegendTitle(e,t,i,s){const o=t.padding,l=t.titleStyle.textAlignment;this.isTop="Top"===t.titlePosition;let a="Near"===l?"start":"Far"===l?"end":"middle",r=Si(i,t.titleStyle);a=this.isTop||this.isVertical?a:"",r="Near"===l?r+o:"Far"===l?r-o:r,r=this.isTop||this.isVertical?r:i.x+("Left"===t.titlePosition?5:i.width-this.legendTitleSize.width-5);const n=new L(this.legendID+"_title",r,i.y+(this.isTop||this.isVertical?this.legendTitleSize.height/this.legendTitleCollections.length:i.height/2+this.legendTitleSize.height/4),a,this.legendTitleCollections);bi(e.renderer,n,t.titleStyle,t.titleStyle.color,s)}createLegendElements(e,t,i,s,o,l){const a=s.padding,r=new Ti(o+"_element",s.background,s.border,s.opacity,t),n=e.renderer.createGroup({id:o+"_collections"}),h=!this.isStockChartControl&&e.enableCanvas,d=e.renderer.createClipPath({id:o+"_clipPath"});return i?i.appendChild(e.renderer.drawRectangle(r)):e.renderer.drawRectangle(r),s.title&&this.renderLegendTitle(e,s,t,i),h||i.appendChild(n),this.legendTranslateGroup=e.renderer.createGroup({id:o+"_translate_g"}),h||n.appendChild(this.legendTranslateGroup),r.y+=a+(this.isTop?this.legendTitleSize.height:0),r.id+="_clipPath_rect",r.width=this.isChartControl||"bulletChart"===e.getModuleName()||this.isStockChartControl||!this.isVertical?t.width:this.maxWidth-a+s.containerPadding.left+s.containerPadding.right,h?this.pagingClipRect=r:(this.clipRect=e.renderer.drawRectangle(r),d.appendChild(this.clipRect)),$t(h,e.svgObject,d,l),h||n.setAttribute("style","clip-path:url(#"+d.id+")"),this.legendTranslateGroup}renderSymbol(e,t,i){const s=this.isBulletChartControl?this.chart:null,o=e.visible?e.fill:"#D3D3D3",l=("chart"===this.chart.getModuleName()||"stockChart"===this.chart.getModuleName())&&"SeriesType"===e.shape&&e.type.toLowerCase().indexOf("line")>-1&&-1===e.type.toLowerCase().indexOf("area"),a=!("chart"!==this.chart.getModuleName()&&"stockChart"!==this.chart.getModuleName()||"Scatter"!==e.type&&"Bubble"!==e.type),r=!this.isStockChartControl&&this.chart.enableCanvas;let n,h,d="SeriesType"===e.shape?e.type:e.shape,c=l?"Series"===this.legend.mode?this.chart.visibleSeries[i].width:this.chart.visibleSeries[0].width:this.isBulletChartControl&&"Multiply"===e.shape?4:1;if(d="Scatter"===d?e.markerShape:d,a&&i<this.chart.visibleSeries.length){const e=this.chart.visibleSeries[i].border;n=e.color?e.color:o,c=e.width?e.width:1}const p=new I(this.legendID+this.generateId(e,"_shape_",i),o,c,a?n:o,1,"","");let u=S(e.text,this.legend.textStyle),g=this.legend.isInversed?e.location.x+u.width+this.legend.shapePadding:e.location.x,m=e.location.y;r?(h=-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),qt({x:g,y:m},d,new w(this.legend.shapeWidth,this.legend.shapeHeight),"",p,0,this.chart.renderer,this.currentPageNumber?new C(0,h,0,0):null,this.isBulletChartControl,s),this.legendRegions.push({rect:new C(e.location.x,e.location.y,this.legend.shapeWidth,this.legend.shapeHeight+h),index:i})):t.appendChild(qt({x:g,y:m},d,new w(this.legend.shapeWidth,this.legend.shapeHeight),e.url,p,0,this.chart.renderer,null,this.isBulletChartControl,s)),("Line"===d&&e.markerVisibility&&"Image"!==e.markerShape||"Doughnut"===e.type&&"Doughnut"===d)&&(p.id=this.legendID+this.generateId(e,"_shape_marker_",i),d="Doughnut"===e.type?"Circle":e.markerShape,p.fill="Doughnut"===e.type?"#FFFFFF":p.fill,r?qt({x:g,y:m},d,new w(this.legend.shapeWidth/2,this.legend.shapeHeight/2),"",p,0,this.chart.renderer,this.currentPageNumber?new C(0,-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),0,0):null,this.isBulletChartControl,s):t.appendChild(qt({x:g,y:m},d,new w(this.legend.shapeWidth/2,this.legend.shapeHeight/2),"",p,0,null,null,this.isBulletChartControl,s)))}renderText(e,t,i,s,o){const l=e.legendSettings,a=t.visible?l.textStyle.color||e.themeStyle.legendLabel:"#D3D3D3",r=!this.isStockChartControl&&this.chart.enableCanvas;s.id=this.legendID+this.generateId(t,"_text_",o),s.text=t.text,s.x=l.isInversed?t.location.x-l.shapeWidth/2:t.location.x+l.shapeWidth/2+l.shapePadding,s.y=t.location.y+this.maxItemHeight/4;const n=bi(e.renderer,s,l.textStyle,a,i,!1,!1,!1,!1,null,this.currentPageNumber&&r?new C(0,-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),0,0):null);if(n&&n.setAttribute("aria-label",l.description||this.accessbilityText),r){const e=S(s.text,l.textStyle);this.legendRegions[o].rect.y=s.y<this.legendRegions[o].rect.y?s.y:this.legendRegions[o].rect.y,this.legendRegions[o].rect.width+=e.width,this.legendRegions[o].rect.height=e.height,this.legendRegions[o].rect.y-=.5*e.height}}renderPagingElements(e,t,i,s){const o=e.renderer.createGroup({id:this.legendID+"_navigation"}),l=!this.isStockChartControl&&e.enableCanvas,a=this.isBulletChartControl?0:this.legendTitleSize.height,r=e.legendSettings,n=new I(this.legendID+"_pageup","transparent",5,"#545454",1,"",""),h=this.pageButtonSize,d=r.enablePages||!this.isPaging||this.isVertical||this.isBulletChartControl?this.rowCount-1:1,c=this.isTitle&&"Left"===r.titlePosition?this.legendTitleSize.width:0;let p;this.pagingRegions=[],this.backwardArrowOpacity=1!==this.currentPage?1:0,this.forwardArrowOpacity=this.currentPage===this.totalPages?0:1,l||s.appendChild(o),this.totalPages=this.isChartControl||this.isBulletChartControl||this.isStockChartControl||!this.isVertical?Math.ceil(this.totalPages/Math.max(1,this.rowCount-1)):Math.ceil(this.totalPages/this.maxColumns),o&&o.setAttribute("style","cursor: pointer"),this.clipPathHeight=d*(this.maxItemHeight+r.padding),l?(this.pagingClipRect.height=this.legendBounds.height-this.clipPathHeight-(this.pagingClipRect.y-this.legendBounds.y)-r.border.width,this.pagingClipRect.y=this.pagingClipRect.y+this.clipPathHeight,this.pagingClipRect.x+=r.border.width,this.pagingClipRect.width-=r.border.width+r.border.width/2,this.chart.renderer.clearRect(new C(this.pagingClipRect.x,this.pagingClipRect.y,this.pagingClipRect.width,this.pagingClipRect.height))):this.clipRect.setAttribute("height",this.clipPathHeight.toString());let u=t.x+h/2,g=t.y+this.clipPathHeight+(a+t.height-this.clipPathHeight)/2;!this.isPaging||r.enablePages||this.isVertical||this.isBulletChartControl||(u=t.x+this.fivePixel+this.pageButtonSize+c,g=r.title&&this.isTop?t.y+8+a+h/1+.5:t.y+8+h+.5);const m=S(this.totalPages+"/"+this.totalPages,r.textStyle);l?qt({x:u,y:g},"LeftArrow",new w(h,h),"",n,0,this.chart.renderer,new C(t.width-(2*(h+8)+8+m.width),0,0,0)):!this.isVertical||r.enablePages||this.isBulletChartControl?(n.opacity=this.isBulletChartControl?n.opacity:r.enablePages?1:this.backwardArrowOpacity,o.appendChild(qt({x:u,y:g},"LeftArrow",new w(h,h),"",n))):(u=t.x+t.width/2,g=t.y+h/2+8+a,n.opacity=this.backwardArrowOpacity,o.appendChild(qt({x:u,y:g},"UpArrow",new w(h,h),"",n))),this.pagingRegions.push(new C(u+t.width-(2*(h+8)+8+m.width)-.5*h,g-.5*h,h,h)),i.x=u+h/2+8,i.y=g+m.height/4,i.id=this.legendID+"_pagenumber",i.text="1/"+this.totalPages,l&&this.totalNoOfPages&&(i.text=this.currentPageNumber+"/"+this.totalNoOfPages),(r.enablePages||this.isBulletChartControl)&&(p=bi(e.renderer,i,r.textStyle,r.textStyle.color,o,!1,!1,!1,!1,null,new C(t.width-(2*(h+8)+8+m.width),0,0,0))),u=i.x+8+h/2+m.width,!this.isPaging||r.enablePages||this.isVertical||(u=t.x+t.width-this.fivePixel-this.pageButtonSize-(r.title&&"Right"===r.titlePosition?this.legendTitleSize.width+this.fivePixel:0)),n.id=this.legendID+"_pagedown",n.opacity=r.enablePages?1:this.forwardArrowOpacity,l?qt({x:u,y:g},"RightArrow",new w(h,h),"",n,0,this.chart.renderer,new C(t.width-(2*(h+8)+8+m.width),0,0,0)):!this.isVertical||r.enablePages||this.isBulletChartControl?o.appendChild(qt({x:u,y:g},"RightArrow",new w(h,h),"",n)):(u=t.x+t.width/2,g=t.y+t.height-h/2-8,o.appendChild(qt({x:u,y:g},"DownArrow",new w(h,h),"",n))),this.pagingRegions.push(new C(u+(t.width-(2*(h+8)+8+m.width)-.5*h),g-.5*h,h,h)),l||!r.enablePages&&!this.isBulletChartControl?(1===this.currentPageNumber&&this.calTotalPage&&(r.enablePages||this.isBulletChartControl)&&(this.totalNoOfPages=this.totalPages,this.calTotalPage=!1),r.enablePages||this.isBulletChartControl||this.translatePage(null,this.currentPage-1,this.currentPage,r)):o.setAttribute("transform","translate("+(t.width-(2*(h+8)+8+m.width))+", 0)"),(r.enablePages||this.isBulletChartControl)&&this.translatePage(p,this.currentPage-1,this.currentPage,r)}translatePage(e,t,i,s){let o=this.clipPathHeight*t,l="translate(0,-"+o+")";return this.isChartControl||this.isBulletChartControl||this.isStockChartControl||!this.isVertical||(o=this.pageXCollections[t*this.maxColumns]-this.legendBounds.x,o=o<0?0:o,l="translate(-"+o+",0)"),this.chart.enableCanvas||this.legendTranslateGroup.setAttribute("transform",l),this.chart.enableCanvas||!s.enablePages&&!this.isBulletChartControl||(e.textContent=i+"/"+this.totalPages),this.currentPage=i,o}changePage(e,t){const i=this.chart.legendSettings,s=document.getElementById(this.legendID+"_pageup"),o=document.getElementById(this.legendID+"_pagedown"),l=i.enablePages||this.isBulletChartControl?document.getElementById(this.legendID+"_pagenumber"):null,a=i.enablePages||this.isBulletChartControl?parseInt(l.textContent.split("/")[0],10):this.currentPage;t&&a>1?this.translatePage(l,a-2,a-1,i):!t&&a<this.totalPages&&this.translatePage(l,a,a+1,i),!this.isPaging||i.enablePages||this.isBulletChartControl||(this.currentPage===this.totalPages?this.hideArrow(o):this.showArrow(o),1===this.currentPage?this.hideArrow(s):this.showArrow(s))}hideArrow(e){e.setAttribute("opacity","0")}showArrow(e){e.setAttribute("opacity","1")}generateId(e,t,i){return this.isChartControl||this.isStockChartControl?t+i:t+e.pointIndex}move(e){const t=this.chart.mouseX,i=this.chart.mouseY;if(e.target.textContent.indexOf("...")>-1){const s=e.target.id.split(this.legendID+"_text_");if(2===s.length){const e=parseInt(s[1],10),o=this.chart.element;isNaN(e)||(this.chart.isTouch&&nt(this.chart.element.id+"_EJ2_Legend_Tooltip"),this.isChartControl?dt(this.chart.series[e].name,t,i,o.offsetWidth,o.id+"_EJ2_Legend_Tooltip",Yt(this.chart.element.id+"_Secondary_Element")):dt(this.chart.visibleSeries[0].points[e].x.toString(),t+10,i+10,o.offsetWidth,o.id+"_EJ2_Legend_Tooltip",Yt(this.chart.element.id+"_Secondary_Element")))}}else nt(this.chart.element.id+"_EJ2_Legend_Tooltip");this.chart.isTouch&&(clearTimeout(this.clearTooltip),this.clearTooltip=+setTimeout(()=>{nt(this.chart.element.id+"_EJ2_Legend_Tooltip")},1e3))}}class is{constructor(e,t,i,s,o,l,a,r,n,h){this.location={x:0,y:0},this.text=e,this.fill=t,this.shape=i,this.url=l,this.visible=s,this.type=o,this.markerVisibility=r,this.markerShape=a,this.pointIndex=n,this.seriesIndex=h}}var ss=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class os extends Wi{constructor(){super(...arguments),this.clipRect=new C(0,0,0,0)}setDataSource(e,t){e&&(this.xData=e.xData,this.yData=e.yData,this.points=e.points),t[kt(this.type)+"IndicatorModule"].initDataSource(this,t),t.visibleSeriesCount+=this.targetSeries.length}}ss([(0,a.Z9)("Sma")],os.prototype,"type",void 0),ss([(0,a.Z9)(14)],os.prototype,"period",void 0),ss([(0,a.Z9)(14)],os.prototype,"kPeriod",void 0),ss([(0,a.Z9)(3)],os.prototype,"dPeriod",void 0),ss([(0,a.Z9)(80)],os.prototype,"overBought",void 0),ss([(0,a.Z9)(20)],os.prototype,"overSold",void 0),ss([(0,a.Z9)(2)],os.prototype,"standardDeviation",void 0),ss([(0,a.Z9)("Close")],os.prototype,"field",void 0),ss([(0,a.Z9)(12)],os.prototype,"slowPeriod",void 0),ss([(0,a.Z9)(26)],os.prototype,"fastPeriod",void 0),ss([(0,a.Z9)(!0)],os.prototype,"showZones",void 0),ss([(0,a.Zz)({color:"#ff9933",width:2},H)],os.prototype,"macdLine",void 0),ss([(0,a.Z9)("Both")],os.prototype,"macdType",void 0),ss([(0,a.Z9)("#2ecd71")],os.prototype,"macdPositiveColor",void 0),ss([(0,a.Z9)("#e74c3d")],os.prototype,"macdNegativeColor",void 0),ss([(0,a.Z9)("rgba(211,211,211,0.25)")],os.prototype,"bandColor",void 0),ss([(0,a.Zz)({color:"#ffb735",width:1},H)],os.prototype,"upperLine",void 0),ss([(0,a.Zz)({color:"#f2ec2f",width:1},H)],os.prototype,"lowerLine",void 0),ss([(0,a.Zz)({color:"#f2ec2f",width:1},H)],os.prototype,"periodLine",void 0),ss([(0,a.Z9)("")],os.prototype,"seriesName",void 0);class ls{constructor(e){this.control=e}print(e){this.printWindow=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),this.printWindow.moveTo(0,0),this.printWindow.resizeTo(screen.availWidth,screen.availHeight);const t={cancel:!1,htmlContent:this.getHTMLContent(e),name:Ie};this.control.trigger(Ie,t),t.cancel||(0,a.S0)(t.htmlContent,this.printWindow)}getHTMLContent(e){const t=(0,a.az)("div");if(e)if(e instanceof Array)for(let i=0;i<e.length;i++)t.appendChild(Yt(e[i]).cloneNode(!0));else e instanceof Element?t.appendChild(e.cloneNode(!0)):t.appendChild(Yt(e).cloneNode(!0));else t.appendChild(this.control.element.cloneNode(!0));return t}export(e,t,i,s,o,l,r,n,h){const d=this.getControlsValue(s,r);o=o||d.width,l=l||d.height;let c=this.control.svgObject;const p=this.control.enableCanvas;let u;p||(c=(0,a.az)("canvas",{id:"ej2-canvas",attrs:{width:o.toString(),height:l.toString()}}));const g=!(a.AR.userAgent.toString().indexOf("HeadlessChrome")>-1);i=(0,a.le)(i)?f.xjJ.Landscape:i;const m=window.URL.createObjectURL(new Blob("SVG"===e?['<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+d.svg.outerHTML+"</svg>"]:[(new XMLSerializer).serializeToString(d.svg)],{type:"image/svg+xml"}));if("SVG"===e)if("msie"===a.AR.info.name){const i=new Blob([(new XMLSerializer).serializeToString(d.svg)],{type:"application/octet-stream"});window.navigator.msSaveOrOpenBlob(i,t+"."+e.toLocaleLowerCase())}else this.triggerDownload(t,e,m,g);else if("msie"===a.AR.info.name){let s=c;p||(s=this.createCanvas()),u=s.toDataURL(),"PDF"===e?this.exportPdf(s,i,o,l,g,t,n,h):this.doexport(e,u,t)}else{const s=new Image,a=c.getContext("2d");s.onload=()=>{a.drawImage(s,0,0),window.URL.revokeObjectURL(m),"PDF"===e?this.exportPdf(c,i,o,l,g,t,n,h):window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(c.toBlob(null),t+"."+e.toLocaleLowerCase()):this.triggerDownload(t,e,c.toDataURL("image/"+e.toLowerCase()),g)},s.src=m}p||nt(document.getElementById(this.control.element.id+"_canvas"))}getDataUrl(e){const t=this.getControlsValue([e]);let i=this.control.svgObject;const s=this.control.enableCanvas;s||(i=(0,a.az)("canvas",{id:"ej2-canvas",attrs:{width:t.width.toString(),height:t.height.toString()}}));const o=window.URL.createObjectURL(new Blob([(new XMLSerializer).serializeToString(t.svg)],{type:"image/svg+xml"}));if("msie"===a.AR.info.name){let t=i;s||(t=this.createCanvas());const o={name:Be,cancel:!1,dataUrl:i.toDataURL("image/png")};return e.trigger(Be,o),{element:t,dataUrl:t.toDataURL()}}{const t=new Image,s=i.getContext("2d");return t.onload=()=>{s.drawImage(t,0,0),window.URL.revokeObjectURL(o);const l={name:Be,cancel:!1,dataUrl:i.toDataURL("image/png")};return e.trigger(Be,l),l.dataUrl},t.src=o,{element:i,blobUrl:o}}}triggerDownload(e,t,i,s){(0,a.az)("a",{attrs:{download:e+"."+t.toLocaleLowerCase(),href:i}}).dispatchEvent(new MouseEvent(s?"click":"move",{view:window,bubbles:!1,cancelable:!0}))}getControlsValue(e,t){let i=0,s=0;const o=this.control.enableCanvas,l=new y("").createSvg({id:"Svg_Export_Element",width:200,height:200});return e.map(e=>{const r=e.svgObject.cloneNode(!0),n=e.renderer.createGroup({style:(0,a.le)(t)||t?"transform: translateY("+s+"px)":"transform: translateX("+i+"px)"}),h=r.childNodes[0].getAttribute("fill");"Tailwind"!==e.theme&&"TailwindDark"!==e.theme||"rgba(255,255,255, 0.0)"!==h&&"transparent"!==h||r.childNodes[0].setAttribute("fill","rgba(255,255,255, 1)"),o||n.appendChild(r),i=(0,a.le)(t)||t?Math.max(e.availableSize.width,i):i+e.availableSize.width,s=(0,a.le)(t)||t?s+e.availableSize.height:Math.max(e.availableSize.height,s),o||l.appendChild(n)}),o||(l.setAttribute("width",i+""),l.setAttribute("height",s+"")),{width:i,height:s,svg:l}}createCanvas(){const e=this.control;this.canvasRender(!0,e);const t=e.svgObject;return this.canvasRender(!1,e),t}canvasRender(e,t){t.enableCanvas=e,t.preRender(),t.render()}exportPdf(e,t,i,s,o,l,a,r){const n=new f.ZlO,h=n.pageSettings.margins,d=n.pageSettings.width,c=n.pageSettings.height;let p=e.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream");n.pageSettings.orientation=t;const u=d<i?i+h.left+h.right:d,g=c<s?s+h.top+h.bottom:c;if(void 0!==a){const e=new f.ihD(1,a.fontSize||15),t=new f.iD(u,40);t.graphics.drawString(a.content+"",e,null,new f.RYn(new f.qve(0,0,0)),a.x,a.y,null),n.template.top=t}if(void 0!==r){const e=new f.ihD(1,r.fontSize||15),t=new f.iD(u,40);t.graphics.drawString(r.content+"",e,null,new f.RYn(new f.qve(0,0,0)),r.x,r.y,null),n.template.bottom=t}n.pageSettings.size=new f.EA8(u,g),p=p.slice(p.indexOf(",")+1),n.pages.add().graphics.drawImage(new f.bjq(p),0,0,i,s),o&&(n.save(l+".pdf"),n.destroy())}doexport(e,t,i){let s=[];s=[t],this.exportImage(s,i,e||"JPG",t)}exportImage(e,t,i,s){const o=[],l=e instanceof HTMLElement?0:e.length;for(let a=0;a<l;a++){const t=e[a].replace(/^data:[a-z]*;,/,"").split(","),i=atob(t[1]),s=new ArrayBuffer(i.length),l=new Uint8Array(s);for(let e=0;e<i.length;e++)l[e]=i.charCodeAt(e);o.push(s)}for(let r=0;r<o.length;r++){const e=new Blob([o[r]],{type:"application/octet-stream"});"msie"===a.AR.info.name&&window.navigator.msSaveOrOpenBlob(e,t+"."+i.toLocaleLowerCase())}}}var as=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};let rs=(()=>{class e extends a.rt{}return as([(0,a.Z9)()],e.prototype,"start",void 0),as([(0,a.Z9)()],e.prototype,"end",void 0),as([(0,a.Z9)([])],e.prototype,"colors",void 0),as([(0,a.Z9)("")],e.prototype,"label",void 0),e})(),ns=(()=>{class e extends a.rt{}return as([(0,a.Z9)(!1)],e.prototype,"enable",void 0),as([(0,a.Z9)("")],e.prototype,"dashArray",void 0),as([(0,a.Zz)({color:null,width:1},G)],e.prototype,"line",void 0),as([(0,a.Z9)("Both")],e.prototype,"lineType",void 0),e})(),hs=(()=>{class e extends a.rt{}return as([(0,a.Z9)(!1)],e.prototype,"enableSelectionZooming",void 0),as([(0,a.Z9)(!1)],e.prototype,"enablePinchZooming",void 0),as([(0,a.Z9)(!1)],e.prototype,"enableMouseWheelZooming",void 0),as([(0,a.Z9)(!0)],e.prototype,"enableDeferredZooming",void 0),as([(0,a.Z9)("XY")],e.prototype,"mode",void 0),as([(0,a.Z9)(["Zoom","ZoomIn","ZoomOut","Pan","Reset"])],e.prototype,"toolbarItems",void 0),as([(0,a.Z9)(!1)],e.prototype,"enablePan",void 0),as([(0,a.Z9)(!1)],e.prototype,"enableScrollbar",void 0),e})(),ds=(()=>{let e=class extends a.wA{constructor(e,t){super(e,t),this.rotatedDataLabelCollections=[],this.animated=!1,this.isPointMouseDown=!1,this.isScrolling=!1,this.checkResize=0,this.visible=0,this.clickCount=0,this.singleClickTimer=0,this.chartAreaType="Cartesian",this.isRtlEnabled=!1,this.chartid=57723,(0,a.sO)("mergePersistData",this.mergePersistChartData,this)}mergePersistChartData(){const e=window.localStorage.getItem(this.getModuleName()+this.element.id);if(!(0,a.le)(e)&&""!==e){const t=JSON.parse(e),i=Object.keys(t);this.isProtectedOnChange=!0;for(const e of i)"object"!=typeof this[e]||(0,a.le)(this[e])?this[e]=t[e]:(0,a.l7)(this[e],t[e]);this.isProtectedOnChange=!1}}isIdHasSpecialCharacter(e){const t=/^[A-Za-z0-9 ]+$/;let i="";if(t.test(e))return e;for(let s=0;s<e.length;s++)t.test(e[s])||-1!==e.indexOf("-")||-1!==e.indexOf("_")||-1!==e.indexOf("\\")?i+=e[s]:i+="\\"+e[s];return i}preRender(){this.element.id=this.isIdHasSpecialCharacter(this.element.id),this.isBlazor=window.Blazor,this.allowServerDataBinding=!1,this.unWireEvents(),this.initPrivateVariable(),this.setCulture(),this.wireEvents(),this.stockChart&&(null===this.stockChart.tooltip.header&&(this.tooltip.header="<b>${point.x}</b>"),null===this.stockChart.tooltip.format&&(this.tooltip.format="High : <b>${point.high}</b><br/>Low : <b>${point.low}</b><br/>Open : <b>${point.open}</b><br/>Close : <b>${point.close}</b>",""!==this.stockChart.series[0].volume&&(this.tooltip.format+="<br/>Volume : <b>${point.volume}</b>")),this.animateSeries=!1)}initPrivateVariable(){if(this.animateSeries=!0,this.delayRedraw=!1,this.horizontalAxes=[],this.verticalAxes=[],this.refreshAxis(),this.refreshDefinition(this.rows),this.refreshDefinition(this.columns),this.tooltipModule&&(this.tooltipModule.previousPoints=[]),""===this.element.id){const e=document.getElementsByClassName("e-chart").length;this.element.id="chart_"+this.chartid+"_"+e}this.svgId=this.stockChart?this.stockChart.element.id+"_stockChart_chart":this.element.id+(this.enableCanvas?"_canvas":"_svg")}render(){this.svgRenderer=new y(this.element.id);const e={chart:this.isBlazor?{}:this,theme:this.theme,name:ne,cancel:!1};this.stockChart?(this.isRtlEnabled="rtl"===window.getComputedStyle(document.querySelector("body")).direction,this.cartesianChartRendering(e)):this.trigger(ne,e,()=>{e.cancel||this.cartesianChartRendering(e)})}cartesianChartRendering(e){this.theme=this.isBlazor?e.theme:this.theme,this.createChartSvg(),this.setTheme(),this.markerRender=new Ji(this),this.calculateAreaType(),this.calculateVisibleSeries(),this.initTechnicalIndicators(),this.initTrendLines(),this.calculateVisibleAxis(),this.processData(),this.renderComplete(),this.allowServerDataBinding=!0}getLocalizedLabel(e){return this.localeObject.getConstant(e)}animate(e){this.redraw=!0,this.animated=!0,this.duration=e||1e3}refreshBound(){if(this.rotatedDataLabelCollections=[],this.legendModule&&this.legendSettings.visible&&this.legendModule.getLegendOptions(this.visibleSeries,this),this.tooltip.enable&&this.tooltipModule&&(this.tooltipModule.previousPoints=[]),this.calculateStackValues(),this.calculateBounds(),this.stockChart&&!this.stockChart.rangeFound&&(this.stockChart.enablePeriodSelector||this.stockChart.enableSelector))return null;this.renderElements(),nt("chartmeasuretext"),this.removeSelection()}calculateStackValues(){let e,t=!1;for(let i=0,s=this.visibleSeries.length;i<s;i++)e=this.visibleSeries[i],e.position=e.rectCount=void 0,-1===e.type.indexOf("Stacking")&&(-1===e.drawType.indexOf("Stacking")||"PolarRadar"!==this.chartAreaType)||t||(e.calculateStackedValue(e.type.indexOf("100")>-1,this),t=!0)}removeSelection(){for(const e of this.visibleSeries)if(e.visible)for(const t of e.points)t.isSelect=!1;Yt(this.element.id+"_ej2_drag_multi_group")?(this.selectionMode.indexOf("Drag")>-1&&(this.selectionModule.filterArray=[]),nt(this.element.id+"_ej2_drag_multi_group"),this.selectionModule.calculateDragSelectedElements(this,new C(0,0,0,0),!0)):Yt(this.element.id+"_ej2_drag_group")&&("Lasso"!==this.selectionMode&&(this.selectionModule.filterArray=[]),nt(this.element.id+"_ej2_drag_group"),this.selectionModule.calculateDragSelectedElements(this,new C(0,0,0,0),!0))}renderElements(){this.renderBorder(),this.renderTitle(),this.renderAreaBorder(),this.renderSeriesElements(this.renderAxes()),this.renderLegend(),this.applyZoomkit(),this.performSelection(),this.setSecondaryElementPosition();for(const e of this.visibleSeries)(0,a.tx)(this.element.id+"_DataLabel","Template",e.marker.dataLabel);this.renderAnnotation()}renderAxes(){let e;return this.yAxisElements=this.renderer.createGroup({id:this.element.id+"yAxisCollection"}),this.rows.length>0&&this.columns.length>0&&(e=this.chartAxisLayoutPanel.renderAxes()),this.stripLineModule&&this.stripLineModule.renderStripLine(this,"Behind",this.axisCollections),e}renderLegend(){if(this.legendModule&&this.legendModule.legendCollections.length&&this.legendSettings.visible){this.legendModule.calTotalPage=!0;const e=this.legendSettings.border.width,t=this.legendModule.legendBounds;let i=new C(t.x,t.y,t.width,t.height);this.enableCanvas&&(i=new C(i.x-e/2,i.y-e/2,i.width+e,i.height+e),this.renderer.canvasClip(i)),this.legendModule.renderLegend(this,this.legendSettings,t),this.enableCanvas&&this.renderer.canvasRestore()}this.redraw||(this.stockChart?Yt(this.stockChart.chartObject.id)||this.stockChart.mainObject.appendChild(this.svgObject):this.element.appendChild(this.svgObject))}setSecondaryElementPosition(){const e=Yt(this.element.id+"_Secondary_Element");if(!e)return;const t=this.element.getBoundingClientRect(),i=Yt(this.svgId).getBoundingClientRect();e.style.left=Math.max(i.left-t.left,0)+"px",e.style.top=Math.max(i.top-t.top,0)+"px"}initializeModuleElements(){this.dataLabelCollections=[];const e=this.element.id;this.series.length&&(this.seriesElements="Scatter"===this.series[0].type||"Bubble"===this.series[0].type?this.svgRenderer.createGroup({id:e+"SeriesCollection"}):this.renderer.createGroup({id:e+"SeriesCollection"})),this.indicators.length&&(this.indicatorElements=this.renderer.createGroup({id:e+"IndicatorCollection"})),this.hasTrendlines()&&(this.trendLineElements=this.renderer.createGroup({id:e+"TrendLineCollection"})),this.dataLabelElements=this.renderer.createGroup({id:e+"DataLabelCollection"})}hasTrendlines(){let e;for(const t of this.series)if(e=!!t.trendlines.length,e)break;return e}renderSeriesElements(e){this.initializeModuleElements();const t=this.element.id;if("g"!==this.element.tagName){const e=gi(this.redraw,t+"_Secondary_Element")||this.createElement("div");e.id=t+"_Secondary_Element",e.setAttribute("style","position: relative"),$t(!1,this.element,e,this.redraw)}if(this.enableCanvas){let e=document.getElementById(t+"_Secondary_Element");e=e||this.createElement("div",{id:t+"_Secondary_Element",attrs:{style:"position: relative; left:0px; top:0px"}});const i=this.svgRenderer.createSvg({id:t+"_tooltip_svg",width:this.availableSize.width,height:this.availableSize.height});i.setAttribute("style","position: absolute; pointer-events: none"),e.appendChild(i)}this.tooltip.enable&&$t(this.enableCanvas,this.svgObject,this.renderer.createGroup({id:t+"_UserInteraction",style:"pointer-events:none;"}),this.redraw),this.rows.length>0&&this.columns.length>0&&(this.initializeIndicator(),this.initializeTrendLine(),this.renderSeries(),this.trendLineElements&&$t(this.enableCanvas,this.svgObject,this.trendLineElements,this.redraw),this.appendElementsAfterSeries(e))}renderSeries(){let e;this.enableCanvas&&this.renderer.canvasClip(this.chartAxisLayoutPanel.seriesClipRect);for(const i of this.visibleSeries)e="TrendLine"===i.category?this.series[i.sourceIndex].trendlines[i.index].visible:i.visible,e&&(this.visible++,Pt(i),this.enableCanvas&&this.renderCanvasSeries(i),i.renderSeries(this));if(this.enableCanvas&&this.renderer.canvasRestore(),this.visible=0,!this.seriesElements)return;this.enableCanvas||this.seriesElements.appendChild(_t(this.redraw,{id:this.element.id+"_ChartAreaClipRect_",x:this.chartAxisLayoutPanel.seriesClipRect.x,y:this.chartAxisLayoutPanel.seriesClipRect.y,width:this.chartAxisLayoutPanel.seriesClipRect.width,height:this.chartAxisLayoutPanel.seriesClipRect.height,fill:"transparent","stroke-width":1,stroke:"Gray"},this.renderer));const t=document.getElementById(this.element.id+"_series_svg");t?$t(!1,t,this.seriesElements,this.redraw):$t(this.enableCanvas,this.svgObject,this.seriesElements,this.redraw)}renderCanvasSeries(e){let t,i;if("Bubble"===e.type||"Scatter"===e.type){t=t||this.svgRenderer.createSvg({id:this.element.id+"_series_svg",width:this.availableSize.width,height:this.availableSize.height}),i=i||this.createElement("div",{id:this.element.id+"_series"}),i.setAttribute("style","position: absolute");const e=document.getElementById(this.element.id+"_Secondary_Element");i.appendChild(t),e.appendChild(i)}t=!this.enableCanvas||"Bubble"!==e.type&&"Scatter"!==e.type?this.svgObject:t}initializeIndicator(){for(const e of this.indicators)this[kt(e.type)+"IndicatorModule"]&&this[kt(e.type)+"IndicatorModule"].createIndicatorElements(this,e,e.index);this.indicatorElements&&$t(this.enableCanvas,this.svgObject,this.indicatorElements,this.redraw)}initializeTrendLine(){for(const e of this.visibleSeries)e.trendlines.length&&this.trendLineModule.getTrendLineElements(e,this)}appendElementsAfterSeries(e){"PolarRadar"===this.chartAreaType&&$t(this.enableCanvas,this.svgObject,this.yAxisElements,this.redraw),$t(this.enableCanvas,this.svgObject,e,this.redraw),(this.zoomModule&&this.zoomSettings.enableScrollbar&&this.scrollElement.childElementCount||this.scrollElement&&this.scrollElement.childElementCount)&&$t(!1,Yt(this.element.id+"_Secondary_Element"),this.scrollElement,this.redraw),this.stripLineModule&&this.stripLineModule.renderStripLine(this,"Over",this.axisCollections),this.tooltip.enable||$t(this.enableCanvas,this.svgObject,this.renderer.createGroup({id:this.element.id+"_UserInteraction",style:"pointer-events:none;"}),this.redraw),this.stockChart&&this.stockChart.calculateStockEvents()}applyZoomkit(){"PolarRadar"!==this.chartAreaType&&(this.redraw||!this.zoomModule||this.zoomSettings.enablePan&&!this.zoomModule.performedUI||this.zoomModule.applyZoomToolkit(this,this.axisCollections))}renderAnnotation(){this.annotationModule&&this.annotationModule.renderAnnotations(Yt((this.stockChart?this.stockChart.element.id:this.element.id)+"_Secondary_Element"))}performSelection(){let e=[];this.selectionModule&&(e=(0,a.l7)([],this.selectionModule.selectedDataIndexes,null,!0),this.selectionModule.invokeSelection(this)),this.highlightModule&&this.highlightModule.invokeHighlight(this),e.length>0&&(this.selectionModule.selectedDataIndexes=e,this.selectionModule.redrawSelection(this,this.selectionMode))}processData(e=!0){this.visibleSeriesCount=0;let t=!0;for(const i of this.visibleSeries)i.visible||this.legendSettings.visible?"Indicator"!==i.category&&"TrendLine"!==i.category&&this.initializeDataModule(i):this.visibleSeriesCount++;for(const i of this.indicators)i.dataSource&&(this.initializeDataModule(i),t=!1);e&&(!this.visibleSeries.length||this.visibleSeriesCount===this.visibleSeries.length&&t)&&(this.refreshBound(),this.trigger("loaded",{chart:this.isBlazor?{}:this}))}initializeDataModule(e){let t;e.xData=[],e.yData=[],t=this.isAngular?Object.keys(e.dataSource).length?e.dataSource:this.dataSource:e.dataSource||this.dataSource,e.dataModule=new Xi(t,e.query),e.points=[],e.refreshDataManager(this)}calculateBounds(){const e=this.margin;let t=0,i=0,s=0,o=e.left;const l=this.availableSize.width-o-e.right-this.border.width;if(this.titleCollection=[],this.subTitleCollection=[],this.title&&(this.titleCollection=vi(this.title,this.titleStyle,l),t=S(this.title,this.titleStyle).height*this.titleCollection.length+15,this.subTitle)){let e=0;for(const t of this.titleCollection)s=S(t,this.titleStyle).width,e=s>e?s:e;this.subTitleCollection=vi(this.subTitle,this.subTitleStyle,e),i=S(this.subTitle,this.subTitleStyle).height*this.subTitleCollection.length+15}let a=e.top+i+t+.5*this.chartArea.border.width;const r=this.availableSize.height-a-this.border.width-e.bottom;this.stockChart&&this.stockChart.legendSettings.visible&&this.stockChart.stockLegendModule&&("Top"===this.stockChart.legendSettings.position?a+=this.stockChart.stockLegendModule.legendBounds.height:"Left"===this.stockChart.legendSettings.position&&(o+=this.stockChart.stockLegendModule.legendBounds.width)),this.initialClipRect=new C(o,a,l,r),this.legendModule&&this.legendSettings.visible&&this.legendModule.calculateLegendBounds(this.initialClipRect,this.availableSize,null),this.chartAxisLayoutPanel.measureAxis(this.initialClipRect)}print(e){new ls(this).print(e)}initTrendLines(){this.isProtectedOnChange=!0;for(const e of this.visibleSeries){let t=0;for(const i of e.trendlines){const s=i;this.trendLineModule&&(s.index=t,s.sourceIndex=e.index,this.trendLineModule.initSeriesCollection(s,this),s.targetSeries&&(s.targetSeries.xAxisName=e.xAxisName,s.targetSeries.yAxisName=e.yAxisName,this.visibleSeries.push(s.targetSeries))),t++}}this.isProtectedOnChange=!1}calculateAreaType(){const e=this.series[0];this.chartArea.border.width=this.stockChart?0:this.chartArea.border.width,e&&(this.requireInvertedAxis=-1!==e.type.indexOf("Bar")&&!this.isTransposed||-1===e.type.indexOf("Bar")&&this.isTransposed&&"PolarRadar"!==this.chartAreaType),this.chartAxisLayoutPanel="PolarRadar"===this.chartAreaType?this.polarSeriesModule||this.radarSeriesModule:new zi(this)}calculateVisibleAxis(){let e,t=[this.primaryXAxis,this.primaryYAxis];t="Cartesian"===this.chartAreaType?t.concat(this.axes):t,this.paretoSeriesModule&&"Pareto"===this.series[0].type&&(t=t.concat(this.paretoSeriesModule.paretoAxes)),this.axisCollections=[],this.zoomModule&&(this.zoomModule.isPanning=this.zoomModule.isAxisZoomed(t)&&this.zoomSettings.enablePan,this.svgObject.setAttribute("cursor",this.zoomModule.isPanning?"pointer":"auto"),this.scrollBarModule&&(this.scrollBarModule.axes=t)),this.scrollSettingEnabled&&this.scrollBarModule&&(this.scrollBarModule.axes=t);for(let i=0,s=t.length;i<s;i++){e=t[i],e.series=[],e.labels=[];for(const t of this.visibleSeries)this.initAxis(t,e,!0);for(const t of this.indicators)this.initAxis(t,e,!1);this.scrollBarModule&&!e.zoomingScrollBar&&this.scrollBarModule.injectTo(e,this),null!=e.orientation&&this.axisCollections.push(e)}this.rows.length>0&&this.columns.length>0&&this.chartAxisLayoutPanel.measure()}initAxis(e,t,i){e.xAxisName===t.name||null==e.xAxisName&&"primaryXAxis"===t.name?(t.orientation=this.requireInvertedAxis?"Vertical":"Horizontal",e.xAxis=t,i&&t.series.push(e)):(e.yAxisName===t.name||null==e.yAxisName&&"primaryYAxis"===t.name)&&(t.orientation=this.requireInvertedAxis?"Horizontal":"Vertical",e.yAxis=t,i&&t.series.push(e))}initTechnicalIndicators(){let e=0;for(const t of this.indicators){const i=t,s=kt(i.type);if(this[s+"IndicatorModule"]){i.index=e,this[s+"IndicatorModule"].initSeriesCollection(i,this);for(const e of i.targetSeries)(t.seriesName||t.dataSource)&&this.visibleSeries.push(e)}e++}}refreshTechnicalIndicator(e){if(this.indicators.length){let t=null;if(e instanceof Ui&&"Indicator"!==e.category)for(const i of this.indicators)i.seriesName!==e.name||i.dataSource||(t=i,t.setDataSource(e,this));else e instanceof os&&(t=e,t.setDataSource(e instanceof Ui?e:null,this))}}calculateVisibleSeries(){let e;this.visibleSeries=[];const t=this.palettes.length?this.palettes:Z(this.theme),i=t.length,s=this.series.sort((e,t)=>e.zOrder-t.zOrder);for(let o=0,l=s.length;o<l;o++){switch(e=s[o],e.category="Pareto"===s[0].type?"Pareto":"Series",e.index=o,e.interior=e.fill||t[o%i],e.type){case"Bar":case"StackingBar":case"StackingBar100":if(-1===s[0].type.indexOf("Bar"))continue;break;case"Polar":case"Radar":if("PolarRadar"!==this.chartAreaType)continue;if("PolarRadar"===this.chartAreaType&&(null===e.xAxisName&&null!==e.yAxisName||null!==e.xAxisName&&null===e.yAxisName||null!==e.xAxisName&&null!==e.yAxisName))continue;break;case"Pareto":this.visibleSeries.push(e),this.paretoSeriesModule.initSeries(e,this);continue;default:if("PolarRadar"===this.chartAreaType||s[0].type.indexOf("Bar")>-1)continue}this.visibleSeries.push(e),s[o]=e}}renderTitle(){let e;const t=this.margin;if(this.title){const i=this.titleStyle.textAlignment,s="Near"===i?"start":"Far"===i?"end":"middle",o=S(this.title,this.titleStyle);e=new C(t.left,0,this.availableSize.width-t.left-t.right,0);const l=new L(this.element.id+"_ChartTitle",Si(e,this.titleStyle),this.margin.top+3*o.height/4,s,this.titleCollection,"","auto"),a=gi(this.redraw,this.element.id+"_ChartTitle",l,this.renderer)||bi(this.renderer,l,this.titleStyle,this.titleStyle.color||this.themeStyle.chartTitle,this.svgObject,null,null,null,null,null,null,0,null,this.enableCanvas);a&&(a.setAttribute("aria-label",this.description||this.title),a.setAttribute("tabindex",this.tabIndex.toString())),this.subTitle&&this.renderSubTitle(l)}}renderSubTitle(e){let t=0,i=0;const s=this.titleStyle.textAlignment;for(const n of this.titleCollection)i=S(n,this.titleStyle).width,t=i>t?i:t;const o=S(this.subTitle,this.subTitleStyle),l=new C("Center"===s?e.x-.5*t:"Far"===s?e.x-t:e.x,0,t,0),a=new L(this.element.id+"_ChartSubTitle",Si(l,this.subTitleStyle),e.y*e.text.length+3*o.height/4+10,(e=>"Near"===e?"start":"Far"===e?"end":"middle")(this.subTitleStyle.textAlignment),this.subTitleCollection,"","auto"),r=gi(this.redraw,this.element.id+"_ChartSubTitle",a,this.renderer)||bi(this.renderer,a,this.subTitleStyle,this.subTitleStyle.color||this.themeStyle.chartTitle,this.svgObject,null,null,null,null,null,null,0,null,this.enableCanvas);r&&(r.setAttribute("aria-label",this.description||this.subTitle),r.setAttribute("tabindex",this.tabIndex.toString()))}renderBorder(){if(this.stockChart)return;const e=this.border.width,t=this.backgroundImage,i=new Ti(this.element.id+"_ChartBorder",t?"transparent":this.background||this.themeStyle.background,this.border,1,new C(.5*e,.5*e,this.availableSize.width-e,this.availableSize.height-e));if(this.htmlObject=gi(this.redraw,this.element.id+"_ChartBorder",i,this.renderer)||this.renderer.drawRectangle(i),$t(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw),t){const i=new Li(this.availableSize.height-e,this.availableSize.width-e,t,0,0,this.element.id+"_ChartBackground","visible","none");this.htmlObject=gi(this.redraw,this.element.id+"_ChartBackground",i,this.renderer)||this.renderer.drawImage(i),$t(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw)}}renderAreaBorder(){if("PolarRadar"===this.chartAreaType)return null;{const e=Yt(this.element.id+"_ChartAreaBorder"),t=e?new C(+e.getAttribute("x"),+e.getAttribute("y"),+e.getAttribute("width"),+e.getAttribute("height")):null,i=new Ti(this.element.id+"_ChartAreaBorder",this.chartArea.background,{width:this.chartArea.border.width,color:this.chartArea.border.color||this.themeStyle.areaBorder},this.chartArea.opacity,this.chartAxisLayoutPanel.seriesClipRect);this.htmlObject=this.renderer.drawRectangle(i),$t(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw,!0,"x","y",null,null,!0,!0,t),this.htmlObject=null}const e=this.chartArea.backgroundImage;if(e){const t=this.chartArea.border.width,i=new Li(this.initialClipRect.height-t,this.initialClipRect.width-t,e,this.initialClipRect.x,this.initialClipRect.y,this.element.id+"_ChartAreaBackground","visible","none");this.htmlObject=this.renderer.drawImage(i),$t(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw,!0,"x","y",null,null,!0,!0)}}addSeries(e){for(let t of e)t=new Ui(this,"series",t),this.series.push(t);this.refresh()}removeSeries(e){this.redraw=!1,this.series.splice(e,1),this.refresh()}clearSeries(){this.series=[],this.refresh()}addAxes(e){for(let t of e)t=new ot(this,"axes",t),this.isBlazor&&(t.interval=isNaN(t.interval)?null:t.interval,t.desiredIntervals=isNaN(t.desiredIntervals)?null:t.desiredIntervals),this.axes.push(t);this.refresh()}removeAxis(e){this.redraw=!1,this.axes.splice(e,1),this.refresh()}destroy(){this.scrollBarModule&&this.scrollBarModule.destroy(),this.markerRender&&(this.markerRender.removeEventListener(),this.markerRender=null),this.horizontalAxes=[],this.verticalAxes=[],this.visibleSeries=[],this.axisCollections=[],this.rotatedDataLabelCollections=[],this.seriesElements=null,this.chartAxisLayoutPanel=null,this.dataLabelCollections=null,this.dataLabelElements=null,this.yAxisElements=null,this.element&&(this.unWireEvents(),this.isReact&&this.clearTemplate(),super.destroy(),this.enableCanvas||(this.removeSvg(),this.svgObject=null))}getModuleName(){return"chart"}getPersistData(){return this.addOnPersist(["loaded","animationComplete","primaryXAxis","primaryYAxis"])}createChartSvg(){this.removeSvg(),yi(this)}unWireEvents(){const e=a.AR.touchMoveEvent,t=a.AR.touchEndEvent,i=a.AR.isPointer?"pointerleave":"mouseleave";a.bi.remove(this.element,a.AR.touchStartEvent,this.chartOnMouseDown),a.bi.remove(this.element,e,this.mouseMove),a.bi.remove(this.element,t,this.mouseEnd),a.bi.remove(this.element,"click",this.chartOnMouseClick),a.bi.remove(this.element,"contextmenu",this.chartRightClick),a.bi.remove(this.element,i,this.mouseLeave),window.removeEventListener(a.AR.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeBound),this.touchObject&&(this.touchObject.destroy(),this.touchObject=null)}wireEvents(){if(!this.element)return;const e=a.AR.isPointer?"pointerleave":"mouseleave";a.bi.add(this.element,a.AR.touchStartEvent,this.chartOnMouseDown,this),a.bi.add(this.element,a.AR.touchMoveEvent,this.mouseMove,this),a.bi.add(this.element,a.AR.touchEndEvent,this.mouseEnd,this),a.bi.add(this.element,"click",this.chartOnMouseClick,this),a.bi.add(this.element,"contextmenu",this.chartRightClick,this),a.bi.add(this.element,e,this.mouseLeave,this),this.resizeBound=this.chartResize.bind(this),window.addEventListener(a.AR.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeBound),this.longPressBound=this.longPress.bind(this),this.touchObject=new a.Xh(this.element,{tapHold:this.longPressBound,tapHoldThreshold:500}),this.setStyle(this.element)}chartRightClick(e){return!this.crosshair.enable||!this.crosshairModule||2!==e.buttons&&0!==e.which&&"touch"!==e.pointerType||(e.preventDefault(),e.stopPropagation(),!1)}setStyle(e){const t=this.zoomSettings,i=t.enableSelectionZooming||t.enablePinchZooming||"None"!==this.selectionMode||this.crosshair.enable||"None"!==this.highlightMode;e.style.touchAction=i?"none":"element",e.style.msTouchAction=i?"none":"element",e.style.msContentZooming="none",e.style.msUserSelect="none",e.style.webkitUserSelect="none",e.style.position="relative",e.style.display="block",e.style.overflow="hidden"}isOrientation(){return"orientation"in window&&"onorientationchange"in window}longPress(e){return this.mouseX=e&&e.originalEvent.changedTouches?e.originalEvent.changedTouches[0].clientX:0,this.mouseY=e&&e.originalEvent.changedTouches?e.originalEvent.changedTouches[0].clientY:0,this.startMove=!0,this.setMouseXY(this.mouseX,this.mouseY),this.notify("tapHold",e),!1}setMouseXY(e,t){if(Yt(this.svgId)){const i=Yt(this.svgId).getBoundingClientRect(),s=this.element.getBoundingClientRect();this.mouseY=t-s.top-Math.max(i.top-s.top,0),this.mouseX=e-s.left-Math.max(i.left-s.left,0)}}export(e,t){this.exportModule&&(this.exportModule.export(e,t),this.afterExport&&this.exportModule.getDataUrl(this))}chartResize(){this.animateSeries=!1;const e={chart:this.isBlazor?{}:this,name:De,currentSize:new w(0,0),previousSize:new w(this.availableSize.width,this.availableSize.height)},t={name:"beforeResize",cancelResizedEvent:!1};return this.resizeTo&&clearTimeout(this.resizeTo),this.trigger(Re,t),t.cancelResizedEvent||(this.resizeTo=+setTimeout(()=>{this.isDestroyed||this.stockChart?clearTimeout(this.resizeTo):(this.createChartSvg(),e.currentSize=this.availableSize,this.trigger(De,e),this.refreshAxis(),this.refreshBound(),this.trigger("loaded",{chart:this.isBlazor?{}:this}))},500)),!1}mouseMove(e){let t,i,s;return"touchmove"===e.type?(this.isTouch=!0,s=e,t=s.changedTouches[0].clientX,i=s.changedTouches[0].clientY):(this.isTouch="touch"===e.pointerType||"2"===e.pointerType||this.isTouch,t=e.clientX,i=e.clientY),Yt(this.svgId)&&(this.setMouseXY(t,i),this.chartOnMouseMove(e)),!1}mouseLeave(e){let t,i,s;return"touchleave"===e.type?(this.isTouch=!0,s=e,t=s.changedTouches[0].clientX,i=s.changedTouches[0].clientY):(this.isTouch="touch"===e.pointerType||"2"===e.pointerType,t=e.clientX,i=e.clientY),this.setMouseXY(t,i),this.chartOnMouseLeave(e),!1}chartOnMouseLeave(e){const t=a.AR.isPointer?"pointerleave":"mouseleave";return this.trigger(we,{target:e.target.id,x:this.mouseX,y:this.mouseY}),nt(this.element.id+"_EJ2_AxisLabel_Tooltip"),this.isChartDrag=this.isPointMouseDown=!1,this.notify(t,e),!1}chartOnMouseClick(e){this.trigger(ve,{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.clickCount++;let t=0;return t=this.isAngular?this.pointDoubleClick.observers.length>0?400:0:this.pointDoubleClick?400:0,1===this.clickCount&&this.pointClick?this.singleClickTimer=+setTimeout(()=>{this.clickCount=0,this.triggerPointEvent(Se,e)},t):2===this.clickCount&&this.pointDoubleClick&&(clearTimeout(this.singleClickTimer),this.clickCount=0,this.triggerPointEvent("pointDoubleClick",e)),this.axisLabelClick&&this.triggerAxisLabelClickEvent("axisLabelClick",e),this.notify("click",e),!1}triggerPointEvent(e,t){const i=t,s=new _i(this).getData();s.series&&s.point&&this.trigger(e,{series:this.isBlazor?{}:s.series,point:s.point,seriesIndex:s.series.index,pointIndex:s.point.index,x:this.mouseX,y:this.mouseY,pageX:i.pageX,pageY:i.pageY})}triggerAxisLabelClickEvent(e,t){const i=t.target,s=t;if(-1!==i.id.indexOf("_AxisLabel_")){const t=i.id.split("_AxisLabel_"),o=+t[0].slice(-1),l=+t[1],a=this.axisCollections[o];!a.visible||0!==o&&1!==o||this.trigger(e,{chart:this,axis:a,text:a.visibleLabels[l].text,labelID:i.id,index:l,location:new Ri(s.pageX,s.pageY),value:a.visibleLabels[l].value})}}chartOnMouseMove(e){return this.trigger(ye,{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.pointMove&&this.triggerPointEvent(xe,e),this.isTouch||(this.titleTooltip(e,this.mouseX,this.mouseY),this.axisTooltip(e,this.mouseX,this.mouseY)),this.dataEditingModule&&this.dataEditingModule.pointMouseMove(e),this.notify(a.AR.touchMoveEvent,e),this.isTouch=!1,!1}titleTooltip(e,t,i,s){const o=e.target.id,l=o===this.element.id+"_ChartTitle"||o===this.element.id+"_ChartSubTitle"||o.indexOf("_AxisTitle")>-1||o.indexOf("_legend_title")>-1;let a=0;o.indexOf("_AxisTitle")>-1&&(a=parseInt(o.replace(this.element.id,"").replace("AxisLabel_","").split("_")[2],10)),l&&e.target.textContent.indexOf("...")>-1?dt(o===this.element.id+"_ChartTitle"?this.title:o.indexOf("_AxisTitle")>-1?this.axisCollections[a].title:o.indexOf("_ChartSubTitle")>-1?this.subTitle:this.legendSettings.title,t,i,this.element.offsetWidth,this.element.id+"_EJ2_Title_Tooltip",Yt(this.element.id+"_Secondary_Element"),s):nt(this.element.id+"_EJ2_Title_Tooltip")}axisTooltip(e,t,i,s){const o=e.target.id;if((o.indexOf("AxisLabel")>-1||o.indexOf("Axis_MultiLevelLabel")>-1)&&e.target.textContent.indexOf("...")>-1){const e=this.legendSettings.visible||""===this.primaryXAxis.title;dt(this.findAxisLabel(o),t,i,this.element.offsetWidth,this.element.id+"_EJ2_AxisLabel_Tooltip",Yt(this.element.id+"_Secondary_Element"),s,e)}else nt(this.element.id+"_EJ2_AxisLabel_Tooltip")}findAxisLabel(e){let t;return e.indexOf("AxisLabel")>-1?(t=e.replace(this.element.id,"").replace("AxisLabel_","").split("_"),this.axisCollections[parseInt(t[0],10)].visibleLabels[parseInt(t[1],10)].originalText):(t=e.replace(this.element.id,"").replace("Axis_MultiLevelLabel_Level_","").replace("Text_","").split("_"),this.axisCollections[parseInt(t[0],10)].multiLevelLabels[parseInt(t[1],10)].categories[parseInt(t[2],10)].text)}chartOnMouseDown(e){let t,i,s,o;const l=a.AR.isDevice?20:30,r=this.element.getBoundingClientRect();this.trigger(Ce,{target:e.target.id,x:this.mouseX,y:this.mouseY}),"touchstart"===e.type?(this.isTouch=!0,o=e,t=o.changedTouches[0].clientX,i=o.changedTouches[0].clientY,s=o.target):(this.isTouch="touch"===e.pointerType,t=e.clientX,i=e.clientY,s=e.target);const n=Yt(this.svgId).getBoundingClientRect();return this.mouseDownX=this.previousMouseMoveX=t-r.left-Math.max(n.left-r.left,0),this.mouseDownY=this.previousMouseMoveY=i-r.top-Math.max(n.top-r.top,0),this.isTouch&&(this.isDoubleTap=(new Date).getTime()<this.threshold&&-1===s.id.indexOf(this.element.id+"_Zooming_")&&(this.mouseDownX-l>=this.mouseX||this.mouseDownX+l>=this.mouseX)&&(this.mouseDownY-l>=this.mouseY||this.mouseDownY+l>=this.mouseY)&&(this.mouseX-l>=this.mouseDownX||this.mouseX+l>=this.mouseDownX)&&(this.mouseY-l>=this.mouseDownY||this.mouseY+l>=this.mouseDownY)),this.dataEditingModule&&this.dataEditingModule.pointMouseDown(),this.notify(a.AR.touchStartEvent,e),!1}mouseEnd(e){let t,i,s;return"touchend"===e.type?(s=e,i=s.changedTouches[0].clientX,this.isTouch=!0,t=s.changedTouches[0].clientY):(t=e.clientY,i=e.clientX,this.isTouch="touch"===e.pointerType||"2"===e.pointerType),this.setMouseXY(i,t),this.chartOnMouseUp(e),!1}chartOnMouseUp(e){return this.trigger(Me,{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.isChartDrag=!1,this.isTouch&&(this.titleTooltip(e,this.mouseX,this.mouseY,this.isTouch),this.axisTooltip(e,this.mouseX,this.mouseY,this.isTouch),this.threshold=(new Date).getTime()+300),this.dataEditingModule&&this.dataEditingModule.pointMouseUp(),!this.enableCanvas&&this.seriesElements&&this.seriesElements.removeAttribute("clip-path"),this.notify(a.AR.touchEndEvent,e),!1}setCulture(){this.intl=new a.eC,this.setLocaleConstants(),this.localeObject=new a.E7(this.getModuleName(),this.defaultLocalConstants,this.locale)}setAnnotationValue(e,t){const i=Yt(this.element.id+"_Annotation_Collections"),s=this.annotations[e];let o;null!==t&&(s.content=t,i?(nt(this.element.id+"_Annotation_"+e),o=this.createElement("div"),this.annotationModule.processAnnotation(s,e,o),i.appendChild(o.children[0])):this.annotationModule.renderAnnotations(Yt(this.element.id+"_Secondary_Element")))}setLocaleConstants(){this.defaultLocalConstants={ZoomIn:"Zoom in",Zoom:"Zoom",ZoomOut:"Zoom out",Pan:"Pan",Reset:"Reset",ResetZoom:"Reset Zoom"}}setTheme(){this.themeStyle=V(this.theme)}requiredModules(){let e,t=[],i=this.series,s=!1,o=!1,l=!1,a=!1,r=this.zoomSettings;return this.chartAreaType=i.length>0&&("Polar"===i[0].type||"Radar"===i[0].type)?"PolarRadar":"Cartesian",this.tooltip.enable&&t.push({member:"Tooltip",args:[this]}),i.map(s=>{this.isLegend=this.legendSettings.visible&&(""!==s.name||!!this.isLegend),e=-1!==s.type.indexOf("100")?s.type.replace("100","")+"Series":s.type+"Series",o=s.errorBar.visible||o,a=s.marker.dataLabel.visible||a,l=s.dragSettings.enable||l,t.some(t=>t.member===e)||t.push({member:e,args:[this,i]}),"PolarRadar"===this.chartAreaType&&t.push({member:s.drawType+"Series",args:[this,i]}),"Pareto"===s.type&&(t.push({member:"ColumnSeries",args:[this,i]}),t.push({member:"LineSeries",args:[this,i]}))}),this.findIndicatorModules(t),this.findTrendLineModules(t),t=this.findAxisModule(t),s=this.annotations.some(e=>null!==e.content),o&&t.push({member:"ErrorBar",args:[this,i]}),this.isLegend&&t.push({member:"Legend",args:[this]}),(this.enableExport||this.allowExport)&&t.push({member:"Export",args:[this]}),"PolarRadar"!==this.chartAreaType&&!this.scrollSettingEnabled&&(r.enableSelectionZooming||r.enableMouseWheelZooming||r.enablePinchZooming||r.enablePan||r.enableScrollbar)&&(t.push({member:"Zoom",args:[this,this.zoomSettings]}),r.enableScrollbar&&t.push({member:"ScrollBar",args:[this]})),"None"===this.selectionMode||"PolarRadar"===this.chartAreaType&&this.selectionMode.indexOf("Drag")>-1||t.push({member:"Selection",args:[this]}),"None"!==this.highlightMode&&t.push({member:"Highlight",args:[this]}),a&&t.push({member:"DataLabel",args:[this,i]}),l&&t.push({member:"DataEditing",args:[this]}),s&&t.push({member:"Annotation",args:[this]}),"PolarRadar"!==this.chartAreaType&&this.crosshair.enable&&t.push({member:"Crosshair",args:[this]}),t}findAxisModule(e){let t=[];t.push(this.primaryXAxis),t.push(this.primaryYAxis),t=t.concat(this.axes);let i=!1,s=!1,o=!1,l=!1,a=!1,r=!1;for(let n of t)i="DateTime"===n.valueType||i,s="Category"===n.valueType||s,o="Logarithmic"===n.valueType||o,a="DateTimeCategory"===n.valueType||a,l=this.findStriplineVisibility(n.stripLines)||l,r=n.multiLevelLabels.length>0||r,this.scrollSettingEnabled=!!n.scrollbarSettings.enable||this.scrollSettingEnabled;return i&&e.push({member:"DateTime",args:[this]}),s&&e.push({member:"Category",args:[this]}),o&&e.push({member:"Logarithmic",args:[this]}),l&&e.push({member:"StripLine",args:[this]}),r&&e.push({member:"MultiLevelLabel",args:[this]}),a&&e.push({member:"DateTimeCategory",args:[this]}),this.scrollSettingEnabled&&e.push({member:"ScrollBar",args:[this]}),e}findIndicatorModules(e){let t,i,s=this.indicators;if(this.indicators.length){e.push({member:"LineSeries",args:[this]}),s.map(e=>{t=t||"Macd"===e.type,i=i||"BollingerBands"===e.type}),t&&e.push({member:"ColumnSeries",args:[this]}),i&&e.push({member:"RangeAreaSeries",args:[this]}),i&&e.push({member:"SplineRangeAreaSeries",args:[this]});for(let t of this.indicators)e.push({member:t.type+"Indicator",args:[this]})}}findTrendLineModules(e){let t,i;for(let s of this.series){let o;s.trendlines.map(e=>{o=o||e.marker.visible,t=!(!t&&"Linear"!==e.type&&"MovingAverage"!==e.type),i=!(!i&&t)}),o&&e.push({member:"Marker",args:[this,s]})}(t||i)&&e.push({member:"TrendLine",args:[this]}),t&&e.push({member:"LineSeries",args:[this]}),i&&e.push({member:"SplineSeries",args:[this]})}findStriplineVisibility(e){let t=!1;for(let i of e)if(i.visible){t=!0;break}return t}removeSvg(){if(this.redraw)return null;if(Ci(this),this.enableCanvas&&this.svgObject&&"CANVAS"===this.svgObject.tagName)return this.renderer.clearRect(new C(0,0,this.availableSize.width,this.availableSize.height)),this.svgObject.parentNode&&(0,a.Od)(this.svgObject),null;nt(this.element.id+"_Secondary_Element"),this.isReact&&this.clearTemplate();let e=0;if(this.zoomModule&&this.zoomModule.pinchTarget&&(this.zoomModule.pinchTarget.id="",this.zoomModule.pinchTarget.setAttribute("opacity","0"),this.svgObject.appendChild(this.zoomModule.pinchTarget),e=1),!(0,a.le)(this.resizeTo)){if(this.resizeTo!==this.checkResize&&this.isBlazor&&this.element.childElementCount){let e=document.querySelectorAll(".e-chart");for(let t=0;t<e.length;t++){let i=e[t];for(;i.firstChild;)(0,a.Od)(i.firstChild)}}this.checkResize=this.resizeTo}if(this.svgObject){for(;this.svgObject.childNodes.length>e;)this.svgObject.removeChild(this.svgObject.firstChild);this.svgObject.hasChildNodes()||!this.svgObject.parentNode||this.stockChart||(0,a.Od)(this.svgObject)}}refreshDefinition(e){for(let t of e)t.axes=[]}refreshAxis(){let e=this.primaryXAxis;e.rect=new C(void 0,void 0,0,0),e=this.primaryYAxis,e.isStack100=!1,e.rect=new C(void 0,void 0,0,0);for(let t of this.axes)e=t,e.rect=new C(void 0,void 0,0,0),e.isStack100=!1;if(this.paretoSeriesModule&&"Pareto"===this.series[0].type)for(let t of this.paretoSeriesModule.paretoAxes)e=t,e.rect=new C(void 0,void 0,0,0),e.isStack100=!1}axisChange(e){return!(!e.name&&!e.valueType||(this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(),0))}getVisibleSeries(e,t){for(let i of e)if(t===i.index)return i;return null}refreshLiveData(){this.calculateVisibleSeries(),this.initTechnicalIndicators(),this.initTrendLines(),this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(!1),this.isBlazor||(this.enableCanvas?this.createChartSvg():this.removeSvg(),this.refreshAxis(),this.refreshBound(),this.trigger("loaded",{chart:this.isBlazor?{}:this}))}removeStyles(){nt(this.element.id+"_ej2_chart_selection"),nt(this.element.id+"_ej2_chart_highlight")}onPropertyChanged(e,t){let i=!1,s=!1;if(this.animateSeries=!1,!this.delayRedraw){for(let o of Object.keys(e))switch(o){case"primaryXAxis":s=this.axisChange(e.primaryXAxis),e.primaryXAxis.edgeLabelPlacement&&(i=!0),e.primaryXAxis.crosshairTooltip||(s=!0);break;case"primaryYAxis":s=this.axisChange(e.primaryYAxis),e.primaryYAxis.edgeLabelPlacement&&(i=!0),e.primaryYAxis.crosshairTooltip||(s=!0);break;case"axes":for(let t of Object.keys(e.axes))s=s||this.axisChange(e.axes[t]),e.axes[t].crosshairTooltip||(s=!0);break;case"height":case"width":this.createChartSvg(),s=!0;break;case"subTitle":case"title":s=!0;break;case"titleStyle":e.titleStyle&&(e.titleStyle.size||e.titleStyle.textOverflow)?s=!0:i=!0;break;case"subTitleStyle":e.subTitleStyle&&(e.subTitleStyle.size||e.subTitleStyle.textOverflow)?s=!0:i=!0;break;case"border":i=!0;break;case"dataSource":this.processData(!1),s=!0;break;case"enableCanvas":this.refresh();break;case"series":let o,l,r=this.series.length,n=!1;for(let i=0;i<r;i++)o=e.series[i],this.isBlazor&&o&&(o.visible!==t.series[i].visible||o.isClosed||o.marker||o.emptyPointSettings||o.type||o.boxPlotMode||o.showMean)&&(l=!0),o&&(o.dataSource||o.query||o.errorBar||o.xName||o.yName||o.size||o.high||o.low||o.open||o.close||o.fill||o.name||o.marker||l)&&((0,a.l7)(this.getVisibleSeries(this.visibleSeries,i),o,null,!0),n=!0);n&&(this.calculateVisibleSeries(),this.initTechnicalIndicators(),this.initTrendLines(),this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(!1),s=!0);break;case"indicators":s=!0;break;case"zoomSettings":(e.zoomSettings.enableScrollbar||t.zoomSettings.enableScrollbar)&&(s=!0),i=!0;break;case"background":i=!0;break;case"chartArea":e.chartArea.border&&e.chartArea.border.width&&(s=!0),i=!0;break;case"legendSettings":e.legendSettings.background&&e.legendSettings.opacity||(s=!0),i=!0;break;case"palettes":this.calculateVisibleSeries(),i=!0;break;case"selectedDataIndexes":this.selectionModule&&(this.selectionModule.currentMode=this.selectionMode,this.selectionModule.selectedDataIndexes=this.selectedDataIndexes,this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,t.selectionMode,!0));break;case"selectionMode":this.selectionModule&&e.selectionMode&&-1===e.selectionMode.indexOf("Drag")&&(this.selectionModule.currentMode=this.selectionMode,this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,t.selectionMode,!0));break;case"isMultiSelect":this.selectionModule&&!e.isMultiSelect&&this.selectionModule.selectedDataIndexes.length>1&&(this.selectionModule.currentMode=this.selectionMode,this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,t.selectionMode));break;case"highlightMode":case"selectionPattern":case"highlightPattern":this.removeStyles(),i=!0;break;case"theme":this.animateSeries=!0;break;case"locale":case"currencyCode":this.isBlazor?(this.setCulture(),i=!0):this.refresh();break;case"tooltip":this.tooltipModule&&(this.tooltipModule.previousPoints=[])}!s&&i&&(this.removeSvg(),this.renderElements(),this.trigger("loaded",{chart:this.isBlazor?{}:this})),s&&(this.enableCanvas?this.createChartSvg():this.removeSvg(),this.isReact&&this.clearTemplate(),this.refreshAxis(),this.refreshBound(),this.trigger("loaded",{chart:this.isBlazor?{}:this}),this.redraw=!1,this.animated=!1)}}};return as([(0,a.Z9)(null)],e.prototype,"width",void 0),as([(0,a.Z9)(null)],e.prototype,"height",void 0),as([(0,a.Z9)("")],e.prototype,"title",void 0),as([(0,a.Z9)("")],e.prototype,"dataSource",void 0),as([(0,a.Zz)(B.chartTitleFont,q)],e.prototype,"titleStyle",void 0),as([(0,a.Z9)("")],e.prototype,"subTitle",void 0),as([(0,a.Zz)(B.chartSubTitleFont,q)],e.prototype,"subTitleStyle",void 0),as([(0,a.Zz)({},U)],e.prototype,"margin",void 0),as([(0,a.Zz)({color:"#DDDDDD",width:0},G)],e.prototype,"border",void 0),as([(0,a.Z9)(null)],e.prototype,"background",void 0),as([(0,a.Zz)({border:{color:null,width:.5},background:"transparent"},W)],e.prototype,"chartArea",void 0),as([(0,a.Zz)({name:"primaryXAxis"},ot)],e.prototype,"primaryXAxis",void 0),as([(0,a.Zz)({name:"primaryYAxis"},ot)],e.prototype,"primaryYAxis",void 0),as([(0,a.FE)([{}],Qe)],e.prototype,"rows",void 0),as([(0,a.FE)([{}],Je)],e.prototype,"columns",void 0),as([(0,a.FE)([{}],ot)],e.prototype,"axes",void 0),as([(0,a.FE)([{}],Ui)],e.prototype,"series",void 0),as([(0,a.FE)([{}],je)],e.prototype,"annotations",void 0),as([(0,a.Z9)([])],e.prototype,"palettes",void 0),as([(0,a.Z9)("Material")],e.prototype,"theme",void 0),as([(0,a.Zz)({},ie)],e.prototype,"tooltip",void 0),as([(0,a.Zz)({},ns)],e.prototype,"crosshair",void 0),as([(0,a.Zz)({},es)],e.prototype,"legendSettings",void 0),as([(0,a.FE)([{}],rs)],e.prototype,"rangeColorSettings",void 0),as([(0,a.Zz)({},hs)],e.prototype,"zoomSettings",void 0),as([(0,a.Z9)("None")],e.prototype,"selectionMode",void 0),as([(0,a.Z9)("None")],e.prototype,"highlightMode",void 0),as([(0,a.Z9)("None")],e.prototype,"selectionPattern",void 0),as([(0,a.Z9)("None")],e.prototype,"highlightPattern",void 0),as([(0,a.Z9)(!1)],e.prototype,"isMultiSelect",void 0),as([(0,a.Z9)(!1)],e.prototype,"allowMultiSelection",void 0),as([(0,a.Z9)(!0)],e.prototype,"enableExport",void 0),as([(0,a.Z9)(!1)],e.prototype,"allowExport",void 0),as([(0,a.FE)([],J)],e.prototype,"selectedDataIndexes",void 0),as([(0,a.Z9)(!1)],e.prototype,"useGroupingSeparator",void 0),as([(0,a.Z9)(!1)],e.prototype,"enableAutoIntervalOnBothAxis",void 0),as([(0,a.Z9)(!1)],e.prototype,"isTransposed",void 0),as([(0,a.Z9)(!1)],e.prototype,"enableCanvas",void 0),as([(0,a.Z9)(null)],e.prototype,"backgroundImage",void 0),as([(0,a.FE)([],os)],e.prototype,"indicators",void 0),as([(0,a.Z9)(!0)],e.prototype,"enableAnimation",void 0),as([(0,a.Z9)(null)],e.prototype,"description",void 0),as([(0,a.Z9)(1)],e.prototype,"tabIndex",void 0),as([(0,a.Z9)(!0)],e.prototype,"enableSideBySidePlacement",void 0),as([(0,a.ju)()],e.prototype,"resized",void 0),as([(0,a.ju)()],e.prototype,"beforeResize",void 0),as([(0,a.ju)()],e.prototype,"annotationRender",void 0),as([(0,a.ju)()],e.prototype,"beforePrint",void 0),as([(0,a.ju)()],e.prototype,"loaded",void 0),as([(0,a.ju)()],e.prototype,"beforeExport",void 0),as([(0,a.ju)()],e.prototype,"afterExport",void 0),as([(0,a.ju)()],e.prototype,"load",void 0),as([(0,a.ju)()],e.prototype,"animationComplete",void 0),as([(0,a.ju)()],e.prototype,"legendRender",void 0),as([(0,a.ju)()],e.prototype,"textRender",void 0),as([(0,a.ju)()],e.prototype,"pointRender",void 0),as([(0,a.ju)()],e.prototype,"seriesRender",void 0),as([(0,a.ju)()],e.prototype,"axisLabelRender",void 0),as([(0,a.ju)()],e.prototype,"axisLabelClick",void 0),as([(0,a.ju)()],e.prototype,"axisRangeCalculated",void 0),as([(0,a.ju)()],e.prototype,"axisMultiLabelRender",void 0),as([(0,a.ju)()],e.prototype,"legendClick",void 0),as([(0,a.ju)()],e.prototype,"multiLevelLabelClick",void 0),as([(0,a.ju)()],e.prototype,"tooltipRender",void 0),as([(0,a.ju)()],e.prototype,"sharedTooltipRender",void 0),as([(0,a.ju)()],e.prototype,"chartMouseMove",void 0),as([(0,a.ju)()],e.prototype,"chartMouseClick",void 0),as([(0,a.ju)()],e.prototype,"pointClick",void 0),as([(0,a.ju)()],e.prototype,"pointDoubleClick",void 0),as([(0,a.ju)()],e.prototype,"pointMove",void 0),as([(0,a.ju)()],e.prototype,"chartMouseLeave",void 0),as([(0,a.ju)()],e.prototype,"chartMouseDown",void 0),as([(0,a.ju)()],e.prototype,"chartMouseUp",void 0),as([(0,a.ju)()],e.prototype,"dragComplete",void 0),as([(0,a.ju)()],e.prototype,"selectionComplete",void 0),as([(0,a.ju)()],e.prototype,"zoomComplete",void 0),as([(0,a.ju)()],e.prototype,"onZooming",void 0),as([(0,a.ju)()],e.prototype,"scrollStart",void 0),as([(0,a.ju)()],e.prototype,"scrollEnd",void 0),as([(0,a.ju)()],e.prototype,"scrollChanged",void 0),as([(0,a.ju)()],e.prototype,"dragStart",void 0),as([(0,a.ju)()],e.prototype,"drag",void 0),as([(0,a.ju)()],e.prototype,"dragEnd",void 0),as([(0,a.Z9)("USD")],e.prototype,"currencyCode",void 0),e=as([a.Zl],e),e})();class cs extends ae{calculateDateTimeNiceInterval(e,t,i,s,o=!0){const l=new Date(i),a=new Date(s),r=Math.abs((l.getTime()-a.getTime())/864e5);let n;switch(e.actualIntervalType=e.intervalType,e.intervalType){case"Years":n=this.calculateNumericNiceInterval(e,r/365,t);break;case"Quarter":n=this.calculateNumericNiceInterval(e,r/365*4,t);break;case"Months":n=this.calculateNumericNiceInterval(e,r/30,t);break;case"Weeks":n=this.calculateNumericNiceInterval(e,r/7,t);break;case"Days":n=this.calculateNumericNiceInterval(e,r,t);break;case"Hours":n=this.calculateNumericNiceInterval(e,24*r,t);break;case"Minutes":n=this.calculateNumericNiceInterval(e,24*r*60,t);break;case"Seconds":n=this.calculateNumericNiceInterval(e,24*r*60*60,t);break;case"Auto":return n=this.calculateNumericNiceInterval(e,r/365,t),n>=1?(e.actualIntervalType="Years",n):(n=this.calculateNumericNiceInterval(e,r/365*4,t),n>=1&&!o?(e.actualIntervalType="Quarter",n):(n=this.calculateNumericNiceInterval(e,r/30,t),n>=1?(e.actualIntervalType="Months",n):(n=this.calculateNumericNiceInterval(e,r/7,t),n>=1&&!o?(e.actualIntervalType="Weeks",n):(n=this.calculateNumericNiceInterval(e,r,t),n>=1?(e.actualIntervalType="Days",n):(n=this.calculateNumericNiceInterval(e,24*r,t),n>=1?(e.actualIntervalType="Hours",n):(n=this.calculateNumericNiceInterval(e,24*r*60,t),n>=1?(e.actualIntervalType="Minutes",n):(n=this.calculateNumericNiceInterval(e,24*r*60*60,t),e.actualIntervalType="Seconds",n)))))))}return n}getSkeleton(e,t,i,s){let o;const l=e.actualIntervalType;return e.skeleton?e.skeleton:(o="Years"===l?s?"y":e.isChart?"DateTime"===e.valueType&&e.isIntervalInDecimal?"y":"yMMM":"y":"Quarter"===l?s?"y":"yMMM":"Months"===l?s?"m":e.isChart?"MMMd":"MMM":"Weeks"===l?s?"m":"MEd":"Days"===l?s?"d":e.isChart?this.getDayFormat(e,t,i):"MMMd":"Hours"===l?s?"t":e.isChart?"DateTime"===e.valueType?"Hm":"EHm":"h":"Minutes"===l?s?"T":e.isChart?"Hms":"hm":s?"T":e.isChart?"Hms":"hms",o)}getMonthFormat(e,t,i){return new Date(t).getFullYear()===new Date(i).getFullYear()?e.isIntervalInDecimal?"MMM":"MMM d":"y MMM"}getDayFormat(e,t,i){return"DateTime"===e.valueType?new Date(t).getMonth()!==new Date(i).getMonth()?"MMMd":e.isIntervalInDecimal?"d":"Ehm":"yMd"}findCustomFormats(e,t,i){let s=e.labelFormat?e.labelFormat:"";return!e.isChart||e.skeleton||"Months"!==e.actualIntervalType||s||(s="DateTime"===e.valueType?this.getMonthFormat(e,t,i):"yMMM"),s}}class ps extends cs{constructor(e){super(e)}calculateRangeAndInterval(e,t){this.calculateRange(t),this.getActualRange(t,e),this.applyRangePadding(t,e),this.calculateVisibleLabels(t,this.chart)}getActualRange(e,t){const i={skeleton:"full",type:"dateTime"},s=this.chart.intl.getDateParser(i),o=this.chart.intl.getDateFormat(i);null!==e.minimum?this.min=this.chart.isBlazor?Date.parse(e.minimum.toString()):Date.parse(s(o(new Date(r.j4.parse.parseJson({val:e.minimum}).val)))):null!==this.min&&this.min!==Number.POSITIVE_INFINITY||(this.min=Date.parse(s(o(new Date(1970,1,1))))),null!==e.maximum?this.max=this.chart.isBlazor?Date.parse(e.maximum.toString()):Date.parse(s(o(new Date(r.j4.parse.parseJson({val:e.maximum}).val)))):null!==this.max&&this.max!==Number.NEGATIVE_INFINITY||(this.max=Date.parse(s(o(new Date(1970,5,1))))),this.min===this.max&&(this.max=this.max+2592e6,this.min=this.min-2592e6),e.actualRange={},e.doubleRange=new le(this.min,this.max);const l=this.calculateDateTimeNiceInterval(e,t,e.doubleRange.start,e.doubleRange.end);e.actualRange.interval=e.interval?e.interval:l,e.actualRange.min=e.doubleRange.start,e.actualRange.max=e.doubleRange.end}applyRangePadding(e,t){let i,s;this.min=e.actualRange.min,this.max=e.actualRange.max;const o=e.actualRange.interval;if(!Zt(e)){const t=e.getRangePadding(this.chart);i=new Date(this.min),s=new Date(this.max);const l=e.actualIntervalType;if("None"===t)this.min=i.getTime(),this.max=s.getTime();else if("Additional"===t||"Round"===t)switch(l){case"Years":this.getYear(i,s,t,o);break;case"Months":this.getMonth(i,s,t,o);break;case"Days":this.getDay(i,s,t,o);break;case"Hours":this.getHour(i,s,t,o);break;case"Minutes":const e=i.getMinutes()/o*o,l=s.getMinutes()+(i.getMinutes()-e);"Round"===t?(this.min=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),e,0).getTime(),this.max=new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),l,59).getTime()):(this.min=new Date(i.getFullYear(),s.getMonth(),i.getDate(),i.getHours(),e+-o,0).getTime(),this.max=new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),l+o,0).getTime());break;case"Seconds":const a=i.getSeconds()/o*o,r=s.getSeconds()+(i.getSeconds()-a);"Round"===t?(this.min=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),a,0).getTime(),this.max=new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),r,0).getTime()):(this.min=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),a+-o,0).getTime(),this.max=new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),r+o,0).getTime())}}e.actualRange.min=this.min,e.actualRange.max=this.max,e.actualRange.delta=e.actualRange.max-e.actualRange.min,e.doubleRange=new le(e.actualRange.min,e.actualRange.max),this.calculateVisibleRange(t,e)}getYear(e,t,i,s){const o=e.getFullYear(),l=t.getFullYear();"Additional"===i?(this.min=new Date(o-s,1,1,0,0,0).getTime(),this.max=new Date(l+s,1,1,0,0,0).getTime()):(this.min=new Date(o,0,0,0,0,0).getTime(),this.max=new Date(l,11,30,23,59,59).getTime())}getMonth(e,t,i,s){const o=e.getMonth(),l=t.getMonth();"Round"===i?(this.min=new Date(e.getFullYear(),o,0,0,0,0).getTime(),this.max=new Date(t.getFullYear(),l,new Date(t.getFullYear(),t.getMonth(),0).getDate(),23,59,59).getTime()):(this.min=new Date(e.getFullYear(),o+-s,1,0,0,0).getTime(),this.max=new Date(t.getFullYear(),l+s,2===l?28:30,0,0,0).getTime())}getDay(e,t,i,s){const o=e.getDate(),l=t.getDate();"Round"===i?(this.min=new Date(e.getFullYear(),e.getMonth(),o,0,0,0).getTime(),this.max=new Date(t.getFullYear(),t.getMonth(),l,23,59,59).getTime()):(this.min=new Date(e.getFullYear(),e.getMonth(),o+-s,0,0,0).getTime(),this.max=new Date(t.getFullYear(),t.getMonth(),l+s,0,0,0).getTime())}getHour(e,t,i,s){const o=e.getHours()/s*s,l=t.getHours()+(e.getHours()-o);"Round"===i?(this.min=new Date(e.getFullYear(),e.getMonth(),e.getDate(),o,0,0).getTime(),this.max=new Date(t.getFullYear(),t.getMonth(),t.getDate(),l,59,59).getTime()):(this.min=new Date(e.getFullYear(),e.getMonth(),e.getDate(),o+-s,0,0).getTime(),this.max=new Date(t.getFullYear(),t.getMonth(),t.getDate(),l+s,0,0).getTime())}calculateVisibleRange(e,t){t.visibleRange={min:t.actualRange.min,max:t.actualRange.max,interval:t.actualRange.interval,delta:t.actualRange.delta};const i=!(0,a.le)(t.zoomingScrollBar)&&t.zoomingScrollBar.isLazyLoad;Vt(t)&&!i&&(t.calculateVisibleRangeOnZooming(this.chart),t.calculateAxisRange(e,this.chart),t.visibleRange.interval=t.enableAutoIntervalOnZooming?this.calculateDateTimeNiceInterval(t,e,t.visibleRange.min,t.visibleRange.max):t.visibleRange.interval),t.dateTimeInterval=this.increaseDateTimeInterval(t,t.visibleRange.min,t.visibleRange.interval).getTime()-t.visibleRange.min,t.triggerRangeRender(this.chart,t.visibleRange.min,t.visibleRange.max,t.visibleRange.interval)}calculateVisibleLabels(e,t){e.visibleLabels=[];let i,s,o=e.visibleRange.min;const l=e.visibleLabels;for(Zt(e)||(o=this.alignRangeStart(e,o,e.visibleRange.interval).getTime());o<=e.visibleRange.max;)i=(0,a.l7)({},(0,a.NA)("properties",e.labelStyle),null,!0),s=l.length?e.visibleLabels[l.length-1].value:o,e.format=t.intl.getDateFormat({format:this.findCustomFormats(e,o,s)||this.blazorCustomFormat(e),type:kt(e.skeletonType),skeleton:this.getSkeleton(e,o,s,t.isBlazor)}),e.startLabel=e.format(new Date(e.visibleRange.min)),e.endLabel=e.format(new Date(e.visibleRange.max)),pt(o,e.visibleRange)&&Bt(t,o,e.format(new Date(o)),i,e),o=this.increaseDateTimeInterval(e,o,e.visibleRange.interval).getTime();"Months"!==e.actualIntervalType&&"Days"!==e.actualIntervalType||!e.isChart||(e.format=t.intl.getDateFormat({format:e.labelFormat||("Months"!==e.actualIntervalType||e.skeleton?"":"y MMM"),type:kt(e.skeletonType),skeleton:e.skeleton||("Days"===e.actualIntervalType?"MMMd":"")})),e.getMaxLabelWidth&&e.getMaxLabelWidth(this.chart)}blazorCustomFormat(e){return this.chart.isBlazor?"Years"===e.actualIntervalType?e.isIntervalInDecimal?"yyyy":"MMM y":"Days"!==e.actualIntervalType||e.isIntervalInDecimal?"":"ddd HH tt":""}increaseDateTimeInterval(e,t,i){let s=new Date(t);e.interval?(e.isIntervalInDecimal=i%1==0,e.visibleRange.interval=i):(i=Math.ceil(i),e.visibleRange.interval=i);const o=e.actualIntervalType;if(e.isIntervalInDecimal)switch(o){case"Years":return s.setFullYear(s.getFullYear()+i),s;case"Quarter":return s.setMonth(s.getMonth()+3*i),s;case"Months":return s.setMonth(s.getMonth()+i),s;case"Weeks":return s.setDate(s.getDate()+7*i),s;case"Days":return s.setDate(s.getDate()+i),s;case"Hours":return s.setHours(s.getHours()+i),s;case"Minutes":return s.setMinutes(s.getMinutes()+i),s;case"Seconds":return s.setSeconds(s.getSeconds()+i),s}else s=this.getDecimalInterval(s,i,o);return s}alignRangeStart(e,t,i){let s=new Date(t);switch(e.actualIntervalType){case"Years":const e=Math.floor(Math.floor(s.getFullYear()/i)*i);return s=new Date(e,s.getMonth(),s.getDate(),0,0,0),s;case"Months":const t=Math.floor(Math.floor(s.getMonth()/i)*i);return s=new Date(s.getFullYear(),t,s.getDate(),0,0,0),s;case"Days":const o=Math.floor(Math.floor(s.getDate()/i)*i);return s=new Date(s.getFullYear(),s.getMonth(),o,0,0,0),s;case"Hours":const l=Math.floor(Math.floor(s.getHours()/i)*i);return s=new Date(s.getFullYear(),s.getMonth(),s.getDate(),l,0,0),s;case"Minutes":const a=Math.floor(Math.floor(s.getMinutes()/i)*i);return s=new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),a,0,0),s;case"Seconds":const r=Math.floor(Math.floor(s.getSeconds()/i)*i);return s=new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),r,0),s}return s}getDecimalInterval(e,t,i){const s=Math.floor(t),o=t-s;switch(i){case"Years":const i=Math.round(12*o);return e.setFullYear(e.getFullYear()+s),e.setMonth(e.getMonth()+i),e;case"Quarter":return e.setMonth(e.getMonth()+3*t),e;case"Months":const l=Math.round(30*o);return e.setMonth(e.getMonth()+s),e.setDate(e.getDate()+l),e;case"Weeks":return e.setDate(e.getDate()+7*t),e;case"Days":const a=Math.round(24*o);return e.setDate(e.getDate()+s),e.setHours(e.getHours()+a),e;case"Hours":const r=Math.round(60*o);return e.setHours(e.getHours()+s),e.setMinutes(e.getMinutes()+r),e;case"Minutes":const n=Math.round(60*o);return e.setMinutes(e.getMinutes()+s),e.setSeconds(e.getSeconds()+n),e;case"Seconds":const h=Math.round(1e3*o);return e.setSeconds(e.getSeconds()+s),e.setMilliseconds(e.getMilliseconds()+h),e}return e}getModuleName(){return"DateTime"}destroy(){}}class us extends cs{constructor(e){super(e)}calculateRangeAndInterval(e,t){this.calculateRange(t),this.getActualRange(t,e),this.applyRangePadding(t,e),this.calculateVisibleLabels(t)}getActualRange(e,t){this.initializeDoubleRange(e),e.actualRange={},e.actualRange.interval=e.interval?Math.ceil(e.interval):Math.max(1,Math.floor(e.doubleRange.delta/jt(t,e))),e.actualRange.min=e.doubleRange.start,e.actualRange.max=e.doubleRange.end,e.actualRange.delta=e.doubleRange.delta}applyRangePadding(e,t){const i="BetweenTicks"===e.labelPlacement&&"PolarRadar"!==this.chart.chartAreaType?.5:0;i>0?(e.actualRange.min-=i,e.actualRange.max+=i):e.actualRange.max+=e.actualRange.max?0:.5,e.doubleRange=new le(e.actualRange.min,e.actualRange.max),e.actualRange.delta=e.doubleRange.delta,this.calculateVisibleRange(t,e)}calculateVisibleLabels(e){e.visibleLabels=[];let t,i,s=Math.ceil(e.visibleRange.min);for((e.zoomFactor<1||e.zoomPosition>0)&&(s=e.visibleRange.min-e.visibleRange.min%e.visibleRange.interval),e.startLabel=e.labels[Math.round(e.visibleRange.min)],e.endLabel=e.labels[Math.floor(e.visibleRange.max)];s<=e.visibleRange.max;s+=e.visibleRange.interval)t=(0,a.l7)({},(0,a.NA)("properties",e.labelStyle),null,!0),pt(s,e.visibleRange)&&e.labels.length>0&&(i=Math.round(s),Bt(this.chart,i,e.labels[i]?e.labels[i].toString():i.toString(),t,e));e.getMaxLabelWidth&&e.getMaxLabelWidth(this.chart)}getModuleName(){return"Category"}destroy(){}}class gs{measureStripLine(e,t,i,s,o,l){let a,r;const n=e.orientation,h="DateTime"===e.valueType;if(t.isRepeat&&null!==t.size)a=s,r=null;else if("DateTimeCategory"===e.valueType){const i=t.start,s=t.end;a=null!=i&&"number"!=typeof i?e.labels.indexOf(this.dateToMilliSeconds(i,l).toString()):i,r=null!=s&&"number"!=typeof s?e.labels.indexOf(this.dateToMilliSeconds(s,l).toString()):s}else a=null===t.start?null:h&&this.isCoreDate(t.start)?this.dateToMilliSeconds(t.start,l):+t.start,r=null===t.end?null:h&&this.isCoreDate(t.start)?this.dateToMilliSeconds(t.end,l):+t.end;const d=this.getFromTovalue(a,r,t.size,t.startFromAxis,e,t);let c="Vertical"===n?(d.to-d.from)*e.rect.height:i.height,p="Horizontal"===n?(d.to-d.from)*e.rect.width:i.width,u="Vertical"===n?i.x:d.from*e.rect.width+e.rect.x,g="Horizontal"===n?i.y:e.rect.y+e.rect.height-("Pixel"===t.sizeType?d.from:d.to)*e.rect.height;if(t.isSegmented&&null!=t.segmentStart&&null!=t.segmentEnd&&"Pixel"!==t.sizeType){const e=h&&this.isCoreDate(t.segmentStart)?this.dateToMilliSeconds(t.segmentStart,l):+t.segmentStart,i=h&&this.isCoreDate(t.segmentEnd)?this.dateToMilliSeconds(t.segmentEnd,l):+t.segmentEnd,s=this.getFromTovalue(e,i,null,null,o,t);"Vertical"===o.orientation?(g=o.rect.y+o.rect.height-s.to*o.rect.height,c=(s.to-s.from)*o.rect.height):(u=s.from*o.rect.width+o.rect.x,p=(s.to-s.from)*o.rect.width)}return 0!==c&&0!==p||"Pixel"===t.sizeType&&(null!==t.start||t.startFromAxis)?new C(u,g,p,c):new C(0,0,0,0)}getFromTovalue(e,t,i,s,o,l){let r=!l.isRepeat&&s?o.visibleRange.min:e,n=this.getToValue(Math.max(e,(0,a.le)(t)?e:t),r,i,o,t,l);return r=this.findValue(r,o),n=this.findValue(n,o),{from:wt(o.isInversed?n:r,o),to:wt(o.isInversed?r:n,o)}}getToValue(e,t,i,s,o,l){let a=l.sizeType;const r=null===o;if("DateTime"!==s.valueType)return"Pixel"===l.sizeType?t:r?t+i:e;{const o=new Date(t);switch("Auto"===a&&(a=s.actualIntervalType,i*=s.visibleRange.interval),a){case"Years":return r?new Date(o.setFullYear(o.getFullYear()+i)):e;case"Months":return r?new Date(o.setMonth(o.getMonth()+i)):e;case"Days":return r?new Date(o.setDate(o.getDate()+i)):e;case"Hours":return r?new Date(o.setHours(o.getHours()+i)):e;case"Minutes":return r?new Date(o.setMinutes(o.getMinutes()+i)):e;case"Seconds":return r?new Date(o.setSeconds(o.getSeconds()+i)):e;default:return t}}}findValue(e,t){return e<t.visibleRange.min?e=t.visibleRange.min:e>t.visibleRange.max&&(e=t.visibleRange.max),e}dateParse(e,t){let i=t.intl.getDateParser({skeleton:"full",type:"dateTime"}),s=t.intl.getDateFormat({skeleton:"full",type:"dateTime"});return new Date(Date.parse(i(s(new Date(r.j4.parse.parseJson({val:e}).val)))))}renderStripLine(e,t,i){const s=e.element.id+"_stripline_"+t+"_",o=e.chartAxisLayoutPanel.seriesClipRect;let l,a=0,r=0,n=0,h=null;const d=new Ti(s+"ClipRect","transparent",{width:1,color:"Gray"},1,{x:e.initialClipRect.x,y:e.initialClipRect.y,width:e.initialClipRect.width,height:e.initialClipRect.height}),c=e.renderer.createGroup({id:s+"collections","clip-path":"url(#"+s+"ClipRect)"});e.enableCanvas||c.appendChild(_t(e.redraw,d,e.renderer));for(const p of i){let d=0;for(const u of p.stripLines)if(u.visible&&u.zIndex===t)if(u.isSegmented&&null!=u.segmentStart&&null!=u.segmentEnd&&"Pixel"!==u.sizeType&&(h=this.getSegmentAxis(i,p,u)),u.isRepeat&&null!=u.repeatEvery&&null!==u.size&&"Pixel"!==u.sizeType)for(r=null!=u.repeatUntil?"DateTime"===p.valueType?this.dateToMilliSeconds(u.repeatUntil,e):+u.repeatUntil:p.actualRange.max,n="DateTime"===p.valueType&&this.isCoreDate(u.start)?this.dateToMilliSeconds(u.start,e):u.start,(u.startFromAxis&&"DateTime"===p.valueType&&"Auto"===u.sizeType||u.start<p.visibleRange.min)&&(n=p.visibleLabels[0].value===p.visibleRange.min?p.visibleRange.min:p.visibleLabels[0].value-("DateTime"===p.valueType?p.dateTimeInterval:p.visibleRange.interval)),n=u.startFromAxis&&"DateTime"!==p.valueType?p.visibleRange.min:n;n<r;)a=n+("DateTime"===p.valueType?p.dateTimeInterval*+u.size:u.size),l=pt(a,p.visibleRange),(n>=p.visibleRange.min&&n<p.visibleRange.max||l)&&this.renderStripLineElement(p,u,o,s,c,e,n,h,d),d++,n=this.getStartValue(p,u,n,e);else this.renderStripLineElement(p,u,o,s,c,e,null,h,d),d++}$t(e.enableCanvas,e.svgObject,c,e.redraw)}isCoreDate(e){return"string"==typeof e}dateToMilliSeconds(e,t){return this.dateParse(e,t).getTime()}renderPath(e,t,i,s,o,l){const a=Yt(i),r=a?a.getAttribute("d"):"";$t(o.enableCanvas,s,o.renderer.drawPath(new I(i,"none",e.size,e.color,e.opacity,e.dashArray,"Vertical"===l.orientation?"M "+t.x+" "+t.y+" L "+(t.x+t.width)+" "+t.y:"M "+t.x+" "+t.y+" L "+t.x+" "+(t.y+t.height))),o.redraw,!0,"x","y",null,r,!0)}renderRectangle(e,t,i,s,o){const l=Yt(i),a=l?new C(+l.getAttribute("x"),+l.getAttribute("y"),+l.getAttribute("width"),+l.getAttribute("height")):null;$t(o.enableCanvas,s,o.renderer.drawRectangle(new Ti(i,e.color,e.border,e.opacity,t,0,0,"",e.dashArray)),o.redraw,!0,"x","y",null,null,!0,!0,a)}renderText(e,t,i,s,o,l){const a=S(e.text,e.textStyle),r=null===e.rotation,n=r?a.height/8*3:0;let h=t.y+t.height/2+n;const d=r?"Vertical"===l.orientation?0:-90:e.rotation;let c,p=t.x+t.width/2;"Horizontal"===l.orientation?(p=this.getTextStart(p+n*this.factor(e.horizontalAlignment),t.width,e.horizontalAlignment),h=this.getTextStart(h-n,t.height,e.verticalAlignment)+("Start"!==e.verticalAlignment||r?0:a.height/4),c=r?this.invertAlignment(e.verticalAlignment):e.horizontalAlignment):(p=this.getTextStart(p,t.width,e.horizontalAlignment),h=this.getTextStart(h+n*this.factor(e.verticalAlignment)-5,t.height,e.verticalAlignment),c=e.horizontalAlignment),bi(o.renderer,new L(i,p,h,c,e.text,"rotate("+d+" "+p+","+h+")","middle"),e.textStyle,e.textStyle.color,s,null,null,null,null,null,null,0,null,o.enableCanvas)}invertAlignment(e){switch(e){case"Start":e="End";break;case"End":e="Start"}return e}getStartValue(e,t,i,s){return"DateTime"===e.valueType?this.getToValue(null,i,+t.repeatEvery,e,null,t):i+ +t.repeatEvery}getSegmentAxis(e,t,i){let s;if(null==i.segmentAxisName)return"Horizontal"===t.orientation?e[1]:e[0];for(let o=0;o<e.length;o++)i.segmentAxisName===e[o].name&&(s=e[o]);return s}renderStripLineElement(e,t,i,s,o,l,a,r,n){const h=this.measureStripLine(e,t,i,a,r,l);"Pixel"===t.sizeType?this.renderPath(t,h,s+"path_"+e.name+"_"+n,o,l,e):0!==h.height&&0!==h.width&&this.renderRectangle(t,h,s+"rect_"+e.name+"_"+n,o,l),""!==t.text&&this.renderText(t,h,s+"text_"+e.name+"_"+n,o,l,e)}factor(e){let t=0;switch(e){case"Start":t=1;break;case"End":t=-1}return t}getTextStart(e,t,i){switch(i){case"Start":e=e-t/2+5;break;case"End":e=e+t/2-5}return e}getModuleName(){return"StripLine"}destroy(){}}class ms{constructor(e){this.chart=e}enableComplexProperty(e){const t=[],i=[],s=e.xAxis.visibleRange,o=e.yAxis.visibleRange,l=e.points,r=e.clipRect,n=Math.abs(s.delta/r.width),h=Math.abs(o.delta/r.height);let d,c=l[0]&&l[0].x>n?0:n,p=l[0]&&l[0].y>h?0:h,u=0,g=0;for(const a of l)a.symbolLocations=[],u=a.xValue?a.xValue:s.min,g=a.yValue?a.yValue:o.min,(Math.abs(c-u)>=n||Math.abs(p-g)>=h)&&(t.push(a),c=u,p=g);for(let m=0;m<t.length;m++)d=t[m],(0,a.le)(d.x)||""===d.x||i.push(d);return i}getLineDirection(e,t,i,s,o,l){let a="";if(null!=e){const r=o(e.xValue,e.yValue,i.xAxis,i.yAxis,s,i),n=o(t.xValue,t.yValue,i.xAxis,i.yAxis,s,i);a=l+" "+r.x+" "+r.y+" L "+n.x+" "+n.y+" "}return a}appendLinePath(e,t,i){const s=Yt(e.id),o=t.chart,l=s?s.getAttribute("d"):null,a=t.chart.renderer.drawPath(e,new Int32Array([t.clipRect.x,t.clipRect.y]));a&&a.setAttribute("clip-path",i),t.pathElement=a,t.chart.enableCanvas||t.seriesElement.appendChild(a),t.isRectSeries=!1,zt(s,e.d,t.chart.redraw,l,o.duration)}renderMarker(e){e.marker&&e.marker.visible&&e.chart.markerRender.render(e)}doProgressiveAnimation(e,t){const i=new a.fw({}),s=e.pathElement,o=s.getAttribute("stroke-dasharray"),l=e.pathElement.getTotalLength();let r;s.style.visibility="hidden",i.animate(s,{duration:t.duration,delay:t.delay,progress:e=>{e.timeStamp>=e.delay&&(s.style.visibility="visible",r=Math.abs(Math.round((e.timeStamp-e.delay)*l/e.duration)),s.setAttribute("stroke-dasharray",r+","+l))},end:()=>{s.setAttribute("stroke-dasharray",o),e.chart.trigger("animationComplete",{series:e.chart.isBlazor?{}:e})}})}storePointLocation(e,t,i,s){const o=t.marker&&t.marker.width?t.marker.width:0,l=t.marker&&t.marker.height?t.marker.height:0;e.symbolLocations.push(s(e.xValue,e.yValue,t.xAxis,t.yAxis,i,t)),e.regions.push(new C(e.symbolLocations[0].x-o,e.symbolLocations[0].y-l,2*o,2*l))}withinYRange(e,t){return e.yValue>=t.visibleRange.min&&e.yValue<=t.visibleRange.max}getFirstLastVisiblePoint(e){let t=null,i=null;for(const s of e)null===t&&s.visible&&(t=i=s),i=s.visible?s:i;return{first:t||e[0],last:i||e[e.length-1]}}doLinearAnimation(e,t){const i=e.clipRectElement.childNodes[0].childNodes[0],s=e.chart.animated?e.chart.duration:t.duration,o=Ft("Linear"),l=+i.getAttribute("height"),r=+i.getAttribute("width"),n=+i.getAttribute("x"),h=e.chart.requireInvertedAxis?+i.getAttribute("height")+ +i.getAttribute("y"):+i.getAttribute("y");let d;i.style.visibility="hidden",new a.fw({}).animate(i,{duration:s,delay:t.delay,progress:t=>{t.timeStamp>=t.delay&&(i.style.visibility="visible",e.chart.requireInvertedAxis?(d=o(t.timeStamp-t.delay,0,l,t.duration),i.setAttribute("transform","translate("+n+" "+h+") scale(1,"+d/l+") translate("+-n+" "+-h+")")):(d=o(t.timeStamp-t.delay,0,r,t.duration),i.setAttribute("transform","translate("+n+" "+h+") scale("+d/r+", 1) translate("+-n+" "+-h+")")))},end:()=>{i.setAttribute("transform","translate(0,0)"),e.chart.trigger("animationComplete",{series:e.chart.isBlazor?{}:e})}})}}class bs extends ms{render(e,t,i,s){let o,l,a="",r=null,n="M";const h=e.chart&&"PolarRadar"===e.chart.chartAreaType,d=e.emptyPointSettings&&"Drop"===e.emptyPointSettings.mode,c=h?Ct:Kt,p="TrendLine"===e.category?e.points:this.enableComplexProperty(e);for(const g of p)g.regions=[],g.symbolLocations=[],g.visible&&gt(p[g.index-1],g,p[g.index+1],e)?(a+=this.getLineDirection(r,g,e,s,c,n),n=r?"L":n,r=g,this.storePointLocation(g,e,s,c)):(r=d?r:null,n=d?n:"M");if(h&&e.isClosed){const r=this.getFirstLastVisiblePoint(p);l=c(r.last.xValue,r.last.yValue,t,i,s,e),o=c(r.first.xValue,r.first.yValue,t,i,s,e),a=a.concat(n+" "+l.x+" "+l.y+" L "+o.x+" "+o.y)}const u=new I("Indicator"===e.category?e.chart.element.id+"_Indicator_"+e.index+"_"+e.name:"TrendLine"===e.category?e.chart.element.id+"_Series_"+e.sourceIndex+"_TrendLine_"+e.index:e.chart.element.id+"_Series_"+(void 0===e.index?e.category:e.index),"none",e.width,e.interior,e.opacity,e.dashArray,a);this.appendLinePath(u,e,""),this.renderMarker(e)}doAnimation(e){this.doProgressiveAnimation(e,e.animation)}getModuleName(){return"LineSeries"}destroy(){}}class fs{getSideBySideInfo(e){e.chart.enableSideBySidePlacement&&!e.position&&this.getSideBySidePositions(e);const t=e.chart.enableSideBySidePlacement?e.position:0,i=e.chart.enableSideBySidePlacement?e.rectCount:1;e.isRectSeries=!0;const s=e.chart.visibleSeries,o=e.chart.enableSideBySidePlacement?e.columnSpacing:0,l=null===e.columnWidth||isNaN(+e.columnWidth)?"Histogram"===e.type?1:.7:e.columnWidth,a=Et(e.xAxis,s)*l;let r;const n=t/i-.5;let h=new le(n,n+1/i);return isNaN(h.start)||isNaN(h.end)||(h=new le(h.start*a,h.end*a),r=o*h.delta,h=new le(h.start+r/2,h.end-r/2)),h}getRectangle(e,t,i,s,o){const l=Kt(e,t,o.xAxis,o.yAxis,o.chart.requireInvertedAxis),a=Kt(i,s,o.xAxis,o.yAxis,o.chart.requireInvertedAxis);return new C(Math.min(l.x,a.x),Math.min(l.y,a.y),Math.abs(a.x-l.x),Math.abs(a.y-l.y))}getSideBySidePositions(e){const t=e.chart;for(const i of t.columns)for(const s of t.rows)this.findRectPosition(e.findSeriesCollection(i,s,!1))}findRectPosition(e){const t=[],i={rectCount:0,position:null};for(let s=0;s<e.length;s++){const o=e[s];-1!==o.type.indexOf("Stacking")?o.stackingGroup?void 0===t[o.stackingGroup]?(o.position=i.rectCount,t[o.stackingGroup]=i.rectCount++):o.position=t[o.stackingGroup]:null===i.position?(o.position=i.rectCount,i.position=i.rectCount++):o.position=i.position:o.position=i.rectCount++}for(let s=0;s<e.length;s++)e[s].rectCount=i.rectCount}updateSymbolLocation(e,t,i){i.chart.requireInvertedAxis?this.updateYRegion(e,t,i):this.updateXRegion(e,t,i),"Histogram"===i.type&&(e.minimum=+e.x-i.histogramValues.binWidth/2,e.maximum=+e.x+i.histogramValues.binWidth/2)}updateXRegion(e,t,i){e.symbolLocations.push({x:t.x+t.width/2,y:"BoxPlot"===i.seriesType||-1!==i.seriesType.indexOf("HighLow")||e.yValue>=0==!i.yAxis.isInversed?t.y:t.y+t.height}),this.getRegion(e,t,i),"RangeColumn"===i.type&&e.symbolLocations.push({x:t.x+t.width/2,y:t.y+t.height})}updateYRegion(e,t,i){e.symbolLocations.push({x:"BoxPlot"===i.seriesType||-1!==i.seriesType.indexOf("HighLow")||e.yValue>=0==!i.yAxis.isInversed?t.x+t.width:t.x,y:t.y+t.height/2}),this.getRegion(e,t,i),"RangeColumn"===i.type&&e.symbolLocations.push({x:t.x,y:t.y+t.height/2})}renderMarker(e){e.marker&&e.marker.visible&&e.chart.markerRender.render(e)}getRegion(e,t,i){if(0===e.y){const t=i.marker&&i.marker.width?i.marker.width:0,s=i.marker&&i.marker.height?i.marker.height:0;e.regions.push(new C(e.symbolLocations[0].x-t,e.symbolLocations[0].y-s,2*t,2*s))}else e.regions.push(t)}triggerEvent(e,t,i,s){const o={cancel:!1,name:ce,series:e,point:t,fill:e.setPointColor(t,i),border:e.setBorderColor(t,s)};return e.chart.trigger(ce,o),t.color=o.fill,o}drawRectangle(e,t,i,s){const o=e.chart;if((o.requireInvertedAxis?i.height:i.width)<=0)return null;let l;l=0===t.y?this.calculateRoundedRectPath(i,0,0,0,0):this.calculateRoundedRectPath(i,e.cornerRadius.topLeft,e.cornerRadius.topRight,e.cornerRadius.bottomLeft,e.cornerRadius.bottomRight);const a="Indicator"===e.category?o.element.id+"_Indicator_"+e.index+"_"+e.name+"_Point_"+t.index:o.element.id+"_Series_"+e.index+"_Point_"+t.index,r=gi(o.redraw,a),n=r?r.getAttribute("d"):"",h=new I(a,s.fill,s.border.width,s.border.color,e.opacity,e.dashArray,l),d=o.renderer.drawPath(h,new Int32Array([e.clipRect.x,e.clipRect.y]));switch(e.seriesType){case"XY":d.setAttribute("aria-label",t.x.toString()+":"+t.yValue.toString());break;case"HighLow":d.setAttribute("aria-label",t.x.toString()+":"+t.high.toString()+":"+t.low.toString())}$t(e.chart.enableCanvas,e.seriesElement,d,o.redraw),e.chart.enableCanvas||zt(d,l,o.redraw,n,o.duration)}animate(e){const t=e.seriesElement.childNodes;let i="Indicator"===e.category?0:1;const s=rt(e);for(const o of s)(o.symbolLocations.length||"BoxAndWhisker"===e.type&&o.regions.length)&&(this.animateRect(t[i],e,o),i++)}animateRect(e,t,i){const s=t.animation,o=t.chart.animated?t.chart.duration:s.duration,l=Ft("Linear"),r=i.yValue<0;let n,h,d,c,p,u=+i.regions[0].height,g=+i.regions[0].width;t.chart.requireInvertedAxis?(h=+i.regions[0].y,t.type.indexOf("Stacking")>-1?(n=wt(0,t.yAxis)*t.yAxis.rect.width,d=n,c=h):(n=+i.regions[0].x,c=r?h:h+u,d=-1!==t.seriesType.indexOf("HighLow")||-1!==t.type.indexOf("Waterfall")?n+g/2:r!==t.yAxis.isInversed?n+g:n)):(n=+i.regions[0].x,t.type.indexOf("Stacking")>-1?(h=(1-wt(0,t.yAxis))*t.yAxis.rect.height,d=n,c=h):(h=+i.regions[0].y,c=-1!==t.seriesType.indexOf("HighLow")||-1!==t.type.indexOf("Waterfall")?h+u/2:r!==t.yAxis.isInversed?h:h+u,d=r?n:n+g)),(0,a.le)(e)||(e.style.visibility="hidden",new a.fw({}).animate(e,{duration:o,delay:s.delay,progress:i=>{i.timeStamp>=i.delay&&(e.style.visibility="visible",t.chart.requireInvertedAxis?(g=g||1,p=l(i.timeStamp-i.delay,0,g,i.duration),e.setAttribute("transform","translate("+d+" "+c+") scale("+p/g+", 1) translate("+-d+" "+-c+")")):(u=u||1,p=l(i.timeStamp-i.delay,0,u,i.duration),e.setAttribute("transform","translate("+d+" "+c+") scale(1,"+p/u+") translate("+-d+" "+-c+")")))},end:()=>{e.setAttribute("transform","translate(0,0)");const s=t.seriesElement;if((e===s.lastElementChild||i.index===t.points.length-1||"Waterfall"===t.type&&e===s.children[s.childElementCount-2])&&(t.chart.trigger("animationComplete",{series:t.chart.isBlazor?{}:t}),"Waterfall"===t.type)){const e=s.childNodes;for(let t=0;t<e.length;t++)-1!==e[t].id.indexOf("Connector")&&(e[t].style.visibility="visible",e[t].setAttribute("transform","translate(0,0)"))}}}))}calculateRoundedRectPath(e,t,i,s,o){return"M "+e.x+" "+(t+e.y)+" Q "+e.x+" "+e.y+" "+(e.x+t)+" "+e.y+" L "+(e.x+e.width-i)+" "+e.y+" Q "+(e.x+e.width)+" "+e.y+" "+(e.x+e.width)+" "+(e.y+i)+" L "+(e.x+e.width)+" "+(e.y+e.height-o)+" Q "+(e.x+e.width)+" "+(e.y+e.height)+" "+(e.x+e.width-o)+" "+(e.y+e.height)+" L "+(e.x+s)+" "+(e.y+e.height)+" Q "+e.x+" "+(e.y+e.height)+" "+e.x+" "+(e.y+e.height-s)+" L "+e.x+" "+(t+e.y)+" Z"}}class ys extends fs{render(e){let t;const i=this.getSideBySideInfo(e),s=Math.max(e.yAxis.visibleRange.min,0);let o;for(const l of e.points)l.symbolLocations=[],l.regions=[],l.visible&&gt(e.points[l.index-1],l,e.points[l.index+1],e)&&(t=this.getRectangle(l.xValue+i.start,l.yValue,l.xValue+i.end,s,e),o=this.triggerEvent(e,l,"Indicator"===e.category?l.color:e.interior,{width:e.border.width,color:e.border.color}),o.cancel||(this.updateSymbolLocation(l,t,e),this.drawRectangle(e,l,t,o)));this.renderMarker(e)}doAnimation(e){this.animate(e)}getModuleName(){return"ColumnSeries"}destroy(){}}class vs extends ms{getAreaPathDirection(e,t,i,s,o,l,a){let r,n="";return null===l&&(r=o(e,t,i.xAxis,i.yAxis,s,i),n+=a+" "+r.x+" "+r.y+" "),n}getAreaEmptyDirection(e,t,i,s,o){let l="";return l+=this.getAreaPathDirection(e.x,e.y,i,s,o,null,"L"),l+=this.getAreaPathDirection(t.x,t.y,i,s,o,null,"L"),l}setPointColor(e,t,i,s,o){if(""===i.pointColorMapping){let t,l;for(let a=0;a<o.length;a++)if(t=o[a],l=s?e.xValue:e.yValue,l<=this.getAxisValue(t.value,s?i.xAxis:i.yAxis,i.chart)||!t.value){e.interior=t.color;break}return null==e.interior&&(e.interior=i.interior),!1}return!!t&&i.setPointColor(e,i.interior)!==i.setPointColor(t,i.interior)}sortSegments(e,t){const i="X"===e.segmentAxis?e.xAxis:e.yAxis;return[].concat(t).sort((t,s)=>this.getAxisValue(t.value,i,e.chart)-this.getAxisValue(s.value,i,e.chart))}applySegmentAxis(e,t,i){if(""!==e.pointColorMapping)return t.map(t=>{this.appendLinePath(t,e,"")}),null;const s="X"===e.segmentAxis,o=s?e.xAxis:e.yAxis,l=e.chart;let a;this.includeSegment(i,o,e,i.length);const r=i.length;let n,h,d;for(let c=0;c<r;c++)a=i[c],n=this.getAxisValue(a.value,o,e.chart),h=this.createClipRect(c?this.getAxisValue(i[c-1].value,o,e.chart):o.visibleRange.min,n,e,c,s),h&&t.map(t=>{d={"clip-path":h,"stroke-dasharray":a.dashArray,opacity:t.opacity,stroke:e.type.indexOf("Line")>-1?a.color||e.interior:e.border.color,"stroke-width":t["stroke-width"],fill:e.type.indexOf("Line")>-1?"none":a.color||e.interior,id:t.id+"_Segment_"+c,d:t.d},zt(Yt(d.id),d.d,l.redraw),e.seriesElement.appendChild(l.renderer.drawPath(d))})}includeSegment(e,t,i,s){if(s<=0)return e.push({value:t.visibleRange.max,color:i.interior}),null;this.getAxisValue(e[s-1].value,t,i.chart)<t.visibleRange.max&&e.push({value:t.visibleRange.max,color:i.interior})}createClipRect(e,t,i,s,o){const l=i.chart.requireInvertedAxis;let a,r=Kt(o?e:i.xAxis.visibleRange.min,o?i.yAxis.visibleRange.max:t,i.xAxis,i.yAxis,l),n=Kt(o?t:i.xAxis.visibleRange.max,o?i.yAxis.visibleRange.min:e,i.xAxis,i.yAxis,l);return n=l?[r,r=n][0]:n,n.x-r.x>0&&n.y-r.y>0?(a=new Ti(i.chart.element.id+"_ChartSegment"+i.index+"ClipRect_"+s,"transparent",{width:1,color:"Gray"},1,{x:r.x,y:r.y,width:n.x-r.x,height:n.y-r.y}),i.seriesElement.appendChild(_t(i.chart.redraw,a,i.chart.renderer)),"url(#"+i.chart.element.id+"_ChartSegment"+i.index+"ClipRect_"+s+")"):null}getAxisValue(e,t,i){if(null===e&&(e=t.visibleRange.max),"DateTime"===t.valueType){const t={skeleton:"full",type:"dateTime"};return Date.parse(i.intl.getDateParser(t)(i.intl.getDateFormat(t)(new Date(r.j4.parse.parseJson({val:e}).val))))}if(t.valueType.indexOf("Category")>-1){const i="DateTimeCategory"===t.valueType?e.getTime().toString():e;return t.labels.indexOf(i)<0?+e:t.labels.indexOf(i)}return+e}}class Ss extends vs{render(e,t,i,s){let o=null,l="";const a=e.chart&&"PolarRadar"===e.chart.chartAreaType;let r,n=Math.max(e.yAxis.visibleRange.min,0);a&&(n=this.getFirstLastVisiblePoint(e.points).first.yValue);const h=e.emptyPointSettings&&"Drop"===e.emptyPointSettings.mode,d=e.border?e.border.width:0,c=e.border?e.border.color:"transparent",p="PolarRadar"===e.chart.chartAreaType?Ct:Kt,u=this.enableComplexProperty(e);let g;for(let m=0;m<u.length;m++)g=u[m],r=g.xValue,g.symbolLocations=[],g.regions=[],g.visible&&gt(u[m-1],g,u[m+1],e)&&(l+=this.getAreaPathDirection(r,n,e,s,p,o,"M"),o=o||new Ri(r,n),l+=this.getAreaPathDirection(r,g.yValue,e,s,p,null,"L"),u[m+1]&&!u[m+1].visible&&(!a||a&&this.withinYRange(u[m+1],i))&&!h&&(l+=this.getAreaEmptyDirection({x:r,y:n},o,e,s,p),o=null),this.storePointLocation(g,e,s,p));if(a&&""!==l){let o="";const a=this.chart;o+=this.getAreaPathDirection(0,n,e,s,p,null,"L"),(t.isInversed||i.isInversed)&&(l+="Polar"===e.type?a.polarSeriesModule.getPolarIsInversedPath(t,o):a.radarSeriesModule.getRadarIsInversedPath(t,o)),l=l.concat(l+" Z")}this.appendLinePath(new I(e.chart.element.id+"_Series_"+e.index,e.interior,d,c,e.opacity,e.dashArray,e.points.length>1&&""!==l?l+this.getAreaPathDirection(e.points[e.points.length-1].xValue,"PolarRadar"===e.chart.chartAreaType?e.points[e.points.length-1].yValue:n,e,s,p,null,"L"):""),e,""),this.renderMarker(e)}destroy(){}getModuleName(){return"AreaSeries"}doAnimation(e){this.doLinearAnimation(e,e.animation)}}class xs extends fs{render(e){const t=Math.max(e.yAxis.visibleRange.min,0),i=this.getSideBySideInfo(e);let s,o;for(const l of e.points)l.symbolLocations=[],l.regions=[],l.visible&&gt(e.points[l.index-1],l,e.points[l.index+1],e)&&(s=this.getRectangle(l.xValue+i.start,l.yValue,l.xValue+i.end,t,e),o=this.triggerEvent(e,l,e.interior,{width:e.border.width,color:e.border.color}),o.cancel||(this.updateSymbolLocation(l,s,e),this.drawRectangle(e,l,s,o)));this.renderMarker(e)}doAnimation(e){this.animate(e)}destroy(){}getModuleName(){return"BarSeries"}}class ws extends ms{constructor(){super(...arguments),this.visibleAxisLabelRect=[]}measureAxis(e){const t=this.chart;this.initialClipRect=e,this.seriesClipRect=new C(e.x,e.y,e.width,e.height),this.measureRowAxis(t,this.initialClipRect),this.measureColumnAxis(t,this.initialClipRect),this.calculateAxisSize()}measureRowAxis(e,t){this.calculateRowSize(t);const i=e.rows[0];this.measureDefinition(i,e,new w(e.availableSize.width,i.computedHeight))}measureColumnAxis(e,t){this.calculateColumnSize(t);const i=e.columns[0];this.measureDefinition(i,e,new w(i.computedWidth,e.availableSize.height))}measureDefinition(e,t,i){for(const s of e.axes)s.getModule(t),s.baseModule.calculateRangeAndInterval(i,s)}calculateAxisSize(){const e=this.chart;let t;this.centerX=.5*this.initialClipRect.width+this.initialClipRect.x,this.centerY=.5*this.initialClipRect.height+this.initialClipRect.y,e.radius=Math.min(this.initialClipRect.width,this.initialClipRect.height)/2-5-e.primaryXAxis.majorTickLines.height-e.primaryXAxis.maxLabelSize.height,e.radius=e.primaryXAxis.coefficient*e.radius/100,this.seriesClipRect.y=this.centerY-e.radius,this.seriesClipRect.x=this.centerX-e.radius,this.seriesClipRect.height=2*e.radius,this.seriesClipRect.width=2*e.radius,this.calculateRowSize(this.seriesClipRect),t=e.primaryYAxis,t.rect=this.seriesClipRect,this.calculateColumnSize(this.seriesClipRect),t=e.primaryXAxis,t.rect=this.seriesClipRect}measure(){const e=this.chart;e.verticalAxes.push(e.primaryYAxis);const t=e.rows[0];t.axes[0]=e.primaryYAxis,e.rows[0]=t,e.horizontalAxes.push(e.primaryXAxis);const i=e.columns[0];i.axes[0]=e.primaryXAxis,e.columns[0]=i}calculateRowSize(e){const t=this.chart,i=t.rows[0];i.computedHeight=e.height/2,i.computedTop=e.y,t.rows[0]=i}calculateColumnSize(e){const t=this.chart,i=t.columns[0];i.computedLeft=e.x,i.computedWidth=e.width,t.columns[0]=i}renderAxes(){let e;const t=this.chart;this.startAngle=t.primaryXAxis.startAngle;const i=t.renderer.createGroup({id:t.element.id+"AxisCollection"}),s=t.renderer.createGroup({id:t.element.id+"AxisOutsideCollection"});for(let o=0,l=t.axisCollections.length;o<l;o++)this.element=t.renderer.createGroup({id:t.element.id+"AxisGroup"+o}),e=t.axisCollections[o],"Horizontal"===e.orientation?((e.majorGridLines.width>0||e.majorTickLines.width>0)&&this.drawXAxisGridLine(e,o),e.visible&&e.internalVisibility&&this.drawXAxisLabels(e,o)):(this.drawYAxisGridLine(e,o),e.lineStyle.width>0&&this.drawYAxisLine(e,o),e.visible&&e.internalVisibility&&this.drawYAxisLabels(e,o)),i.appendChild(this.element);return i.appendChild(this.element),$t(t.enableCanvas,t.svgObject,i,t.redraw),s}drawYAxisLine(e,t){const i=this.chart;let s={};const o=Tt(Lt(e.visibleLabels[0].value,e),this.startAngle);s={id:i.element.id+"AxisLine_"+t,d:"M "+this.centerX+" "+this.centerY+"L "+(this.centerX+i.radius*o.x)+" "+(this.centerY+i.radius*o.y),"stroke-dasharray":e.lineStyle.dashArray,"stroke-width":e.lineStyle.width,stroke:e.lineStyle.color||i.themeStyle.axisLine};const l=i.renderer.drawPath(s);this.setPointerEventNone(l),i.yAxisElements.appendChild(l)}drawYAxisLabels(e,t){const i=this.chart;let s,o,l=0,a=0;const r=this.startAngle<0?this.startAngle+360:this.startAngle,n="middle";let h,d;const c=[],p=[];p[0]=!0;const u=e.labelIntersectAction,g=i.renderer.createGroup({id:i.element.id+"AxisLabels"+t}),m=Tt(Lt(e.visibleLabels[0].value,e),this.startAngle);for(let b=0,f=e.visibleLabels.length;b<f;b++){if(d=!1,h=i.radius*wt(e.visibleLabels[b].value,e),s=e.visibleLabels[b].size,h=i.radius*wt(e.visibleLabels[b].value,e),l=this.centerX+h*m.x+(e.majorTickLines.height+s.width/2+2.5)*Math.cos(r*Math.PI/180)*("Inside"===e.labelPosition?1:-1),a=this.centerY+h*m.y+(e.majorTickLines.height+s.height/2)*Math.sin(r*Math.PI/180)*("Inside"===e.labelPosition?1:-1),a+=s.height/4,c[b]=this.getLabelRegion(l,a,e.visibleLabels[b],n),0!==b&&"Hide"===u){for(let e=b;e>=0;e--){if(e=0===e?0:e===b?e-1:e,p[e]&&li(c[b],c[e])){d=!0,p[b]=!1;break}p[b]=!0}if(d)continue;for(const e of this.visibleAxisLabelRect)if(li(c[b],e)){d=!0;break}}d||(this.visibleAxisLabelRect.push(c[b]),o=new L(i.element.id+t+"_AxisLabel_"+b,l,a,n,e.visibleLabels[b].text),bi(i.renderer,o,e.labelStyle,e.labelStyle.color||i.themeStyle.axisLabel,g,!1,i.redraw,!0,!0,null,null,0,null,i.enableCanvas))}i.yAxisElements.appendChild(g)}drawYAxisGridLine(e,t){const i=this.chart;let s,o,l,a="",r="";const n=this.startAngle<0?this.startAngle+360:this.startAngle;let h,d,c,p;const u={color:e.majorGridLines.color||i.themeStyle.majorGridLine,width:e.majorGridLines.width};let g,m;if(e.majorGridLines.width>0)if("Polar"===i.visibleSeries[0].type){for(let l=0;l<e.visibleLabels.length;l++)m=Yt(i.element.id+"_MajorGridLine_"+t+"_"+l),g=m?m.getAttribute("r"):null,o=i.radius*wt(e.visibleLabels[l].value,e),s=new Ai(i.element.id+"_MajorGridLine_"+t+"_"+l,"transparent",u,e.majorGridLines.width,this.centerX,this.centerY,o),$t(i.enableCanvas,this.element,i.renderer.drawCircle(s),i.redraw,!0,"r","r",new Ri(+g,+g),null,!0);o!==i.radius&&(s=new Ai(i.element.id+"_MajorGridLine_"+t+"_"+e.visibleLabels.length+1,"transparent",u,e.majorGridLines.width,this.centerX,this.centerY,i.radius),$t(i.enableCanvas,this.element,i.renderer.drawCircle(s),i.redraw,!0,"r","r",new Ri(+g,+g),null,!0))}else{for(let l=0;l<e.visibleLabels.length;l++)o=i.radius*wt(e.visibleLabels[l].value,e),r=this.renderRadarGrid(o,"",i),m=Yt(i.element.id+"_MajorGridLine_"+t+"_"+l),g=m?m.getAttribute("d"):null,s=new I(i.element.id+"_MajorGridLine_"+t+"_"+l,"transparent",e.majorGridLines.width,e.majorGridLines.color||i.themeStyle.majorGridLine,null,null,r),$t(i.enableCanvas,this.element,i.renderer.drawPath(s),i.redraw,!0,"x","y",null,g,!0);o!==i.radius&&(r=this.renderRadarGrid(i.radius,"",i),m=Yt(i.element.id+"_MajorGridLine_"+t+"_"+e.visibleLabels.length),g=m?m.getAttribute("d"):null,s=new I(i.element.id+"_MajorGridLine_"+t+"_"+e.visibleLabels.length,"transparent",e.majorGridLines.width,e.majorGridLines.color||i.themeStyle.majorGridLine,null,null,r),$t(i.enableCanvas,this.element,i.renderer.drawPath(s),i.redraw,!0,"x","y",null,g,!0))}if(e.majorTickLines.width>0){l=Tt(Lt(e.visibleLabels[0].value,e),this.startAngle);for(let s=0;s<e.visibleLabels.length;s++)o=i.radius*wt(e.visibleLabels[s].value,e),h=this.centerX+o*l.x,d=this.centerY+o*l.y,c=h+e.majorTickLines.height*Math.cos(n*Math.PI/180)*("Inside"===e.tickPosition?1:-1),p=d+e.majorTickLines.height*Math.sin(n*Math.PI/180)*("Inside"===e.tickPosition?1:-1),a="M "+h+" "+d+" L "+c+" "+p,this.renderTickLine(e,t,a,"",s)}}renderRadarGrid(e,t,i){let s,o,l,a,r,n;for(let h=0,d=i.primaryXAxis.visibleLabels.length;h<d;h++)s=Tt(Lt(i.primaryXAxis.visibleLabels[h].value,i.primaryXAxis),this.startAngle),o=Tt(Lt(h+1<d?i.primaryXAxis.visibleLabels[h+1].value:i.primaryXAxis.visibleLabels[0].value,i.primaryXAxis),this.startAngle),l=this.centerX+e*s.x,a=this.centerY+e*s.y,r=this.centerX+e*o.x,n=this.centerY+e*o.y,t=t.concat((h?"L ":"M ")+" "+l+" "+a+" L  "+r+" "+n+" ");return t}drawXAxisGridLine(e,t){const i=this.chart;let s,o,l="",a="",r="",n="";const h=this.centerX;let d;const c=this.centerY;let p,u;const g=e.visibleLabels.length;for(let m=0;m<g;m++)s=e.visibleLabels[m].value,o=Tt(Lt(e.visibleLabels[m].value,e),this.startAngle),d=this.centerX+i.radius*o.x,p=this.centerY+i.radius*o.y,l="M "+h+" "+c+" L "+d+" "+p,a="M "+d+" "+p+" L "+(d+e.majorTickLines.height*o.x*("Inside"===e.tickPosition?-1:1))+" "+(p+e.majorTickLines.height*o.y*("Inside"===e.tickPosition?-1:1)),e.minorTicksPerInterval>0&&(e.minorGridLines.width>0||e.minorTickLines.width>0)&&"Category"!==e.valueType&&"Radar"!==i.visibleSeries[0].type&&(u=this.drawAxisMinorLine(e,s,r,n),r=u[0],n=u[1]),this.renderTickLine(e,t,a,n,m),this.renderGridLine(e,t,l,r,m)}drawAxisMinorLine(e,t,i,s){let o,l,a,r=t;const n=e.visibleRange,h=[];for(let d=0;d<e.minorTicksPerInterval;d++)if(r+=("DateTime"===e.valueType?e.dateTimeInterval:e.visibleRange.interval)/(e.minorTicksPerInterval+1),ct(r,n)){a=Tt(Lt(r,e),this.startAngle),o=this.centerX+this.chart.radius*a.x,l=this.centerY+this.chart.radius*a.y;const t=o+e.minorTickLines.height*a.x*("Inside"===e.tickPosition?-1:1),n=l+e.minorTickLines.height*a.y*("Inside"===e.tickPosition?-1:1);i=i.concat("M "+this.centerX+" "+this.centerY+"L "+o+" "+l),s=s.concat("M "+o+" "+l+"L "+t+" "+n)}return h.push(i),h.push(s),h}drawXAxisLabels(e,t){let i;this.visibleAxisLabelRect=[],this.chart.legendModule&&(i=this.chart.legendModule.legendBounds);const s=this.chart;let o=0,l=0;const a=s.renderer.createGroup({id:s.element.id+"AxisLabels"+t});let r,n,h,d;const c="Inside"===e.labelPosition;let p,u,g,m="";const b=[],f=[];f[0]=!0;const y=e.labelIntersectAction,v="Category"===e.valueType&&"BetweenTicks"===e.labelPlacement?.5:0;let x=s.radius+e.majorTickLines.height;x=c?-x:x;for(let w=0,C=e.visibleLabels.length;w<C;w++){if(g=!1,n=Tt(Lt(e.visibleLabels[w].value+v,e),this.startAngle),isNaN(n.x)||isNaN(n.y)||(o=this.centerX+(x+e.majorTickLines.height+5)*n.x,l=this.centerY+(x+e.majorTickLines.height+5)*n.y,m=parseFloat(o.toFixed(1))===parseFloat(this.centerX.toFixed(1))?"middle":o<this.centerX&&!c||o>this.centerX&&c?"end":"start"),u=e.visibleLabels[w],h=u.text,e.enableTrim||"Trim"===y){const t=e.visibleLabels[w].originalText;let i,l;const a=e.labelPosition,r=s.availableSize.width,n=t.length;for(let s=n-1;s>=0;--s)if(i=t.substring(0,s)+"...",l=S(i,e.labelStyle).width,o===r/2?o-l/2>=0&&o+l/2<=r:"Outside"===a&&(o>=r/2&&o+l<=r||o<=r/2&&o-l>=0)||"Inside"===a&&(o+l<=r/2||o-l>=r/2)){h=s===n-1?t:i,u.size.width=S(h,e.labelStyle).width,u.text=h;break}}if(b[w]=this.getLabelRegion(o,l,u,m),0===w?d=o:w===e.visibleLabels.length-1&&"Category"!==e.valueType&&(p=S(h,e.labelStyle).height,p+=o,h=p>d?"":h),0!==w&&"Hide"===y)for(let e=w;e>=0;e--){if(e=0===e?0:e===w?e-1:e,f[e]&&li(b[w],b[e])){g=!0,f[w]=!1;break}f[w]=!0}if(!g&&i&&(g=li(b[w],i),g)){const t=this.getAvailableSpaceToTrim(i,b[w]);t>0&&(h=pi(t,e.visibleLabels[w].originalText,e.labelStyle),g=!1)}r=new L(s.element.id+t+"_AxisLabel_"+w,o,l,m,h,"","central"),g||(this.visibleAxisLabelRect.push(b[w]),bi(s.renderer,r,u.labelStyle,u.labelStyle.color||s.themeStyle.axisLabel,a,!1,s.redraw,!0,!0,null,null,0,null,s.enableCanvas))}this.element.appendChild(a)}getAvailableSpaceToTrim(e,t){const i=e.x,s=i+e.width,o=t.x,l=o+t.width;let a=0;return o>i&&o<s&&l>s?a=l-s:o>i&&o<s&&l<s?a=0:(l>i&&l<s&&o<i||l>i&&l>s&&o<i)&&(a=i-o),a}getLabelRegion(e,t,i,s){return"middle"===s?e-=i.size.width/2:"end"===s?e-=i.size.width:e=e,new C(e,t-=i.size.height/2,i.size.width,i.size.height)}renderTickLine(e,t,i,s,o){let l;const a=this.chart;let r,n;e.majorTickLines.width>0&&(n=Yt(a.element.id+"_MajorTickLine_"+t+"_"+o),r=n?n.getAttribute("d"):null,l=new I(a.element.id+"_MajorTickLine_"+t+"_"+o,"transparent",e.majorTickLines.width,e.majorTickLines.color||a.themeStyle.majorTickLine,null,null,i),n=a.renderer.drawPath(l),this.setPointerEventNone(n),$t(a.enableCanvas,a.yAxisElements,n,a.redraw,!0,"x","y",null,r)),e.minorTickLines.width>0&&(n=Yt(a.element.id+"_MinorTickLine_"+t+"_"+o),r=n?n.getAttribute("d"):null,l=new I(a.element.id+"_MinorTickLine_"+t+"_"+o,"transparent",e.minorTickLines.width,e.minorTickLines.color||a.themeStyle.minorTickLine,null,null,s),n=a.renderer.drawPath(l),this.setPointerEventNone(n),$t(a.enableCanvas,a.yAxisElements,n,a.redraw,!0,"x","y",null,r))}renderGridLine(e,t,i,s,o){const l=this.chart;let a,r,n;e.majorGridLines.width>0&&(n=Yt(l.element.id+"_MajorGridLine_"+t+"_"+o),r=n?n.getAttribute("d"):null,a=new I(l.element.id+"_MajorGridLine_"+t+"_"+o,"transparent",e.majorGridLines.width,e.majorGridLines.color||l.themeStyle.majorGridLine,null,e.majorGridLines.dashArray,i),$t(l.enableCanvas,this.element,l.renderer.drawPath(a),l.redraw,!0,"x","y",null,r)),e.minorGridLines.width>0&&(n=Yt(l.element.id+"_MinorGridLine_"+t+"_"+o),r=n?n.getAttribute("d"):null,a=new I(l.element.id+"_MinorGridLine_"+t+"_"+o,"transparent",e.minorGridLines.width,e.minorGridLines.color||l.themeStyle.minorGridLine,null,e.minorGridLines.dashArray,s),$t(l.enableCanvas,this.element,l.renderer.drawPath(a),l.redraw,!0,"x","y",null,r))}setPointerEventNone(e){e&&e.setAttribute("style","pointer-events:none")}}class Cs extends ws{render(e,t,i,s){let o=kt(e.drawType),l=i.minimum,r=i.maximum;for(let n of e.points)n.visible=n.visible&&!(!(0,a.le)(l)&&n.yValue<l||!(0,a.le)(r)&&n.yValue>r);e.points.length&&(e.drawType.indexOf("Column")>-1?this.columnDrawTypeRender(e,t,i):e.chart[o+"SeriesModule"].render(e,t,i,s))}columnDrawTypeRender(e,t,i){let s,o,l,a,r,n,h,d,c,p,u,g,m,b,f,y,v,S,x,w,C,M=t.actualRange.min,T=e.clipRect.width/2+e.clipRect.x,L=e.clipRect.height/2+e.clipRect.y,A="RangeColumn"===e.drawType,D="Polar"===e.type,R="Logarithmic"===i.valueType,P="StackingColumn"===e.drawType,k="",E=0,F=(e.points[1]?e.points[1].xValue:2*e.points[0].xValue)-e.points[0].xValue,O="Category"===t.valueType&&"BetweenTicks"===t.labelPlacement?0:t.isInversed?-F/2:F/2,N="DateTime"===t.valueType?t.dateTimeInterval:1;this.getSeriesPosition(e);let z=t.isInversed?e.rectCount-1-e.position:e.position;do{E+=N,M+=N}while(M<=t.actualRange.max-("Category"===t.valueType?0:1));for(let _ of e.points)_.symbolLocations=[],_.regions=[],_.visible&&gt(e.points[_.index-1],_,e.points[_.index+1],e)&&(h=t.isInversed?t.visibleRange.max-_.xValue:_.xValue-t.visibleRange.min,r=h+(F/e.rectCount*z-O)+E/360*t.startAngle,r/=E,l=2*Math.PI*(r+t.startAngle),a=2*Math.PI*(r+t.startAngle+F/e.rectCount/E),0===l&&0===a?(a=2*Math.PI,C="1"):C="0",d=l,c=a,l=l-.5*Math.PI+e.columnSpacing/2,a=a-.5*Math.PI-1e-6-e.columnSpacing/2,P||A?(b=A?_.low:e.stackedValues.startValues[_.index],f=A?_.high:e.stackedValues.endValues[_.index],f=R?ht(0===f?1:f,i.logBase):f,f=f>i.actualRange.max?i.actualRange.max:f):(b=i.visibleRange.min,f=_.yValue>i.actualRange.max?i.actualRange.max:_.yValue),n=b===f?0:e.chart.radius*wt(f,i),p=T+n*Math.cos(l),u=T+n*Math.cos(a),g=L+n*Math.sin(l),m=L+n*Math.sin(a),y=e.chart.radius*wt(0===b&&0!==i.visibleRange.min?i.visibleRange.min:b,i),v=T+y*Math.cos(l),S=L+y*Math.sin(l),x=T+y*Math.cos(a),w=L+y*Math.sin(a),k=D?"M "+p+" "+g+" A "+n+" "+n+" 0 "+C+" 1 "+u+" "+m+" L "+x+" "+w+" A "+y+" "+y+" 1 0 0 "+v+" "+S+" Z":"M "+p+" "+g+" L "+u+" "+m+" L "+x+" "+w+" L "+v+" "+S+" Z",_.regionData=new At(d,c,y,n,r),o=this.triggerEvent(e.chart,e,_),s=new I(e.chart.element.id+"_Series_"+e.index+"_Point_"+_.index,o.fill,o.border.width,o.border.color,e.opacity,e.dashArray,k),o.cancel||(this.appendLinePath(s,e,""),D?(_.symbolLocations.push({x:T+n*Math.cos(l+(a-l)/2),y:L+n*Math.sin(l+(a-l)/2)}),A&&_.symbolLocations.push({x:T+y*Math.cos(l+(a-l)/2),y:L+y*Math.sin(l+(a-l)/2)})):(_.symbolLocations.push({x:(p+u)/2,y:(g+m)/2}),A&&_.symbolLocations.push({x:(x+v)/2,y:(w+S)/2}))));this.renderMarker(e),e.isRectSeries=!0}triggerEvent(e,t,i){let s={cancel:!1,name:ce,series:t,point:i,fill:t.setPointColor(i,t.interior),border:t.setBorderColor(i,{width:t.border.width,color:t.border.color})};return e.trigger(ce,s),i.color=s.fill,s}getSeriesPosition(e){let t=e.chart,i=[],s=[],o={rectCount:0,position:null};for(let l of t.visibleSeries)!l.visible||"Polar"!==l.type&&"Radar"!==l.type||-1===l.drawType.indexOf("Column")||i.push(l);for(let l=0;l<i.length;l++){let e=i[l];-1!==e.drawType.indexOf("Stacking")?e.stackingGroup?void 0===s[e.stackingGroup]?(e.position=o.rectCount,s[e.stackingGroup]=o.rectCount++):e.position=s[e.stackingGroup]:null===o.position?(e.position=o.rectCount,o.position=o.rectCount++):e.position=o.position:e.position=o.rectCount++}for(let l=0;l<i.length;l++)i[l].rectCount=o.rectCount}doAnimation(e){let t=e.animation.duration,i=e.animation.delay,s=e.seriesElement.childNodes,o=1;if("Scatter"===e.drawType)for(let l of e.points)l.symbolLocations.length&&s[o]&&(Nt(s[o],i,t,e,l.index,l.symbolLocations[0],!1),o++);else for(o=1;o<s.length;o++)this.doPolarRadarAnimation(s[o],i,t,e)}doPolarRadarAnimation(e,t,i,s){let o=s.clipRect.width/2+s.clipRect.x,l=s.clipRect.height/2+s.clipRect.y,r=0;e.style.visibility="hidden",new a.fw({}).animate(e,{duration:i,delay:t,progress:t=>{t.timeStamp>t.delay&&(t.element.style.visibility="visible",r=(t.timeStamp-t.delay)/t.duration,e.setAttribute("transform","translate("+o+" "+l+") scale("+r+") translate("+-o+" "+-l+")"))},end:()=>{e.style.visibility="visible",e.removeAttribute("transform"),s.chart.trigger("animationComplete",{series:s.chart.isBlazor?{}:s})}})}getPolarIsInversedPath(e,t){let i,s,o,l=this.chart.radius,a=t,r=e.isInversed?"1 1 ":"1 0 ";return i=Tt(Lt(e.visibleLabels[0].value,e),this.startAngle),s=this.centerX+l*i.x,o=this.centerY+l*i.y,a+"L "+s+" "+o+" A "+l+" "+l+" 0 "+r+s+" "+(this.centerY+l)+" A "+l+" "+l+" 0 "+r+s+" "+o+" "}getModuleName(){return"PolarSeries"}destroy(){}}class Ms extends Cs{render(e,t,i,s){let o=kt(e.drawType),l=i.minimum,r=i.maximum;for(let n of e.points)n.visible=n.visible&&!(!(0,a.le)(l)&&n.yValue<l||!(0,a.le)(r)&&n.yValue>r);e.points.length&&(-1===e.drawType.indexOf("Column")?e.chart[o+"SeriesModule"].render(e,t,i,s):this.columnDrawTypeRender(e,t,i))}getRadarIsInversedPath(e,t){let i,s,o,l=this.chart.radius,a=e.visibleLabels.length,r=t;o=Tt(Lt(e.visibleLabels[0].value,e),this.startAngle),s=this.centerY+l*o.y,i=this.centerX+l*o.x,r+=" L "+i+" "+s+" ";for(let n=a-1;n>=0;n--)o=Tt(Lt(e.visibleLabels[n].value,e),this.startAngle),s=this.centerY+l*o.y,i=this.centerX+l*o.x,r+="L "+i+" "+s+" ";return r}getModuleName(){return"RadarSeries"}destroy(){}}class Ts extends fs{render(e){let t,i,s=this.getSideBySideInfo(e),o=e.stackedValues;for(let l of e.points)l.symbolLocations=[],l.regions=[],l.visible&&gt(e.points[l.index-1],l,e.points[l.index+1],e)&&(t=this.getRectangle(l.xValue+s.start,o.endValues[l.index],l.xValue+s.end,o.startValues[l.index],e),i=this.triggerEvent(e,l,e.interior,{width:e.border.width,color:e.border.color}),i.cancel||(this.drawRectangle(e,l,t,i),this.updateSymbolLocation(l,t,e)));this.renderMarker(e)}destroy(){}getModuleName(){return"StackingBarSeries"}doAnimation(e){this.animate(e)}}class Ls extends fs{render(e){e.isRectSeries=!0;const t=this.getSideBySideInfo(e);let i,s;const o=e.stackedValues,l=rt(e);for(const a of l)a.symbolLocations=[],a.regions=[],a.visible&&gt(l[a.index-1],a,l[a.index+1],e)&&(i=this.getRectangle(a.xValue+t.start,o.endValues[a.index],a.xValue+t.end,o.startValues[a.index],e),s=this.triggerEvent(e,a,e.interior,{width:e.border.width,color:e.border.color}),s.cancel||(this.drawRectangle(e,a,i,s),this.updateSymbolLocation(a,i,e)));this.renderMarker(e)}doAnimation(e){this.animate(e)}destroy(){}getModuleName(){return"StackingColumnSeries"}}class As extends ms{render(e,t,i,s){let o,l,a,r="",n="M",h=null;const d=this.enableComplexProperty(e);o="Category"===t.valueType&&"BetweenTicks"===t.labelPlacement?.5:0;for(const p of d)p.symbolLocations=[],p.regions=[],p.visible&&gt(d[p.index-1],p,d[p.index+1],e)?(null!=h?(a=Kt(p.xValue,p.yValue,t,i,s),l=Kt(h.xValue,h.yValue,t,i,s),r=r.concat(n+" "+l.x+" "+l.y+" L "+a.x+" "+l.y+" L "+a.x+" "+a.y+" "),n="L"):(l=Kt(p.xValue-o,p.yValue,t,i,s),r=r.concat(n+" "+l.x+" "+l.y+" "),n="L"),this.storePointLocation(p,e,s,Kt),h=p):(h="Drop"===e.emptyPointSettings.mode?h:null,n="Drop"===e.emptyPointSettings.mode?n:"M");d.length>0&&(l=Kt(d[d.length-1].xValue+o,d[d.length-1].yValue,t,i,s),r=r.concat(n+" "+l.x+" "+l.y+" "));const c=new I(e.chart.element.id+"_Series_"+e.index,"transparent",e.width,e.interior,e.opacity,e.dashArray,r);this.appendLinePath(c,e,""),this.renderMarker(e)}doAnimation(e){this.doLinearAnimation(e,e.animation)}destroy(){}getModuleName(){return"StepLineSeries"}}class Ds extends ms{render(e,t,i,s){let o,l,a=null,r="";const n=this.enableComplexProperty(e),h=n.length,d=Math.max(e.yAxis.visibleRange.min,0);let c,p,u,g=null;u="Category"===t.valueType&&"BetweenTicks"===t.labelPlacement?.5:0;for(let b=0;b<h;b++)c=n[b],p=c.xValue,c.symbolLocations=[],c.regions=[],c.visible&&gt(n[b-1],c,n[b+1],e)&&(null===a&&(a=new Ri(p,0),o=Kt(p-u,d,t,i,s),r+="M "+o.x+" "+o.y+" ",o=Kt(p-u,c.yValue,t,i,s),r+="L "+o.x+" "+o.y+" "),null!=g?(o=Kt(c.xValue,c.yValue,t,i,s),l=Kt(g.xValue,g.yValue,t,i,s),r+="L "+o.x+" "+l.y+" L "+o.x+" "+o.y+" "):"Gap"===e.emptyPointSettings.mode&&(o=Kt(c.xValue,c.yValue,t,i,s),r+="L "+o.x+" "+o.y+" "),this.storePointLocation(c,e,s,Kt),g=c),n[b+1]&&!n[b+1].visible&&"Drop"!==e.emptyPointSettings.mode&&(o=Kt(p+u,d,t,i,s),r+="L "+o.x+" "+o.y,a=null,g=null);h>1&&""!==r?(a={x:n[h-1].xValue+u,y:n[h-1].yValue},l=Kt(a.x,a.y,t,i,s),r+="L "+l.x+" "+l.y+" ",a={x:n[h-1].xValue+u,y:d},l=Kt(a.x,a.y,t,i,s),r+="L "+l.x+" "+l.y+" "):r="";const m=new I(e.chart.element.id+"_Series_"+e.index,e.interior,e.border.width,e.border.color,e.opacity,e.dashArray,r);this.appendLinePath(m,e,""),this.renderMarker(e)}doAnimation(e){this.doLinearAnimation(e,e.animation)}destroy(){}getModuleName(){return"StepAreaSeries"}}class Rs extends ms{render(e,t,i,s){const o="PolarRadar"===e.chart.chartAreaType,l=o?Ct:Kt;let a="";const r=this.enableComplexProperty(e),n=r.length,h=e.stackedValues,d=o?Math.max(e.yAxis.visibleRange.min,h.endValues[0]):Math.max(e.yAxis.visibleRange.min,h.startValues[0]);let c,p,u=0;n>0&&(c=l(r[0].xValue,d,t,i,s,e),a=a.concat("M "+c.x+" "+c.y+" "));const g=e.chart&&"PolarRadar"===e.chart.chartAreaType;for(let b=0;b<n;b++)if(r[b].symbolLocations=[],r[b].regions=[],r[b].visible&&gt(r[b-1],r[b],r[b+1],e))c=l(r[b].xValue,h.endValues[b],t,i,s,e),a=a.concat("L "+c.x+" "+c.y+" "),r[b].symbolLocations.push(l(r[b].xValue,h.endValues[b],t,i,s,e)),r[b].regions.push(new C(r[b].symbolLocations[0].x-e.marker.width,r[b].symbolLocations[0].y-e.marker.height,2*e.marker.width,2*e.marker.height));else if(!g&&"Drop"!==e.emptyPointSettings.mode){for(let o=b-1;o>=u;o--)p=l(r[o].xValue,h.startValues[o],t,i,s,e),a=a.concat("L "+p.x+" "+p.y+" ");r[b+1]&&r[b+1].visible&&(!g||g&&this.withinYRange(r[b+1],i))&&(c=l(r[b+1].xValue,h.startValues[b+1],t,i,s,e),a=a.concat("M "+c.x+" "+c.y+" ")),u=b+1}if("PolarRadar"===e.chart.chartAreaType&&r.length>1){const o=this.getFirstLastVisiblePoint(e.points),r=this.chart;c={x:o.first.xValue,y:h.endValues[o.first.index]},p=l(c.x,c.y,t,i,s,e),a+="L "+p.x+" "+p.y+" ",1===this.chart.visible&&(t.isInversed||i.isInversed)&&(this.chart.enableAnimation=!1,a="Polar"===e.type?r.polarSeriesModule.getPolarIsInversedPath(t,a):r.radarSeriesModule.getRadarIsInversedPath(t,a))}if(!g||g&&e.index!==this.getFirstSeriesIndex(e.chart.visibleSeries))for(let b=n-1;b>=u;b--){if(g&&!r[b].visible)continue;const d=this.getPreviousSeries(e);"Drop"===d.emptyPointSettings.mode&&d.points[b].isEmpty||(p=l(r[b].xValue,h.startValues[b],t,i,s,e),h.startValues[b]===h.endValues[b]&&(p.y=Math.floor(p.y)),a=a.concat((b===n-1&&o?"M":"L")+" "+p.x+" "+p.y+" "))}const m=new I(e.chart.element.id+"_Series_"+e.index,e.interior,e.border.width,e.border.color,e.opacity,e.dashArray,a);this.appendLinePath(m,e,""),this.renderMarker(e)}doAnimation(e){this.doLinearAnimation(e,e.animation)}destroy(){}getModuleName(){return"StackingAreaSeries"}getPreviousSeries(e){const t=e.chart.visibleSeries;for(let i=0,s=t.length;i<s;i++)if(e.index===t[i].index&&0!==i)return t[i-1];return t[0]}getFirstSeriesIndex(e){for(const t of e)if(t.visible)return t.index;return 0}}class Is{render(e,t,i,s){e.isRectSeries=!1;const o=e.marker,l=this.enableComplexProperty(e);let a;const r="PolarRadar"===e.chart.chartAreaType?Ct:Kt;let n;const h=e.chart.redraw;for(const d of l)n=h&&d.symbolLocations?d.symbolLocations[0]:null,d.symbolLocations=[],d.regions=[],d.visible&&gt(l[d.index-1],d,l[d.index+1],e)&&(a={cancel:!1,name:ce,series:e,point:d,fill:e.setPointColor(d,e.interior),border:e.setBorderColor(d,{width:e.border.width,color:e.border.color}),height:o.height,width:o.width,shape:o.shape},e.chart.trigger(ce,a),a.cancel?d.marker={visible:!0}:(d.symbolLocations.push(r(d.xValue,d.yValue,t,i,s,e)),d.color=a.fill,this.refresh(e,d,a,n)))}enableComplexProperty(e){const t=[],i=[],s=e.yAxis.visibleRange,o=e.xAxis.visibleRange,l=e.clipRect,r=e.points,n=Math.abs(s.delta/l.height),h=Math.abs(o.delta/l.width);let d,c=r[0]&&r[0].y>n?0:n,p=r[0]&&r[0].x>h?0:h,u=0,g=0;for(const a of r)a.symbolLocations=[],u=a.yValue?a.yValue:s.min,g=a.xValue?a.xValue:o.min,(Math.abs(c-u)>=n||Math.abs(p-g)>=h)&&(i.push(a),c=u,p=g);for(let m=0;m<i.length;m++)d=i[m],(0,a.le)(d.x)||""===d.x||t.push(d);return t}refresh(e,t,i,s){const o=e.chart;let l,a;const r=e.marker,n=i.point.marker.imageUrl||r.imageUrl,h=new I(o.element.id+"_Series_"+e.index+"_Point_"+t.index,i.fill,i.border.width,i.border.color,e.opacity,null);o.redraw&&Yt(h.id)&&(l="Circle"===i.shape?"c":"",a=Yt(h.id).getAttribute("d")),$t(!1,e.seriesElement,qt(t.symbolLocations[0],i.shape,new w(i.width,i.height),n,h,(t.x.toString(),t.yValue.toString()),e.chart.svgRenderer,e.clipRect),o.redraw,!0,l+"x",l+"y",s,a),t.regions.push(new C(t.symbolLocations[0].x-r.width,t.symbolLocations[0].y-r.height,2*r.width,2*r.height)),t.marker={border:i.border,fill:i.fill,height:i.height,visible:!0,width:i.width,shape:i.shape,imageUrl:n}}doAnimation(e){const t=e.animation.duration,i=e.animation.delay,s=e.seriesElement.childNodes;let o=1;for(const l of e.points)l.symbolLocations.length&&s[o]&&(Nt(s[o],i,t,e,l.index,l.symbolLocations[0],!1),o++)}getModuleName(){return"ScatterSeries"}destroy(){}}class Ps extends fs{render(e){let t;const i=this.getSideBySideInfo(e);let s;for(const o of e.points)o.symbolLocations=[],o.regions=[],o.visible&&gt(e.points[o.index-1],o,e.points[o.index+1],e)&&(t=this.getRectangle(o.xValue+i.start,o.high,o.xValue+i.end,o.low,e),s=this.triggerEvent(e,o,e.interior,{width:e.border.width,color:e.border.color}),s.cancel||(this.updateSymbolLocation(o,t,e),this.drawRectangle(e,o,t,s)));this.renderMarker(e)}getModuleName(){return"RangeColumnSeries"}doAnimation(e){this.animate(e)}destroy(){}}class ks extends ms{render(e,t,i,s){let o,l,a="",r="M";const n=this.enableComplexProperty(e);for(let d=0,c=n.length;d<c;d++){o=n[d],o.symbolLocations=[],o.regions=[];let h=Math.min(o.low,o.high),c=Math.max(o.low,o.high);if(i.isInversed){const e=h;h=c,c=e}const p=Kt(o.xValue,h,t,i,s),u=Kt(o.xValue,c,t,i,s);o.symbolLocations.push(u),o.symbolLocations.push(p);const g=new C(Math.min(p.x,u.x),Math.min(p.y,u.y),Math.max(Math.abs(u.x-p.x),e.marker.width),Math.max(Math.abs(u.y-p.y),e.marker.width));s?g.y-=e.marker.width/2:g.x-=e.marker.width/2,o.regions.push(g),o.visible&&gt(n[o.index-1],o,n[o.index+1],e)?(a=a.concat(r+" "+p.x+" "+p.y+" "),l=!1,(d+1<n.length&&!n[d+1].visible||d===n.length-1)&&(a=this.closeRangeAreaPath(n,o,e,a,d),r="M",a=a.concat(" Z"),l=!0),r="L"):(!1===l&&0!==d&&(a=this.closeRangeAreaPath(n,o,e,a,d),l=!0),r="M",o.symbolLocations=[])}const h=new I("Indicator"===e.category?e.chart.element.id+"_Indicator_"+e.index+"_"+e.name:e.chart.element.id+"_Series_"+e.index,e.interior,e.border.width,e.border.color,e.opacity,e.dashArray,a);this.appendLinePath(h,e,""),this.renderMarker(e)}closeRangeAreaPath(e,t,i,s,o){for(let l=o;l>=0&&e[l].visible&&e[l].symbolLocations[0];l--)s+="L "+(t=e[l]).symbolLocations[0].x+" "+t.symbolLocations[0].y+" ";return s}doAnimation(e){this.doLinearAnimation(e,e.animation)}getModuleName(){return"RangeAreaSeries"}destroy(){}}class Es extends ms{constructor(e){super(e),this.splinePoints=[],this.lowSplinePoints=[]}findSplinePoint(e){let t,i,s=[];const o=[];let l,a=0;s=this.filterEmptyPoints(e);for(let n=0;n<s.length;n++)l=s[n],null!==l.x&&""!==l.x&&(l.index=a,a++,o.push(l));let r=!1;if(this.splinePoints=this.findSplineCoefficients(o,e,r),"SplineRangeArea"===e.type&&(r=!r,this.lowSplinePoints=this.findSplineCoefficients(o,e,r)),o.length>1){e.drawPoints=[],e.lowDrawPoints=[];for(const s of o)if(0!==s.index){const l=this.getPreviousIndex(o,s.index-1,e);"SplineRangeArea"===e.type&&(o[l].yValue=o[l].high>o[l].low?o[l].high:o[l].low,s.yValue=s.high>s.low?s.high:s.low),t=this.getControlPoints(o[l],s,this.splinePoints[l],this.splinePoints[s.index],e),e.drawPoints.push(t),"SplineRangeArea"===e.type&&(o[l].yValue=o[l].low<o[l].high?o[l].low:o[l].high,s.yValue=s.low<s.high?s.low:s.high,i=this.getControlPoints(o[l],s,this.lowSplinePoints[l],this.lowSplinePoints[s.index],e),e.lowDrawPoints.push(i));const a=e.yMax-e.yMin;s.yValue&&t.controlPoint1.y&&t.controlPoint2.y&&a>1&&(e.yMin=Math.min(e.yMin,s.yValue,t.controlPoint1.y,t.controlPoint2.y),e.yMax=Math.ceil(Math.max(e.yMax,s.yValue,t.controlPoint1.y,t.controlPoint2.y)),e.yMin="Logarithmic"!==e.yAxis.valueType?Math.floor(e.yMin):e.yMin)}"PolarRadar"===e.chart.chartAreaType&&e.isClosed&&(t=this.getControlPoints({xValue:o[o.length-1].xValue,yValue:o[o.length-1].yValue},{xValue:o[o.length-1].xValue+1,yValue:o[0].yValue},this.splinePoints[0],this.splinePoints[o[o.length-1].index],e),e.drawPoints.push(t))}}getPreviousIndex(e,t,i){if("Drop"!==i.emptyPointSettings.mode)return t;for(;(0,a.le)(e[t])&&t>-1;)t-=1;return t}getNextIndex(e,t,i){if("Drop"!==i.emptyPointSettings.mode)return t;for(;(0,a.le)(e[t])&&t<e.length;)t+=1;return t}filterEmptyPoints(e,t){if("Drop"!==e.emptyPointSettings.mode&&this.isPointInRange(e.points))return t||e.points;const i=t||(0,a.l7)([],e.points,null,!0);for(let s=0;s<i.length;s++)i[s].index=s,i[s].isEmpty&&(i[s].symbolLocations=[],i[s].regions=[],i.splice(s,1),s--);return i}isPointInRange(e){for(const t of e)if(!t.isPointInRange)return!1;return!0}findSplineCoefficients(e,t,i){let s=[];const o=[];let l=t.cardinalSplineTension?t.cardinalSplineTension:.5;switch(l=l<0?0:l>1?1:l,t.splineType){case"Monotonic":s=this.monotonicSplineCoefficients(e,t,i);break;case"Cardinal":s=this.cardinalSplineCofficients(e,t,i);break;default:"Clamped"===t.splineType?s=this.clampedSplineCofficients(e,t,i):(s[0]=o[0]=0,s[e.length-1]=0),s=this.naturalSplineCoefficients(e,t,i)}return s}monotonicSplineCoefficients(e,t,i){const s=e.length,o=[],l=[],a=[],r=[];let n,h;for(let d=0;d<s-1;d++)"SplineRangeArea"===t.type&&(i||(e[d+1].yValue=e[d+1].high>e[d+1].low?e[d+1].high:e[d+1].low,e[d].yValue=e[d].high>e[d].low?e[d].high:e[d].low),i&&(e[d+1].yValue=e[d+1].low<e[d+1].high?e[d+1].low:e[d+1].high,e[d].yValue=e[d].low<e[d].high?e[d].low:e[d].high)),l[d]=e[d+1].xValue-e[d].xValue,a[d]=e[d+1].yValue-e[d].yValue,r[d]=a[d]/l[d];h=r.length,o[0]=r[0],o[s-1]=r[h-1];for(let d=0;d<l.length;d++)h>d+1&&(r[d]*r[d+1]<=0?o[d+1]=0:(n=l[d]+l[d+1],o[d+1]=3*n/((n+l[d+1])/r[d]+(n+l[d])/r[d+1])));return o}cardinalSplineCofficients(e,t,i){const s=e.length,o=[];let l=t.cardinalSplineTension?t.cardinalSplineTension:.5;l=l<0?0:l>1?1:l;for(let a=0;a<s;a++)o[a]=0===a?s>2?l*(e[a+2].xValue-e[a].xValue):0:a===s-1?s>2?l*(e[s-1].xValue-e[s-3].xValue):0:l*(e[a+1].xValue-e[a-1].xValue);return o}clampedSplineCofficients(e,t,i){const s=e.length,o=[],l=[];for(let a=0;a<s-1;a++)"SplineRangeArea"===t.type&&(i||(e[1].yValue=e[1].high>e[1].low?e[1].high:e[1].low,e[0].yValue=e[0].high>e[0].low?e[0].high:e[0].low,e[e.length-1].yValue=e[e.length-1].high>e[e.length-1].low?e[e.length-1].high:e[e.length-1].low,e[e.length-2].yValue=e[e.length-2].high>e[e.length-2].low?e[e.length-2].high:e[e.length-2].low),i&&(e[1].yValue=e[1].low<e[1].high?e[1].low:e[1].high,e[0].yValue=e[0].low<e[0].high?e[0].low:e[0].high,e[e.length-1].yValue=e[e.length-1].low<e[e.length-1].high?e[e.length-1].low:e[e.length-1].high,e[e.length-2].yValue=e[e.length-2].low<e[e.length-2].high?e[e.length-2].low:e[e.length-2].high)),o[0]=3*(e[1].yValue-e[0].yValue)/(e[1].xValue-e[0].xValue)-3,l[0]=.5,o[e.length-1]=3*(e[e.length-1].yValue-e[e.length-2].yValue)/(e[e.length-1].xValue-e[e.length-2].xValue),o[0]=l[0]=Math.abs(o[0])===1/0?0:o[0],o[e.length-1]=l[e.length-1]=Math.abs(o[e.length-1])===1/0?0:o[e.length-1];return o}naturalSplineCoefficients(e,t,i){const s=e.length,o=[],l=[];let a,r,n,h,d;o[0]=l[0]=0,o[e.length-1]=0;for(let c=1;c<s-1;c++)if("SplineRangeArea"===t.type&&(i||(e[c+1].yValue=e[c+1].low>e[c+1].high?e[c+1].low:e[c+1].high,e[c].yValue=e[c].low>e[c].high?e[c].low:e[c].high,e[c-1].yValue=e[c-1].low>e[c-1].high?e[c-1].low:e[c-1].high),i&&(e[c+1].yValue=e[c+1].high<e[c+1].low?e[c+1].high:e[c+1].low,e[c].yValue=e[c].high<e[c].low?e[c].high:e[c].low,e[c-1].yValue=e[c-1].high<e[c-1].low?e[c-1].high:e[c-1].low)),n=e[c].xValue-e[c-1].xValue,h=e[c+1].xValue-e[c-1].xValue,d=e[c+1].xValue-e[c].xValue,a=e[c+1].yValue-e[c].yValue||null,r=e[c].yValue-e[c-1].yValue||null,0===n||0===h||0===d)o[c]=0,l[c]=0;else{const e=1/(n*o[c-1]+2*h);o[c]=-e*d,l[c]=e*(6*(a/d-r/n)-n*l[c-1])}for(let c=s-2;c>=0;c--)o[c]=o[c]*o[c+1]+l[c];return o}getControlPoints(e,t,i,s,o){let l,a,r,n=i,h=s;const d=e.xValue,c=e.yValue,p=t.xValue,u=t.yValue;switch(o.splineType){case"Cardinal":"DateTime"===o.xAxis.valueType&&(n=i/this.dateTimeInterval(o),h=s/this.dateTimeInterval(o)),l=new Ri(d+i/3,c+n/3),a=new Ri(p-s/3,u-h/3),r=new Fi(l,a);break;case"Monotonic":const e=(p-d)/3;l=new Ri(d+e,c+i*e),a=new Ri(p-e,u-s*e),r=new Fi(l,a);break;default:const t=1/3;let g=p-d;g*=g;const m=t*(c+2*u-t*g*(.5*i+s));l=new Ri((2*d+p)*t,t*(2*c+u-t*g*(i+.5*s))),a=new Ri((d+2*p)*t,m),r=new Fi(l,a)}return r}dateTimeInterval(e){const t=e.xAxis.actualIntervalType;let i;return i="Years"===t?31536e6:"Months"===t?2592e6:"Days"===t?864e5:"Hours"===t?36e5:"Minutes"===t?6e4:"Seconds"===t?1e3:2592e6,i}doAnimation(e){this.doLinearAnimation(e,e.animation)}}class Fs{render(e,t,i,s){const o=e.marker,l=e.points;let a,r,n,h;const d=Math.max(e.chart.initialClipRect.height,e.chart.initialClipRect.width),c=d/100;let p,u,g=e.maxRadius*c,m=e.minRadius*c,b=null,f=null;const y=e.chart.redraw;if(null===e.maxRadius||null===e.minRadius){for(const t of e.chart.visibleSeries)"Bubble"!==t.type||!0!==t.visible||null!==t.maxRadius&&null!==t.minRadius||(b=t.sizeMax>b?t.sizeMax:b);f=d/5/2,m=g=1,h=f*g}else b=e.sizeMax,h=g-m;for(const v of l)v.symbolLocations=[],v.regions=[],v.visible&&gt(l[v.index-1],v,l[v.index+1],e)&&(n=null===e.maxRadius||null===e.minRadius?h*Math.abs(+v.size/b):m+h*Math.abs(+v.size/b),n=n||m,r={cancel:!1,name:ce,series:e,point:v,fill:e.setPointColor(v,e.interior),border:e.setBorderColor(v,{width:e.border.width,color:e.border.color}),height:2*n,width:2*n},e.chart.trigger(ce,r),r.cancel?v.marker={visible:!1}:(v.symbolLocations.push(Kt(v.xValue,v.yValue,t,i,s)),v.color=r.fill,a=new I(e.chart.element.id+"_Series_"+e.index+"_Point_"+v.index,r.fill,r.border.width,r.border.color,e.opacity,null),p=qt(v.symbolLocations[0],"Circle",new w(r.width,r.height),o.imageUrl,a,(v.x.toString(),v.yValue.toString()),e.chart.svgRenderer,e.clipRect),$t(!1,e.seriesElement,p,y),v.regions.push(new C(v.symbolLocations[0].x-n,v.symbolLocations[0].y-n,2*n,2*n)),v.marker={border:r.border,fill:r.fill,height:r.height,visible:!0,shape:"Circle",width:r.width},u=y?v.symbolLocations[0]:null,y&&mi(p,300,u,v.symbolLocations[0],"cx","cy")))}destroy(){}getModuleName(){return"BubbleSeries"}doAnimation(e){const t=e.animation.duration,i=e.animation.delay,s=e.seriesElement.childNodes;let o=1;for(const l of e.points)l.symbolLocations.length&&(Nt(s[o],i,t,e,l.index,l.symbolLocations[0],!1),o++)}}class Os extends Es{render(e,t,i,s){let o=null,l="",a="M",r=[];const n="TrendLine"===e.category?e.points:this.enableComplexProperty(e);let h;r=this.filterEmptyPoints(e,n);const d="PolarRadar"===e.chart.chartAreaType?Ct:Kt;for(const p of r)h=this.getPreviousIndex(r,p.index-1,e),p.symbolLocations=[],p.regions=[],p.visible&&gt(r[h],p,r[this.getNextIndex(r,p.index-1,e)],e)?(null!==o&&(l=this.getSplineDirection(e.drawPoints[h],o,p,t,i,s,e,a,d,l),a="L"),o=p,this.storePointLocation(p,e,s,d)):(a="M",o=null,p.symbolLocations=[]);if(r.length>0&&e.drawPoints.length>0&&"PolarRadar"===e.chart.chartAreaType&&e.isClosed){const o=this.getFirstLastVisiblePoint(r);l=this.getSplineDirection(e.drawPoints[e.drawPoints.length-1],o.last,{xValue:o.first.xValue,yValue:o.first.yValue},t,i,s,e,a,d,l),a="L"}const c=new I("TrendLine"===e.category?e.chart.element.id+"_Series_"+e.sourceIndex+"_TrendLine_"+e.index:e.chart.element.id+"_Series_"+e.index,"transparent",e.width,e.interior,e.opacity,e.dashArray,l);this.appendLinePath(c,e,""),this.renderMarker(e)}getSplineDirection(e,t,i,s,o,l,a,r,n,h){const d=e.controlPoint1,c=e.controlPoint2,p=n(t.xValue,t.yValue,s,o,l,a),u=n(i.xValue,i.yValue,s,o,l,a),g=n(d.x,d.y,s,o,l,a),m=n(c.x,c.y,s,o,l,a);return h.concat(r+" "+p.x+" "+p.y+" C "+g.x+" "+g.y+" "+m.x+" "+m.y+" "+u.x+" "+u.y+" ")}getModuleName(){return"SplineSeries"}destroy(){}}class Ns extends Es{render(e,t,i,s){let o,l,a,r,n,h=null,d="",c=null,p=null,u=[];const g=[];let m,b=0;u=this.filterEmptyPoints(e);for(let x=0;x<u.length;x++)m=u[x],null!==m.x&&""!==m.x&&(m.index=b,b++,g.push(m));const f=g.length;let y;const v="PolarRadar"===e.chart.chartAreaType?Ct:Kt,S="PolarRadar"===e.chart.chartAreaType?e.points[0].yValue:Math.max(e.yAxis.visibleRange.min,0);for(let x=0;x<f;x++)m=g[x],m.symbolLocations=[],m.regions=[],y=this.getPreviousIndex(g,m.index-1,e),m.visible&&gt(g[y],m,g[this.getNextIndex(g,m.index-1,e)],e)?(h?(r=e.drawPoints[y].controlPoint1,n=e.drawPoints[y].controlPoint2,o=v(m.xValue,m.yValue,t,i,s,e),l=v(r.x,r.y,t,i,s,e),a=v(n.x,n.y,t,i,s,e),d=d.concat("C "+l.x+" "+l.y+" "+a.x+" "+a.y+" "+o.x+" "+o.y+" ")):(c=v(m.xValue,S,t,i,s,e),d+="M "+c.x+" "+c.y+" ",p=v(m.xValue,m.yValue,t,i,s,e),d+="L "+p.x+" "+p.y+" "),this.storePointLocation(m,e,s,v),h=m):(h=null,m.symbolLocations=[]),(x+1<f&&!g[x+1].visible||x===f-1)&&o&&c&&(c=v(m.xValue,S,t,i,s,e),d=d.concat("L "+c.x+" "+c.y));this.appendLinePath(new I(e.chart.element.id+"_Series_"+e.index,e.interior,e.border.width,e.border.color,e.opacity,e.dashArray,d),e,""),this.renderMarker(e)}getModuleName(){return"SplineAreaSeries"}destroy(){}}class zs{constructor(e){this.arrowLocation=new Ri(0,0),this.rx=2,this.ry=2,this.chart=e,this.elementID=this.chart.element.id,this.svgRenderer=new y(this.chart.element.id),this.addEventListener()}addEventListener(){if(this.chart.isDestroyed)return;const e=a.AR.isPointer?"pointerleave":"mouseleave";this.chart.on(a.AR.touchMoveEvent,this.mouseMoveHandler,this),this.chart.on(a.AR.touchEndEvent,this.mouseUpHandler,this),this.chart.on(e,this.mouseLeaveHandler,this),this.chart.on("tapHold",this.longPress,this)}mouseUpHandler(){this.chart.startMove&&this.removeCrosshair(2e3)}mouseLeaveHandler(){this.removeCrosshair(1e3)}mouseMoveHandler(e){const t=this.chart;"touchmove"===e.type&&(a.AR.isIos||a.AR.isIos7)&&t.startMove&&e.preventDefault&&e.preventDefault(),t.disableTrackTooltip||(Dt(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect)?!t.startMove&&t.isTouch||this.crosshair():this.removeCrosshair(1e3))}longPress(){const e=this.chart;return Dt(e.mouseX,e.mouseY,e.chartAxisLayoutPanel.seriesClipRect)&&this.crosshair(),!1}crosshair(){const e=this.chart;let t,i="",s="",o=document.getElementById(this.elementID+"_crosshair_axis");const l=e.crosshair;let r=document.getElementById(this.elementID+"_tooltip");const n=e.chartAxisLayoutPanel.seriesClipRect,h=e.enableCanvas?document.getElementById(this.elementID+"_Secondary_Element"):document.getElementById(this.elementID+"_UserInteraction");let d,c=document.getElementById(this.elementID+"_Crosshair");return e.enableCanvas&&(c||(c=(0,a.az)("div",{id:this.elementID+"_Crosshair",styles:"position: absolute; pointer-events: none"}),h.appendChild(c))),this.stopAnimation(),e.tooltip.enable&&!Dt(e.tooltipModule.valueX,e.tooltipModule.valueY,n)?null:e.stockChart&&e.stockChart.onPanning?(this.removeCrosshair(1e3),null):(this.valueX=e.tooltip.enable?e.tooltipModule.valueX:e.mouseX,this.valueY=e.tooltip.enable?e.tooltipModule.valueY:e.mouseY,e.enableCanvas||h.setAttribute("opacity","1"),"Both"!==l.lineType&&"Horizontal"!==l.lineType||(i+="M "+n.x+" "+this.valueY+" L "+(n.x+n.width)+" "+this.valueY),"Both"!==l.lineType&&"Vertical"!==l.lineType||(s+="M "+this.valueX+" "+n.y+" L "+this.valueX+" "+(n.y+n.height)),void(e.enableCanvas?(o||(o=this.svgRenderer.createGroup({id:this.elementID+"_crosshair_axis"})),d=this.svgRenderer.createSvg({id:e.tooltip.enable?e.element.id+"_tooltip_svg":e.element.id+"_svg",width:e.availableSize.width,height:e.availableSize.height}),e.tooltip.enable&&(r=r||e.tooltipModule.createElement(),r.appendChild(d),h.appendChild(r)),t=new I(this.elementID+"_HorizontalLine","none",l.line.width,l.line.color||e.themeStyle.crosshairLine,1,l.dashArray,i),this.drawCrosshairLine(t,c,n.x,this.valueY,n.width,0,i),t.d=s,t.id=this.elementID+"_VerticalLine",this.drawCrosshairLine(t,c,this.valueX,n.y,0,n.height,s),this.renderAxisTooltip(e,n,o),d.appendChild(o),e.tooltip.enable||c.appendChild(d)):0===h.childNodes.length?(o=e.renderer.createGroup({id:this.elementID+"_crosshair_axis"}),t=new I(this.elementID+"_HorizontalLine","none",l.line.width,l.line.color||e.themeStyle.crosshairLine,1,l.dashArray,i),this.renderCrosshairLine(t,h),t.d=s,t.id=this.elementID+"_VerticalLine",this.renderCrosshairLine(t,h),h.appendChild(o),this.renderAxisTooltip(e,n,h.lastChild)):(document.getElementById(this.elementID+"_HorizontalLine").setAttribute("d",i),document.getElementById(this.elementID+"_VerticalLine").setAttribute("d",s),this.renderAxisTooltip(e,n,h.lastChild))))}renderCrosshairLine(e,t){const i=this.chart.renderer.drawPath(e);t.appendChild(i)}drawCrosshairLine(e,t,i,s,o,l,r){if(!document.getElementById(e.id)&&r){const i=(0,a.az)("div",{id:e.id});t.appendChild(i)}if(document.getElementById(e.id)){const a="top:"+s.toString()+"px;left:"+i.toString()+"px;width:"+o+"px;height:"+l+"px;fill:"+e.stroke+";border: 0.5px solid black;position: absolute",r=document.getElementById(e.id),n=document.getElementById(this.elementID+"_crosshair_axis");r.setAttribute("style",a),t.style.opacity="1",n&&(n.style.opacity="1")}}renderAxisTooltip(e,t,i){let s,o,l,a,r,n,h,d;for(let c=0,p=e.axisCollections.length;c<p;c++)if(s=e.axisCollections[c],d=s.placeNextToAxisLine?s.updatedRect:s.rect,s.crosshairTooltip.enable)if(this.valueX<=d.x+d.width&&d.x<=this.valueX||this.valueY<=d.y+d.height&&d.y<=this.valueY){if(a=document.getElementById(this.elementID+"_axis_tooltip_"+c),r=document.getElementById(this.elementID+"_axis_tooltip_text_"+c),o=this.getAxisText(s),!o)continue;l=this.tooltipLocation(o,s,t,d),null===a&&(a=e.enableCanvas?this.svgRenderer.drawPath({id:this.elementID+"_axis_tooltip_"+c,fill:s.crosshairTooltip.fill||e.themeStyle.crosshairFill}):e.renderer.drawPath({id:this.elementID+"_axis_tooltip_"+c,fill:s.crosshairTooltip.fill||e.themeStyle.crosshairFill},null),i.appendChild(a),n=new L(this.elementID+"_axis_tooltip_text_"+c,0,0,"start",o),r=bi(e.enableCanvas?this.svgRenderer:e.renderer,n,s.crosshairTooltip.textStyle,s.crosshairTooltip.textStyle.color||e.themeStyle.crosshairLabel,i,null,null,null,null,null,null,0,null,e.enableCanvas)),h=x(this.rx,this.ry,l,this.arrowLocation,10,this.isTop,this.isBottom,this.isLeft,this.valueX,this.valueY),a.setAttribute("d",h),r.textContent=o,r.setAttribute("x",(l.x+5).toString()),r.setAttribute("y",(l.y+5+3*this.elementSize.height/4).toString())}else nt(this.elementID+"_axis_tooltip_"+c),nt(this.elementID+"_axis_tooltip_text_"+c)}getAxisText(e){let t;this.isBottom=!1,this.isTop=!1,this.isLeft=!1,this.isRight=!1;const i="Category"===e.valueType&&"BetweenTicks"===e.labelPlacement?.5:0;return"Horizontal"===e.orientation?(t=Rt(Math.abs(this.valueX-e.rect.x),e.rect.width,e)+i,this.isBottom=!e.opposedPosition,this.isTop=e.opposedPosition):(t=It(Math.abs(this.valueY-e.rect.y),e.rect.height,e)+i,this.isRight=e.opposedPosition,this.isLeft=!e.opposedPosition),"DateTime"===e.valueType?e.format(new Date(t)):"Category"===e.valueType?e.labels[Math.floor(t)]:"DateTimeCategory"===e.valueType?this.chart.dateTimeCategoryModule.getIndexedAxisLabel(e.labels[Math.floor(t)],e.format):"Logarithmic"===e.valueType?e.format(Math.pow(e.logBase,t)):e.labelFormat&&null!==e.labelFormat.match("{value}")?e.labelFormat.replace("{value}",e.format(t)):e.format(t)}tooltipLocation(e,t,i,s){let o;const l=i.x,a=i.y,r="Inside"===t.labelPosition;let n=t.scrollbarSettings.enable||t.zoomingScrollBar&&t.zoomingScrollBar.svgObject?t.scrollBarHeight:0;if(this.elementSize=S(e,t.crosshairTooltip.textStyle),"Horizontal"===t.orientation){const e=r?s.y-this.elementSize.height-10:s.y+10;this.arrowLocation=new Ri(this.valueX,r?s.y-this.elementSize.height-20:s.y+n),o=new C(this.valueX-this.elementSize.width/2-5,e+(r?0:n),this.elementSize.width+10,this.elementSize.height+10),t.opposedPosition&&(o.y=r?s.y:s.y-(this.elementSize.height+10+10)-n),o.x<l&&(o.x=l),o.x+o.width>l+i.width&&(o.x-=o.x+o.width-(l+i.width)),this.arrowLocation.x+5>o.x+o.width-this.rx&&(this.arrowLocation.x=o.x+o.width-this.rx-5),this.arrowLocation.x-5<o.x+this.rx&&(this.arrowLocation.x=o.x+this.rx+5)}else n*=t.opposedPosition?1:-1,this.arrowLocation=new Ri(s.x,this.valueY),o=new C((r?s.x-n:s.x-this.elementSize.width-20)+n,this.valueY-this.elementSize.height/2-5,this.elementSize.width+10,this.elementSize.height+10),t.opposedPosition?(o.x=r?s.x-this.elementSize.width-10:s.x+10+n,o.x+o.width>this.chart.availableSize.width&&(this.arrowLocation.x-=o.x+o.width-this.chart.availableSize.width,o.x-=o.x+o.width-this.chart.availableSize.width)):o.x<0&&(this.arrowLocation.x-=o.x,o.x=0),o.y<a&&(o.y=a),o.y+o.height>=a+i.height&&(o.y-=o.y+o.height-(a+i.height)),this.arrowLocation.y+5>o.y+o.height-this.ry&&(this.arrowLocation.y=o.y+o.height-this.ry-5),this.arrowLocation.y-5<o.y+this.ry&&(this.arrowLocation.y=o.y+this.ry+5);return o}stopAnimation(){si(this.crosshairInterval)}progressAnimation(){si(this.crosshairInterval)}removeCrosshair(e){const t=this.chart,i=t.enableCanvas?document.getElementById(this.elementID+"_Crosshair"):document.getElementById(this.elementID+"_UserInteraction"),s=t.enableCanvas?document.getElementById(this.elementID+"_crosshair_axis"):null;this.stopAnimation(),i&&"0"!==i.getAttribute("opacity")&&(this.crosshairInterval=+setTimeout(()=>{new a.fw({}).animate(i,{duration:200,progress:e=>{i.style.animation="",t.enableCanvas?(i.style.opacity=(1-e.timeStamp/e.duration).toString(),s.style.opacity=(1-e.timeStamp/e.duration).toString()):i.setAttribute("opacity",(1-e.timeStamp/e.duration).toString())},end:()=>{t.enableCanvas?(i.style.opacity="0",s.style.opacity="0"):i.setAttribute("opacity","0"),t.startMove=!1,t.tooltipModule&&(t.tooltipModule.valueX=null,t.tooltipModule.valueY=null)}})},e))}getModuleName(){return"Crosshair"}destroy(){}}class _s extends _i{constructor(e){super(e),this.element=this.chart.element,this.textStyle=e.tooltip.textStyle,this.control=e}getElement(e){return document.getElementById(e)}getTooltipElement(e){this.inverted=this.chart.requireInvertedAxis,this.header=null===this.control.tooltip.header?this.control.tooltip.shared?"<b>${point.x}</b>":"<b>${series.name}</b>":this.control.tooltip.header,this.formattedText=[];const t=document.getElementById(this.chart.element.id+"_tooltip"),i=this.chart.element.id.indexOf("stockChart")>-1;return!e&&!t||i?this.createElement():null}createElement(){const e=document.createElement("div");return e.id=this.element.id+"_tooltip",e.className="ejSVGTooltip",e.setAttribute("style","pointer-events:none; position:absolute;z-index: 1"),e}pushData(e,t,i,s){return!!e.series.enableTooltip&&(this.currentPoints.push(e),this.stopAnimation(),i&&!document.getElementById(i.id)&&(this.chart.stockChart?document.getElementById(this.chart.stockChart.element.id+"_Secondary_Element").appendChild(i):document.getElementById(this.element.id+"_Secondary_Element").appendChild(i)),!0)}removeHighlight(){let e,t;for(let i=0,s=this.previousPoints.length;i<s;i++)e=this.previousPoints[i],e.series.isRectSeries?e.series.visible&&this.highlightPoint(e.series,e.point.index,!1):(t=e.series,t.marker.visible||"Scatter"===e.series.type||"Bubble"===e.series.type||(this.previousPoints.shift(),s-=1))}highlightPoint(e,t,i){const s=this.getElement(this.element.id+"_Series_"+e.index+"_Point_"+t),o=this.control.accumulationSelectionModule,l=!!(o&&o.selectedDataIndexes.length>0);s&&(!l||l&&s.getAttribute("class")&&-1===s.getAttribute("class").indexOf("_ej2_chart_selection_series_")?s.setAttribute("opacity",(i?e.opacity/2:e.opacity).toString()):s.setAttribute("opacity",e.opacity.toString()))}highlightPoints(){for(const e of this.currentPoints)e.series.isRectSeries&&"Series"===e.series.category&&this.highlightPoint(e.series,e.point.index,!0)}createTooltip(e,t,i,s,o,l,a,r,n=null,h=null,d){const c=this.currentPoints[0].series,p=e.tooltipModule||e.accumulationTooltipModule;if(!p)return;let u=c.isRectSeries&&"Waterfall"!==c.type&&o&&o.y<0,g=this.chart.requireInvertedAxis&&c.isRectSeries,m=null;if(this.text.length<=1){let t,s,a=d||e.tooltip.template;if(a&&"chart"===e.getModuleName()&&"#"!==a[0]&&"string"==typeof a){const e=document.createElement("div");e.id="testing_template",e.className="ejSVGTooltip",e.setAttribute("style","pointer-events:none; position:absolute;z-index: 1"),document.getElementById(this.chart.element.id+"_Secondary_Element").appendChild(e);const i=a.replaceAll("${x}",o.x).replaceAll("${y}",o.y);e.innerHTML=i,t=new w(e.firstElementChild.offsetWidth,e.firstElementChild.offsetHeight),s=new w(0,0),e.remove()}else t=S(this.text[0],e.tooltip.textStyle),s=""!==this.header&&"<b></b>"!==this.header?S(this.header,this.textStyle):new w(0,0);const n=47;t.width=Math.max(t.width,s.width)+(l.length>0?n:0),t.height=t.height+s.height+(32+(s.height>0?20:0)),m=this.getCurrentPosition(u,g),m=this.getPositionBySize(t,new C(0,0,r.width,r.height),i,m),u="Left"===m||"Bottom"===m,g="Left"===m||"Right"===m}t?this.svgTooltip=new _({opacity:e.tooltip.opacity,header:this.headerText,content:this.text,fill:e.tooltip.fill,border:e.tooltip.border,enableAnimation:e.tooltip.enableAnimation,location:i,shared:e.tooltip.shared,shapes:l,clipBounds:"PolarRadar"===this.chart.chartAreaType?new Ri(0,0):s,areaBounds:r,palette:this.findPalette(),template:d||e.tooltip.template,data:h,theme:e.theme,offset:a,textStyle:e.tooltip.textStyle,isNegative:u,inverted:g,arrowPadding:this.text.length>1||this.chart.stockChart?0:12,availableSize:e.availableSize,duration:this.chart.tooltip.duration,isCanvas:this.chart.enableCanvas,isTextWrap:e.tooltip.enableTextWrap&&"chart"===e.getModuleName(),blazorTemplate:{name:"Template",parent:this.chart.tooltip},controlInstance:this.chart,tooltipPlacement:m,tooltipRender:()=>{p.removeHighlight(),p.highlightPoints(),p.updatePreviousPoint(n)},animationComplete:e=>{e.tooltip.fadeOuted&&p.fadeOut(p.previousPoints)}},"#"+this.element.id+"_tooltip"):this.svgTooltip&&(this.svgTooltip.location=i,this.svgTooltip.content=this.text,this.svgTooltip.header=this.headerText,this.svgTooltip.offset=a,this.svgTooltip.palette=this.findPalette(),this.svgTooltip.shapes=l,this.svgTooltip.data=h,this.svgTooltip.template=e.tooltip.template,this.svgTooltip.textStyle=e.tooltip.textStyle,this.svgTooltip.isNegative=u,this.svgTooltip.inverted=g,this.svgTooltip.clipBounds="PolarRadar"===this.chart.chartAreaType?new Ri(0,0):s,this.svgTooltip.arrowPadding=this.text.length>1||this.chart.stockChart?0:12,this.svgTooltip.tooltipPlacement=m,this.svgTooltip.dataBind()),this.chart.isReact&&this.chart.renderReactTemplates()}getPositionBySize(e,t,i,s){const o=this.isTooltipFitPosition("Top",new C(0,0,t.width,t.height),i,e),l=this.isTooltipFitPosition("Bottom",new C(0,0,t.width,t.height),i,e),a=this.isTooltipFitPosition("Right",new C(0,0,t.width,t.height),i,e),r=this.isTooltipFitPosition("Left",new C(0,0,t.width,t.height),i,e);let n;if(!(o||l||a||r)){const e=[i.x-t.x,t.x+t.width-i.x,i.y-t.y,t.y+t.height-i.y],s=e.indexOf(Math.max.apply(this,e));return 0===s?"Left":1===s?"Right":2===s?"Top":"Bottom"}return n="Top"===s?o?"Top":l?"Bottom":a?"Right":"Left":"Bottom"===s?l?"Bottom":o?"Top":a?"Right":"Left":"Right"===s?a?"Right":r?"Left":o?"Top":"Bottom":r?"Left":a?"Right":o?"Top":"Bottom",n}isTooltipFitPosition(e,t,i,s){const o=new Ri(0,0),l=new Ri(0,0);switch(e){case"Top":o.x=i.x-s.width/2,o.y=i.y-s.height,l.x=i.x+s.width/2,l.y=i.y;break;case"Bottom":o.x=i.x-s.width/2,o.y=i.y,l.x=i.x+s.width/2,l.y=i.y+s.height;break;case"Right":o.x=i.x,o.y=i.y-s.height/2,l.x=i.x+s.width,l.y=i.y+s.height/2;break;case"Left":o.x=i.x-s.width,o.y=i.y-s.height/2,l.x=i.x,l.y=i.y+s.height/2}return Dt(o.x,o.y,t)&&Dt(l.x,l.y,t)}getCurrentPosition(e,t){let i;return i=t?e?"Left":"Right":e?"Bottom":"Top",i}findPalette(){const e=[];for(const t of this.currentPoints)e.push(this.findColor(t,t.series));return e}findColor(e,t){return!t.isRectSeries||"Candle"!==t.type&&"Hilo"!==t.type&&"HiloOpenClose"!==t.type?(e.point.color&&"#ffffff"!==e.point.color?e.point.color:e.point.interior)||t.marker.fill||t.interior:e.point.color}updatePreviousPoint(e){e&&(this.currentPoints=this.currentPoints.concat(e)),this.previousPoints=(0,a.l7)([],this.currentPoints,null,!0)}fadeOut(e){const t=this.getElement(this.chart.enableCanvas?this.element.id+"_tooltip_group":this.element.id+"_tooltip_svg");t&&parseInt(t.getAttribute("opacity"),10)>0||(this.valueX=null,this.valueY=null,this.currentPoints=[],this.removeHighlight(),this.removeHighlightedMarker(e),this.svgTooltip=null,this.control.trigger("animationComplete",{}))}removeHighlightedMarker(e){if(this.chart.markerRender){for(const t of e)nt(this.element.id+"_Series_"+t.series.index+"_Point_"+t.point.index+"_Trackball");this.chart.markerRender.removeHighlightedMarker()}this.previousPoints=[]}removeText(){this.textElements=[];const e=this.getElement(this.element.id+"_tooltip_group");if(e&&e.childNodes.length>0)for(;e.lastChild&&1!==e.childNodes.length;)e.removeChild(e.lastChild)}stopAnimation(){si(this.toolTipInterval)}removeTooltip(e){const t=this.getElement(this.element.id+"_tooltip"),i=t?this.getElement(t.id+"parent_template"):null,s=i&&"<div></div>"!==i.innerHTML;this.stopAnimation(),this.chart.isReact&&s&&this.chart.clearTemplate([i.id],[0]),t&&this.previousPoints.length>0&&(this.toolTipInterval=+setTimeout(()=>{this.svgTooltip&&this.svgTooltip.fadeOut()},e))}}class Bs extends _s{constructor(e){super(e),this.addEventListener()}addEventListener(){this.chart.isDestroyed||(this.chart.on(a.AR.isPointer?"pointerleave":"mouseleave",this.mouseLeaveHandler,this),this.chart.on("tapHold",this.longPress,this),this.chart.on(a.AR.touchMoveEvent,this.mouseMoveHandler,this),this.chart.on(a.AR.touchEndEvent,this.mouseUpHandler,this))}mouseUpHandler(){const e=this.control;e.isTouch&&!this.isSelected(e)&&(Dt(e.mouseX,e.mouseY,e.chartAxisLayoutPanel.seriesClipRect)&&e.tooltip.shared||!e.tooltip.shared)&&(e.crosshair.enable?e.startMove&&this.removeTooltip(2e3):(this.tooltip(),this.removeTooltip(2e3)))}mouseLeaveHandler(){this.removeTooltip(this.chart.tooltip.fadeOutDuration)}mouseMoveHandler(){const e=this.chart;e.disableTrackTooltip||this.isSelected(e)||(e.tooltip.shared||e.isTouch&&!e.startMove||this.tooltip(),Dt(e.mouseX,e.mouseY,e.chartAxisLayoutPanel.seriesClipRect)?!e.tooltip.shared||e.isTouch&&!e.startMove||this.tooltip():e.tooltip.shared&&this.removeTooltip(this.chart.tooltip.fadeOutDuration))}longPress(){const e=this.chart;return e.crosshair.enable&&Dt(e.mouseX,e.mouseY,e.chartAxisLayoutPanel.seriesClipRect)&&this.tooltip(),!1}tooltip(){if(this.chart.stockChart&&this.chart.stockChart.onPanning)return this.removeTooltip(1e3),null;const e=this.getElement(this.chart.enableCanvas?this.element.id+"_tooltip_group":this.element.id+"_tooltip_svg"),t=this.chart.stockChart&&e&&e.firstChild.childNodes.length>1,i=e&&parseInt(e.getAttribute("opacity"),10)>0&&!t,s=this.getTooltipElement(i);this.chart.enableCanvas&&s&&(document.getElementById(this.chart.element.id+"_Secondary_Element").appendChild(s),s.appendChild(document.getElementById(this.chart.element.id+"_tooltip_svg"))),this.chart.tooltip.shared?this.renderGroupedTooltip(this.chart,!i,s):this.renderSeriesTooltip(this.chart,!i,s)}findHeader(e){return""===this.header?"":(this.header=this.parseTemplate(e.point,e.series,this.header,e.series.xAxis,e.series.yAxis),""!==this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()?this.header:"")}findShapes(){if(!this.chart.tooltip.enableMarker)return[];const e=[];for(const t of this.currentPoints)e.push(t.point.marker.shape||t.series.marker.shape);return e}renderSeriesTooltip(e,t,i){let s=this.getData();if(s.lierIndex=this.lierIndex,this.currentPoints=[],this.findData(s,this.previousPoints[0])){if((!e.dataEditingModule||!e.dataEditingModule.isPointDragging)&&this.previousPoints[0]&&s.point.index===this.previousPoints[0].point.index&&s.series.index===this.previousPoints[0].series.index)return null;this.pushData(s,t,i,!0)&&this.triggerTooltipRender(s,t,this.getTooltipText(s),this.findHeader(s))}else if(!s.point&&this.isRemove)this.removeTooltip(this.chart.tooltip.fadeOutDuration),this.isRemove=!1;else{const t=this.mergeXvalues(this.chart.visibleSeries);for(const i of e.visibleSeries)i.visible&&"TrendLine"!==i.category&&(s=this.getClosestX(e,i,t)||s)}s&&s.point&&this.findMouseValue(s,e)}triggerTooltipRender(e,t,i,s){const o={cancel:!1,name:fe,text:i,headerText:s,template:void 0,series:this.chart.isBlazor?{}:e.series,textStyle:this.textStyle,point:e.point,data:{pointX:e.point.x,pointY:e.point.y,seriesIndex:e.series.index,seriesName:e.series.name,pointIndex:e.point.index,pointText:e.point.text}},l=i=>{i.cancel?(this.removeHighlight(),(0,a.Od)(this.getElement(this.element.id+"_tooltip"))):("BoxAndWhisker"===e.series.type&&(this.removeText(),t=!0),this.headerText=i.headerText,this.formattedText=this.formattedText.concat(i.text),this.text=this.formattedText,this.createTooltip(this.chart,t,this.getSymbolLocation(e),e.series.clipRect,e.point,this.findShapes(),this.findMarkerHeight(this.currentPoints[0]),this.chart.chartAxisLayoutPanel.seriesClipRect,null,this.getTemplateText(e),this.chart.tooltip.template?i.template:"")),this.isRemove=!0};l.bind(this,e),this.chart.trigger(fe,o,l)}findMarkerHeight(e){if(!this.chart.tooltip.enableMarker)return 0;let t=0;const i=e.series;return t=(i.marker.visible||this.chart.tooltip.shared&&(!i.isRectSeries||i.marker.visible)||"Scatter"===i.type||"Scatter"===i.drawType)&&"Candle"!==i.type&&"Hilo"!==i.type&&"HiloOpenClose"!==i.type?(i.marker.height+2)/2+2*i.marker.border.width:0,t}findData(e,t){return e.point&&(!t||t.point!==e.point||t&&t.lierIndex>3&&t.lierIndex!==this.lierIndex||t.point===e.point)}getSymbolLocation(e){let t;if("BoxAndWhisker"!==e.series.type){if(!e.point.symbolLocations[0])return null;t=new Ri(e.point.symbolLocations[0].x,e.point.symbolLocations[0].y)}switch(e.series.type){case"BoxAndWhisker":return this.getBoxLocation(e);case"Waterfall":return this.getWaterfallRegion(e,t);case"RangeArea":case"SplineRangeArea":return this.getRangeArea(e,t);default:return t}}getRangeArea(e,t){return e.point.regions[0]&&(this.inverted?t.x=e.point.regions[0].x+e.point.regions[0].width/2:t.y=e.point.regions[0].y+e.point.regions[0].height/2),t}getWaterfallRegion(e,t){return this.inverted?t.x=e.point.y<0?t.x+e.point.regions[0].width:t.x:t.y=e.point.y<0?t.y-e.point.regions[0].height:t.y,t}getTooltipText(e){const t=e.series;return this.parseTemplate(e.point,t,this.getFormat(this.chart,t),t.xAxis,t.yAxis)}getTemplateText(e){if(this.chart.tooltip.template){const t=(0,a.l7)({},e.point);return t.x=this.formatPointValue(e.point,e.series.xAxis,"x",!0,!1),"XY"===e.series.seriesType?t.y=this.formatPointValue(e.point,e.series.yAxis,"y",!1,!0):(t.low=this.formatPointValue(e.point,e.series.yAxis,"low",!1,!0),t.high=this.formatPointValue(e.point,e.series.yAxis,"high",!1,!0)),t}return e.point}findMouseValue(e,t){t.requireInvertedAxis?(this.valueY=(1-wt(e.point.xValue,e.series.xAxis))*e.series.xAxis.rect.height+e.series.xAxis.rect.y,this.valueX=t.mouseX):(this.valueX="PolarRadar"===t.chartAreaType?Lt(e.point.xValue,e.series.xAxis)*e.series.xAxis.rect.width+e.series.xAxis.rect.x:"TrendLine"===e.series.category&&t.tooltip.shared?this.valueX:wt(e.point.xValue,e.series.xAxis)*e.series.xAxis.rect.width+e.series.xAxis.rect.x,this.valueY=t.mouseY)}renderGroupedTooltip(e,t,i){let s,o;const l="PolarRadar"===e.chartAreaType?this.getData():null;this.stopAnimation(),this.removeHighlight(),this.currentPoints=[];const a=[];t&&(e.stockChart?i&&!A(i.id)&&document.getElementById(e.stockChart.element.id+"_Secondary_Element").appendChild(i):i&&document.getElementById(this.element.id+"_Secondary_Element").appendChild(i)),this.removeText();const r={text:[],cancel:!1,name:pe,data:[],headerText:"",textStyle:this.textStyle},n=this.mergeXvalues(this.chart.visibleSeries);for(const h of e.visibleSeries)h.enableTooltip&&h.visible&&("Cartesian"===e.chartAreaType&&h.visible?s=this.getClosestX(e,h,n):"PolarRadar"===e.chartAreaType&&h.visible&&null!==l.point&&(s=new ki(h.points[l.point.index],h)),s&&(e.isBlazor?(r.data.push({pointX:s.point.x,pointY:s.point.y,seriesIndex:s.series.index,seriesName:s.series.name,pointIndex:s.point.index,pointText:s.point.text}),r.headerText=this.findHeader(s),this.currentPoints.push(s),r.text.push(this.getTooltipText(s)),o="TrendLine"===s.series.category&&e.tooltip.shared?o:s):this.triggerSharedTooltip(s,t,this.getTooltipText(s),this.findHeader(s),a)));e.isBlazor&&s&&this.triggerBlazorSharedTooltip(r,o,a,e,t),this.currentPoints.length>0?this.createTooltip(e,t,this.findSharedLocation(),1===this.currentPoints.length?this.currentPoints[0].series.clipRect:null,null,this.findShapes(),this.findMarkerHeight(this.currentPoints[0]),e.chartAxisLayoutPanel.seriesClipRect,a,this.chart.tooltip.template?this.getTemplateText(s):null,this.chart.tooltip.template?r.template:""):this.getElement(this.element.id+"_tooltip_path")&&this.getElement(this.element.id+"_tooltip_path").setAttribute("d","")}triggerBlazorSharedTooltip(e,t,i,s,o){const l={cancel:!1,name:pe,text:e.text,headerText:e.headerText,textStyle:e.textStyle,data:e.data},a=e=>{e.cancel?i.push(t):(this.text=e.text,this.headerText=e.headerText,this.findMouseValue(t,this.chart),t=null,this.createTooltip(s,o,this.findSharedLocation(),null,null,this.findShapes(),this.findMarkerHeight(this.currentPoints[0]),s.chartAxisLayoutPanel.seriesClipRect,i))};a.bind(this,t,i),this.chart.trigger(pe,l,a)}triggerSharedTooltip(e,t,i,s,o){const l={cancel:!1,name:fe,text:i,headerText:s,point:e.point,series:this.chart.isBlazor?{}:e.series,textStyle:this.textStyle,data:{pointX:e.point.x,pointY:e.point.y,seriesIndex:e.series.index,seriesName:e.series.name,pointIndex:e.point.index,pointText:e.point.text}},a=t=>{t.cancel?o.push(e):("BoxAndWhisker"===e.series.type&&this.removeText(),this.formattedText=this.formattedText.concat(t.text),this.text=this.formattedText,this.headerText=t.headerText,this.findMouseValue(e,this.chart),this.currentPoints.push(e),e=null)};a.bind(this,e,o),this.chart.trigger(fe,l,a),l.template&&(this.chart.tooltip.template=l.template)}findSharedLocation(){const e=this.chart.stockChart;if(e){1===this.text.length&&this.text.push("");const t=e.enablePeriodSelector?e.toolbarHeight:0,i=document.getElementById(e.element.id+"_ChartTitle"),s=""!==e.title?i.getBoundingClientRect().height+10:0;return new Ri(this.chart.chartAxisLayoutPanel.seriesClipRect.x+5,this.chart.chartAxisLayoutPanel.seriesClipRect.y+t+5+s)}return this.currentPoints.length>1?new Ri(this.valueX,this.valueY):this.getSymbolLocation(this.currentPoints[0])}getBoxLocation(e){return this.lierIndex>3?e.point.symbolLocations[this.lierIndex-4]:{x:e.point.regions[0].x+e.point.regions[0].width/2,y:e.point.regions[0].y+e.point.regions[0].height/2}}parseTemplate(e,t,i,s,o){let l,a;for(const r of Object.keys(e))l=new RegExp("${point."+r+"}","gm"),i=i.replace(l.source,this.formatPointValue(e,"${point.x}"===l.source?s:o,r,"${point.x}"===l.source,"${point.high}"===l.source||"${point.open}"===l.source||"${point.close}"===l.source||"${point.low}"===l.source||"${point.y}"===l.source||"${point.minimum}"===l.source||"${point.maximum}"===l.source||"${point.outliers}"===l.source||"${point.upperQuartile}"===l.source||"${point.lowerQuartile}"===l.source||"${point.median}"===l.source));for(const r of Object.keys(Object.getPrototypeOf(t)))l=new RegExp("${series."+r+"}","gm"),a=t[r],i=i.replace(l.source,a);return i}formatPointValue(e,t,i,s,o){let l,r,n;return"Category"!==t.valueType&&s?(r=t.labelFormat&&null!==t.labelFormat.match("{value}"),l=r?t.labelFormat.replace("{value}",t.format(e[i])):t.format(e[i])):o&&!(0,a.le)(e[i])?(r=t.labelFormat&&null!==t.labelFormat.match("{value}"),n=t.format("outliers"===i?e[i][this.lierIndex-4]:e[i]),l=r?t.labelFormat.replace("{value}",n):n):l=e[i],l}getFormat(e,t){if(t.tooltipFormat)return"XY"===t.seriesType&&"Indicator"===t.category?this.getIndicatorTooltipFormat(t,e,e.tooltip.format):t.tooltipFormat;if(!t.tooltipFormat&&e.tooltip.format)return"XY"===t.seriesType&&"Indicator"===t.category?this.getIndicatorTooltipFormat(t,e,e.tooltip.format):e.tooltip.format;const i=e.tooltip.shared?"${series.name}":"Histogram"===t.type?"${point.minimum}-${point.maximum}":"${point.x}";switch(t.seriesType){case"XY":return"Indicator"===t.category&&this.getIndicatorTooltipFormat(t,e,e.tooltip.format),i+" : "+("Bubble"===t.type?"<b>${point.y}</b>  Size : <b>${point.size}</b>":"<b>${point.y}</b>");case"HighLow":return i+"<br/>High : <b>${point.high}</b><br/>Low : <b>${point.low}</b>";case"HighLowOpenClose":return i+"<br/>High : <b>${point.high}</b><br/>Low : <b>${point.low}</b><br/>Open : <b>${point.open}</b><br/>Close : <b>${point.close}</b>";case"BoxPlot":return i+"<br/>"+(this.lierIndex>3?"Outliers : <b>${point.outliers}</b>":"Maximum : <b>${point.maximum}</b><br/>Q3 : <b>${point.upperQuartile}</b><br/>Median : <b>${point.median}</b><br/>Q1 : <b>${point.lowerQuartile}</b><br/>Minimum : <b>${point.minimum}</b>");default:return""}}getIndicatorTooltipFormat(e,t,i){let s;return s="XY"===e.seriesType?e.name+" : <b>${point.y}</b>":i,s}removeHighlightedMarker(e){for(const t of e)nt(this.element.id+"_Series_"+t.series.index+"_Point_"+t.point.index+"_Trackball");this.chart.markerRender&&this.chart.markerRender.removeHighlightedMarker(),this.previousPoints=[]}getModuleName(){return"Tooltip"}destroy(){}}class Zs{constructor(e){this.iconRectOverFill="transparent",this.iconRectSelectionFill="transparent",this.zoomCompleteEvtCollection=[],this.chart=e,this.elementId=e.element.id,this.chart.svgRenderer=new y(this.elementId),this.selectionColor="Bootstrap4"===e.theme?"#FFFFFF":"Tailwind"===e.theme?"#374151":"TailwindDark"===e.theme?"#F3F4F6":"#ff4081",this.fillColor="Bootstrap4"===e.theme?"#495057":"Tailwind"===e.theme?"#6B7280":"TailwindDark"===e.theme?"#D1D5DB":"#737373",this.iconRectOverFill="Bootstrap4"===e.theme?"#5A6268":this.iconRectOverFill,this.iconRectSelectionFill="Bootstrap4"===e.theme?"#5B6269":this.iconRectSelectionFill,this.iconRect="Bootstrap4"===e.theme?new C(-5,-5,26,26):new C(0,0,16,16)}createPanButton(e,t){const i=this.chart.svgRenderer,s=this.chart.zoomModule.isPanning?this.selectionColor:this.fillColor;let o="M5,3h2.3L7.275,5.875h1.4L8.65,3H11L8,0L5,3z M3,11V8.7l2.875,0.025v-1.4L3,7.35V5L0,8L3,";o+="11z M11,13H8.7l0.025-2.875h-1.4L7.35,13H5l3,3L11,13z M13,5v2.3l-2.875-0.025v1.4L13,8.65V11l3-3L13,5z",e.id=this.elementId+"_Zooming_Pan",e.setAttribute("aria-label",this.chart.getLocalizedLabel("Pan")),this.panElements=e,e.appendChild(i.drawRectangle(new Ti(this.elementId+"_Zooming_Pan_1","transparent",{},1,this.iconRect))),e.appendChild(i.drawPath(new I(this.elementId+"_Zooming_Pan_2",s,null,null,1,null,"M5,3h2.3L7.275,5.875h1.4L8.65,3H11L8,0L5,3z M3,11V8.7l2.875,0.025v-1.4L3,7.35V5L0,8L3,11z M11,13H8.7l0.025-2.875h-1.4L7.35,13H5l3,3L11,13z M13,5v2.3l-2.875-0.025v1.4L13,8.65V11l3-3L13,5z"))),t.appendChild(e),this.wireEvents(e,this.pan)}createZoomButton(e,t){const i=this.chart.svgRenderer,s=this.chart.zoomModule.isPanning?this.fillColor:this.selectionColor,o=this.chart.zoomModule.isPanning?"transparent":this.iconRectSelectionFill;let l="M0.001,14.629L1.372,16l4.571-4.571v-0.685l0.228-0.274c1.051,0.868,2.423,1.417,3.885,1.417c3.291,0,";l+="5.943-2.651,5.943-5.943S13.395,0,10.103,0S4.16,2.651,4.16,5.943c0,1.508,0.503,2.834,1.417,3.885l-0.274,0.228H4.571",l+="L0.001,14.629L0.001,14.629z M5.943,5.943c0-2.285,1.828-4.114,4.114-4.114s4.114,1.828,4.114,",e.id=this.elementId+"_Zooming_Zoom",e.setAttribute("aria-label",this.chart.getLocalizedLabel("Zoom")),this.zoomElements=e,this.selectedID=this.chart.zoomModule.isPanning?this.chart.element.id+"_Zooming_Pan_1":this.elementId+"_Zooming_Zoom_1",e.appendChild(i.drawRectangle(new Ti(this.elementId+"_Zooming_Zoom_1",o,{},1,this.iconRect))),e.appendChild(i.drawPath(new I(this.elementId+"_Zooming_Zoom_3",s,null,null,1,null,"M0.001,14.629L1.372,16l4.571-4.571v-0.685l0.228-0.274c1.051,0.868,2.423,1.417,3.885,1.417c3.291,0,5.943-2.651,5.943-5.943S13.395,0,10.103,0S4.16,2.651,4.16,5.943c0,1.508,0.503,2.834,1.417,3.885l-0.274,0.228H4.571L0.001,14.629L0.001,14.629z M5.943,5.943c0-2.285,1.828-4.114,4.114-4.114s4.114,1.828,4.114,4.114s-1.828,4.114-4.114,4.114S5.943,8.229,5.943,5.943z"))),t.appendChild(e),this.wireEvents(e,this.zoom)}createZoomInButton(e,t,i){const s=this.chart.svgRenderer,o=this.fillColor;let l="M10.103,0C6.812,0,4.16,2.651,4.16,5.943c0,1.509,0.503,2.834,1.417,3.885l-0.274,0.229H4.571L0,";l+="14.628l0,0L1.372,16l4.571-4.572v-0.685l0.228-0.275c1.052,0.868,2.423,1.417,3.885,1.417c3.291,0,5.943-2.651,",l+="5.943-5.943C16,2.651,13.395,0,10.103,0z M10.058,10.058c-2.286,0-4.114-1.828-4.114-4.114c0-2.286,1.828-4.114,",e.id=this.elementId+"_Zooming_ZoomIn",e.setAttribute("aria-label",this.chart.getLocalizedLabel("ZoomIn")),e.appendChild(s.drawRectangle(new Ti(this.elementId+"_Zooming_ZoomIn_1","transparent",{},1,this.iconRect))),e.appendChild(s.drawPath(new I(this.elementId+"_Zooming_ZoomIn_2",o,null,null,1,null,"M10.103,0C6.812,0,4.16,2.651,4.16,5.943c0,1.509,0.503,2.834,1.417,3.885l-0.274,0.229H4.571L0,14.628l0,0L1.372,16l4.571-4.572v-0.685l0.228-0.275c1.052,0.868,2.423,1.417,3.885,1.417c3.291,0,5.943-2.651,5.943-5.943C16,2.651,13.395,0,10.103,0z M10.058,10.058c-2.286,0-4.114-1.828-4.114-4.114c0-2.286,1.828-4.114,4.114-4.114c2.286,0,4.114,1.828,4.114,4.114C14.172,8.229,12.344,10.058,10.058,10.058z"))),e.appendChild(s.drawPolygon(new Di(this.elementId+"_Zooming_ZoomIn_3","12.749,5.466 10.749,5.466 10.749,3.466 9.749,3.466 9.749,5.466 7.749,5.466 7.749,6.466 9.749,6.466 9.749,8.466 10.749,8.466 10.749,6.466 12.749,6.466",o))),this.zoomInElements=e,this.elementOpacity=i.zoomModule.isPanning?"0.2":"1",e.setAttribute("opacity",this.elementOpacity),t.appendChild(e),this.wireEvents(e,this.zoomIn)}createZoomOutButton(e,t,i){const s=this.chart.svgRenderer,o=this.fillColor;let l="M0,14.622L1.378,16l4.533-4.533v-0.711l0.266-0.266c1.022,0.889,2.4,1.422,3.866,";l+="1.422c3.289,0,5.955-2.666,5.955-5.955S13.333,0,10.044,0S4.089,2.667,4.134,5.911c0,1.466,0.533,2.844,",l+="1.422,3.866l-0.266,0.266H4.578L0,14.622L0,14.622z M5.911,5.911c0-2.311,1.822-4.133,4.133-4.133s4.133,1.822,4.133,",e.id=this.elementId+"_Zooming_ZoomOut",e.setAttribute("aria-label",this.chart.getLocalizedLabel("ZoomOut")),e.appendChild(s.drawRectangle(new Ti(this.elementId+"_Zooming_ZoomOut_1","transparent",{},1,this.iconRect))),e.appendChild(s.drawPath(new I(this.elementId+"_Zooming_ZoomOut_2",o,null,null,1,null,"M0,14.622L1.378,16l4.533-4.533v-0.711l0.266-0.266c1.022,0.889,2.4,1.422,3.866,1.422c3.289,0,5.955-2.666,5.955-5.955S13.333,0,10.044,0S4.089,2.667,4.134,5.911c0,1.466,0.533,2.844,1.422,3.866l-0.266,0.266H4.578L0,14.622L0,14.622z M5.911,5.911c0-2.311,1.822-4.133,4.133-4.133s4.133,1.822,4.133,4.133s-1.866,4.133-4.133,4.133S5.911,8.222,5.911,5.911z M12.567,6.466h-5v-1h5V6.466z"))),this.zoomOutElements=e,this.elementOpacity=i.zoomModule.isPanning?"0.2":"1",e.setAttribute("opacity",this.elementOpacity),t.appendChild(e),this.wireEvents(e,this.zoomOut)}createResetButton(e,t,i,s){const o=this.chart.svgRenderer,l=this.fillColor;let a,r="M12.364,8h-2.182l2.909,3.25L16,8h-2.182c0-3.575-2.618-6.5-5.818-6.5c-1.128,0-2.218,0.366-3.091,";r+="1.016l1.055,1.178C6.581,3.328,7.272,3.125,8,3.125C10.4,3.125,12.363,5.319,12.364,8L12.364,8z M11.091,",r+="13.484l-1.055-1.178C9.419,12.672,8.728,12.875,8,12.875c-2.4,0-4.364-2.194-4.364-4.875h2.182L2.909,4.75L0,8h2.182c0,",e.id=this.elementId+"_Zooming_Reset",e.setAttribute("aria-label",this.chart.getLocalizedLabel("Reset")),s?(a=S(this.chart.getLocalizedLabel("ResetZoom"),{size:"12px"}),e.appendChild(o.drawRectangle(new Ti(this.elementId+"_Zooming_Reset_1","transparent",{},1,new C(0,0,a.width,a.height)))),bi(i.renderer,new L(this.elementId+"_Zooming_Reset_2",0+a.width/2,0+3*a.height/4,"middle",this.chart.getLocalizedLabel("ResetZoom"),"rotate(0,0,0)","auto"),{size:"12px"},"black",e,null,null,null,null,null,null,0,null,i.enableCanvas)):(e.appendChild(o.drawRectangle(new Ti(this.elementId+"_Zooming_Reset_1","transparent",{},1,this.iconRect))),e.appendChild(o.drawPath(new I(this.elementId+"_Zooming_Reset_2",l,null,null,1,null,"M12.364,8h-2.182l2.909,3.25L16,8h-2.182c0-3.575-2.618-6.5-5.818-6.5c-1.128,0-2.218,0.366-3.091,1.016l1.055,1.178C6.581,3.328,7.272,3.125,8,3.125C10.4,3.125,12.363,5.319,12.364,8L12.364,8z M11.091,13.484l-1.055-1.178C9.419,12.672,8.728,12.875,8,12.875c-2.4,0-4.364-2.194-4.364-4.875h2.182L2.909,4.75L0,8h2.182c0,3.575,2.618,6.5,5.818,6.5C9.128,14.5,10.219,14.134,11.091,13.484L11.091,13.484z")))),t.appendChild(e),this.wireEvents(e,this.reset)}wireEvents(e,t){a.bi.add(e,"mousedown touchstart",t,this),a.bi.add(e,"mouseover",this.showTooltip,this),a.bi.add(e,"mouseout",this.removeTooltip,this)}showTooltip(e){const t=e.currentTarget.id.split("_Zooming_")[1],i=e.pageX-(S(t,{size:"10px"}).width+5),s=Yt(e.currentTarget.id+"_1"),o=Yt(e.currentTarget.id+"_2"),l=Yt(e.currentTarget.id+"_3");s&&(this.hoveredID=s.id,s.setAttribute("fill",this.iconRectOverFill)),o&&o.setAttribute("fill",this.selectionColor),l&&l.setAttribute("fill",this.selectionColor),this.chart.isTouch||function(e,t,i,s,o){let l=Yt(e);const r="top:"+i.toString()+"px;left:"+s.toString()+"px;color:black !important; background:#FFFFFF !important; position:absolute;border:1px solid #707070;font-size:10px;border-radius:2px; z-index:1";l?(l.setAttribute("innerHTML","&nbsp;"+t+"&nbsp;"),l.setAttribute("styles",r)):(l=(0,a.az)("div",{id:e,innerHTML:"&nbsp;"+t+"&nbsp;",styles:r}),document.body.appendChild(l))}("EJ2_Chart_ZoomTip",this.chart.getLocalizedLabel(t),e.pageY+10,i)}removeTooltip(){if(Yt(this.hoveredID)){let e=this.chart.zoomModule.isPanning?this.hoveredID.indexOf("_Pan_")>-1?this.iconRectSelectionFill:"transparent":this.hoveredID.indexOf("_Zoom_")>-1?this.iconRectSelectionFill:"transparent";Yt(this.hoveredID).setAttribute("fill",e)}let e=this.hoveredID?Yt(this.hoveredID.replace("_1","_2")):null,t=this.hoveredID?Yt(this.hoveredID.replace("_1","_3")):null;if(e){let t=this.chart.zoomModule.isPanning?this.hoveredID.indexOf("_Pan_")>-1?this.selectionColor:this.fillColor:this.hoveredID.indexOf("_Zoom_")>-1?this.selectionColor:this.fillColor;e.setAttribute("fill",t)}if(t){let e=this.chart.zoomModule.isPanning?this.fillColor:this.hoveredID.indexOf("_Zoom_")>-1?this.selectionColor:this.fillColor;t.setAttribute("fill",e)}nt("EJ2_Chart_ZoomTip")}reset(){let e,t,i=this.chart;i.zoomModule.isDevice||(0,a.Od)(i.zoomModule.toolkitElements),this.removeTooltip(),i.svgObject.setAttribute("cursor","auto");let s=[];this.zoomCompleteEvtCollection=[];for(let o of i.axisCollections)e={cancel:!1,name:Te,axis:o,previousZoomFactor:o.zoomFactor,previousZoomPosition:o.zoomPosition,currentZoomFactor:1,currentZoomPosition:0,previousVisibleRange:o.visibleRange,currentVisibleRange:null},o.zoomFactor=1,o.zoomPosition=0,o.zoomingScrollBar&&(o.zoomingScrollBar.isScrollUI=!1),e.cancel||(o.zoomFactor=e.currentZoomFactor,o.zoomPosition=e.currentZoomPosition,this.zoomCompleteEvtCollection.push(e)),s.push({zoomFactor:o.zoomFactor,zoomPosition:o.zoomFactor,axisName:o.name,axisRange:o.visibleRange});return t={cancel:!1,axisCollection:s,name:Ze},!t.cancel&&this.chart.isBlazor?(this.chart.trigger(Ze,t,()=>{this.setDefferedZoom(i)}),!1):this.setDefferedZoom(i)}setDefferedZoom(e){return e.disableTrackTooltip=!1,e.zoomModule.isZoomed=e.zoomModule.isPanning=e.isChartDrag=e.delayRedraw=!1,e.zoomModule.touchMoveList=e.zoomModule.touchStartList=[],e.zoomModule.pinchTarget=null,e.removeSvg(),e.enableAutoIntervalOnBothAxis&&e.processData(!1),e.refreshAxis(),e.refreshBound(),this.elementOpacity="1",!1}zoomIn(e){return this.zoomInOutCalculation(1,this.chart,this.chart.axisCollections,this.chart.zoomSettings.mode),!1}zoomOut(e){return this.zoomInOutCalculation(-1,this.chart,this.chart.axisCollections,this.chart.zoomSettings.mode),!1}zoom(e){return this.chart.zoomModule.isPanning=!1,this.elementOpacity="1",this.chart.svgObject.setAttribute("cursor","auto"),this.zoomInElements.setAttribute("opacity",this.elementOpacity),this.zoomOutElements.setAttribute("opacity",this.elementOpacity),this.applySelection(this.zoomElements.childNodes,this.selectionColor),this.applySelection(this.panElements.childNodes,"#737373"),Yt(this.selectedID)&&Yt(this.selectedID).setAttribute("fill","transparent"),this.selectedID=this.chart.element.id+"_Zooming_Zoom_1",Yt(this.selectedID).setAttribute("fill",this.iconRectSelectionFill),!1}pan(){let e;return this.chart.zoomModule.isPanning=!0,this.chart.svgObject.setAttribute("cursor","pointer"),this.elementOpacity="0.2",e=this.zoomInElements?this.zoomInElements.setAttribute("opacity",this.elementOpacity):null,e=this.zoomOutElements?this.zoomOutElements.setAttribute("opacity",this.elementOpacity):null,e=this.panElements?this.applySelection(this.panElements.childNodes,this.selectionColor):null,e=this.zoomElements?this.applySelection(this.zoomElements.childNodes,"#737373"):null,Yt(this.selectedID)&&Yt(this.selectedID).setAttribute("fill","transparent"),this.selectedID=this.chart.element.id+"_Zooming_Pan_1",Yt(this.selectedID).setAttribute("fill",this.iconRectSelectionFill),!1}zoomInOutCalculation(e,t,i,s){if(!t.zoomModule.isPanning&&"0.2"!==this.elementOpacity){let o,l,a,r;t.disableTrackTooltip=!0,t.delayRedraw=!0,this.zoomCompleteEvtCollection=[];for(let t of i)r={cancel:!1,name:Te,axis:t,previousZoomFactor:t.zoomFactor,previousZoomPosition:t.zoomPosition,currentZoomFactor:t.zoomFactor,currentZoomPosition:t.zoomPosition,previousVisibleRange:t.visibleRange,currentVisibleRange:null},("Horizontal"===t.orientation&&"Y"!==s||"Vertical"===t.orientation&&"X"!==s)&&(a=Math.max(Math.max(1/Gt(t.zoomFactor,0,1),1)+.25*e,1),o=1===a?1:Gt(1/a,0,1),l=1===a?0:t.zoomPosition+.5*(t.zoomFactor-o),t.zoomPosition===l&&t.zoomFactor===o||(o=l+o>1?1-l:o),r.currentZoomFactor=o,r.currentZoomPosition=l,r.cancel||(t.zoomFactor=r.currentZoomFactor,t.zoomPosition=r.currentZoomPosition,this.zoomCompleteEvtCollection.push(r)))}}applySelection(e,t){for(let i=1,s=e.length;i<s;i++)e[i].setAttribute("fill",t)}}class Vs{constructor(e){this.zoomCompleteEvtCollection=[],this.chart=e,this.isPointer=a.AR.isPointer,this.browserName=a.AR.info.name,this.wheelEvent="mozilla"===this.browserName?this.isPointer?"mousewheel":"DOMMouseScroll":"mousewheel",this.cancelEvent=this.isPointer?"pointerleave":"mouseleave",this.addEventListener(),this.isDevice=a.AR.isDevice;const t=e.zoomSettings;this.toolkit=new Zs(e),this.zooming=t,this.elementId=e.element.id,this.zoomingRect=new C(0,0,0,0),this.zoomAxes=[],this.zoomkitOpacity=.3,this.isIOS=a.AR.isIos||a.AR.isIos7,this.isZoomed=this.performedUI=this.zooming.enablePan&&this.zooming.enableSelectionZooming,t.enableScrollbar&&(e.scrollElement=(0,a.az)("div",{id:e.element.id+"_scrollElement"}))}renderZooming(e,t,i){this.calculateZoomAxesRange(t),!this.zooming.enableSelectionZooming||i&&(!t.isDoubleTap||1!==this.touchStartList.length)||this.isPanning&&!t.isDoubleTap?this.isPanning&&t.isChartDrag&&(!i||i&&1===this.touchStartList.length)&&(this.pinchTarget=i?e.target:null,this.doPan(t,t.axisCollections)):(this.isPanning=!!this.isDevice||this.isPanning,this.performedUI=!0,this.drawZoomingRectangle(t))}drawZoomingRectangle(e){const t=e.chartAxisLayoutPanel.seriesClipRect,i=new Ri(e.previousMouseMoveX,e.previousMouseMoveY),s=new Ri(e.mouseX,e.mouseY),o=this.zoomingRect=function(e,t,i){const s=t.x<i.x?i.x:t.x>i.x+i.width?i.x+i.width:t.x,o=t.y<i.y?i.y:t.y>i.y+i.height?i.y+i.height:t.y;return new C(s>e.x?e.x:s,o>e.y?e.y:o,Math.abs(s-e.x),Math.abs(o-e.y))}(i,s,t);o.width>0&&o.height>0&&(this.isZoomed=!0,e.disableTrackTooltip=!0,e.svgObject.setAttribute("cursor","crosshair"),"X"===this.zooming.mode?(o.height=t.height,o.y=t.y):"Y"===this.zooming.mode&&(o.width=t.width,o.x=t.x),(e.enableCanvas?document.getElementById(this.elementId+"_tooltip_svg"):e.svgObject).appendChild(e.svgRenderer.drawRectangle(new Ti(this.elementId+"_ZoomArea",e.themeStyle.selectionRectFill,{color:e.themeStyle.selectionRectStroke,width:1},1,o,0,0,"","3"))))}doPan(e,t){if(e.startMove&&e.crosshair.enable)return null;let i,s,o;this.isZoomed=!0,this.offset=e.delayRedraw?this.offset:e.chartAxisLayoutPanel.seriesClipRect,e.delayRedraw=!0,this.zoomCompleteEvtCollection=[],e.disableTrackTooltip=!0;const l=[];for(const r of t)o={cancel:!1,name:Te,axis:r,previousZoomFactor:r.zoomFactor,previousZoomPosition:r.zoomPosition,currentZoomFactor:r.zoomFactor,currentZoomPosition:r.zoomPosition,previousVisibleRange:r.visibleRange,currentVisibleRange:null},i=Math.max(1/Gt(r.zoomFactor,0,1),1),"Horizontal"===r.orientation?(s=(e.previousMouseMoveX-e.mouseX)/r.rect.width/i,o.currentZoomPosition=Gt(r.zoomPosition+s,0,1-r.zoomFactor)):(s=(e.previousMouseMoveY-e.mouseY)/r.rect.height/i,o.currentZoomPosition=Gt(r.zoomPosition-s,0,1-r.zoomFactor)),o.cancel||(r.zoomFactor=o.currentZoomFactor,r.zoomPosition=o.currentZoomPosition,this.zoomCompleteEvtCollection.push(o)),l.push({zoomFactor:r.zoomFactor,zoomPosition:r.zoomFactor,axisName:r.name,axisRange:r.visibleRange});const a={cancel:!1,axisCollection:l,name:Ze};!a.cancel&&this.chart.isBlazor?this.chart.trigger(Ze,a,()=>{this.performDefferedZoom(e)}):(this.performDefferedZoom(e),this.redrawOnZooming(e,!1))}performDefferedZoom(e){let t,i;if(this.zooming.enableDeferredZooming){switch(t=e.mouseX-e.mouseDownX,i=e.mouseY-e.mouseDownY,this.zooming.mode){case"X":i=0;break;case"Y":t=0}this.setTransform(t,i,null,null,e,!1),this.refreshAxis(e.chartAxisLayoutPanel,e,e.axisCollections),e.enableCanvas&&this.performZoomRedraw(e)}else this.performZoomRedraw(e);e.previousMouseMoveX=e.mouseX,e.previousMouseMoveY=e.mouseY}performZoomRedraw(e){const t=this.zoomingRect;e.animateSeries=!1,this.isZoomed&&(t.width>0&&t.height>0?(this.performedUI=!0,e.svgObject.setAttribute("cursor","auto"),this.doZoom(e,e.axisCollections,e.chartAxisLayoutPanel.seriesClipRect),e.isDoubleTap=!1):e.disableTrackTooltip&&(e.disableTrackTooltip=!1,e.delayRedraw=!1,e.enableCanvas?e.createChartSvg():e.removeSvg(),e.refreshAxis(),e.refreshBound()))}refreshAxis(e,t,i){const s=t.zoomSettings.mode;e.measureAxis(new C(t.initialClipRect.x,t.initialClipRect.y,t.initialClipRect.width,t.initialClipRect.height)),i.map((t,i)=>{"Horizontal"===t.orientation&&"Y"!==s&&e.drawXAxisLabels(t,i,null,t.placeNextToAxisLine?t.updatedRect:t.rect),"Vertical"===t.orientation&&"X"!==s&&e.drawYAxisLabels(t,i,null,t.placeNextToAxisLine?t.updatedRect:t.rect)})}doZoom(e,t,i){const s=this.zoomingRect,o=this.zooming.mode;let l;this.isPanning=e.zoomSettings.enablePan||this.isPanning;const a=[];this.zoomCompleteEvtCollection=[];for(const n of t)l={cancel:!1,name:Te,axis:n,previousZoomFactor:n.zoomFactor,previousZoomPosition:n.zoomPosition,currentZoomFactor:n.zoomFactor,currentZoomPosition:n.zoomPosition,previousVisibleRange:n.visibleRange,currentVisibleRange:null},"Horizontal"===n.orientation?"Y"!==o&&(l.currentZoomPosition+=Math.abs((s.x-i.x)/i.width)*n.zoomFactor,l.currentZoomFactor*=s.width/i.width):"X"!==o&&(l.currentZoomPosition+=(1-Math.abs((s.height+(s.y-i.y))/i.height))*n.zoomFactor,l.currentZoomFactor*=s.height/i.height),l.cancel||(n.zoomFactor=l.currentZoomFactor,n.zoomPosition=l.currentZoomPosition,this.zoomCompleteEvtCollection.push(l)),a.push({zoomFactor:n.zoomFactor,zoomPosition:n.zoomFactor,axisName:n.name,axisRange:n.visibleRange});const r={cancel:!1,axisCollection:a,name:Ze};!r.cancel&&this.chart.isBlazor?this.chart.trigger(Ze,r,()=>{this.zoomingRect=new C(0,0,0,0),this.performZoomRedraw(e)}):(this.zoomingRect=new C(0,0,0,0),this.redrawOnZooming(e))}redrawOnZooming(e,t=!0,i=!1){const s=i?this.toolkit.zoomCompleteEvtCollection:this.zoomCompleteEvtCollection;let o;t&&this.performZoomRedraw(e);for(let l=0;l<s.length;l++)s[l].cancel||(o={cancel:!1,name:Te,axis:e.axisCollections[l],previousZoomFactor:s[l].previousZoomFactor,previousZoomPosition:s[l].previousZoomPosition,currentZoomFactor:e.axisCollections[l].zoomFactor,currentZoomPosition:e.axisCollections[l].zoomPosition,currentVisibleRange:e.axisCollections[l].visibleRange,previousVisibleRange:s[l].previousVisibleRange},e.trigger(Te,o))}performMouseWheelZooming(e,t,i,s,o){const l="mozilla"!==this.browserName||this.isPointer?e.wheelDelta>0?1:-1:-e.detail/3>0?1:-1,a=this.zooming.mode;let r,n,h,d,c=.5;this.isZoomed=!0,this.calculateZoomAxesRange(s),s.disableTrackTooltip=!0,this.performedUI=!0,this.isPanning=s.zoomSettings.enablePan||this.isPanning,this.zoomCompleteEvtCollection=[];const p=[];for(const g of o)d={cancel:!1,name:Te,axis:g,previousZoomFactor:g.zoomFactor,previousZoomPosition:g.zoomPosition,currentZoomFactor:g.zoomFactor,currentZoomPosition:g.zoomPosition,currentVisibleRange:null,previousVisibleRange:g.visibleRange},("Vertical"===g.orientation&&"X"!==a||"Horizontal"===g.orientation&&"Y"!==a)&&(r=Math.max(Math.max(1/Gt(g.zoomFactor,0,1),1)+.25*l,1),r>=1&&(c="Horizontal"===g.orientation?t/g.rect.width:1-i/g.rect.height,c=c>1?1:c<0?0:c,n=1===r?1:Gt((l>0?.9:1.1)/r,0,1),h=1===r?0:g.zoomPosition+(g.zoomFactor-n)*c,g.zoomPosition===h&&g.zoomFactor===n||(n=h+n>1?1-h:n),d.currentZoomFactor=n,d.currentZoomPosition=h),d.cancel||(g.zoomFactor=d.currentZoomFactor,g.zoomPosition=d.currentZoomPosition,this.zoomCompleteEvtCollection.push(d))),p.push({zoomFactor:g.zoomFactor,zoomPosition:g.zoomFactor,axisName:g.name,axisRange:g.visibleRange});const u={cancel:!1,axisCollection:p,name:Ze};!u.cancel&&this.chart.isBlazor?this.chart.trigger(Ze,u,()=>{this.performZoomRedraw(s)}):this.redrawOnZooming(s)}performPinchZooming(e,t){if(this.zoomingRect.width>0&&this.zoomingRect.height>0||t.startMove&&t.crosshair.enable)return!1;this.calculateZoomAxesRange(t),this.isZoomed=!0,this.isPanning=!0,this.performedUI=!0,this.offset=t.delayRedraw?this.offset:t.chartAxisLayoutPanel.seriesClipRect,t.delayRedraw=!0,t.disableTrackTooltip=!0;const i=t.element.getBoundingClientRect(),s=this.touchStartList,o=this.touchMoveList,l=s[0].pageX-i.left,a=s[0].pageY-i.top,r=o[0].pageX-i.left,n=o[0].pageY-i.top,h=s[1].pageX-i.left,d=s[1].pageY-i.top,c=o[1].pageY-i.top,p=Math.abs(r-(o[1].pageX-i.left))/Math.abs(l-h),u=Math.abs(n-c)/Math.abs(a-d),g=new C((this.offset.x-r)/p+l,(this.offset.y-n)/u+a,this.offset.width/p,this.offset.height/u),m=r-p*l,b=n-u*a;if(!isNaN(p-p)&&!isNaN(u-u))switch(this.zooming.mode){case"XY":this.setTransform(m,b,p,u,t,!0);break;case"X":this.setTransform(m,0,p,1,t,!0);break;case"Y":this.setTransform(0,b,1,u,t,!0)}return this.calculatePinchZoomFactor(t,g),this.refreshAxis(t.chartAxisLayoutPanel,t,t.axisCollections),this.redrawOnZooming(t,!1),!0}calculatePinchZoomFactor(e,t){const i=this.zooming.mode;let s,o,l,a,r,n,h,d,c;const p=[];this.zoomCompleteEvtCollection=[];for(let g=0;g<e.axisCollections.length;g++){const u=e.axisCollections[g];("Horizontal"===u.orientation&&"Y"!==i||"Vertical"===u.orientation&&"X"!==i)&&(d=u.zoomFactor,c=u.zoomPosition,h={cancel:!1,name:Te,axis:u,previousZoomFactor:u.zoomFactor,previousZoomPosition:u.zoomPosition,currentZoomFactor:d,currentZoomPosition:c,previousVisibleRange:u.visibleRange,currentVisibleRange:null},"Horizontal"===u.orientation?(r=t.x-this.offset.x,n=u.rect.width/this.zoomAxes[g].delta,l=r/n+this.zoomAxes[g].min,r=t.x+t.width-this.offset.x,a=r/n+this.zoomAxes[g].min):(r=t.y-this.offset.y,n=u.rect.height/this.zoomAxes[g].delta,l=(-1*r+u.rect.height)/n+this.zoomAxes[g].min,r=t.y+t.height-this.offset.y,a=(-1*r+u.rect.height)/n+this.zoomAxes[g].min),s=Math.min(l,a),o=Math.max(l,a),c=(s-this.zoomAxes[g].actualMin)/this.zoomAxes[g].actualDelta,d=(o-s)/this.zoomAxes[g].actualDelta,h.currentZoomPosition=c<0?0:c,h.currentZoomFactor=d>1?1:d,h.cancel||(u.zoomFactor=h.currentZoomFactor,u.zoomPosition=h.currentZoomPosition,this.zoomCompleteEvtCollection.push(h)),p.push({zoomFactor:u.zoomFactor,zoomPosition:u.zoomFactor,axisName:u.name,axisRange:u.visibleRange}))}const u={cancel:!1,axisCollection:p,name:Ze};!u.cancel&&this.chart.isBlazor&&this.chart.trigger(Ze,u)}setTransform(e,t,i,s,o,l){let a,r,n,h;if(o.enableCanvas||o.seriesElements.setAttribute("clip-path","url(#"+this.elementId+"_ChartAreaClipRect_)"),o.indicatorElements&&o.indicatorElements.setAttribute("clip-path","url(#"+this.elementId+"_ChartAreaClipRect_)"),null!==e&&null!==t)for(const d of o.visibleSeries)r=o.requireInvertedAxis?d.yAxis.rect.x:d.xAxis.rect.x,n=o.requireInvertedAxis?d.xAxis.rect.y:d.yAxis.rect.y,a="translate("+(e+(l?i*r:r))+","+(t+(l?s*n:n))+")",a=i||s?a+" scale("+i+" "+s+")":a,d.visible&&("Indicator"===d.category?d.seriesElement.parentNode.setAttribute("transform",a):o.enableCanvas||d.seriesElement.setAttribute("transform",a),h=Yt(o.element.id+"_Series_"+d.index+"_DataLabelCollections"),d.errorBarElement&&d.errorBarElement.setAttribute("transform",a),d.symbolElement&&d.symbolElement.setAttribute("transform",a),d.textElement&&(d.textElement.setAttribute("visibility","hidden"),d.shapeElement.setAttribute("visibility","hidden")),h&&(h.style.visibility="hidden"))}calculateZoomAxesRange(e){let t,i;for(let s=0;s<e.axisCollections.length;s++){const o=e.axisCollections[s];i=o.visibleRange,this.zoomAxes[s]?e.delayRedraw||(this.zoomAxes[s].min=i.min,this.zoomAxes[s].delta=i.delta):(t={actualMin:o.actualRange.min,actualDelta:o.actualRange.delta,min:i.min,delta:i.delta},this.zoomAxes[s]=t)}}showZoomingToolkit(e){let t=this.zooming.toolbarItems;const i=e.chartAxisLayoutPanel.seriesClipRect,s=e.svgRenderer,o=this.isDevice?1:t.length,l=this.isDevice?S("Reset Zoom",{size:"12px"}).width:16,r=this.isDevice?S("Reset Zoom",{size:"12px"}).height:22,n=o*l+5*(o+1)+5*(o-1),h=i.x+i.width-n-5,d=i.y+5;let c=5;const p=this.toolkit;let u,g='<filter id="chart_shadow" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="5"/>';if(g+='<feOffset dx="-3" dy="4" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="1"/>',g+='</feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>',0===o||Yt(this.elementId+"_Zooming_KitCollection"))return!1;const m=s.createDefs();t=this.isDevice?["Reset"]:t,m.innerHTML='<filter id="chart_shadow" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="5"/><feOffset dx="-3" dy="4" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="1"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>',this.toolkitElements=s.createGroup({id:this.elementId+"_Zooming_KitCollection",transform:"translate("+h+","+d+")"}),this.toolkitElements.appendChild(m);const b="Tailwind"===this.chart.theme?"#F3F4F6":"TailwindDark"===this.chart.theme?"#374151":"#fafafa";this.toolkitElements.appendChild(s.drawRectangle(new Ti(this.elementId+"_Zooming_Rect",b,{color:"transparent",width:1},1,new C(0,0,n,r+10),0,0)));const f=s.drawRectangle(new Ti(this.elementId+"_Zooming_Rect",b,{color:"transparent",width:1},.1,new C(0,0,n,r+10),0,0));let y;"Tailwind"===this.chart.theme||"TailwindDark"===this.chart.theme?f.setAttribute("box-shadow","0px 1px 2px rgba(0, 0, 0, 0.06), 0px 1px 3px rgba(0, 0, 0, 0.1)"):f.setAttribute("filter","url(#chart_shadow)"),this.toolkitElements.appendChild(f);let v=!1;for(let a=1;a<=o;a++){switch(y=t[a-1],u=s.createGroup({transform:"translate("+c+","+(this.isDevice?5:8)+")"}),y){case"Pan":p.createPanButton(u,this.toolkitElements),v=!0;break;case"Zoom":p.createZoomButton(u,this.toolkitElements);break;case"ZoomIn":p.createZoomInButton(u,this.toolkitElements,e);break;case"ZoomOut":p.createZoomOutButton(u,this.toolkitElements,e);break;case"Reset":p.createResetButton(u,this.toolkitElements,e,this.isDevice)}c+=l+10}if(this.toolkitElements.setAttribute("opacity",this.isDevice?"1":""+this.zoomkitOpacity),this.toolkitElements.setAttribute("cursor","auto"),e.enableCanvas){const t=document.createElement("div");t.id=e.element.id+"_zoom",t.setAttribute("style","position:absolute; z-index:1");const i=e.svgRenderer.createSvg({id:e.element.id+"_zoomkit_svg",width:e.availableSize.width,height:e.availableSize.height/2});i.setAttribute("style","position:absolute"),i.appendChild(this.toolkitElements),t.appendChild(i),document.getElementById(this.elementId+"_Secondary_Element").appendChild(t)}else e.svgObject.appendChild(this.toolkitElements);return this.isDevice||(a.bi.add(this.toolkitElements,"mousemove touchstart",this.zoomToolkitMove,this),a.bi.add(this.toolkitElements,"mouseleave touchend",this.zoomToolkitLeave,this),this.isPanning&&v&&p.pan()),!0}applyZoomToolkit(e,t){this.isAxisZoomed(t)?(this.showZoomingToolkit(e),this.isZoomed=!0):(this.toolkit.removeTooltip(),this.isPanning=!1,this.isZoomed=!1,e.svgObject.setAttribute("cursor","auto"))}isAxisZoomed(e){let t=!1;for(const i of e)t=t||1!==i.zoomFactor||0!==i.zoomPosition;return t}zoomToolkitMove(){const e=this.toolkitElements;return this.zoomkitOpacity=1,e.setAttribute("opacity",""+this.zoomkitOpacity),!1}zoomToolkitLeave(){const e=this.toolkitElements;return this.zoomkitOpacity=.3,e.setAttribute("opacity",""+this.zoomkitOpacity),!1}addEventListener(){this.chart.isDestroyed||(a.bi.add(this.chart.element,this.wheelEvent,this.chartMouseWheel,this),this.chart.on(a.AR.touchMoveEvent,this.mouseMoveHandler,this),this.chart.on(a.AR.touchStartEvent,this.mouseDownHandler,this),this.chart.on(a.AR.touchEndEvent,this.mouseUpHandler,this),this.chart.on(this.cancelEvent,this.mouseCancelHandler,this))}removeEventListener(){this.chart.isDestroyed||(a.bi.remove(this.chart.element,this.wheelEvent,this.chartMouseWheel),this.chart.off(a.AR.touchMoveEvent,this.mouseMoveHandler),this.chart.off(a.AR.touchStartEvent,this.mouseDownHandler),this.chart.off(a.AR.touchEndEvent,this.mouseUpHandler),this.chart.off(this.cancelEvent,this.mouseCancelHandler))}chartMouseWheel(e){const t=this.chart,i=t.element.getBoundingClientRect(),s=Yt(t.svgId).getBoundingClientRect(),o=e.clientX-i.left-Math.max(s.left-i.left,0),l=e.clientY-i.top-Math.max(s.top-i.top,0);return this.zooming.enableMouseWheelZooming&&Dt(o,l,t.chartAxisLayoutPanel.seriesClipRect)&&(e.preventDefault(),this.performMouseWheelZooming(e,o,l,t,t.axisCollections)),!1}mouseMoveHandler(e){const t=this.chart;let i=null;"touchmove"===e.type&&(e.preventDefault&&this.isIOS&&(this.isPanning||t.isDoubleTap||this.zooming.enablePinchZooming&&this.touchStartList.length>1)&&e.preventDefault(),i=e.touches),t.isChartDrag&&(t.isTouch&&(this.touchMoveList=this.addTouchPointer(this.touchMoveList,e,i),this.zooming.enablePinchZooming&&this.touchMoveList.length>1&&this.touchStartList.length>1&&this.performPinchZooming(e,t)),this.renderZooming(e,t,t.isTouch))}mouseDownHandler(e){const t=this.chart;let i,s=null;"touchstart"===e.type?(s=e.touches,i=e.target):i=e.target,-1===i.id.indexOf(t.element.id+"_Zooming_")&&Dt(t.previousMouseMoveX,t.previousMouseMoveY,t.chartAxisLayoutPanel.seriesClipRect)&&(t.isChartDrag=!0),t.isTouch&&(this.touchStartList=this.addTouchPointer(this.touchStartList,e,s))}mouseUpHandler(e){const t=this.chart,i=-1===e.target.id.indexOf(t.element.id+"_ZoomOut_")||-1===e.target.id.indexOf(t.element.id+"_ZoomIn_");(t.isChartDrag||i)&&this.redrawOnZooming(t,!0,!0),t.isTouch&&(t.isDoubleTap&&Dt(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect)&&1===this.touchStartList.length&&this.isZoomed&&this.toolkit.reset(),this.touchStartList=[],t.isDoubleTap=!1)}mouseCancelHandler(){this.isZoomed&&this.performZoomRedraw(this.chart),this.pinchTarget=null,this.touchStartList=[],this.touchMoveList=[]}addTouchPointer(e,t,i){if(i){e=[];for(let t=0,s=i.length;t<s;t++)e.push({pageX:i[t].clientX,pageY:i[t].clientY,pointerId:null})}else if(0===(e=e||[]).length)e.push({pageX:t.clientX,pageY:t.clientY,pointerId:t.pointerId});else for(let s=0,o=e.length;s<o;s++)e[s].pointerId===t.pointerId?e[s]={pageX:t.clientX,pageY:t.clientY,pointerId:t.pointerId}:e.push({pageX:t.clientX,pageY:t.clientY,pointerId:t.pointerId});return e}getModuleName(){return"Zoom"}destroy(){this.removeEventListener()}}class js extends class{constructor(e){this.control=e}seriesStyles(){let e,t,i,s=document.getElementById(this.styleId),o="{}";const l=this.control.selectionPattern,r=this.control.highlightPattern;if((0,a.le)(s)||"None"!==l||"None"!==r){s=document.createElement("style"),s.setAttribute("id",this.styleId);for(const n of this.control.visibleSeries){const h=this.control.visibleSeries[n.index]||this.control.visibleSeries[n.index];if(!((0,a.le)(l)&&(0,a.le)(r)||"None"===l&&"None"===r)){const e=this.styleId.indexOf("highlight")>0?r:l;if("Pie"===h.type||"Funnel"===h.type||"Pyramid"===h.type)for(let s=0;s<h.points.length;s++)i=h.opacity,t=this.pattern(this.control,h.points[s].color,n.index,e,i),o="{ fill:"+t+"}";else h.type&&(i=h.opacity,t=this.pattern(this.control,h.interior,n.index,e,i),o="{ fill:"+t+"}")}e=n.selectionStyle||this.styleId+"_series_"+n.index+",."+this.styleId+"_series_"+n.index+"> *",o=o.indexOf("None")>-1?"{}":o,s.innerHTML+=n.selectionStyle?"":"."+e+o}s.innerHTML+="."+this.unselected+" { opacity:0.3;} ",document.body.appendChild(s)}}pattern(e,t,i,s,o){const l="#ffffff",a=e.svgObject,r=[],n={id:e.element.id+"_"+s+"_Selection_"+i,patternUnits:"userSpaceOnUse"},h=10,d=12;switch(s){case"Dots":n.height=n.width=6,n.width=6,r[0]={x:0,y:0,width:7,height:7,transform:"translate(0,0)",fill:l,opacity:o,name:"rect"},r[1]={cx:3,cy:3,r:2,"stroke-width":1,fill:t,name:"circle"};break;case"Pacman":n.height="18.384",n.width="17.917",r[0]={name:"rect",x:0,y:0,width:17.917,height:18.384,transform:"translate(0,0)",fill:l,opacity:o},r[1]={name:"path",d:"M9.081,9.194l5.806-3.08c-0.812-1.496-2.403-3.052-4.291-3.052H8.835C6.138,3.063,3,6.151,3,8.723v1.679   c0,2.572,3.138,5.661,5.835,5.661h1.761c2.085,0,3.835-1.76,4.535-3.514L9.081,9.194z","stroke-width":1,stroke:t,fill:t};break;case"Chessboard":n.height=n.width=h,r[0]={x:0,y:0,width:h,height:h,fill:l,opacity:o,name:"rect"},r[1]={x:0,y:0,width:5,height:5,fill:t,opacity:o,name:"rect"},r[2]={x:5,y:5,width:5,height:5,fill:t,opacity:o,name:"rect"};break;case"Crosshatch":n.height=n.width="8",r[0]={x:0,y:0,width:8,height:8,transform:"translate(0,0)",fill:l,opacity:o,name:"rect"},r[1]={d:"M0 0L8 8ZM8 0L0 8Z","stroke-width":1,stroke:t,name:"path"};break;case"DiagonalForward":n.height=n.width=6,r[0]={x:0,y:0,width:6,height:6,transform:"translate(0,0)",fill:l,opacity:o,name:"rect"},r[1]={d:"M 3 -3 L 9 3 M 6 6 L 0 0 M 3 9 L -3 3","stroke-width":2,stroke:t,name:"path"};break;case"DiagonalBackward":n.height=n.width=6,r[0]={x:0,y:0,width:6,height:6,transform:"translate(0,0)",fill:l,opacity:o,name:"rect"},r[1]={d:"M 3 -3 L -3 3 M 0 6 L 6 0 M 9 3 L 3 9","stroke-width":2,stroke:t,name:"path"};break;case"Grid":n.height=n.width=6,r[0]={name:"rect",x:0,y:0,width:6,height:6,transform:"translate(0,0)",fill:l,opacity:o},r[1]={name:"path",d:"M1 3.5L11 3.5 M0 3.5L11 3.5 M0 7.5L11 7.5 M0 11.5L11 11.5 M5.5 0L5.5 12 M11.5 0L11.5 12Z","stroke-width":1,stroke:t};break;case"Turquoise":n.height=n.width=17,r[0]={name:"rect",x:0,y:0,width:17,height:17,transform:"translate(0,0)",fill:l,opacity:o},r[1]={name:"path",d:"M0.5739999999999998,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":h,stroke:t,fill:t},r[2]={name:"path",d:"M11.805,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":h,stroke:t,fill:t},r[3]={name:"path",d:"M6.19,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":h,stroke:t,fill:t},r[4]={name:"path",d:"M11.805,8.217a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":h,stroke:t,fill:t},r[5]={name:"path",d:"M6.19,8.217a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":h,stroke:t,fill:t},r[6]={name:"path",d:"M11.805,13.899a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":h,stroke:t,fill:t},r[7]={name:"path",d:"M6.19,13.899a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":h,stroke:t,fill:t};break;case"Star":n.height=n.width=21,r[0]={name:"rect",x:0,y:0,width:21,height:21,transform:"translate(0,0)",fill:l,opacity:o},r[1]={name:"path",d:"M15.913,18.59L10.762 12.842 5.613 18.75 8.291 11.422 0.325 9.91 8.154 8.33 5.337 0.91 10.488 6.658 15.637 0.75 12.959 8.078 20.925 9.59 13.096 11.17 z","stroke-width":1,stroke:t,fill:t};break;case"Triangle":n.height=n.width=h,r[0]={name:"rect",x:0,y:0,width:h,height:h,transform:"translate(0,0)",fill:l,opacity:o},r[1]={name:"path",d:"M4.987,0L7.48 4.847 9.974 9.694 4.987 9.694 0 9.694 2.493 4.847 z","stroke-width":1,stroke:t,fill:t};break;case"Circle":n.height=n.width=9,r[0]={name:"rect",x:0,y:0,width:9,height:9,transform:"translate(0,0)",fill:l,opacity:o},r[1]={name:"circle",cx:5.125,cy:3.875,r:3.625,"stroke-width":1,fill:t};break;case"Tile":n.height=n.width=18,r[0]={name:"rect",x:0,y:0,width:18,height:18,transform:"translate(0,0)",fill:l,opacity:o},r[1]={name:"path",d:"M0,9L0 0 9 0 z","stroke-width":1,stroke:t,fill:t},r[2]={name:"path",d:"M9,9L9 0 18 0 z","stroke-width":1,stroke:t,fill:t},r[3]={name:"path",d:"M0,18L0 9 9 9 z","stroke-width":1,stroke:t,fill:t},r[4]={name:"path",d:"M9,18L9 9 18 9 z","stroke-width":1,stroke:t,fill:t};break;case"HorizontalDash":n.height=n.width=d,r[0]={name:"rect",x:0,y:0,width:d,height:d,transform:"translate(0,0)",fill:l,opacity:o},r[1]={name:"path",d:"M0,1.5 L10 1.5 M0,5.5 L10 5.5 M0,9.5 L10 9.5 z","stroke-width":1,stroke:t,fill:t};break;case"VerticalDash":n.height=n.width=d,r[0]={name:"rect",x:0,y:0,width:d,height:d,transform:"translate(0,0)",fill:l,opacity:o},r[1]={name:"path",d:"M1.5,0 L1.5 10 M5.5,0 L5.5 10 M9.5,0 L9.5 10 z","stroke-width":1,stroke:t,fill:t};break;case"Rectangle":n.height=n.width=d,r[0]={name:"rect",width:d,height:d,fill:l,opacity:o},r[1]={name:"rect",x:1,y:2,width:4,height:9,fill:t,opacity:o},r[2]={name:"rect",x:7,y:2,width:4,height:9,fill:t,opacity:o};break;case"Box":n.height=n.width=h,r[0]={name:"rect",width:13,height:13,fill:l,opacity:o},r[1]={name:"rect",x:1.5,y:1.5,width:h,height:9,fill:t,opacity:o};break;case"HorizontalStripe":n.height=d,n.width=h,r[0]={name:"rect",x:0,y:0,width:h,height:d,transform:"translate(0,0)",fill:l,opacity:o},r[1]={name:"path",d:"M0,0.5 L10 0.5 M0,4.5 L10 4.5 M0,8.5 L10 8.5 z","stroke-width":1,stroke:t,fill:t};break;case"VerticalStripe":n.height=h,n.width=d,r[0]={name:"rect",x:0,y:0,width:d,height:h,transform:"translate(0,0)",fill:l,opacity:o},r[1]={name:"path",d:"M0.5,0 L0.5 10 M4.5,0 L4.5 10 M8.5,0 L8.5 10 z","stroke-width":1,stroke:t,fill:t};break;case"Bubble":n.height=n.width=20,r[0]={name:"rect",x:0,y:0,width:20,height:20,transform:"translate(0,0)",fill:l,opacity:o},r[1]={name:"circle",cx:5.217,cy:11.325,r:3.429,"stroke-width":1,fill:"#D0A6D1"},r[2]={name:"circle",cx:13.328,cy:6.24,r:4.884,"stroke-width":1,fill:t},r[3]={name:"circle",cx:13.277,cy:14.66,r:3.018,"stroke-width":1,fill:"#D0A6D1"}}const c=e.svgRenderer||e.renderer,p=c.createPattern(n,"pattern");return this.loadPattern(e,r,p,c),a.appendChild(p),"url(#"+e.element.id+"_"+s+"_Selection_"+i+")"}loadPattern(e,t,i,s){let o;for(o=0;o<t.length;o++){const e=s.createPattern(t[o],t[o].name);i.appendChild(e)}}concatIndexes(e,t){return e.concat(t)}checkVisibility(e){if(!e)return!1;let t=!1;const i=[];for(const s of e)-1===i.indexOf(s.series)&&i.push(s.series);for(const s of i)if(this.control.series[s].visible){t=!0;break}return t}addSvgClass(e,t){let i=e.getAttribute("class")||"";i+=""!==i?" ":"",-1===i.indexOf(t)&&e.setAttribute("class",i+t)}removeSvgClass(e,t){const i=e.getAttribute("class")||"";i.indexOf(t)>-1&&e.setAttribute("class",i.replace(t,""))}getChildren(e){const t=[];for(let i=0;i<e.childNodes.length;i++)"defs"!==e.childNodes[i].tagName&&t.push(e.childNodes[i]);return t}}{constructor(e){super(e),this.isdrawRect=!0,this.multiDataIndexes=[],this.pathIndex=0,this.seriesIndex=0,this.count=-1,this.dragRectArray=[],this.filterArray=[],this.totalSelectedPoints=[],this.chart=e,this.renderer=e.renderer,this.isMultiDrag=e.isMultiSelect&&e.selectionMode.indexOf("Drag")>-1,this.addEventListener()}addEventListener(){if(this.chart.isDestroyed||this.chart.stockChart&&this.chart.stockChart.onPanning)return;const e=a.AR.isPointer?"pointerleave":"mouseleave";this.chart.on(a.AR.touchMoveEvent,this.mouseMove,this),this.chart.on(e,this.completeSelection,this),this.chart.on("click",this.calculateSelectedElements,this),this.chart.on(a.AR.touchStartEvent,this.mousedown,this),this.chart.on(a.AR.touchEndEvent,this.completeSelection,this)}mousedown(e){const t=this.chart;t.isPointMouseDown||"None"===t.selectionMode||t.isChartDrag||(t.isDoubleTap||!t.isTouch||this.rectPoints)&&this.dragStart(t,t.chartAxisLayoutPanel.seriesClipRect,t.mouseDownX,t.mouseDownY,e)}removeEventListener(){this.chart.isDestroyed||(this.chart.off(a.AR.touchMoveEvent,this.mouseMove),this.chart.off("pointerleave",this.completeSelection),this.chart.off("click",this.calculateSelectedElements),this.chart.off(a.AR.touchStartEvent,this.mousedown),this.chart.off(a.AR.touchEndEvent,this.completeSelection))}initPrivateVariables(e){this.styleId=e.element.id+"_ej2_chart_selection",this.unselected=e.element.id+"_ej2_deselected",this.closeIconId=e.element.id+"_ej2_drag_close",this.draggedRectGroup=e.element.id+"_ej2_drag_group",this.multiRectGroup=e.element.id+"_ej2_drag_multi_group",this.draggedRect=e.element.id+"_ej2_drag_rect",this.lassoPath=e.element.id+"_ej2_drag_path",this.selectedDataIndexes=[],this.rectPoints=null,this.isSeriesMode="Series"===e.selectionMode}invokeSelection(e){this.initPrivateVariables(e),this.series=(0,a.l7)({},e.visibleSeries,null,!0),this.seriesStyles(),this.currentMode=e.selectionMode,e.selectionMode.indexOf("Drag")>-1||this.selectDataIndex(e,this.concatIndexes(e.selectedDataIndexes,this.selectedDataIndexes))}generateStyle(e){return e?(this.styleId.indexOf("selection")>1&&"None"!==this.chart.selectionMode&&(this.unselected=e.unSelectedStyle||this.unselected),this.styleId.indexOf("highlight")>0&&"None"!==this.chart.highlightMode&&(this.unselected=e.nonHighlightStyle||this.unselected),e.selectionStyle||this.styleId+"_series_"+e.index):"undefined"}selectDataIndex(e,t){for(const i of t)this.performSelection(i,e,this.getElementByIndex(e,i)[0])}getElementByIndex(e,t,i=""){let s=e.element.id+"_Series_"+t.series+"_Point_"+t.point;const o=e.series[t.series];return s=!o.isRectSeries&&"Scatter"!==o.type&&"Bubble"!==o.type&&o.marker.visible?s+"_Symbol"+i:s,[Yt(s),"RangeArea"!==o.type&&"SplineRangeArea"!==o.type||!o.marker.visible?null:Yt(s+"1")]}getClusterElements(e,t){const i=[];let s,o;for(const l of e.visibleSeries)l.visible&&(t=new $(l.index,t.point),i.push(this.getElementByIndex(e,t)[0]),s=this.generateStyle(e.visibleSeries[t.series]),o=document.querySelectorAll("."+s),this.findTrackballElements(o,s),!e.isMultiSelect&&o.length>0&&o[0].id!==i[i.length-1].id&&this.removeSelection(e,t.series,o,s,!0));return i}findTrackballElements(e,t){let i,s;for(let o=0;o<e.length;o++)if(!(0,a.le)(e[o])&&(i=(0,a.le)(e[o].parentNode)?[]:[].slice.call(e[0].parentNode.querySelectorAll("."+t)),i.length>0)){s=[];for(let e=0;e<i.length;e++)i[e].id.indexOf("Trackball")>-1&&s.push(i[e]);this.removeStyles(s)}}findElements(e,t,i,s=""){return this.isSeriesMode?this.getSeriesElements(t):"Cluster"===this.currentMode?this.getClusterElements(e,i):this.getElementByIndex(e,i,s)}isAlreadySelected(e){const t=e.target;if("click"===e.type?(this.currentMode=this.chart.selectionMode,this.styleId=this.chart.element.id+"_ej2_chart_selection"):"mousemove"===e.type&&(this.currentMode=this.chart.highlightMode,this.highlightDataIndexes=[],this.styleId=this.chart.element.id+"_ej2_chart_highlight"),"None"!==this.chart.highlightMode&&"None"===this.chart.selectionMode&&"click"===e.type)return!1;if("None"!==this.chart.highlightMode&&this.previousSelectedEle&&this.previousSelectedEle[0]){const i=t.parentNode.id;let s;t.parentNode&&(s=i.indexOf("SeriesGroup")>0||i.indexOf("SymbolGroup")>0);for(let t=0;t<this.previousSelectedEle.length;t++)this.previousSelectedEle[t].hasAttribute("class")&&(this.previousSelectedEle[t].getAttribute("class").indexOf("highlight")>-1&&(s||"click"===e.type)?(this.previousSelectedEle[t].removeAttribute("class"),this.addOrRemoveIndex(this.highlightDataIndexes,this.indexFinder(this.previousSelectedEle[t].id))):!s&&this.previousSelectedEle[t].getAttribute("class").indexOf("highlight")>-1&&this.performSelection(this.indexFinder(this.previousSelectedEle[t].id),this.chart,this.previousSelectedEle[t]))}return!0}calculateSelectedElements(e){if((0,a.le)(e.target))return;const t=e.target;if(("None"!==this.chart.selectionMode||"None"!==this.chart.highlightMode)&&-1!==t.id.indexOf(this.chart.element.id+"_")){if("mousemove"===e.type){if(t.hasAttribute("class")&&(t.getAttribute("class").indexOf("highlight")>-1||t.getAttribute("class").indexOf("selection")>-1))return;if(!(0,a.le)(t.parentNode)&&t.parentNode.hasAttribute("class")&&(t.parentNode.getAttribute("class").indexOf("highlight")>0||t.parentNode.getAttribute("class").indexOf("selection")>0))return}if(this.isAlreadySelected(e),t.id.indexOf("_Series_")>-1){let e;if(t.id.indexOf("_Trackball_1")>-1)e=Yt(t.id.split("_Trackball_")[0]+"_Symbol"),e=(0,a.le)(e)?Yt(t.id.split("_Trackball_")[0]):e;else if(t.id.indexOf("_Trackball_0")>-1)return null;this.performSelection(this.indexFinder(t.id),this.chart,e||t)}}}performSelection(e,t,i){if(this.isSeriesMode="Series"===this.currentMode,"BoxAndWhisker"===t.series[e.series].type&&i&&i.id===t.element.id+"_Series_"+e.series+"_Point_"+e.point+"_BoxPath"&&(i=i.parentNode),"Area"===t.series[e.series].type&&("Point"===this.currentMode||"Cluster"===this.currentMode)&&i&&i.id===this.chart.element.id+"_Series_"+e.series){const i=this.generateStyle(t.series[e.series]),s=document.querySelectorAll("."+i);this.findTrackballElements(s,i),this.blurEffect(t.element.id,t.visibleSeries)}switch(this.currentMode){case"Series":this.selection(t,e,this.getSeriesElements(t.series[e.series])),this.selectionComplete(t,e,this.currentMode),this.blurEffect(t.element.id,t.visibleSeries);break;case"Point":!isNaN(e.point)&&i&&(this.selection(t,e,[i]),this.selectionComplete(t,e,this.currentMode),this.blurEffect(t.element.id,t.visibleSeries));break;case"Cluster":isNaN(e.point)||(this.clusterSelection(t,e),this.selectionComplete(t,e,this.currentMode),this.blurEffect(t.element.id,t.visibleSeries))}}selectionComplete(e,t,i){let s,o,l;const a=[];let r,n;if("Cluster"===i){for(const h of e.visibleSeries)if(h.visible)for(let i=0;i<this.selectedDataIndexes.length;i++)o=e.isMultiSelect?this.selectedDataIndexes[i].point:t.point,l=h.index,s=h.points,isNaN(o)||(r=s[o].yValue,n=s[o].xValue,"Category"===e.primaryXAxis.valueType?n=s[o].x.toLocaleString():"DateTime"===e.primaryXAxis.valueType&&(n=new Date(s[o].xValue)),"Indicator"!==h.category&&a.push({x:n,y:r,seriesIndex:l,pointIndex:o}),"RangeArea"!==h.type&&"SplineRangeArea"!==h.type||a.push({x:n,y:s[o].regions[0].y,seriesIndex:l,pointIndex:o}))}else if("Series"===i)if(e.isMultiSelect)for(let h=0;h<this.selectedDataIndexes.length;h++)l=this.selectedDataIndexes[h].series,a.push({seriesIndex:l});else l=this.selectedDataIndexes.length>0?this.selectedDataIndexes[0].series:0,a.push({seriesIndex:l});else if("Point"===i)for(let h=0;h<this.selectedDataIndexes.length;h++)o=this.selectedDataIndexes[h].point,l=this.selectedDataIndexes[h].series,s=e.series[l].points,isNaN(o)||(n=s[o].xValue,r=s[o].yValue,"Category"===e.primaryXAxis.valueType?n=s[o].x.toLocaleString():"DateTime"===e.primaryXAxis.valueType&&(n=new Date(s[o].xValue)),a.push({x:n,y:r,seriesIndex:l,pointIndex:o}));e.trigger(Ae,{name:Ae,selectedDataValues:a,cancel:!1})}selection(e,t,i){if("Lasso"!==this.currentMode&&(e.isMultiSelect||-1!==this.currentMode.indexOf("Drag")||-1!==this.styleId.indexOf("highlight")||"None"===e.selectionMode||this.removeMultiSelectElements(e,this.selectedDataIndexes,t,e.series)),!(0,a.le)(i[0])){let s;const o=i[0]&&(i[0].getAttribute("class")||""),l=i[0].parentNode&&(i[0].parentNode.getAttribute("class")||"");""!==o&&"Cluster"!==this.currentMode&&this.findTrackballElements(i,o),i[0]&&o.indexOf(this.getSelectionClass(i[0].id))>-1?this.removeStyles(i):i[0].parentNode&&l.indexOf(this.getSelectionClass(i[0].id))>-1?this.removeStyles([i[0].parentNode]):(this.previousSelectedEle="None"!==e.highlightMode?i:[],this.applyStyles(i),s=!0),this.styleId.indexOf("highlight")>0&&"None"!==e.highlightMode?this.addOrRemoveIndex(this.highlightDataIndexes,t,s):this.addOrRemoveIndex(this.selectedDataIndexes,t,s)}}clusterSelection(e,t){this.selection(e,t,this.getClusterElements(e,new $(t.series,t.point)))}removeMultiSelectElements(e,t,i,s){let o;for(let l=0;l<t.length;l++)o=s[t[l].series],(this.isSeriesMode&&!this.toEquals(t[l],i,this.isSeriesMode)||"Cluster"===this.currentMode&&!this.toEquals(t[l],i,!1)||!this.isSeriesMode&&this.toEquals(t[l],i,!0)&&!this.toEquals(t[l],i,!1))&&(this.removeStyles(this.findElements(e,o,t[l])),t.splice(l,1),l--)}blurEffect(e,t,i=!1){const s=this.checkVisibility(this.highlightDataIndexes)||this.checkVisibility(this.selectedDataIndexes);for(const o of t)o.visible&&(this.checkSelectionElements(Yt(e+"SeriesGroup"+o.index),this.generateStyle(o),s,i,o.index),(0,a.le)(Yt(e+"SymbolGroup"+o.index))||this.checkSelectionElements(Yt(e+"SymbolGroup"+o.index),this.generateStyle(o),s,i,o.index))}checkSelectionElements(e,t,i,s,o){let l,a,r,n=this.isSeriesMode?[e]:e.childNodes;"None"!==this.chart.selectionMode&&"None"!==this.chart.highlightMode&&(n=e.children);let h=e;for(let d=0;d<n.length;d++)l=n[d].getAttribute("class")||"",a=n[d].parentNode.getAttribute("class")||"","None"!==this.chart.selectionMode&&"None"!==this.chart.highlightMode&&(t=l.indexOf("selection")>0||l.indexOf("highlight")>0?l:t,t=a.indexOf("selection")>0||a.indexOf("highlight")>0?a:t),-1===l.indexOf(t)&&-1===a.indexOf(t)&&i?this.addSvgClass(n[d],this.unselected):(h=n[d],this.removeSvgClass(n[d],this.unselected),this.removeSvgClass(n[d].parentNode,this.unselected)),n[d].id.indexOf("Trackball")>0&&h.classList[0]===t&&(this.removeSvgClass(n[d],this.unselected),this.removeSvgClass(n[d].parentNode,this.unselected),this.addSvgClass(n[d],t));if(e.id.indexOf("Symbol")>-1&&e.querySelectorAll("."+t)[0]&&e.querySelectorAll("."+t)[0].getAttribute("class")===t){const t=Yt(this.control.element.id+"_Series_"+e.id[e.id.length-1]);(t&&t.hasAttribute("class")?t.getAttribute("class"):"").indexOf(this.unselected)>-1&&this.removeSvgClass(t,this.unselected)}this.control.legendModule&&this.control.legendSettings.visible&&(r=Yt(this.control.element.id+"_chart_legend_shape_"+o),r&&(r.hasAttribute("class")&&this.removeSvgClass(r,r.getAttribute("class")),l=h.getAttribute("class")||"",a=h.parentNode.getAttribute("class")||"",-1===l.indexOf(t)&&-1===a.indexOf(t)&&i?(this.addSvgClass(r,this.unselected),this.removeSvgClass(r,t)):(this.removeSvgClass(r,this.unselected),""===l&&""===a||"EJ2-Trackball"===l.trim()?this.removeSvgClass(r,t):this.addSvgClass(r,t)),s&&a.indexOf(t)>-1&&this.addSvgClass(r,t)))}applyStyles(e){for(const t of e)t&&(this.removeSvgClass(t.parentNode,this.unselected),this.removeSvgClass(t,this.unselected),this.addSvgClass(t,this.getSelectionClass(t.id)))}getSelectionClass(e){return this.generateStyle(this.control.series[this.indexFinder(e).series])}removeStyles(e){for(const t of e)t&&this.removeSvgClass(t,this.getSelectionClass(t.id))}addOrRemoveIndex(e,t,i){for(let s=0;s<e.length;s++)this.toEquals(e[s],t,this.isSeriesMode)&&(e.splice(s,1),s--);i&&e.push(t)}toEquals(e,t,i){return(e.series===t.series||"Cluster"===this.currentMode&&!i)&&(i||e.point===t.point)}redrawSelection(e,t,i){this.isSeriesMode="Series"===t,(0,a.le)(t)||(e.isRedrawSelection=-1===t.indexOf("Drag")&&"Lasso"!==t&&!i);let s=(0,a.l7)([],this.selectedDataIndexes,null,!0);const o=(0,a.l7)([],this.highlightDataIndexes,null,!0);this.styleId.indexOf("highlight")>0&&o.length>0?(this.removeSelectedElements(e,this.highlightDataIndexes,e.series),s=o):this.removeSelectedElements(e,this.selectedDataIndexes,e.series),this.blurEffect(e.element.id,e.visibleSeries),this.selectDataIndex(e,s)}legendSelection(e,t,i){let s=i.target;if("mousemove"===i.type){if(i.target.id.indexOf("text")>1&&(s=Yt(i.target.id.replace("text","shape"))),s.hasAttribute("class")&&(s.getAttribute("class").indexOf("highlight")>-1||s.getAttribute("class").indexOf("selection")>-1))return;this.currentMode=this.chart.highlightMode}if(this.isAlreadySelected(i)){let i=this.generateStyle(e.visibleSeries[t]),s=document.querySelectorAll("."+i);this.isSeriesMode="Series"===this.currentMode;const o=!0;if(s.length>0)this.removeSelection(e,t,s,i,o);else{for(const a of e.visibleSeries)a.index===t||e.isMultiSelect||(i=this.generateStyle(e.visibleSeries[a.index]),s=document.querySelectorAll("."+i),this.removeSelection(e,t,s,i,o));const l=this.getSeriesElements(e.visibleSeries[t]);for(const e of l){if((0,a.le)(e))return;this.checkSelectionElements(e,i,!1,!0,t)}this.isSeriesMode=!0,this.selection(e,new $(t,NaN),l),this.isSeriesMode="Series"===e.selectionMode,this.blurEffect(e.element.id,e.visibleSeries,!0)}}}removeSelection(e,t,i,s,o){if(i.length>0){const l=[];for(let e=0;e<i.length;e++)l.push(i[e]);this.removeStyles(l),this.isSeriesMode=!0,this.addOrRemoveIndex(this.selectedDataIndexes,new $(t,NaN));for(const i of e.visibleSeries)if(s=this.generateStyle(i),document.querySelectorAll("."+s).length>0){for(const e of l)this.checkSelectionElements(e,s,!0,!0,t);o=!1;break}o&&(this.isSeriesMode="Series"===e.selectionMode,this.blurEffect(e.element.id,e.visibleSeries))}}getSeriesElements(e){const t=[e.seriesElement];return e.marker.visible&&"Scatter"!==e.type&&"Bubble"!==e.type&&!e.isRectSeries&&t.push(e.symbolElement),t}indexFinder(e){let t=["NaN","NaN"];return e.indexOf("SeriesGroup")>-1?(t=e.split("SeriesGroup"),t[0]=t[1]):e.indexOf("SymbolGroup")>-1?(t=e.split("SymbolGroup"),t[0]=t[1]):e.indexOf("_Point_")>-1?t=e.split("_Series_")[1].split("_Point_"):e.indexOf("_Series_")>-1?t[0]=e.split("_Series_")[1]:e.indexOf("_chart_legend_shape_")>-1&&(t=e.split("_chart_legend_shape_"),t[0]=t[1]),new $(parseInt(t[0],10),parseInt(t[1],10))}calculateDragSelectedElements(e,t,i){this.removeSelectedElements(e,this.selectedDataIndexes,e.series);const s="Lasso"===e.selectionMode,o=new C(t.x,t.y,t.width,t.height),l=new Ri(e.chartAxisLayoutPanel.seriesClipRect.x,e.chartAxisLayoutPanel.seriesClipRect.y);let a,r;this.removeOffset(o,l);let n=[];const h=[];this.isSeriesMode=!1;const d=e.allowMultiSelection&&(this.rectGrabbing||this.resizing);if(this.rectPoints=this.dragRectArray[d?this.targetIndex:this.count]=new C(t.x,t.y,t.width,t.height),t.width&&t.height&&!i){const e=new C(t.x,t.y,t.width,t.height);this.removeOffset(e,l),this.filterArray[d?this.targetIndex:this.count]=e}for(const c of e.visibleSeries)if(c.visible){let t,i;a=c.points,n=[],!e.isTransposed&&-1===c.type.indexOf("Bar")||e.isTransposed&&-1!==c.type.indexOf("Bar")?(t=c.xAxis.rect.x-l.x,i=c.yAxis.rect.y-l.y):(t=c.xAxis.rect.y-l.y,i=c.yAxis.rect.x-l.x);for(let s=0;s<a.length;s++){const l=a[s].yValue;let h,d=a[s].xValue;"Category"===e.primaryXAxis.valueType?d=a[s].x.toLocaleString():"DateTime"===e.primaryXAxis.valueType&&(d=new Date(a[s].xValue)),h="BoxAndWhisker"===c.type?a[s].regions.some(e=>Dt(e.x+t,e.y+i,o)):"Lasso"===e.selectionMode?a[s].isSelect:e.allowMultiSelection?this.isPointSelect(a[s],t,i,this.filterArray):a[s].symbolLocations.some(e=>e&&Dt(e.x+t,e.y+i,o)),h&&"Indicator"!==c.category&&(r=new $(c.index,a[s].index),this.selection(e,r,this.findElements(e,c,r)),n.push({x:d,y:l})),!h||"RangeArea"!==c.type&&"SplineRangeArea"!==c.type||n.push({x:d,y:a[s].regions[0].y})}h.push(n)}this.blurEffect(e.element.id,e.visibleSeries),i||this.createCloseButton(s?e.mouseDownX:t.x+t.width,s?e.mouseDownY:t.y),e.trigger(Le,{name:Le,selectedDataValues:h,cancel:!1})}removeOffset(e,t){e.x-=t.x,e.y-=t.y}isPointSelect(e,t,i,s){const o=e.symbolLocations[0];for(const l of s)if(l&&o&&Dt(o.x+t,o.y+i,l))return!0;return!1}drawDraggingRect(e,t,i){const s=e.chartAxisLayoutPanel.seriesClipRect,o=e.chartArea.border.width,l=e.themeStyle.selectionRectFill,r=e.themeStyle.selectionRectStroke,n="Lasso"===e.selectionMode;switch(this.isdrawRect&&(s.x=s.x-o/2,s.y=s.y-o/2,s.width=s.width+o,s.height=s.height+o,this.isdrawRect=!1),e.selectionMode){case"DragX":t.y=s.y,t.height=s.height;break;case"DragY":t.x=s.x,t.width=s.width}if((t.width<5||t.height<5)&&!n)return null;const h=e.selectionMode.indexOf("Drag")>-1||"Lasso"===e.selectionMode;if(e.allowMultiSelection&&h){let i,s,o=Yt(this.multiRectGroup);if(o||(o=e.svgRenderer.createGroup({id:this.multiRectGroup}),e.svgObject.appendChild(o)),this.rectGrabbing||this.resizing){let e;e=Yt(this.draggedRect+this.targetIndex),e.nextSibling&&(0,a.Od)(e.nextSibling),this.setAttributes(e,t)}else if(!Yt(this.draggedRectGroup+this.count)){s=e.svgRenderer.createGroup({id:this.draggedRectGroup+this.count});const t=document.getElementById(e.element.id+"_series_svg");e.enableCanvas?t.appendChild(s):o.appendChild(s)}"Lasso"!==e.selectionMode?(i=e.svgRenderer.drawRectangle(new Ti(this.draggedRect+this.count,l,{color:r,width:1},1,t)),i.setAttribute("style","cursor:move;")):i=e.svgRenderer.drawPath(new I(this.lassoPath+this.count,l,3,r,1,"",this.path)),s||this.rectGrabbing||this.resizing?this.rectGrabbing||this.resizing||s.appendChild(i):Yt(this.draggedRectGroup+this.count).appendChild(i)}else{let i=Yt(n?this.lassoPath:this.draggedRect);if(this.closeIcon&&nt(this.closeIconId),i)n?i.setAttribute("d",this.path):this.setAttributes(i,t);else{const s=e.svgRenderer.createGroup({id:this.draggedRectGroup}),o=document.getElementById(e.element.id+"_series_svg");e.enableCanvas?o.appendChild(s):e.svgObject.appendChild(s),i="Lasso"!==e.selectionMode?e.svgRenderer.drawRectangle(new Ti(this.draggedRect,l,{color:r,width:1},1,t)):e.svgRenderer.drawPath(new I(this.lassoPath,l,3,r,1,"",this.path)),s.appendChild(i)}}}getIndex(e){let t;for(t=e.length-1;t>0;t--){const i=Number(e[t]);if(isNaN(i))break}return+e.substr(t+1,e.length-1)}createCloseButton(e,t){const i=this.chart.allowMultiSelection,s=this.chart.themeStyle.selectionCircleStroke,o=this.rectGrabbing||this.resizing,l=this.chart.svgRenderer.createGroup({id:this.closeIconId+(i?o?this.targetIndex:this.count:""),style:"cursor:pointer; visibility: visible;"});l.appendChild(this.chart.svgRenderer.drawCircle(new Ai(this.closeIconId+"_circle"+(i?o?this.targetIndex:this.count:""),"#FFFFFF",{color:s,width:1},1,e,t,10))),l.appendChild(this.chart.svgRenderer.drawPath({id:this.closeIconId+"_cross"+(i?o?this.targetIndex:this.count:""),d:"M "+(e-4)+" "+(t-4)+" L "+(e+4)+" "+(t+4)+" M "+(e-4)+" "+(t+4)+" L "+(e+4)+" "+(t-4),stroke:s,"stroke-width":2,fill:s})),this.closeIcon=l;const a=Yt(this.draggedRectGroup+(i?o?this.targetIndex:this.count:""));a&&a.appendChild(l)}removeDraggedElements(e,t){if(t.target.id.indexOf(this.closeIconId)>-1&&-1===t.type.indexOf("move")){let i=!0;if(e.allowMultiSelection){const s=this.getIndex(t.target.id),o=Yt(this.multiRectGroup);if((0,a.Od)(Yt(this.draggedRectGroup+s)),this.dragRectArray[s]=null,this.filterArray[s]=null,this.totalSelectedPoints[s]=null,o&&0===o.childElementCount&&(nt(o),this.dragRectArray=[],this.filterArray=[],this.totalSelectedPoints=[]),"Lasso"===this.currentMode){if(null!=this.multiDataIndexes[s])for(let e=0;e<this.multiDataIndexes[s].length;e++)this.multiDataIndexes[s][e].isSelect=!1;this.multiDataIndexes[s]=null;for(let e=0;e<this.multiDataIndexes.length;e++)if(null!=this.multiDataIndexes[e]){i=!1;for(let t=0;t<this.multiDataIndexes[e].length;t++)this.multiDataIndexes[e][t].isSelect=!0}this.calculateDragSelectedElements(e,this.dragRect,!0)}else if(this.filterArray.length)for(let t=0;t<this.filterArray.length;t++)this.filterArray[t]&&(i=!1,this.calculateDragSelectedElements(e,this.filterArray[t],!0));else this.calculateDragSelectedElements(e,new C(0,0,0,0),!0)}else(0,a.Od)(Yt(this.draggedRectGroup)),this.removeSelectedElements(e,this.selectedDataIndexes,e.series);this.blurEffect(e.element.id,e.visibleSeries),this.changeCursorStyle(!1,e.svgObject,"auto"),e.allowMultiSelection&&!i||(this.rectPoints=null)}}resizingSelectionRect(e,t,i,s){let o;if(e.allowMultiSelection&&s.id.indexOf("_ej2_drag_rect")>-1||this.dragRectArray[this.targetIndex]){s.id.indexOf("_ej2_drag_rect")>-1&&(this.targetIndex=this.getIndex(s.id));const e=this.dragRectArray[this.targetIndex];o=new C(e.x,e.y,e.width,e.height)}if(e.allowMultiSelection||(o=new C(this.rectPoints.x,this.rectPoints.y,this.rectPoints.width,this.rectPoints.height)),o){const s=this.findResizeMode(e.svgObject,o,t);this.resizing&&(o=ei(o.x,o.y,o.x+o.width,o.y+o.height,e.chartAxisLayoutPanel.seriesClipRect),this.drawDraggingRect(e,o),this.dragRect=o),i&&(this.resizing=s)}}findResizeMode(e,t,i){let s="se-resize",o=!1;if(this.resizing){const e=t.x,s=t.y;let o=i.x-e,l=i.y-s;switch(this.resizeMode){case 0:l=Math.abs(t.height+t.y-i.y),t.y=Math.min(t.height+t.y,i.y),t.height=l;break;case 1:o=Math.abs(t.width+t.x-i.x),t.x=Math.min(t.width+t.x,i.x),t.width=o;break;case 2:t.height=Math.abs(l),t.y=Math.min(i.y,s);break;case 3:t.width=Math.abs(o),t.x=Math.min(i.x,e);break;case 4:t.width=Math.abs(o),t.height=Math.abs(l),t.x=Math.min(i.x,e),t.y=Math.min(i.y,s)}}else{const e=[new C(t.x,t.y,t.width-5,5),new C(t.x,t.y,5,t.height),new C(t.x,t.y+t.height-5,t.width-5,5),new C(t.x+t.width-5,t.y+5,5,t.height-15),new C(t.x+t.width-10,t.y+t.height-10,10,10)];for(let t=0;t<e.length;t++)if(Dt(i.x,i.y,e[t])){s=4===t?s:t%2==0?"ns-resize":"ew-resize",o=!0,this.resizeMode=t;break}}return"Lasso"!==this.currentMode&&this.changeCursorStyle(o,Yt(this.chart.allowMultiSelection?this.draggedRect+this.targetIndex:this.draggedRect),s),this.changeCursorStyle(o,e,s),o}changeCursorStyle(e,t,i){i=e?i:this.control.svgObject===t?"auto":"move",t&&t.setAttribute("style","cursor:"+i+";")}removeSelectedElements(e,t,i){let s;t=e.isRedrawSelection?t:t.splice(0,t.length);for(const o of i){s=this.getSeriesElements(o),this.removeStyles(s);for(const e of s)this.removeStyles(this.getChildren(e))}}setAttributes(e,t){const i=Object.keys(t);for(const s of i)e.setAttribute(s,t[s])}draggedRectMoved(e,t,i,s){let o;if((this.resizing||this.rectGrabbing)&&e.allowMultiSelection){const e=this.dragRectArray[this.targetIndex];o=new C(e.x,e.y,e.width,e.height)}else o=new C(this.rectPoints.x,this.rectPoints.y,this.rectPoints.width,this.rectPoints.height);o.x-=t.x-e.mouseX,o.y-=t.y-e.mouseY,o=ei(o.x,o.y,o.x+o.width,o.height+o.y,e.chartAxisLayoutPanel.seriesClipRect),i?this.drawDraggingRect(e,o,s):this.calculateDragSelectedElements(e,o)}completeSelection(e){const t=this.chart;"None"!==t.selectionMode&&(this.currentMode=t.selectionMode,(this.dragging||this.resizing)&&this.dragRect.width>5&&this.dragRect.height>5?this.calculateDragSelectedElements(t,this.dragRect):(!t.allowMultiSelection&&this.rectGrabbing&&this.rectPoints.width&&this.rectPoints.height||this.rectGrabbing&&this.dragRectArray[this.targetIndex].width&&this.dragRectArray[this.targetIndex].height)&&this.draggedRectMoved(t,this.dragRect),"Lasso"===t.selectionMode&&this.dragging&&this.path&&-1!==this.path.indexOf("L")&&(t.allowMultiSelection?Yt(this.lassoPath+this.count)&&(Yt(this.lassoPath+this.count).setAttribute("d",this.path+"Z"),this.pointChecking(Yt(this.lassoPath+this.count))):(Yt(this.lassoPath).setAttribute("d",this.path+"Z"),this.pointChecking(Yt(this.lassoPath))),(this.dragging||this.resizing)&&this.calculateDragSelectedElements(t,this.dragRect)),this.dragging=!1,this.rectGrabbing=!1,this.resizing=!1,this.removeDraggedElements(t,e))}getDragRect(e,t){return ei(e.mouseDownX,e.mouseDownY,e.mouseX,e.mouseY,t)}dragStart(e,t,i,s,o){const l=e.selectionMode;this.currentMode=e.selectionMode,this.dragging=(l.indexOf("Drag")>-1||"Lasso"===l)&&(e.isDoubleTap||!e.isTouch)&&"PolarRadar"!==e.chartAreaType;const a=o.target;if(this.path=void 0,this.dragging&&(this.count=Yt(this.multiRectGroup)?this.count+1:0,this.dragRect=new C(e.mouseDownX,e.mouseDownY,0,0),(e.mouseDownX<t.x||e.mouseDownX>t.x+t.width||e.mouseDownY<t.y||e.mouseDownY>t.y+t.height)&&(this.dragging=!1)),"Lasso"===l)for(const r of e.visibleSeries)if(r.visible)for(const t of r.points)e.allowMultiSelection||(t.isSelect=!1);if("Lasso"!==l&&(this.rectPoints&&!e.allowMultiSelection&&(this.dragRect=new C(e.mouseDownX,e.mouseDownY,0,0),this.resizingSelectionRect(e,new Ri(i,s),!0),this.rectGrabbing=Dt(i,s,this.rectPoints)),e.allowMultiSelection)){const t=this.getIndex(a.id);this.targetIndex=this.isDragRect(a.id)?t:void 0,this.dragRectArray.length&&this.isDragRect(a.id)&&(this.resizingSelectionRect(e,new Ri(i,s),!0,a),this.rectGrabbing=Dt(i,s,this.dragRectArray[t]))}}isDragRect(e){return e.indexOf("_ej2_drag_rect")>-1}mouseMove(e){const t=this.chart;let i=e.target;if("None"===t.highlightMode||(0,a.le)(i))"None"!==t.selectionMode&&("touchmove"===e.type&&(a.AR.isIos||a.AR.isIos7)&&this.dragging&&e.preventDefault&&e.preventDefault(),Dt(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect)?(this.rectGrabbing&&!this.resizing?this.draggedRectMoved(t,this.dragRect,!0,i):this.dragging&&!this.resizing&&("Lasso"===t.selectionMode?(this.getPath(t.mouseDownX,t.mouseDownY,t.mouseX,t.mouseY),this.drawDraggingRect(t,this.dragRect,i)):(this.dragRect=this.getDragRect(t,t.chartAxisLayoutPanel.seriesClipRect),this.drawDraggingRect(t,this.dragRect,i))),(this.rectPoints&&!t.allowMultiSelection||t.allowMultiSelection&&!this.dragging||this.resizing)&&this.resizingSelectionRect(t,new Ri(t.mouseX,t.mouseY),null,i)):this.completeSelection(e));else{if(e.target.id.indexOf("text")>1&&(i=Yt(e.target.id.replace("text","shape"))),i.hasAttribute("class")&&(i.getAttribute("class").indexOf("highlight")>-1||i.getAttribute("class").indexOf("selection")>-1))return;this.calculateSelectedElements(e)}}getPath(e,t,i,s){this.dragging&&(this.path=this.path?this.path+" L"+i+" "+s:"M "+e+" "+t)}pointChecking(e){const t=this.chart;let i;const s=Yt(t.svgId).getBoundingClientRect(),o=t.chartAxisLayoutPanel.seriesClipRect.x+Math.max(s.left,0),l=t.chartAxisLayoutPanel.seriesClipRect.y+Math.max(s.top,0);this.multiDataIndexes[this.count]=[];for(const a of t.visibleSeries)a.points.filter(s=>{s.symbolLocations&&s.symbolLocations.length&&(i=document.elementFromPoint(s.symbolLocations[0].x+o,s.symbolLocations[0].y+l)),i===e?(s.isSelect=!0,this.chart.allowMultiSelection&&"Lasso"===this.currentMode&&(this.multiDataIndexes[this.count][this.seriesIndex]=s,this.seriesIndex++)):t.allowMultiSelection||(s.isSelect=!1)});this.seriesIndex=0}getModuleName(){return"Selection"}destroy(){this.removeEventListener()}}class Hs{constructor(e){this.errorHeight=0,this.chart=e}initPrivateVariables(e,t){let i="",s="";const o=e.chart.renderer,l=void 0===e.index?e.category:e.index;"Cartesian"===e.chart.chartAreaType&&(i="translate("+e.clipRect.x+","+e.clipRect.y+")",s="url(#"+this.chart.element.id+"_ChartSeriesClipRect_"+l+")"),t.dataLabel.visible&&(e.shapeElement=o.createGroup({id:this.chart.element.id+"ShapeGroup"+l,transform:i,"clip-path":"url(#"+this.chart.element.id+"_ChartSeriesClipRect_"+l+")"}),e.textElement=o.createGroup({id:this.chart.element.id+"TextGroup"+l,transform:i,"clip-path":s})),this.markerHeight="Scatter"===e.type||t.visible?t.height/2:0,this.commonId=this.chart.element.id+"_Series_"+l+"_Point_",this.calculateErrorHeight(e,e.marker.dataLabel.position),this.chartBackground="transparent"===this.chart.chartArea.background?this.chart.background||this.chart.themeStyle.background:this.chart.chartArea.background}calculateErrorHeight(e,t){if(!e.errorBar.visible)return null;if(e.errorBar.visible&&"PolarRadar"!==this.chart.chartAreaType){const i=e.errorBar.direction,s=this.chart.errorBarModule.positiveHeight,o=this.chart.errorBarModule.negativeHeight;this.isRectSeries(e)?("Top"!==t&&"Auto"!==t||(this.errorHeight="Both"===i||"Minus"===i?o:0),"Outer"!==t&&"Auto"!==t||(this.errorHeight="Both"===i||"Plus"===i?s:0)):("Top"!==t&&"Outer"!==t&&"Auto"!==t||(this.errorHeight="Both"!==i&&"Plus"!==i||e.chart.isTransposed?0:s),"Bottom"!==t&&"Auto"!==t||(this.errorHeight="Both"===i||"Minus"===i?o:0))}else this.errorHeight=0}isRectSeries(e){return e.isRectSeries||"RangeArea"===e.type||"SplineRangeArea"===e.type}render(e,t,i){let s;this.initPrivateVariables(e,e.marker);let o,l,r,n,h,d,c,p={x:0,y:0};this.inverted=t.requireInvertedAxis,this.yAxisInversed=e.yAxis.isInversed;const u=t.redraw;let g=!1,m=[];const b=(0,a.az)("div",{id:t.element.id+"_Series_"+(void 0===e.index?e.category:e.index)+"_DataLabelCollections"}),f=rt(e);let y,v,x;for(let w=0;w<f.length;w++){if(y=f[w],!i.showZero&&(0!==y.y||0===y.y&&"Zero"===e.emptyPointSettings.mode))return null;this.margin=i.margin;let M,T,A,D,R,I=[],P=!0;const k=e.clipRect;let E;g=!1,d=c=i.angle,n={width:i.border.width,color:i.border.color};const F=(0,a.l7)({},(0,a.NA)("properties",i.font),null,!0);if(y.symbolLocations.length&&y.symbolLocations[0]||"BoxAndWhisker"===e.type&&y.regions.length){I=ii(y,e,t),M=I.length;for(let a=0;a<M;a++)if(r={cancel:!1,name:de,series:e,point:y,text:I[a],border:n,color:i.fill,template:i.template,font:F,location:p,textSize:S(I[a],i.font)},t.trigger(de,r),!r.cancel)if(this.fontBackground=r.color,this.isDataLabelShape(r),this.markerHeight="Bubble"===e.type?y.regions[0].height/2:this.markerHeight,null!==r.template)this.createDataLabelTemplate(b,e,i,y,r,a,u);else{if(h=S(r.text,i.font),s=this.calculateTextPosition(y,e,h,i,a),"PolarRadar"===t.chartAreaType)for(const e of t.chartAxisLayoutPanel.visibleAxisLabelRect)if(li(new C(s.x,s.y,s.width,s.height),e)){P=!1;break}const n=new C(s.x+k.x,s.y+k.y,s.width,s.height);if(i.enableRotation){const e=this.getRectanglePoints(s);if(v=s.x+s.width/2,x=s.y+s.height/2,m=vt(e,v,x,d),g=this.isDataLabelOverlapWithChartBound(m,t,k),!g){this.chart.rotatedDataLabelCollections.push(m);const e=this.chart.rotatedDataLabelCollections.length-1;for(let t=e;t>=0;t--)if(this.chart.rotatedDataLabelCollections[e]&&this.chart.rotatedDataLabelCollections[t-1]&&St(this.chart.rotatedDataLabelCollections[e],this.chart.rotatedDataLabelCollections[t-1])){g=!0,this.chart.rotatedDataLabelCollections[e]=null;break}}}else g=oi(s,t.dataLabelCollections,k);g&&"None"!==i.labelIntersectAction||!P||(t.dataLabelCollections.push(n),this.isShape&&(E=t.renderer.drawRectangle(new Ti(this.commonId+y.index+"_TextShape_"+a,r.color,r.border,i.opacity,s,i.rx,i.ry),new Int32Array([k.x,k.y])),e.shapeElement&&e.shapeElement.appendChild(E)),o=hi(di(this.fontBackground)),l=Math.round((299*o.r+587*o.g+114*o.b)/1e3),T=s.x+this.margin.left+h.width/2+p.x,A=s.y+this.margin.top+3*h.height/4+p.y,p={x:0,y:0},0!==d&&i.enableRotation?(D=v,R=x,c=d>360?d-360:d<-360?d+360:d):(c=0,D=s.x,R=s.y),bi(t.renderer,new L(this.commonId+y.index+"_Text_"+a,T,A,"middle",r.text,"rotate("+c+","+D+","+R+")","auto",c),r.font,r.font.color||(l>=128||"Hilo"===e.type?"black":"white"),e.textElement,!1,u,!0,!1,e.chart.duration,e.clipRect,0,null,t.enableCanvas))}}}b.childElementCount&&(t.enableCanvas?Yt(t.element.id+"_Secondary_Element").appendChild(b):$t(t.enableCanvas,Yt(t.element.id+"_Secondary_Element"),b,t.redraw,!1,"x","y",null,"",!1,!1,null,t.duration))}getRectanglePoints(e){return[new Ri(e.x,e.y),new Ri(e.x+e.width,e.y),new Ri(e.x+e.width,e.y+e.height),new Ri(e.x,e.y+e.height)]}isDataLabelOverlapWithChartBound(e,t,i){for(let s=0;s<e.length;s++)if(!Dt(e[s].x+i.x,e[s].y+i.y,t.initialClipRect))return!0;return!1}createDataLabelTemplate(e,t,i,s,o,l,r){this.margin={left:0,right:0,bottom:0,top:0};const n=t.clipRect,h=Xt((0,a.az)("div",{id:this.chart.element.id+"_Series_"+(void 0===t.index?t.category:t.index)+"_DataLabel_"+s.index+(l?"_"+l:""),styles:"position: absolute;background-color:"+o.color+";"+Qt(i.font)+";border:"+o.border.width+"px solid "+o.border.color+";"}),s.index,o.template,this.chart,s,t,this.chart.element.id+"_DataLabel",l);this.calculateTemplateLabelSize(e,h,s,t,i,l,n,r)}calculateTemplateLabelSize(e,t,i,s,o,l,a,r,n){const h=Jt(t,r,n),d=this.calculateTextPosition(i,s,{width:h.width,height:h.height},o,l);let c=!1;n&&(c=0===h.width||0===h.height),t.style.left=("PolarRadar"===this.chart.chartAreaType?0:s.clipRect.x)+d.x-0+"px",t.style.top=("PolarRadar"===this.chart.chartAreaType?0:s.clipRect.y)+d.y+0+"px";const p=hi(di(this.fontBackground)),u=s.chart.requireInvertedAxis?s.xAxis:s.yAxis,g=s.chart.requireInvertedAxis?s.yAxis:s.xAxis;t.style.color=o.font.color||(Math.round((299*p.r+587*p.g+114*p.b)/1e3)>=128?"black":"white"),t.childElementCount&&!c&&(!oi(d,this.chart.dataLabelCollections,a)||"None"===o.labelIntersectAction)&&("XY"!==s.seriesType||void 0===i.yValue||pt(i.yValue,s.yAxis.visibleRange)||s.type.indexOf("Stacking")>-1||s.type.indexOf("100")>-1&&pt(s.stackedValues.endValues[i.index],s.yAxis.visibleRange))&&pt(i.xValue,s.xAxis.visibleRange)&&parseFloat(t.style.top)>=u.rect.y&&parseFloat(t.style.left)>=g.rect.x&&parseFloat(t.style.top)<=u.rect.y+u.rect.height&&parseFloat(t.style.left)<=g.rect.x+g.rect.width&&(this.chart.dataLabelCollections.push(new C(d.x+a.x,d.y+a.y,d.width,d.height)),$t(this.chart.enableCanvas,e,t,r,!0,"left","top"),s.animation.enable&&this.chart.animateSeries&&!this.chart.enableCanvas?this.doDataLabelAnimation(s,t):this.chart.enableCanvas&&e.appendChild(t))}calculateTextPosition(e,t,i,s,o){let l,a=o>1&&"Candle"===t.type?e.regions[1]:e.regions[0];o>1&&"HiloOpenClose"===t.type&&(a=2===o?e.regions[1]:e.regions[2]),l=this.getLabelLocation(e,t,i,o);const r=t.clipRect;if(this.chart.requireInvertedAxis&&this.isRectSeries(t)&&"BoxAndWhisker"!==t.type){this.locationY=l.y;const r=i.width+this.borderWidth+this.margin.left+this.margin.right-5;l.x="Auto"===s.position?l.x:this.calculateAlignment(r,l.x,s.alignment,e.yValue<0),l.x=this.calculateRectPosition(l.x,a,e.yValue<0!==this.yAxisInversed,s.position,t,i,o,e)}else{this.locationX=l.x;const r=i.height+2*this.borderWidth+this.markerHeight+this.margin.bottom+this.margin.top+5;l.y="Auto"===s.position?l.y:this.calculateAlignment(r,l.y,s.alignment,!!this.isRectSeries(t)&&e.yValue<0),l.y=this.isRectSeries(t)&&"BoxAndWhisker"!==t.type?this.calculateRectPosition(l.y,a,e.yValue<0!==this.yAxisInversed,s.position,t,i,o,e):this.calculatePathPosition(l.y,s.position,t,e,i,o),this.isRectSeries(t)&&"PolarRadar"===this.chart.chartAreaType&&(l=this.calculatePolarRectPosition(l,s.position,t,e,i,o,s.alignment,r))}const n=ai(l,i,this.margin);return!0===s.enableRotation&&0!==s.angle||n.y>r.y+r.height||n.x>r.x+r.width||n.x+n.width<0||n.y+n.height<0||(n.x=n.x<0?5:n.x,n.y=n.y<0&&"None"!==s.labelIntersectAction?5:n.y,n.x-=n.x+n.width>r.x+r.width?n.x+n.width-(r.x+r.width)+5:0,n.y-=n.y+n.height>r.y+r.height?n.y+n.height-(r.y+r.height)+5:0,this.fontBackground="transparent"===this.fontBackground?this.chartBackground:this.fontBackground),n}calculatePolarRectPosition(e,t,i,s,o,l,a,r){let n;const h=this.chart.availableSize.width,d="Center"===a?0:"Far"===a?1:-1,c=s.regionData.startAngle-.5*Math.PI+(s.regionData.endAngle-s.regionData.startAngle)/2;return n=0===l?s.regionData.radius<s.regionData.innerRadius?s.regionData.innerRadius:s.regionData.radius:s.regionData.radius>s.regionData.innerRadius?s.regionData.innerRadius:s.regionData.radius,this.fontBackground="transparent"===this.fontBackground?this.chartBackground:this.fontBackground,i.drawType.indexOf("Stacking")>-1?t="Outer"===t?"Top":t:i.drawType.indexOf("Range")>-1&&(t="Outer"===t||"Top"===t?t:"Auto"),"Outer"===t?n=0===l?n+10+this.markerHeight:n-10-this.markerHeight:"Middle"===t?(n=n/2+5,"StackingColumn"===i.drawType&&(n=s.regionData.innerRadius+(s.regionData.radius-s.regionData.innerRadius)/2+5-o.height/2)):"Top"===t?n=0===l?n-10-this.markerHeight:n+10+this.markerHeight:"Bottom"===t?(n=10,n+="StackingColumn"===i.drawType?s.regionData.innerRadius+this.markerHeight:0):n=0===l?n>=i.chart.radius?n-5:"StackingColumn"===i.drawType?n-10:n+10:n>=i.chart.radius?n+5:n-10,n+=r*d,e.x=i.clipRect.width/2+i.clipRect.x+n*Math.cos(c),"StackingColumn"===i.drawType?e.x=e.x<h/2?e.x+o.width/2:e.x>h/2?e.x-o.width/2:e.x:"Column"===i.drawType&&(e.x=e.x<h/2?e.x-o.width/2:e.x>h/2?e.x+o.width/2:e.x),e.y=i.clipRect.height/2+i.clipRect.y+n*Math.sin(c),e}getLabelLocation(e,t,i,s){let o=new Ri(0,0),l="Candle"===t.type&&s>1?e.regions[1]:e.regions[0];"HiloOpenClose"===t.type&&(l=2===s?e.regions[1]:e.regions[2]);const a=t.xAxis,r=t.yAxis,n=t.chart.requireInvertedAxis;if("BoxAndWhisker"===t.type){switch(this.markerHeight=0,s){case 0:o=Kt(e.xValue,e.median,a,r,n);break;case 1:o=Kt(e.xValue,e.maximum,a,r,n);break;case 2:o=Kt(e.xValue,e.minimum,a,r,n);break;case 3:o=Kt(e.xValue,e.upperQuartile,a,r,n);break;case 4:o=Kt(e.xValue,e.lowerQuartile,a,r,n);break;default:o=Kt(e.xValue,e.outliers[s-5],a,r,n),this.markerHeight=t.marker.height/2}n?o.y=e.regions[0].y+e.regions[0].height/2:o.x=e.regions[0].x+e.regions[0].width/2}else o=0===s||1===s?new Ri(e.symbolLocations[0].x,e.symbolLocations[0].y):2!==s&&3!==s||"Candle"!==t.type?n?{x:l.x+l.width/2,y:l.y}:{x:l.x+l.width,y:l.y+l.height/2}:new Ri(e.symbolLocations[1].x,e.symbolLocations[1].y);return s>1&&"HiloOpenClose"===t.type&&(t.chart.requireInvertedAxis?o.y=l.y+l.height/2+2*(2===s?1:-1):o.x=l.x+l.width/2+2*(2===s?1:-1)),o}calculateRectPosition(e,t,i,s,o,l,a,r){if("PolarRadar"===o.chart.chartAreaType)return null;const n=this.margin;let h=this.borderWidth+(this.inverted?l.width:l.height)/2+5;switch("StackingColumn100"===o.type||"StackingBar100"===o.type?s="Outer"===s?"Top":s:o.type.indexOf("Range")>-1?s="Outer"===s||"Top"===s?s:"Auto":"Waterfall"===o.type&&(s="Auto"===s?"Middle":s),s){case"Bottom":e=this.inverted?i?e+t.width-h-n.left:e-t.width+h+n.right:i?e-t.height+h+n.top:e+t.height-h-n.bottom;break;case"Middle":e=e=this.inverted?i?e+t.width/2:e-t.width/2:i?e-t.height/2:e+t.height/2;break;case"Auto":e=this.calculateRectActualPosition(e,t,i,o,l,a,r);break;default:h+=this.errorHeight,e=this.calculateTopAndOuterPosition(e,t,s,o,a,h,i)}this.fontBackground=(this.inverted?e<t.x||e>t.x+t.width:e<t.y||e>t.y+t.height)?"transparent"===this.fontBackground?this.chartBackground:this.fontBackground:"transparent"===this.fontBackground?r.color||o.interior:this.fontBackground;const d=o.chart.series.length;if("Outer"===s&&o.type.indexOf("Stacking")>-1&&d-1>o.index){let e,t;for(let i=o.index+1;i<d;i++)if(e=o.chart.series[i],t=e.points[r.index],e.type.indexOf("Stacking")>-1&&-1===e.type.indexOf("100")){this.fontBackground=t&&(t.yValue<0&&r.yValue<0||t.yValue>0&&r.yValue>0)?t?t.color:e.interior:this.fontBackground;break}}return e}calculatePathPosition(e,t,i,s,o,l){switch(i.type.indexOf("Area")>-1&&"RangeArea"!==i.type&&"SplineRangeArea"!==i.type&&this.yAxisInversed&&"Auto"!==i.marker.dataLabel.position&&(t="Top"===t?"Bottom":"Bottom"===t?"Top":t),this.fontBackground="transparent"===this.fontBackground?this.chartBackground:this.fontBackground,t){case"Top":case"Outer":e=e-this.markerHeight-this.borderWidth-o.height/2-this.margin.bottom-5-this.errorHeight;break;case"Bottom":e=e+this.markerHeight+this.borderWidth+o.height/2+this.margin.top+5+this.errorHeight;break;case"Auto":e=this.calculatePathActualPosition(e,this.markerHeight,i,s,o,l)}return e}isDataLabelShape(e){this.isShape="transparent"!==e.color||e.border.width>0,this.borderWidth=e.border.width,this.isShape||(this.margin={left:0,right:0,bottom:0,top:0})}calculateRectActualPosition(e,t,i,s,o,l,a){let r,n,h=!0,d=0;const c=this.chart.dataLabelCollections,p=-1!==s.type.indexOf("Range")||"Hilo"===s.type?2:4;for(;h&&d<p;){let p=this.getPosition(d);s.type.indexOf("Stacking")>-1&&"Outer"===p&&(p="Top",d++),r=this.calculateRectPosition(e,t,i,p,s,o,l,a),this.inverted?(n=ai(new Ri(r,this.locationY),o,this.margin),h=n.x<0||oi(n,c,s.clipRect)||n.x+n.width>s.clipRect.width):(n=ai(new Ri(this.locationX,r),o,this.margin),h=n.y<0||oi(n,c,s.clipRect)||n.y>s.clipRect.height),d++}return r}calculateAlignment(e,t,i,s){switch(i){case"Far":t=this.inverted?s?t-e:t+e:s?t+e:t-e;break;case"Near":t=this.inverted?s?t+e:t-e:s?t-e:t+e;break;case"Center":t=t}return t}calculateTopAndOuterPosition(e,t,i,s,o,l,a){const r=this.margin;let n;switch(s.type){case"RangeColumn":case"RangeArea":case"SplineRangeArea":case"Hilo":n=0===o&&!this.yAxisInversed||1===o&&this.yAxisInversed,e=this.updateLabelLocation(i,e,l,r,t,n);break;case"Candle":n=(0===o||2===o)&&!this.yAxisInversed||(1===o||3===o)&&this.yAxisInversed,e=this.updateLabelLocation(i,e,l,r,t,n,o>1);break;case"HiloOpenClose":o<=1?(n=0===o&&!this.yAxisInversed||1===o&&this.yAxisInversed,e=this.updateLabelLocation(i,e,l,r,t,n)):e=this.yAxisInversed?this.inverted?e-l-r.right:e+l+r.top:this.inverted?e+l+r.left:e-l-r.bottom;break;default:e=a&&"Top"===i||!a&&"Outer"===i?this.inverted?e+l+r.left+this.markerHeight:e-l-r.bottom-this.markerHeight:this.inverted?e-l-r.right-this.markerHeight:e+l+r.top+this.markerHeight}return e}updateLabelLocation(e,t,i,s,o,l,a=!1){return this.inverted?l?"Outer"!==e||a?t-i-s.right-this.markerHeight:t+i+s.left+this.markerHeight:"Outer"!==e||a?t-o.width+i+s.left+this.markerHeight:t-o.width-i-s.right-this.markerHeight:l?"Outer"!==e||a?t+i+s.top+this.markerHeight:t-i-s.bottom-this.markerHeight:"Outer"!==e||a?t+o.height-i-s.bottom-this.markerHeight:t+o.height+i+s.top+this.markerHeight}calculatePathActualPosition(e,t,i,s,o,l){const a=i.points,r=s.index,n=a[r].yValue;let h;const d=a.length-1>r?a[r+1]:null,c=r>0?a[r-1]:null;let p,u,g,m,b=!0;const f=this.chart.dataLabelCollections;if("Bubble"===i.type)h="Top";else if(i.type.indexOf("Step")>-1)h="Top",r&&(h=c&&c.visible&&n>c.yValue===this.yAxisInversed&&n!==c.yValue?"Bottom":"Top");else if("BoxAndWhisker"===i.type)1===l||3===l||l>4?h=i.yAxis.isInversed?"Bottom":"Top":2===l||4===l?h=i.yAxis.isInversed?"Top":"Bottom":(b=!1,h="Middle",p=this.calculatePathPosition(e,h,i,s,o,l));else if(0===r)h=!d||!d.visible||n>d.yValue||n<d.yValue&&this.yAxisInversed?"Top":"Bottom";else if(r===a.length-1)h=!c||!c.visible||n>c.yValue||n<c.yValue&&this.yAxisInversed?"Top":"Bottom";else if(d.visible||c&&c.visible)if(d.visible&&c){const e=(d.yValue-c.yValue)/2,t=e*r+(d.yValue-e*(r+1));h=this.yAxisInversed?t<n?"Bottom":"Top":t<n?"Top":"Bottom"}else h=d.yValue>n||c&&c.yValue>n?"Bottom":"Top";else h="Top";for(g="Bottom"===h,m=["Outer","Top","Bottom","Middle","Auto"].indexOf(h);b&&m<4;)p=this.calculatePathPosition(e,this.getPosition(m),i,s,o,l),u=ai(new Ri(this.locationX,p),o,this.margin),b=u.y<0||oi(u,f,i.clipRect)||u.y+u.height>i.clipRect.height,m=g?m-1:m+1,g=!1;return p}doDataLabelAnimation(e,t){const i=e.shapeElement.childNodes,s=e.textElement.childNodes,o=e.animation.delay+e.animation.duration,l=e.chart.animated?e.chart.duration:200;let a;const r=t?1:s.length;let n;for(let h=0;h<r;h++)n=s[h],t?(t.style.visibility="hidden",Ht(t,o,l,"ZoomIn")):(a=new Ri(+n.getAttribute("x")+ +n.getAttribute("width")/2,+n.getAttribute("y")+ +n.getAttribute("height")/2),Nt(n,o,l,e,null,a,!0),i[h]&&(n=i[h],a=new Ri(+n.getAttribute("x")+ +n.getAttribute("width")/2,+n.getAttribute("y")+ +n.getAttribute("height")/2),Nt(n,o,l,e,null,a,!0)))}getPosition(e){return["Outer","Top","Bottom","Middle","Auto"][e]}getModuleName(){return"DataLabel"}destroy(){}}class qs extends ts{constructor(e){super(e),this.library=this,this.addEventListener()}addEventListener(){this.chart.isDestroyed||(this.chart.on(a.AR.touchMoveEvent,this.mouseMove,this),this.chart.on("click",this.click,this),this.chart.on(a.AR.touchEndEvent,this.mouseEnd,this))}removeEventListener(){this.chart.isDestroyed||(this.chart.off(a.AR.touchMoveEvent,this.mouseMove),this.chart.off("click",this.click),this.chart.off(a.AR.touchEndEvent,this.mouseEnd))}mouseMove(e){this.chart.legendSettings.visible&&!this.chart.isTouch&&(this.move(e),this.chart.highlightModule&&"None"!==this.chart.highlightMode&&this.click(e))}mouseEnd(e){this.chart.legendSettings.visible&&this.chart.isTouch&&this.move(e)}getLegendOptions(e,t){let i,s;this.legendCollections=[];const o=[];e.length>1&&(this.legend.mode="Series");for(const l of e)if("Series"===this.legend.mode)"Indicator"!==l.category&&(i="PolarRadar"===t.chartAreaType?l.drawType:l.type,s=l.pointColorMapping&&l.points.length>0&&l.points[0].interior?l.points[0].interior:l.interior,this.legendCollections.push(new is(l.name,s,l.legendShape,"TrendLine"===l.category?this.chart.series[l.sourceIndex].trendlines[l.index].visible:l.visible,i,l.legendImageUrl,l.marker.shape,l.marker.visible)));else if("Point"===this.legend.mode)for(const e of l.points)i="PolarRadar"===t.chartAreaType?l.drawType:l.type,s=e.interior?e.interior:l.interior,0===this.legendCollections.filter(t=>t.text===e.x.toString()).length&&this.legendCollections.push(new is(e.x.toString(),s,l.legendShape,"TrendLine"===l.category?this.chart.series[l.sourceIndex].trendlines[l.index].visible:e.visible,i,"",l.marker.shape,l.marker.visible));else if("Range"===this.legend.mode)for(const e of l.points){i="PolarRadar"===t.chartAreaType?l.drawType:l.type,s=e.interior?e.interior:l.interior;let a="Others";if(o.indexOf(s)<0&&(o.push(s),t.rangeColorSettings.length>=1&&1===t.rangeColorSettings[0].colors.length)){for(const e of t.rangeColorSettings)e.colors[0]===s&&(a=e.label);this.legendCollections.push(new is(a,s,l.legendShape,"TrendLine"===l.category?this.chart.series[l.sourceIndex].trendlines[l.index].visible:e.visible,i,"",l.marker.shape,l.marker.visible))}}else if(0===this.legendCollections.length&&t.rangeColorSettings.length>0){const e=t.rangeColorSettings[0].start.toString(),s=t.rangeColorSettings[t.rangeColorSettings.length-1].end.toString();this.legendCollections.push(new is(e,l.interior,"Rectangle",!0,i,"",l.marker.shape,l.marker.visible)),this.legendCollections.push(new is(s,l.interior,"Rectangle",!0,i,"",l.marker.shape,l.marker.visible))}}getLegendBounds(e,t,i){this.calculateLegendTitle(i,t),this.isTitle=!!i.title;const s=i.padding,o=i.titlePosition;let l=0,a=0;const r=this.arrowWidth,n=this.isVertical&&!i.enablePages?this.arrowHeight:0;let h=this.isTitle&&"Top"===o?this.legendTitleSize.height+this.fivePixel:0;h=this.isTitle&&this.isVertical&&"Top"!==o?this.legendTitleSize.height+this.fivePixel:h,this.isVertical?a=i.width?0:e.width/100*5:l=i.height?0:e.height/100*5,t.height+=l,t.width+=a;const d=i.shapeWidth,c=i.shapePadding;let p,u=0,g=0,m=0,b=0,f=0,y=0;this.maxItemHeight=Math.max(S("MeasureText",i.textStyle).height,i.shapeHeight);let v=!1;for(const x of this.legendCollections)Ne.test(x.text)&&(x.text=wi(x.text,Ne)),ze.test(x.text)&&(x.text=wi(x.text,ze)),p={fill:x.fill,text:x.text,shape:x.shape,markerShape:x.markerShape,name:he,cancel:!1},this.chart.trigger(he,p),x.render=!p.cancel,x.text=p.text,x.fill=p.fill,x.shape=p.shape,x.markerShape=p.markerShape,x.textSize=S(x.text,i.textStyle),x.render&&(v=!0,m=d+c+x.textSize.width+s,g+=m,i.enablePages||this.isVertical||(y=this.isTitle&&"Top"!==o?this.legendTitleSize.width+this.fivePixel:0,y+=r),(t.width<s+g+y||this.isVertical)&&(u=Math.max(u,g+s+y-(this.isVertical?0:m)),0===f&&m!==g&&(f=1),g=this.isVertical?0:m,f++,b=f*(this.maxItemHeight+s)+s+h+n));b=Math.max(b,this.maxItemHeight+s+s+h),this.isPaging=t.height<b,this.isPaging&&!i.enablePages&&(b=this.isVertical?b:this.maxItemHeight+s+s+("Top"===o?h:0)),this.totalPages=f,this.isPaging||this.isVertical||(g+=this.isTitle&&"Top"!==o?this.fivePixel+this.legendTitleSize.width+this.fivePixel:0),v?this.setBounds(Math.max(g+s,u),b,i,t):this.setBounds(0,0,i,t)}getRenderPoint(e,t,i,s,o,l,a){const r=this.legend.padding,n=s.location.x+i+s.textSize.width;n+(e.textSize.width+i)>o.x+o.width+this.legend.shapeWidth/2||this.isVertical?(e.location.x=t.x,e.location.y=l===a?s.location.y:s.location.y+this.maxItemHeight+r):(e.location.x=l===a?s.location.x:n,e.location.y=s.location.y),e.text=pi(+(this.legendBounds.x+this.legendBounds.width-(e.location.x+i-this.legend.shapeWidth/2)).toFixed(4),e.text,this.legend.textStyle)}LegendClick(e,t){const i=this.chart,s=i.visibleSeries["Series"===i.legendSettings.mode?e:0],o=this.legendCollections[e],l="isProtectedOnChange";if("Series"===i.legendSettings.mode){const a={legendText:o.text,legendShape:o.shape,chart:i.isBlazor?{}:i,series:s,points:s.points,name:re,cancel:!1};this.chart.trigger(re,a),s.legendShape=a.legendShape,null!==s.fill&&(i.visibleSeries[e].interior=s.fill),i.legendSettings.toggleVisibility?("TrendLine"===s.category?i.series[s.sourceIndex].trendlines[s.index].visible=!i.series[s.sourceIndex].trendlines[s.index].visible:(s.chart[l]=!0,this.changeSeriesVisiblity(s,s.visible)),o.visible="TrendLine"===s.category?i.series[s.sourceIndex].trendlines[s.index].visible:s.visible,this.refreshLegendToggle(i,s)):i.selectionModule?i.selectionModule.legendSelection(i,e,t):i.highlightModule&&i.highlightModule.legendSelection(i,e,t),s.chart[l]=!1}else if("Point"===i.legendSettings.mode){const t=s.points[e];this.chart.trigger(re,{legendText:o.text,legendShape:o.shape,chart:i.isBlazor?{}:i,series:s,points:[t],name:re,cancel:!1}),i.legendSettings.toggleVisibility&&(t.visible=!t.visible,this.legendCollections[e].visible=t.visible,this.refreshLegendToggle(i,s))}else if("Range"===i.legendSettings.mode){const t=[],l=this.legendCollections[e];for(const e of s.points)l.fill===(e.interior||s.interior)&&t.push(e);if(this.chart.trigger(re,{legendText:o.text,legendShape:o.shape,chart:i.isBlazor?{}:i,series:s,points:t,name:re,cancel:!1}),i.legendSettings.toggleVisibility){l.visible=!l.visible;for(const e of t)e.visible=!e.visible;this.refreshLegendToggle(i,s)}}}refreshLegendToggle(e,t){let i=[];if(e.selectionModule&&(i=(0,a.l7)([],e.selectionModule.selectedDataIndexes,null,!0)),e.svgObject.childNodes.length>0&&!e.enableAnimation&&!e.enableCanvas){for(;e.svgObject.lastChild;)e.svgObject.removeChild(e.svgObject.lastChild);(0,a.Od)(e.svgObject)}e.animateSeries=!1,e.redraw=e.enableAnimation,e.rotatedDataLabelCollections=[],nt(A(e.element.id+"_Secondary_Element").querySelectorAll(".ejSVGTooltip")[0]),Ci(e),this.redrawSeriesElements(t,e),e.removeSvg(),e.refreshAxis(),t.refreshAxisLabel(),this.refreshSeries(e.visibleSeries),e.markerRender.removeHighlightedMarker(),e.refreshBound(),e.trigger("loaded",{chart:e}),i.length>0&&(e.selectionModule.selectedDataIndexes=i,e.selectionModule.redrawSelection(e,e.selectionMode)),e.highlightModule&&"None"!==e.highlightMode&&e.highlightModule.redrawSelection(e,e.highlightMode),e.redraw=!1}changeSeriesVisiblity(e,t){e.visible=!t,this.isSecondaryAxis(e.xAxis)&&(e.xAxis.internalVisibility=e.xAxis.series.some(e=>e.visible)),this.isSecondaryAxis(e.yAxis)&&(e.yAxis.internalVisibility=e.yAxis.series.some(e=>e.visible))}isSecondaryAxis(e){return this.chart.axes.indexOf(e)>-1}redrawSeriesElements(e,t){if(!t.redraw)return null;nt(t.element.id+"_Series_"+(void 0===e.index?e.category:e.index)+"_DataLabelCollections")}refreshSeries(e){for(const t of e)t.position=void 0}click(e){if(!this.chart.legendSettings.visible)return;const t=this.chart.mouseX,i=this.chart.mouseY;let s=[];const o=e.target.id,l=[this.legendID+"_text_",this.legendID+"_shape_marker_",this.legendID+"_shape_"];let a;for(const r of l)if(o.indexOf(r)>-1){a=parseInt(o.split(r)[1],10),this.LegendClick(a,e);break}o.indexOf(this.legendID+"_pageup")>-1?this.changePage(e,!0):o.indexOf(this.legendID+"_pagedown")>-1&&this.changePage(e,!1),this.chart.enableCanvas&&this.pagingRegions.length&&this.checkWithinBounds(t,i),s=this.legendRegions.filter(e=>Dt(t,i+(this.isPaging?(this.currentPageNumber-1)*this.translatePage(null,1,2):0),e.rect)),s.length&&this.chart.enableCanvas&&this.LegendClick(s[0].index,e)}checkWithinBounds(e,t){const i=this.chart.renderer,s=this.legendBounds,o=this.chart.legendSettings.border.width,l=new C(s.x,s.y,s.width,s.height);return l.x=l.x-o/2,l.y=l.y-o/2,l.width=l.width+o,l.height=l.height+o,Dt(e,t,this.pagingRegions[0])?(--this.currentPageNumber>0?(this.legendRegions=[],i.clearRect(l),i.canvasClip(new Ti("legendClipPath","transparent",{width:0,color:""},null,l)),this.renderLegend(this.chart,this.legend,s),i.canvasRestore()):++this.currentPageNumber,null):Dt(e,t,this.pagingRegions[1])?(++this.currentPageNumber>0&&this.currentPageNumber<=this.totalNoOfPages?(this.legendRegions=[],i.clearRect(l),i.canvasClip(new Ti("legendClipPath","transpaent",{width:0,color:""},null,l)),this.renderLegend(this.chart,this.legend,s),i.canvasRestore()):--this.currentPageNumber,null):void 0}getModuleName(){return"Legend"}destroy(){this.removeEventListener()}}class Gs extends vs{render(e,t,i,s){let o,l=null,r="";const n=Math.max(e.yAxis.visibleRange.min,0),h=[];let d,c,p;const u=this.sortSegments(e,e.segments);e.visiblePoints.map((a,g,m)=>{a.symbolLocations=[],a.regions=[],p=!1,a.visible&&gt(m[g-1],a,m[g+1],e)&&(r+=this.getAreaPathDirection(a.xValue,n,e,s,Kt,l,"M"),l=l||new Ri(a.xValue,n),o=Kt(a.xValue,a.yValue,t,i,s),c&&this.setPointColor(a,c,e,"X"===e.segmentAxis,u)?(p=!0,d=Kt(l.x,n,t,i,s),r+="L "+o.x+" "+o.y+" ",r+="L "+o.x+" "+d.y+" ",this.generatePathOption(h,e,c,r,"_Point_"+c.index),r="M "+o.x+" "+d.y+" L "+o.x+" "+o.y+" "):(r+="L "+o.x+" "+o.y+" ",this.setPointColor(a,null,e,"X"===e.segmentAxis,u)),m[g+1]&&!m[g+1].visible&&"Drop"!==e.emptyPointSettings.mode&&(r+=this.getAreaEmptyDirection({x:a.xValue,y:n},l,e,s,Kt),l=null),c=a,this.storePointLocation(a,e,s,Kt))}),(0,a.le)(p)||p||(r=e.points.length>1?r+this.getAreaPathDirection(c.xValue,n,e,s,Kt,null,"L"):"",this.generatePathOption(h,e,c,r,"")),this.applySegmentAxis(e,h,u),this.renderMarker(e)}generatePathOption(e,t,i,s,o){e.push(new I(t.chart.element.id+"_Series_"+t.index+o,t.setPointColor(i,t.interior),t.border.width,t.border.color,t.opacity,t.dashArray,s))}destroy(){}getModuleName(){return"MultiColoredAreaSeries"}doAnimation(e){this.doLinearAnimation(e,e.animation)}}class Ys extends vs{render(e,t,i,s){let o=null,l="M";const a=this.enableComplexProperty(e),r=[];let n="";const h=this.sortSegments(e,e.segments);for(const d of a)d.regions=[],d.visible&&gt(a[d.index-1],d,a[d.index+1],e)?(n+=this.getLineDirection(o,d,e,s,Kt,l),null!=o?this.setPointColor(d,o,e,"X"===e.segmentAxis,h)?(r.push(new I(e.chart.element.id+"_Series_"+e.index+"_Point_"+o.index,"none",e.width,e.setPointColor(o,e.interior),e.opacity,e.dashArray,n)),l="M",n=""):l="L":this.setPointColor(d,null,e,"X"===e.segmentAxis,h),o=d,this.storePointLocation(d,e,s,Kt)):(o="Drop"===e.emptyPointSettings.mode?o:null,l="Drop"===e.emptyPointSettings.mode?l:"M",d.symbolLocations=[]);""!==n&&r.push(new I(e.chart.element.id+"_Series_"+e.index,"none",e.width,e.setPointColor(a[a.length-1],e.interior),e.opacity,e.dashArray,n)),this.applySegmentAxis(e,r,h),this.renderMarker(e)}doAnimation(e){this.doLinearAnimation(e,e.animation)}getModuleName(){return"MultiColoredLineSeries"}destroy(){}}class Ws{constructor(e){this.xAxisPrevHeight=[],this.xAxisMultiLabelHeight=[],this.yAxisPrevHeight=[],this.yAxisMultiLabelHeight=[],this.multiLevelLabelRectXRegion=[],this.xLabelCollection=[],this.chart=e,this.addEventListener()}addEventListener(){this.chart.isDestroyed||this.chart.on("click",this.click,this)}getMultilevelLabelsHeight(e){let t=0;const i=[],s=[],o="Vertical"===e.orientation,l=o?e.rect.height:e.rect.width;let a,r,n;e.multiLevelLabels.map((h,d)=>{h.categories.map(t=>{""!==t.text&&null!==t.start&&null!==t.end&&(a=S(t.text,h.textStyle),r=o?a.width:a.height,r+=2*h.border.width+("CurlyBrace"===h.border.type?10:0),n=null!==t.maximumTextWidth?t.maximumTextWidth:wt("string"==typeof t.end?Number(new Date(t.end)):t.end,e)*l-wt("string"==typeof t.start?Number(new Date(t.start)):t.start,e)*l,a.width>n-10&&n>0&&"Wrap"===h.overflow&&!o&&(r*=xi(t.text,n-10,h.textStyle).length),i[d]=i[d]?i[d]<r?r:i[d]:r)}),s[d]=t,t+=i[d]?i[d]+10:0}),e.multiLevelLabelHeight=t+(""!==e.title||this.chart.legendModule&&this.chart.legendSettings.visible?5:0),o?(this.yAxisMultiLabelHeight=i,this.yAxisPrevHeight=s):(this.xAxisMultiLabelHeight=i,this.xAxisPrevHeight=s)}renderXAxisMultiLevelLabels(e,t,i,s){let o,l;const r=10;let n,h;const d=(e.labelPosition===e.tickPosition?e.majorTickLines.height:0)+e.maxLabelSize.height+r;let c,p,u,g,m="";const b="Outside"===e.labelPosition;let f,y;const v=e.isInversed;let x;const w=e.opposedPosition,M=e.scrollbarSettings.enable||b&&(0,a.le)(e.crossesAt)?e.scrollBarHeight:0;this.createClipRect(s.x-e.majorTickLines.width,(w&&!b||!w&&b?s.y+d-e.majorTickLines.width:s.y-d-e.multiLevelLabelHeight)+M,e.multiLevelLabelHeight+r,s.width+2*e.majorTickLines.width,this.chart.element.id+"_XAxis_Clippath_"+t,this.chart.element.id+"XAxisMultiLevelLabel"+t),e.multiLevelLabels.map((i,a)=>{h=0,this.labelElement=this.chart.renderer.createGroup({id:this.chart.element.id+t+"_MultiLevelLabel"+a}),i.categories.map((T,A)=>{if(m="",p="string"==typeof T.start?Number(new Date(T.start)):T.start,u="string"==typeof T.end?Number(new Date(T.end)):T.end,x=this.triggerMultiLabelRender(e,T.text,e.multiLevelLabels[a].textStyle,e.multiLevelLabels[a].alignment,T.customAttributes),!x.cancel){n=wt(p,e)*s.width,c=wt(u,e)*s.width,c=v?[n,n=c][0]:c,g=S(x.text,x.textStyle),f=(null===T.maximumTextWidth?c-n:T.maximumTextWidth)-r,o=n+s.x+r,l=(w&&!b||!w&&b?d+s.y+g.height/2+r+this.xAxisPrevHeight[a]:s.y-d+g.height/2-this.xAxisMultiLabelHeight[a]-this.xAxisPrevHeight[a])+M,"Center"===x.alignment?(o+=(c-n-r)/2,y="middle"):"Far"===x.alignment?(o=o+(c-n-r)-i.border.width/2,y="end"):(y="start",o+=i.border.width/2),l="CurlyBrace"===i.border.type?!w&&b||w&&!b?l+r:l-5:l;const D=new L(this.chart.element.id+t+"_Axis_MultiLevelLabel_Level_"+a+"_Text_"+A,o,l,y,x.text);if("None"!==i.overflow&&(D.text="Wrap"===i.overflow?xi(x.text,f,x.textStyle):pi(f,x.text,x.textStyle),D.x=D.x-5),bi(this.chart.renderer,D,x.textStyle,x.textStyle.color||this.chart.themeStyle.axisLabel,this.labelElement,!1,this.chart.redraw,!0,null,null,null,0,null,this.chart.enableCanvas),this.chart.enableCanvas){let e=S(x.text,x.textStyle);this.multiLevelLabelRectXRegion.push(new C(D.x,D.y,e.width,e.height)),this.xLabelCollection.push(D)}i.border.width>0&&"WithoutBorder"!==i.border.type&&(m=this.renderXAxisLabelBorder(a,c-n-r,e,n,d,g,D,s,x.alignment,m,b,w,h),""!==m&&(this.createBorderElement(a,t,e,m,h),h++)),this.chart.enableCanvas||this.multiElements.appendChild(this.labelElement)}})}),this.chart.enableCanvas||i.appendChild(this.multiElements)}renderXAxisLabelBorder(e,t,i,s,o,l,a,r,n,h,d,c,p){let u,g,m,b,f=10;const y=i.multiLevelLabels[e],v=t+f;let S=this.xAxisMultiLabelHeight[e]+f;const x="Outside"===i.labelPosition?i.scrollBarHeight:0,w=s+r.x,C=!c&&d||c&&!d?o+r.y+this.xAxisPrevHeight[e]+x:r.y-o-this.xAxisPrevHeight[e]-x,M=y.categories[p].type||y.border.type;switch(M){case"WithoutTopandBottomBorder":case"Rectangle":case"WithoutTopBorder":S=!c&&d||c&&!d?S:-S,h+="M "+w+" "+C+" L "+w+" "+(C+S)+" M "+(w+v)+" "+C+" L "+(w+v)+" "+(C+S),h+="WithoutTopandBottomBorder"!==M?" L "+w+" "+(C+S)+" ":" ",h+="Rectangle"===M?"M "+w+" "+C+" L "+(w+v)+" "+C:" ";break;case"Brace":"Near"===n?(m=a.x,b=a.x+l.width+2):"Center"===n?(m=a.x-l.width/2-2,b=a.x+l.width/2+2):(m=a.x-l.width-2,b=a.x),S=!c&&d||c&&!d?S:-S,h+="M "+w+" "+C+" L "+w+" "+(C+S/2)+" M "+w+" "+(C+S/2)+" L "+(m-2)+" "+(C+S/2)+" M "+b+" "+(C+S/2)+" L "+(w+v)+" "+(C+S/2)+" M "+(w+v)+" "+(C+S/2)+" L "+(w+v)+" "+C;break;case"CurlyBrace":!c&&d||c&&!d?(f=10,u=15,g=5):(f=-10,u=-15,g=-5),h+="Center"===n?"M "+w+" "+C+" C "+w+" "+C+" "+(w+5)+" "+(C+f)+" "+(w+10)+" "+(C+f)+" L "+(w+v/2-5)+" "+(C+f)+" L "+(w+v/2)+" "+(C+u)+" L "+(w+v/2+5)+" "+(C+f)+" L "+(w+v-10)+" "+(C+f)+" C "+(w+v-10)+" "+(C+f)+" "+(w+v)+" "+(C+g)+" "+(w+v)+" "+C:"Near"===n?"M "+w+" "+C+" C "+w+" "+C+" "+(w+5)+" "+(C+f)+" "+(w+10)+" "+(C+f)+" L "+(w+15)+" "+(C+u)+" L "+(w+20)+" "+(C+f)+" L "+(w+v-10)+" "+(C+f)+" C "+(w+v-10)+" "+(C+f)+" "+(w+v)+" "+(C+g)+" "+(w+v)+" "+C:"M "+w+" "+C+" C "+w+" "+C+" "+(w+5)+" "+(C+f)+" "+(w+10)+" "+(C+f)+" L "+(w+v-20)+" "+(C+f)+" L "+(w+v-15)+" "+(C+u)+" L "+(w+v-10)+" "+(C+f)+" L "+(w+v-10)+" "+(C+f)+" C "+(w+v-10)+" "+(C+f)+" "+(w+v)+" "+(C+g)+" "+(w+v)+" "+C}return h}renderYAxisMultiLevelLabels(e,t,i,s){let o;const l="Outside"===e.labelPosition;let r,n;const h=(e.tickPosition===e.labelPosition?e.majorTickLines.height:0)+e.maxLabelSize.width+10;let d,c,p,u,g="";const m=e.isInversed;let b,f,y;const v=e.opposedPosition;let x=l&&(0,a.le)(e.crossesAt)?e.scrollBarHeight:0;x*=v?1:-1,this.createClipRect((v&&!l||!v&&l?s.x-e.multiLevelLabelHeight-h-10:s.x+h)+x,s.y-e.majorTickLines.width,s.height+2*e.majorTickLines.width,e.multiLevelLabelHeight+10,this.chart.element.id+"_YAxis_Clippath_"+t,this.chart.element.id+"YAxisMultiLevelLabel"+t),e.multiLevelLabels.map((i,a)=>{this.labelElement=this.chart.renderer.createGroup({id:this.chart.element.id+t+"_MultiLevelLabel"+a}),u=0,i.categories.map((w,C)=>{if(g="",f="string"==typeof w.end?Number(new Date(w.end)):w.end,b="string"==typeof w.start?Number(new Date(w.start)):w.start,d=wt(b,e)*s.height,c=wt(f,e)*s.height,c=m?[d,d=c][0]:c,p=this.triggerMultiLabelRender(e,w.text,i.textStyle,i.alignment,w.customAttributes),!p.cancel){o=S(p.text,p.textStyle),y=c-d,r=s.x-h-this.yAxisPrevHeight[a]-this.yAxisMultiLabelHeight[a]/2-5,n=s.height+s.y-d-y/2,r=v?l?s.x+h+5+this.yAxisMultiLabelHeight[a]/2+this.yAxisPrevHeight[a]+x:s.x-h-this.yAxisMultiLabelHeight[a]/2-this.yAxisPrevHeight[a]-5:l?r+x:s.x+h+5+this.yAxisMultiLabelHeight[a]/2+this.yAxisPrevHeight[a],"Center"===p.alignment?n+=o.height/4:"Far"===p.alignment?n+=y/2-o.height/2:n=n-y/2+o.height,r="CurlyBrace"===i.border.type?!v&&l||v&&!l?r-10:r+10:r;const m=new L(this.chart.element.id+t+"_Axis_MultiLevelLabel_Level_"+a+"_Text_"+C,r,n,"middle",p.text);m.text="Trim"===i.overflow?pi(null===w.maximumTextWidth?this.yAxisMultiLabelHeight[a]:w.maximumTextWidth,p.text,p.textStyle):m.text,bi(this.chart.renderer,m,p.textStyle,p.textStyle.color||this.chart.themeStyle.axisLabel,this.labelElement,this.chart.redraw,!0,null,null,null,null,0,null,this.chart.enableCanvas),i.border.width>0&&"WithoutBorder"!==i.border.type&&(g=this.renderYAxisLabelBorder(a,y,e,c,h,d,o,m,s,p.alignment,g,l,v,u),""!==g&&(this.createBorderElement(a,t,e,g,u),u++)),this.chart.enableCanvas||this.multiElements.appendChild(this.labelElement)}})}),this.chart.enableCanvas||i.appendChild(this.multiElements)}renderYAxisLabelBorder(e,t,i,s,o,l,r,n,h,d,c,p,u,g){const m=s-l;let b,f,y=10;const v=i.multiLevelLabels[e],S=v.categories[g].type,x=h.y+h.height-s;let w=p&&(0,a.le)(i.crossesAt)?i.scrollBarHeight:0;w*=u?1:-1;let C=this.yAxisMultiLabelHeight[e]+y;const M=(!u&&p||u&&!p?h.x-o-this.yAxisPrevHeight[e]:h.x+o+this.yAxisPrevHeight[e])+w,T=S||v.border.type;switch(T){case"WithoutTopandBottomBorder":case"Rectangle":case"WithoutTopBorder":C=!u&&p||u&&!p?-C:C,c+="M "+M+" "+x+" L "+(M+C)+" "+x+" M "+M+" "+(x+m)+" L "+(M+C)+" "+(x+m),c+="WithoutTopandBottomBorder"!==T?" L "+(M+C)+" "+x+" ":" ",c+="Rectangle"===T?"M "+M+" "+(x+m)+"L "+M+" "+x+" ":" ";break;case"Brace":C=!u&&p||u&&!p?C:-C,c+="M "+M+" "+x+" L "+(M-C/2)+" "+x+" L "+(M-C/2)+" "+(n.y-r.height/2-4)+" M "+(M-C/2)+" "+(n.y+r.height/4+2)+" L "+(M-C/2)+" "+(x+m)+" L "+M+" "+(x+m);break;case"CurlyBrace":!u&&p||u&&!p?(y=-10,b=-15,f=-5):(y=10,b=15,f=5),c+="Center"===d?"M "+M+" "+x+" C "+M+" "+x+" "+(M+y)+" "+x+" "+(M+y)+" "+(x+10)+" L "+(M+y)+" "+(x+(m-10)/2)+" L "+(M+b)+" "+(x+(m-10)/2+5)+" L "+(M+y)+" "+(x+(m-10)/2+10)+" L "+(M+y)+" "+(x+(m-10))+" C "+(M+y)+" "+(x+(m-10))+" "+(M+f)+" "+(x+m)+" "+M+" "+(x+m):"Far"===d?"M "+M+" "+x+" C "+M+" "+x+" "+(M+y)+" "+x+" "+(M+y)+" "+(x+10)+" L "+(M+y)+" "+(x+m-20)+"  L "+(M+b)+" "+(x+(m-15))+" L "+(M+y)+" "+(x+(m-10))+" L "+(M+y)+" "+(x+(m-10))+" C "+(M+y)+" "+(x+(m-10))+" "+(M+y)+" "+(x+m)+" "+M+" "+(x+m):"M "+M+" "+x+" C "+M+" "+x+" "+(M+y)+" "+x+" "+(M+y)+" "+(x+10)+" L "+(M+b)+" "+(x+15)+" L "+(M+y)+" "+(x+20)+" L "+(M+y)+" "+(x+(m-10))+" C "+(M+y)+" "+(x+(m-10))+" "+(M+f)+" "+(x+m)+" "+M+" "+(x+m)}return c}createClipRect(e,t,i,s,o,l){this.multiElements=this.chart.renderer.createGroup({id:l,"clip-path":"url(#"+o+")"}),this.chart.enableCanvas||this.multiElements.appendChild(_t(this.chart.redraw,{id:o,x:e,y:t,width:s,height:i,fill:"white","stroke-width":1,stroke:"Gray"},this.chart.renderer))}createBorderElement(e,t,i,s,o){const l=s,a=this.chart.renderer.drawPath(new I(this.chart.element.id+t+"_Axis_MultiLevelLabel_Rect_"+e+"_"+o,"Transparent",i.multiLevelLabels[e].border.width,i.multiLevelLabels[e].border.color||this.chart.themeStyle.axisLine,1,"",s));a.setAttribute("style","pointer-events: none"),$t(this.chart.enableCanvas,this.labelElement,a,this.chart.redraw,!0,"x","y",null,l)}triggerMultiLabelRender(e,t,i,s,o){const l={cancel:!1,name:be,axis:e,text:t,textStyle:i,alignment:s,customAttributes:o};return this.chart.trigger(be,l),l}MultiLevelLabelClick(e,t){const i=parseInt(e.substr(0,1),10),s=parseInt(e.substr(7),10),o=this.chart.axisCollections[t],l=o.multiLevelLabels[i].categories,a={axis:o,level:i,text:l[s].text,customAttributes:l[s].customAttributes,start:l[s].start,end:l[s].end,name:Oe,cancel:!1};return this.chart.trigger(Oe,a),a}click(e){let t=e.target.id;const i="_Axis_MultiLevelLabel_Level_";let s,o,l;if(this.chart.enableCanvas)for(let a=0;a<this.multiLevelLabelRectXRegion.length;a++)Dt(e.x,e.y,this.multiLevelLabelRectXRegion[a],this.multiLevelLabelRectXRegion[a].width,this.multiLevelLabelRectXRegion[a].height)&&(t=this.xLabelCollection[a].id);t.indexOf(i)>-1&&(s=t.split(i)[1],o=t.split(i)[0],l=parseInt(o.charAt(o.length-1),10),this.MultiLevelLabelClick(s,l))}getModuleName(){return"MultiLevelLabel"}destroy(){}}class Us{constructor(e){this.chartId=e.element.id+"_"}renderElements(e,t){const i=t.createGroup({id:this.chartId+"scrollBar_"+e.axis.name,transform:"translate("+(e.isVertical&&e.axis.isInversed?e.height:e.axis.isInversed?e.width:"0")+","+(e.isVertical&&e.axis.isInversed?"0":e.axis.isInversed?e.height:e.isVertical?e.width:"0")+") rotate("+(e.isVertical&&e.axis.isInversed?"90":e.isVertical?"270":e.axis.isInversed?"180":"0")+")"}),s=t.createGroup({id:this.chartId+"scrollBar_backRect_"+e.axis.name}),o=t.createGroup({id:this.chartId+"scrollBar_thumb_"+e.axis.name,transform:"translate(0,0)"});return this.backRect(e,t,s),this.thumb(e,t,o),this.renderCircle(e,t,o),this.arrows(e,t,o),this.thumbGrip(e,t,o),i.appendChild(s),i.appendChild(o),i}backRect(e,t,i){const s=e.scrollbarThemeStyle,o=t.drawRectangle(new Ti(this.chartId+"scrollBarBackRect_"+e.axis.name,s.backRect,{width:1,color:s.backRect},1,new C(0,0,e.width,e.height),0,0));i.appendChild(o)}arrows(e,t,i){const s=e.scrollbarThemeStyle,o=new I(this.chartId+"scrollBar_leftArrow_"+e.axis.name,s.arrow,1,s.arrow,1,"","");this.leftArrowEle=t.drawPath(o),o.id=this.chartId+"scrollBar_rightArrow_"+e.axis.name,this.rightArrowEle=t.drawPath(o),this.setArrowDirection(this.thumbRectX,this.thumbRectWidth,e.height),i.appendChild(this.leftArrowEle),i.appendChild(this.rightArrowEle)}setArrowDirection(e,t,i){const s="M "+(e+t+4-.5)+" "+i/2+" L "+(e+t+4-6)+" 11.5 L "+(e+t+4-6)+" 4.5 Z";this.leftArrowEle.setAttribute("d","M "+(e-4+1)+" "+i/2+" L "+(e-4+6)+" 11 L "+(e-4+6)+" 5 Z"),this.rightArrowEle.setAttribute("d",s)}thumb(e,t,i){e.startX=this.thumbRectX,this.slider=t.drawRectangle(new Ti(this.chartId+"scrollBarThumb_"+e.axis.name,e.scrollbarThemeStyle.thumb,{width:1,color:""},1,new C(this.thumbRectX,0,this.thumbRectWidth,e.height))),i.appendChild(this.slider)}renderCircle(e,t,i){const s=e.scrollbarThemeStyle,o=new Ai(this.chartId+"scrollBar_leftCircle_"+e.axis.name,s.circle,{width:1,color:s.circle},1,this.thumbRectX,e.height/2,8),l=t.createDefs(),a=t.createGroup({id:this.chartId+e.axis.name+"_thumb_shadow"});l.innerHTML='<filter x="-25.0%" y="-20.0%" width="150.0%" height="150.0%" filterUnits="objectBoundingBox"id="scrollbar_shadow"><feOffset dx="0" dy="1" in="SourceAlpha" result="shadowOffsetOuter1"></feOffset><feGaussianBlur stdDeviation="1.5" in="shadowOffsetOuter1" result="shadowBlurOuter1"></feGaussianBlur><feComposite in="shadowBlurOuter1" in2="SourceAlpha" operator="out" result="shadowBlurOuter1"></feComposite><feColorMatrix values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.16 0" type="matrix" in="shadowBlurOuter1"></feColorMatrix></filter>',a.innerHTML='<use fill="black" fill-opacity="1" filter="url(#scrollbar_shadow)" xlink:href="#'+this.chartId+"scrollBar_leftCircle_"+e.axis.name+'"></use><use fill="black" fill-opacity="1" filter="url(#scrollbar_shadow)" xlink:href="#'+this.chartId+"scrollBar_rightCircle_"+e.axis.name+'"></use>',this.leftCircleEle=t.drawCircle(o),o.id=this.chartId+"scrollBar_rightCircle_"+e.axis.name,o.cx=this.thumbRectX+this.thumbRectWidth,this.rightCircleEle=t.drawCircle(o),i.appendChild(l),i.appendChild(this.leftCircleEle),i.appendChild(this.rightCircleEle),i.appendChild(a)}thumbGrip(e,t,i){let s=0,o=0;const l=e.scrollbarThemeStyle,a=new Ai(this.chartId+"scrollBar_gripCircle0_"+e.axis.name,l.grip,{width:1,color:l.grip},1,0,0,1);this.gripCircle=t.createGroup({id:this.chartId+"scrollBar_gripCircle_"+e.axis.name,transform:"translate("+(this.thumbRectX+this.thumbRectWidth/2+5*(e.isVertical?1:-1))+","+(e.isVertical?"10":"5")+") rotate("+(e.isVertical?"180":"0")+")"});for(let r=1;r<=6;r++)a.id=this.chartId+"scrollBar_gripCircle"+r+"_"+e.axis.name,a.cx=s,a.cy=o,this.gripCircle.appendChild(t.drawCircle(a)),s=3===r?0:s+5,o=r>=3?5:0;i.appendChild(this.gripCircle)}}class Xs{constructor(e,t){this.scrollRange={max:null,min:null,interval:null,delta:null},this.component=e,this.elements=[],this.scrollElements=new Us(e),this.axis=t,this.mouseMoveListener=this.scrollMouseMove.bind(this),this.mouseUpListener=this.scrollMouseUp.bind(this),this.animateDuration=500,this.isPointer=a.AR.isPointer,this.browserName=a.AR.info.name}getMouseXY(e){let t,i,s;e.type.indexOf("touch")>-1?(s=e,t=s.changedTouches[0].clientX,i=s.changedTouches[0].clientY):(t=e.clientX,i=e.clientY);const o=Yt(this.component.element.id+"_scrollBar_svg"+this.axis.name).getBoundingClientRect();this.mouseX=t-Math.max(o.left,0),this.mouseY=i-Math.max(o.top,0)}wireEvents(e){a.bi.add(e,a.AR.touchStartEvent,this.scrollMouseDown,this),a.bi.add(e,a.AR.touchMoveEvent,this.scrollMouseMove,this),a.bi.add(e,a.AR.touchEndEvent,this.scrollMouseUp,this),a.bi.add(e,"mousewheel",this.scrollMouseWheel,this),window.addEventListener("mousemove",this.mouseMoveListener,!1),window.addEventListener("mouseup",this.mouseUpListener,!1)}unWireEvents(e){a.bi.remove(e,a.AR.touchStartEvent,this.scrollMouseDown),a.bi.remove(e,a.AR.touchMoveEvent,this.scrollMouseMove),a.bi.remove(e,a.AR.touchEndEvent,this.scrollMouseUp),a.bi.remove(e,"mousewheel",this.scrollMouseWheel),window.removeEventListener("mousemove",this.mouseMoveListener,!1),window.removeEventListener("mouseup",this.mouseUpListener,!1)}scrollMouseDown(e){const t=e.target.id,i=this.scrollElements;if(this.getMouseXY(e),this.isResizeLeft=this.isExist(t,"_leftCircle_")||this.isExist(t,"_leftArrow_"),this.isResizeRight=this.isExist(t,"_rightCircle_")||this.isExist(t,"_rightArrow_"),this.previousXY=this.isVertical&&this.axis.isInversed?this.mouseY:this.isVertical?this.width-this.mouseY:this.axis.isInversed?this.width-this.mouseX:this.mouseX,this.previousWidth=i.thumbRectWidth,this.previousRectX=i.thumbRectX,this.startZoomPosition=this.axis.zoomPosition,this.startZoomFactor=this.axis.zoomFactor,this.startRange=this.axis.visibleRange,this.scrollStarted=!0,this.component.trigger(Pe,this.getArgs(Pe)),this.isExist(t,"scrollBarThumb_")||this.isExist(t,"gripCircle"))this.isThumbDrag=!0,this.svgObject.style.cursor="-webkit-grabbing";else if(this.isExist(t,"scrollBarBackRect_")){const e=this.moveLength(this.previousXY,this.previousRectX);if(i.thumbRectX=this.isWithIn(e)?e:i.thumbRectX,this.positionThumb(i.thumbRectX,i.thumbRectWidth),this.setZoomFactorPosition(i.thumbRectX,i.thumbRectWidth,!1),this.isLazyLoad){const e=this.calculateLazyRange(i.thumbRectX,i.thumbRectWidth,i.thumbRectX>this.previousRectX?"RightMove":"LeftMove");e&&this.component.trigger(ke,e)}}""===this.component.element.style.height&&(this.isCustomHeight=!0,this.component.element.style.height=this.component.availableSize.height+"px")}isExist(e,t){return e.indexOf(t)>-1}isWithIn(e){return e-8>=0&&e+this.scrollElements.thumbRectWidth+8<=this.width}moveLength(e,t,i=8){let s=.1*(this.width-2*i);return s=e<t?t-(t-s>i?s:i):t+(t+this.scrollElements.thumbRectWidth+s<this.width-i?s:i),s}setZoomFactorPosition(e,t,i=!0){this.isScrollUI=!0;const s=this.axis,o=e+t+8+1;this.zoomPosition=(e-(e-8.5<=0?8.5:0))/(this.isVertical?s.rect.height:this.width),this.zoomFactor=(t+(o>=this.width?9:0))/(this.isVertical?s.rect.height:this.width),s.zoomPosition=this.zoomPosition<0?0:this.zoomPosition>.9?1:this.zoomPosition,s.zoomFactor=i?this.zoomFactor:s.zoomFactor}scrollMouseMove(e){const t=e.target,i=this.scrollElements;this.getMouseXY(e),this.setCursor(t),this.setTheme(t);let s=this.isVertical&&this.axis.isInversed?this.width-this.mouseY:this.isVertical?this.mouseY:this.mouseX;const o=this.axis.visibleRange,l=this.zoomPosition,a=this.zoomFactor;let r;this.isLazyLoad&&(this.isThumbDrag||this.isResizeLeft||this.isResizeRight)&&(r=this.calculateLazyRange(i.thumbRectX,i.thumbRectWidth,this.previousRectX-i.thumbRectX<0?"RightMove":"LeftMove"));const n=r?r.currentRange:null;if(this.isThumbDrag){this.component.isScrolling=this.isThumbDrag,s=this.isVertical||this.axis.isInversed?this.width-s:s;const e=i.thumbRectX+(s-this.previousXY);s>=e+i.thumbRectWidth?this.setCursor(t):this.svgObject.style.cursor="-webkit-grabbing",s>=0&&s<=e+i.thumbRectWidth&&(i.thumbRectX=this.isWithIn(e)?e:i.thumbRectX,this.positionThumb(i.thumbRectX,i.thumbRectWidth),this.previousXY=s,this.setZoomFactorPosition(e,i.thumbRectWidth,!1)),this.component.trigger(Ee,this.getArgs(Ee,o,l,a,n))}else(this.isResizeLeft||this.isResizeRight)&&(this.resizeThumb(),this.component.trigger(Ee,this.getArgs(Ee,o,l,a,n)))}scrollMouseWheel(e){const t=Yt(this.component.element.id+"_scrollBar_svg"+this.axis.name).getBoundingClientRect();this.mouseX=e.clientX-Math.max(t.left,0),this.mouseY=e.clientY-Math.max(t.top,0);let i=.5;const s=this.scrollElements,o=this.axis,l="mozilla"!==this.browserName||this.isPointer?e.wheelDelta/120>0?1:-1:-e.detail/3>0?1:-1,a=Math.max(Math.max(1/Gt(o.zoomFactor,0,1),1)+.25*l,1),r=this.axis.visibleRange,n=this.zoomPosition,h=this.zoomFactor;let d;a>=1&&(i="Horizontal"===o.orientation?this.mouseX/o.rect.width:1-this.mouseY/o.rect.height,i=i>1?1:i<0?0:i,this.zoomFactor=1===a?1:Gt(1/a,0,1),this.zoomPosition=1===a?0:o.zoomPosition+(o.zoomFactor-this.zoomFactor)*i),s.thumbRectX=this.isWithIn(this.zoomPosition*this.width)?this.zoomPosition*this.width:s.thumbRectX,this.isScrollUI=!0,this.positionThumb(s.thumbRectX,s.thumbRectWidth),this.isLazyLoad&&this.setZoomFactorPosition(s.thumbRectX,s.thumbRectWidth),o.zoomFactor=this.zoomFactor,o.zoomPosition=this.zoomPosition,this.isLazyLoad&&(d=this.calculateMouseWheelRange(s.thumbRectX,s.thumbRectWidth),d&&d.currentRange.minimum!==d.previousAxisRange.minimum&&d.currentRange.maximum!==d.previousAxisRange.maximum&&(this.component.trigger(ke,d),this.isScrollEnd=!1)),this.isLazyLoad||this.component.trigger(Ee,this.getArgs(Ee,r,n,h))}scrollMouseUp(){let e;if(this.startX=this.scrollElements.thumbRectX,!this.isResizeLeft&&!this.isResizeRight||this.isLazyLoad||(this.axis.zoomFactor=this.startX+this.scrollElements.thumbRectWidth+8+1>=this.width-1&&this.startX-8.5<=0?1:this.zoomFactor),this.isLazyLoad){const t=this.previousRectX-this.startX;if((t>0||t<0)&&this.isThumbDrag){const i=t<0?"RightMove":"LeftMove";this.startX="RightMove"===i?this.startX+Math.abs(t)<this.width-8?this.startX:this.width-8-this.scrollElements.thumbRectWidth:this.startX+this.scrollElements.thumbRectWidth-Math.abs(t)>8?this.startX:8,e=this.calculateLazyRange(this.startX,this.scrollElements.thumbRectWidth,i),e&&(this.component.trigger(ke,e),this.scrollStarted=!1)}(this.isResizeLeft||this.isResizeRight)&&(e=this.calculateLazyRange(this.startX,this.scrollElements.thumbRectWidth),e&&(this.component.trigger(ke,e),this.scrollStarted=!1))}this.isThumbDrag=!1,this.isResizeLeft=!1,this.isResizeRight=!1,this.isScrollEnd=!1,this.component.isScrolling=!1,this.scrollStarted&&!this.isLazyLoad&&(this.component.trigger(ke,this.getArgs(Ee,this.startRange,this.startZoomPosition,this.startZoomFactor)),this.scrollStarted=!1),this.isCustomHeight&&(this.component.element.style.height=null)}calculateMouseWheelRange(e,t){let i,s,o;const l=this.scrollRange,a=this.getStartEnd(this.previousStart,this.previousEnd,!1);e+t+8<=this.width&&(s=(e-8)/this.width,i=t/this.width);const r=l.min+s*l.delta,n=r+i*l.delta;return n&&(o={axis:this.axis,currentRange:this.getStartEnd(r,n,!0),previousAxisRange:a}),o}calculateLazyRange(e,t,i){let s,o,l,a,r,n=t;const h=this.scrollRange,d=this.getStartEnd(this.previousStart,this.previousEnd,!1);return this.isResizeRight||"RightMove"===i?(n=this.isResizeRight?n+16:n,s=(n+8)/this.width,o="RightMove"===i?(e+8)/this.width:this.axis.zoomPosition,l="RightMove"===i?h.min+o*h.delta:this.previousStart,a=l+s*h.delta):this.isResizeLeft||"LeftMove"===i?(o=(e-8)/this.width,s=n/this.width,l=h.min+o*h.delta,l=l>=h.min?l:h.min,a="LeftMove"===i?l+s*h.delta:this.previousEnd):this.isThumbDrag&&(o="RightMove"===i?(e+8)/this.width:(e-8)/this.width,s=this.scrollElements.thumbRectWidth/this.width,l=h.min+o*h.delta,l=l>=h.min?l:h.min,a=l+s*h.delta),a&&(r={axis:this.component.isBlazor?{}:this.axis,currentRange:this.getStartEnd(l,a,!0),previousAxisRange:d}),r}getStartEnd(e,t,i){const s=this.valueType;switch("DateTime"!==s&&"DateTimeCategory"!==s||!i?i&&(this.previousStart=Math.round(e),this.previousEnd=Math.ceil(t)):(this.previousStart=e,this.previousEnd=t),s){case"Double":case"Category":case"Logarithmic":e=Math.round(e),t=Math.ceil(t);break;case"DateTime":case"DateTimeCategory":e=new Date(e),t=new Date(t)}return{minimum:e,maximum:t}}render(e){return(this.component.zoomModule||e&&this.axis.scrollbarSettings.enable)&&this.getDefaults(),this.getTheme(),this.removeScrollSvg(),function(e,t){const i=e.axis.rect,s="Horizontal"===e.axis.orientation;let o,l=!1,a=0;for(const r of e.axis.series)r.marker.visible&&r.marker.height>a&&(a=r.marker.height);for(const r of e.axis.series)if(r.visible&&(o=r.yMin.toString(),l=r.yData.some(e=>e===o)),l)break;e.svgObject=t.createSvg({id:e.component.element.id+"_scrollBar_svg"+e.axis.name,width:e.isVertical?e.height:e.width,height:e.isVertical?e.width:e.height,style:"position: absolute;top: "+((e.axis.opposedPosition&&s?-16:l?a:0)+i.y)+"px;left: "+((e.axis.opposedPosition&&!s?16:0)+i.x-(e.isVertical?e.height:0))+"px;cursor:auto;"}),e.elements.push(e.svgObject)}(this,this.component.svgRenderer),this.wireEvents(this.svgObject),this.svgObject.appendChild(this.scrollElements.renderElements(this,this.component.svgRenderer)),this.svgObject}getTheme(){this.scrollbarThemeStyle=function(e){let t;switch(e){case"HighContrastLight":t={backRect:"#333",thumb:"#bfbfbf",circle:"#fff",circleHover:"#685708",arrow:"#333",grip:"#333",arrowHover:"#fff",backRectBorder:"#969696"};break;case"Bootstrap":t={backRect:"#f5f5f5",thumb:"#e6e6e6",circle:"#fff",circleHover:"#eee",arrow:"#8c8c8c",grip:"#8c8c8c"};break;case"Fabric":t={backRect:"#f8f8f8",thumb:"#eaeaea",circle:"#fff",circleHover:"#eaeaea",arrow:"#a6a6a6",grip:"#a6a6a6"};break;default:t={backRect:"#f5f5f5",thumb:"#e0e0e0",circle:"#fff",circleHover:"#eee",arrow:"#9e9e9e",grip:"#9e9e9e"}}return t}(this.component.theme)}removeScrollSvg(){document.getElementById(this.component.element.id+"_scrollBar_svg"+this.axis.name)&&(0,a.Od)(document.getElementById(this.component.element.id+"_scrollBar_svg"+this.axis.name))}setCursor(e){const t=e.id;this.svgObject.style.cursor=t.indexOf("scrollBarThumb_")>-1||t.indexOf("_gripCircle")>-1?"-webkit-grab":t.indexOf("Circle_")>-1||t.indexOf("Arrow_")>-1?this.isVertical?"ns-resize":"ew-resize":"auto"}setTheme(e){const t=e.id,i=t.indexOf("_leftCircle_")>-1||t.indexOf("_leftArrow_")>-1,s=t.indexOf("_rightCircle_")>-1||t.indexOf("_rightArrow_")>-1,o=this.scrollbarThemeStyle,l=this.scrollElements.leftArrowEle,a=this.scrollElements.rightArrowEle,r=this.scrollElements.leftCircleEle,n=this.scrollElements.rightCircleEle,h=this.isCurrentAxis(e,l);r.style.fill=i&&h?o.circleHover:o.circle,n.style.fill=s&&h?o.circleHover:o.circle,r.style.stroke=i&&h?o.circleHover:o.circle,n.style.stroke=s&&h?o.circleHover:o.circle,"HighContrastLight"===this.component.theme&&(l.style.fill=i&&h?o.arrowHover:o.arrow,l.style.stroke=i&&h?o.arrowHover:o.arrow,a.style.fill=s&&h?o.arrowHover:o.arrow,a.style.stroke=s&&h?o.arrowHover:o.arrow,r.style.stroke=i&&h?o.circleHover:o.circle,n.style.stroke=s&&h?o.circleHover:o.circle)}isCurrentAxis(e,t){return e.id.split("_")[2]===t.id.split("_")[2]}resizeThumb(){let e;const t=this.previousRectX,i=this.isVertical&&this.axis.isInversed?this.mouseY:this.isVertical?this.width-this.mouseY:this.axis.isInversed?this.width-this.mouseX:this.mouseX,s=Math.abs(this.previousXY-i);if(this.isResizeLeft&&i>=0){let o=t+(i>this.previousXY?s:-s);e=o-8>=0?this.previousWidth+(i>this.previousXY?-s:s):this.previousWidth,o=o-8>=0?o:t,e>=40&&i<o+e&&(this.scrollElements.thumbRectX=this.previousRectX=o,this.scrollElements.thumbRectWidth=this.previousWidth=e,this.previousXY=i,this.positionThumb(o,e),this.setZoomFactorPosition(o,e))}else this.isResizeRight&&(e=i>=40+this.scrollElements.thumbRectX&&i<=this.width-8?i-this.scrollElements.thumbRectX:this.previousWidth,this.scrollElements.thumbRectWidth=this.previousWidth=e,this.previousXY=i,this.positionThumb(this.startX,e),this.setZoomFactorPosition(this.startX,e),this.isLazyLoad||this.setZoomFactorPosition(this.startX,e))}positionThumb(e,t){const i=this.scrollElements;i.slider.setAttribute("x",e.toString()),i.slider.setAttribute("width",t.toString()),i.leftCircleEle.setAttribute("cx",e.toString()),i.rightCircleEle.setAttribute("cx",(e+t).toString()),i.setArrowDirection(e,t,this.height),i.gripCircle.setAttribute("transform","translate("+(e+t/2+5*(this.isVertical?1:-1))+","+(this.isVertical?"10":"5")+") rotate("+(this.isVertical?"180":"0")+")")}getDefaults(){const e=this.axis;this.axis.scrollbarSettings.enable&&(this.isLazyLoad=!0,this.getLazyDefaults(e)),this.isVertical="Vertical"===e.orientation,this.zoomFactor=this.isLazyLoad?this.zoomFactor:e.zoomFactor,this.zoomPosition=this.isLazyLoad?this.zoomPosition:e.zoomPosition;let t=this.zoomFactor*(this.isVertical?e.rect.height:e.rect.width);t=t>40?t:40,this.scrollX=e.rect.x,this.scrollY=e.rect.y,this.width=this.isVertical?e.rect.height:e.rect.width,this.height=16;const i=this.zoomPosition*(this.isVertical?e.rect.height:this.width),s=this.width-40-8;this.scrollElements.thumbRectX=i>s?s:i<8?8:i,this.scrollElements.thumbRectWidth=t+this.scrollElements.thumbRectX<this.width-16?t:this.width-this.scrollElements.thumbRectX-8}getLazyDefaults(e){let t,i,s=e.valueType;const o=e.scrollbarSettings,l=e.scrollbarSettings.range,a=e.visibleRange,r=e.scrollbarSettings.pointsLength;this.valueType=s=o.range.minimum&&o.range.maximum||!o.pointsLength?s:"Double";const n={skeleton:"full",type:"dateTime"},h=this.component.intl.getDateParser(n),d=this.component.intl.getDateFormat(n);switch(s){case"Double":case"Category":case"Logarithmic":t=l.minimum?l.minimum:r?0:a.min,i=l.maximum?l.maximum:r?r-1:a.max;break;case"DateTime":case"DateTimeCategory":t=l.minimum?Date.parse(h(d(l.minimum))):a.min,i=l.maximum?Date.parse(h(d(l.maximum))):a.max}t=Math.min(t,a.min),i=Math.max(i,a.max);const c=(a.min-t)/(i-t);this.zoomFactor=l.minimum||l.maximum?(a.max-a.min)/(i-t):this.axis.maxPointLength/e.scrollbarSettings.pointsLength,this.zoomPosition=l.minimum||l.maximum?c:e.zoomPosition,this.scrollRange.min=t,this.scrollRange.max=i,this.scrollRange.delta=i-t,this.previousStart=a.min,this.previousEnd=a.max}getLogRange(e){const t=e.scrollbarSettings.range;let i=ht(t.minimum,e.logBase),s=ht(t.maximum,e.logBase);return i=isFinite(i)?i:t.minimum,s=isFinite(i)?s:t.maximum,{minimum:Math.floor(i/1),maximum:Math.ceil(s/1)}}injectTo(e,t){e.zoomingScrollBar=new Xs(t,e)}destroy(){this.axes?this.axes.map(e=>{e.zoomingScrollBar.destroy()}):(this.elements.map(e=>{this.unWireEvents(e),(0,a.Od)(e.firstChild)}),this.elements=[])}getModuleName(){return"ScrollBar"}getArgs(e,t,i,s,o){return{axis:this.component.isBlazor?{}:this.axis,name:e,range:this.axis.visibleRange,zoomFactor:this.axis.zoomFactor,zoomPosition:this.axis.zoomPosition,previousRange:t,previousZoomFactor:s,previousZoomPosition:i,currentRange:o}}}class Qs extends fs{constructor(){super(...arguments),this.paretoAxes=[]}initSeries(e,t){const i=new Ui(t,"series",e.properties,!0);i.name="Pareto",i.yAxisName=e.yAxisName+"_CumulativeAxis",i.category="Pareto",e.category="Pareto",i.type="Line",i.interior=t.themeStyle.errorBar,t.visibleSeries.push(i),this.initAxis(e,i,t)}initAxis(e,t,i){if(!this.paretoAxes.some(e=>e.name===t.yAxisName)){const s=e.yAxisName?i.axes.filter(t=>t.name===e.yAxisName)[0]:i.primaryYAxis,o=new ot(i,"axis",{name:t.yAxisName,majorGridLines:{width:0},majorTickLines:s.majorTickLines,lineStyle:s.lineStyle,minimum:0,maximum:100,rowIndex:s.rowIndex,opposedPosition:!0,labelFormat:"{value}%"});this.paretoAxes.push(o)}}render(e){e.chart.columnSeriesModule.render(e)}performCumulativeCalculation(e,t){const i=e;let s=0,o=0;const l=i.length;for(let a=0;a<l;a++)s+=i[a][t.yName];for(let a=0;a<l;a++)o+=i[a][t.yName],i[a][t.yName]=Math.round(o/s*100);return i}doAnimation(e){this.animate(e)}getModuleName(){return"ParetoSeries"}destroy(){}}class Js{constructor(e){this.chart=e}export(e,t,i,s,o,l,a,r,n){const h=new ls(this.chart);s=s||[this.chart];const d={cancel:!1,name:_e,width:o,height:l};this.chart.trigger(_e,d),d.cancel||h.export(e,t,i,s,o=d.width,l=d.height,a,r,n)}getDataUrl(e){return new ls(e).getDataUrl(e)}getModuleName(){return"Export"}destroy(){}}var Ks=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class $s extends a.rt{}Ks([(0,a.Z9)(null)],$s.prototype,"content",void 0),Ks([(0,a.Z9)("0")],$s.prototype,"x",void 0),Ks([(0,a.Z9)("0")],$s.prototype,"y",void 0),Ks([(0,a.Z9)("Pixel")],$s.prototype,"coordinateUnits",void 0),Ks([(0,a.Z9)("Chart")],$s.prototype,"region",void 0),Ks([(0,a.Z9)("Middle")],$s.prototype,"verticalAlignment",void 0),Ks([(0,a.Z9)("Center")],$s.prototype,"horizontalAlignment",void 0),Ks([(0,a.Z9)(null)],$s.prototype,"description",void 0);class eo extends a.rt{}Ks([(0,a.Z9)(!1)],eo.prototype,"visible",void 0),Ks([(0,a.Z9)(!0)],eo.prototype,"showZero",void 0),Ks([(0,a.Z9)(null)],eo.prototype,"name",void 0),Ks([(0,a.Z9)("transparent")],eo.prototype,"fill",void 0),Ks([(0,a.Z9)("Inside")],eo.prototype,"position",void 0),Ks([(0,a.Z9)(5)],eo.prototype,"rx",void 0),Ks([(0,a.Z9)(5)],eo.prototype,"ry",void 0),Ks([(0,a.Z9)(0)],eo.prototype,"angle",void 0),Ks([(0,a.Z9)(!1)],eo.prototype,"enableRotation",void 0),Ks([(0,a.Zz)({width:null,color:null},G)],eo.prototype,"border",void 0),Ks([(0,a.Zz)({size:"11px",color:"",fontStyle:"Normal",fontWeight:"Normal",fontFamily:"Segoe UI"},q)],eo.prototype,"font",void 0),Ks([(0,a.Zz)({},H)],eo.prototype,"connectorStyle",void 0),Ks([(0,a.Z9)(null)],eo.prototype,"template",void 0);class to extends a.rt{}Ks([(0,a.Z9)("50%")],to.prototype,"x",void 0),Ks([(0,a.Z9)("50%")],to.prototype,"y",void 0);class io{constructor(){this.visible=!0,this.symbolLocation=null,this.region=null,this.labelRegion=null,this.labelVisible=!0,this.regions=null,this.isExplode=!1,this.isClubbed=!1,this.isSliced=!1,this.argsData=null,this.isLabelUpdated=null,this.initialLabelRegion=null}}class so extends a.rt{constructor(){super(...arguments),this.points=[],this.clubbedPoints=[],this.sumOfPoints=0,this.isRectSeries=!0,this.clipRect=new C(0,0,0,0),this.category="Series",this.rightSidePoints=[],this.leftSidePoints=[]}refreshDataManager(e,t){const i=this.dataSource||e.dataSource;i instanceof r.hm||!(0,a.le)(this.query)?this.dataModule.getData(this.dataModule.generateQuery().requiresCount()).then(t=>this.dataManagerSuccess(t,e)):this.dataManagerSuccess({result:i,count:i.length},e,t)}dataManagerSuccess(e,t,i=!0){const s={name:ue,series:this,data:e.result};t.allowServerDataBinding=!1,t.trigger(ue,s),this.resultData=""!==e.result?e.result:[],t.isBlazor||i||this.getPoints(this.resultData,t),(++t.seriesCounts===t.visibleSeries.length&&i||window.Blazor&&!i&&1===t.seriesCounts)&&(this.getPoints(this.resultData,t),t.refreshChart())}getPoints(e,t){let i,s=Object.keys(e).length;if(this.sumOfPoints=0,0===s)return null;this.findSumOfPoints(e),this.points=[],this.clubbedPoints=[],this.sumOfClub=0;let o=this.palettes.length?this.palettes:Z(t.theme),l=ui(this.groupTo,this.sumOfPoints);for(let r=0;r<s;r++)i=this.setPoints(e,r,o,t),this.isClub(i,l,r)?(i.index=this.clubbedPoints.length,i.isExplode=!0,this.clubbedPoints.push(i),i.isSliced=!0):((0,a.le)(i.y)&&(i.visible=!1),this.pushPoints(i,o));if(this.lastGroupTo=this.groupTo,this.sumOfClub>0){let e=this.generateClubPoint();this.pushPoints(e,o);let t=this.points.length-1;this.clubbedPoints.map(i=>{i.index+=t,i.color=e.color})}this.clubbedPoints.length&&this.explode&&"Pie"===this.type&&(this.explodeAll||this.points[this.points.length-1].index===this.explodeIndex)&&(this.points.splice(this.points.length-1,1),this.points=this.points.concat(this.clubbedPoints))}generateClubPoint(){let e=new io;return e.isClubbed=!0,e.x="Others",e.y=this.sumOfClub,e.text=e.originalText=e.x+": "+this.sumOfClub,e.sliceRadius="80%",e}pushPoints(e,t){e.index=this.points.length,e.isExplode=this.explodeAll||e.index===this.explodeIndex,e.color=e.color||t[e.index%t.length],this.points.push(e)}isClub(e,t,i){if(!(0,a.le)(t)){if("Value"===this.groupMode&&Math.abs(e.y)<=t)return this.sumOfClub+=Math.abs(e.y),!0;if("Point"===this.groupMode&&i>=t)return this.sumOfClub+=Math.abs(e.y),!0}return!1}findSumOfPoints(e){let t=Object.keys(e).length;for(let i=0;i<t;i++)(0,a.le)(e[i])||(0,a.le)(e[i][this.yName])||isNaN(e[i][this.yName])||(this.sumOfPoints+=Math.abs(e[i][this.yName]))}setPoints(e,t,i,s){let o=new io;return o.x=(0,a.NA)(this.xName,e[t]),o.y=(0,a.NA)(this.yName,e[t]),o.percentage=+(o.y/this.sumOfPoints*100).toFixed(2),o.legendImageUrl=(0,a.NA)(this.legendImageUrl,e[t]),o.color=(0,a.NA)(this.pointColorMapping,e[t]),o.text=o.originalText=(0,a.NA)(this.dataLabel.name||"",e[t]),o.tooltip=(0,a.NA)(this.tooltipMappingName||"",e[t]),o.sliceRadius=(0,a.NA)(this.radius,e[t]),o.sliceRadius=(0,a.le)(o.sliceRadius)?"80%":o.sliceRadius,o.separatorY=s.intl.formatNumber(o.y,{useGrouping:s.useGroupingSeparator}),this.setAccEmptyPoint(o,t,e,i),o}renderSeries(e,t){let i,s=t?Yt(e.element.id+"_Series_"+this.index):e.renderer.createGroup({id:e.element.id+"_Series_"+this.index});this.renderPoints(e,s,t),e.accumulationDataLabelModule&&this.dataLabel.visible&&(i=e.renderer.createGroup({id:e.element.id+"_datalabel_Series_"+this.index}),i.style.visibility=this.animation.enable&&e.animateSeries&&"Pie"===this.type?"hidden":"visible",this.renderDataLabel(e,i,t)),"Pie"===this.type&&(this.findMaxBounds(this.labelBound,this.accumulationBound),e.pieSeriesModule.animateSeries(e,this.animation,this,s)),e.accumulationLegendModule&&(this.labelBound.x-=e.explodeDistance,this.labelBound.y-=e.explodeDistance,this.labelBound.height+=e.explodeDistance-this.labelBound.y,this.labelBound.width+=e.explodeDistance-this.labelBound.x)}renderPoints(e,t,i){let s,o=e.element.id+"_Series_"+this.index+"_Point_";for(let l of this.points){let a={cancel:!1,name:ce,series:this,point:l,fill:l.color,border:this.isEmpty(l)?{width:this.emptyPointSettings.border.width,color:this.emptyPointSettings.border.color}:{width:this.border.width,color:this.border.color}};e.trigger(ce,a),l.color=a.fill,s=new I(o+l.index,l.color,a.border.width||1,a.border.color||l.color,this.opacity,"",""),e[kt(this.type)+"SeriesModule"].renderPoint(l,this,e,s,t,i)}$t(!1,e.getSeriesElement(),t,i)}renderDataLabel(e,t,i){e.accumulationDataLabelModule.findAreaRect();let s=(0,a.az)("div",{id:e.element.id+"_Series_0_DataLabelCollections"});this.leftSidePoints=[],this.rightSidePoints=[];let o=[],l=[];for(let a of this.points)a.visible&&(this.dataLabel.showZero||!this.dataLabel.showZero&&(0!==a.y||0===a.y&&"Zero"===this.emptyPointSettings.mode))&&e.accumulationDataLabelModule.renderDataLabel(a,this.dataLabel,t,this.points,this.index,s,i),a.midAngle>=90&&a.midAngle<=270?this.leftSidePoints.push(a):a.midAngle>=0&&a.midAngle<=90?l.push(a):o.push(a);if(o.sort((e,t)=>e.midAngle-t.midAngle),l.sort((e,t)=>e.midAngle-t.midAngle),this.leftSidePoints.sort((e,t)=>e.midAngle-t.midAngle),this.rightSidePoints=o.concat(l),e.accumulationDataLabelModule.drawDataLabels(this,this.dataLabel,t,s,i),null!==this.dataLabel.template&&s.childElementCount){let o=e.accumulationDataLabelModule.drawDataLabels.bind(e.accumulationDataLabelModule,this,this.dataLabel,t,s,i);e.isReact&&e.renderReactTemplates(o),$t(!1,Yt(e.element.id+"_Secondary_Element"),s,i)}$t(!1,e.getSeriesElement(),t,i)}findMaxBounds(e,t){e.x=t.x<e.x?t.x:e.x,e.y=t.y<e.y?t.y:e.y,e.height=t.y+t.height>e.height?t.y+t.height:e.height,e.width=t.x+t.width>e.width?t.x+t.width:e.width}setAccEmptyPoint(e,t,i,s){if(!(0,a.le)(e.y)&&!isNaN(e.y))return null;switch(e.color=this.emptyPointSettings.fill||e.color,this.emptyPointSettings.mode){case"Zero":e.y=0,e.visible=!0;break;case"Average":let s=i[t+1]&&i[t+1][this.yName]||0;e.y=(Math.abs(i[t-1]&&i[t-1][this.yName]||0)+Math.abs(s))/2,this.sumOfPoints+=e.y,e.visible=!0;break;default:e.visible=!1}}isEmpty(e){return e.color===this.emptyPointSettings.fill}}function oo(e,t){for(let i of t)if(i.index===e)return i;return null}Ks([(0,a.Z9)("")],so.prototype,"dataSource",void 0),Ks([(0,a.Z9)()],so.prototype,"query",void 0),Ks([(0,a.Z9)("")],so.prototype,"xName",void 0),Ks([(0,a.Z9)("")],so.prototype,"name",void 0),Ks([(0,a.Z9)("")],so.prototype,"tooltipMappingName",void 0),Ks([(0,a.Z9)("")],so.prototype,"yName",void 0),Ks([(0,a.Z9)(!0)],so.prototype,"visible",void 0),Ks([(0,a.Zz)({color:null,width:0},G)],so.prototype,"border",void 0),Ks([(0,a.Zz)(null,Q)],so.prototype,"animation",void 0),Ks([(0,a.Z9)("SeriesType")],so.prototype,"legendShape",void 0),Ks([(0,a.Z9)("")],so.prototype,"legendImageUrl",void 0),Ks([(0,a.Z9)("")],so.prototype,"pointColorMapping",void 0),Ks([(0,a.Z9)(null)],so.prototype,"selectionStyle",void 0),Ks([(0,a.Z9)(null)],so.prototype,"groupTo",void 0),Ks([(0,a.Z9)("Value")],so.prototype,"groupMode",void 0),Ks([(0,a.Zz)({},eo)],so.prototype,"dataLabel",void 0),Ks([(0,a.Z9)([])],so.prototype,"palettes",void 0),Ks([(0,a.Z9)(0)],so.prototype,"startAngle",void 0),Ks([(0,a.Z9)(null)],so.prototype,"endAngle",void 0),Ks([(0,a.Z9)("80%")],so.prototype,"radius",void 0),Ks([(0,a.Z9)("0")],so.prototype,"innerRadius",void 0),Ks([(0,a.Z9)("Pie")],so.prototype,"type",void 0),Ks([(0,a.Z9)(!0)],so.prototype,"enableTooltip",void 0),Ks([(0,a.Z9)(!1)],so.prototype,"explode",void 0),Ks([(0,a.Z9)("30%")],so.prototype,"explodeOffset",void 0),Ks([(0,a.Z9)(!1)],so.prototype,"explodeAll",void 0),Ks([(0,a.Z9)(null)],so.prototype,"explodeIndex",void 0),Ks([(0,a.Zz)({mode:"Drop"},ee)],so.prototype,"emptyPointSettings",void 0),Ks([(0,a.Z9)(0)],so.prototype,"gapRatio",void 0),Ks([(0,a.Z9)("80%")],so.prototype,"width",void 0),Ks([(0,a.Z9)("80%")],so.prototype,"height",void 0),Ks([(0,a.Z9)("20%")],so.prototype,"neckWidth",void 0),Ks([(0,a.Z9)("20%")],so.prototype,"neckHeight",void 0),Ks([(0,a.Z9)("Linear")],so.prototype,"pyramidMode",void 0),Ks([(0,a.Z9)(1)],so.prototype,"opacity",void 0);class lo{constructor(e){this.accumulation=e}get center(){return this.pieCenter||("Pie"===this.accumulation.visibleSeries[0].type?this.accumulation.pieSeriesModule.pieBaseCenter:null)}set center(e){this.pieCenter=e}get radius(){return void 0!==this.pieRadius?this.pieRadius:this.accumulation.pieSeriesModule.pieBaseRadius}set radius(e){this.pieRadius=e}get labelRadius(){return void 0!==this.pieLabelRadius?this.pieLabelRadius:this.accumulation.pieSeriesModule.pieBaseLabelRadius}set labelRadius(e){this.pieLabelRadius=e}isCircular(){return"Pie"===this.accumulation.type}isVariousRadius(){return this.accumulation.pieSeriesModule.isRadiusMapped}processExplode(e){if(e.target.id.indexOf("_Series_")>-1||e.target.id.indexOf("_datalabel_")>-1){const t=Mt(e.target.id).point;if(isNaN(t)||e.target.id.indexOf("_datalabel_")>-1&&"Outside"===this.accumulation.visibleSeries[0].points[t].labelPosition)return null;this.explodePoints(t,this.accumulation),this.deExplodeAll(t,this.accumulation.enableAnimation?300:0)}}invokeExplode(){const e=this.accumulation.visibleSeries[0],t=this.accumulation.enableAnimation?300:0;for(const i of e.points)i.isExplode&&this.pointExplode(i.index,i,t);if(this.accumulation.accumulationSelectionModule&&"None"!==this.accumulation.selectionMode&&this.accumulation.accumulationSelectionModule.selectedDataIndexes.length)for(const i of this.accumulation.accumulationSelectionModule.selectedDataIndexes)this.explodePoints(i.point,this.accumulation,!0),this.deExplodeAll(i.point,t)}deExplodeAll(e,t){const i=this.accumulation.element.id+"_Series_0_Point_",s=this.accumulation.visibleSeries[0].points;for(const o of s)(e!==o.index&&!o.isSliced||o.isClubbed)&&(o.isExplode=!1,this.deExplodeSlice(o.index,i,t))}explodePoints(e,t,i=!1){const s=t.visibleSeries[0],o=s.points,l=oo(e,o);let r=!0;const n=this.accumulation.enableAnimation?300:0;if((0,a.le)(l))return null;const h=!i&&(l.isSliced||s.clubbedPoints.length&&o[o.length-1].index===s.clubbedPoints[s.clubbedPoints.length-1].index);"Pie"===s.type&&(h||l.isClubbed)&&(r=this.clubPointExplode(e,l,s,o,t,n,h)),r&&this.pointExplode(e,l,n,i)}getSum(e){let t=0;return e.map(e=>{t+=e.visible?e.y:0}),t}clubPointExplode(e,t,i,s,o,l,a=!1){if(t.isClubbed)return o.animateSeries=!1,s.splice(s.length-1,1),i.clubbedPoints.map(e=>{e.visible=!0,e.isExplode=!0}),o.visibleSeries[0].points=s.concat(i.clubbedPoints),this.deExplodeAll(e,l),i.sumOfPoints=this.getSum(o.visibleSeries[0].points),o.refreshChart(),!1;if(a||t.isSliced){o.animateSeries=!1,s.splice(s.length-i.clubbedPoints.length,i.clubbedPoints.length);const a=i.generateClubPoint();if(a.index=s.length,a.color=i.clubbedPoints[0].color,s.push(a),i.sumOfPoints=this.getSum(s),this.deExplodeAll(e,l),a.isExplode=!1,o.visibleSeries[0].points=s,o.refreshChart(),this.pointExplode(a.index,s[a.index],0,!0),a.isExplode=!1,this.deExplodeSlice(a.index,o.element.id+"_Series_0_Point_",l),t.isSliced)return!1}return!0}pointExplode(e,t,i,s){let o;const l=this.accumulation.element.id+"_Series_0_Point_",a=this.accumulation;o=this.isCircular()?ft(t.midAngle,a.explodeDistance,this.center):{x:t.labelRegion&&t.labelRegion.x<t.region.x?-a.explodeDistance:a.explodeDistance,y:0},this.isExplode(l+e)||s?(t.isExplode=!0,this.explodeSlice(e,o,l,this.center||{x:0,y:0},i)):(t.isExplode=!1,this.deExplodeSlice(e,l,i))}isExplode(e){const t=Yt(e),i=t?t.getAttribute("transform"):null;return t&&("translate(0, 0)"===i||null===i||"translate(0)"===i)}deExplodeSlice(e,t,i){const s=Yt(t+e);s&&s.parentNode.lastChild.hasAttribute("transform")&&s.parentNode.lastChild.removeAttribute("transform");const o=s?s.getAttribute("transform"):null;if(this.accumulation.enableAnimation&&s&&o&&"translate(0, 0)"!==o&&"translate(0)"!==o){const s=/translate\((-?\d+\.?\d*),?\s*(-?\d+[.]?\d*)?\)/.exec(o);this.performAnimation(e,t,0,0,+s[1],+s[2]||0,i,!0)}else this.performAnimation(e,t,0,0,0,0,i,!0)}setTranslate(e,t,i,s){this.setElementTransform(t+e,i),this.accumulation.visibleSeries[0].dataLabel.visible&&(this.setElementTransform((t=this.accumulation.element.id+"_datalabel_Series_0_")+"shape_"+e,i),this.setElementTransform(t+"text_"+e,i+s),this.setElementTransform(t+"connector_"+e,i))}setElementTransform(e,t){const i=Yt(e);i&&i.setAttribute("transform",t)}explodeSlice(e,t,i,s,o){this.performAnimation(e,i,0,0,t.x-s.x,t.y-s.y,o)}performAnimation(e,t,i,s,o,l,r,n){const h=this.accumulation,d=t.split("_"),c=parseInt(t.split("_")[d.length-3],10),p=h.visibleSeries[c].points[e];if(r<=0)return this.setTranslate(e,t,"translate("+o+", "+l+")",p.transform),null;let u,g;new a.fw({}).animate((0,a.az)("div"),{duration:r,progress:a=>{u=Ot(a.timeStamp,i,o,a.duration),g=Ot(a.timeStamp,s,l,a.duration),this.setTranslate(e,t,"translate("+(n?o-u:u)+", "+(n?l-g:g)+")",p.transform)},end:()=>{this.setTranslate(e,t,"translate("+(n?i:o)+", "+(n?i:l)+")",p.transform)}})}}class ao extends lo{initProperties(e,t){this.accumulation=e,this.size=Math.min(e.initialClipRect.width,e.initialClipRect.height),this.initAngles(t);const i=parseInt(t.radius,10);if(-1===t.radius.indexOf("%")&&"number"!=typeof i||isNaN(i)){const e=[];this.isRadiusMapped=!0;for(let o=0;o<Object.keys(t.points).length;o++)e[o]=-1!==t.points[o].sliceRadius.indexOf("%")?ui(t.points[o].sliceRadius,this.size/2):parseInt(t.points[o].sliceRadius,10);const i=Math.min.apply(null,e),s=Math.max.apply(null,e);this.pieBaseRadius=this.seriesRadius=s,this.innerRadius=ui(t.innerRadius,this.seriesRadius),this.innerRadius=this.innerRadius>i?this.innerRadius/2:this.innerRadius}else this.isRadiusMapped=!1,this.pieBaseRadius=ui(t.radius,this.size/2),this.innerRadius=ui(t.innerRadius,this.pieBaseRadius),this.pieBaseLabelRadius="Inside"===t.dataLabel.position?(this.pieBaseRadius-this.innerRadius)/2+this.innerRadius:this.pieBaseRadius+ui(t.dataLabel.connectorStyle.length||"4%",this.size/2);this.radius=this.pieBaseRadius,this.labelRadius=this.pieBaseLabelRadius,e.explodeDistance=t.explode?ui(t.explodeOffset,this.pieBaseRadius):0,this.findCenter(e,t),this.center=this.pieBaseCenter,this.defaultLabelBound(t,t.dataLabel.visible,t.dataLabel.position),this.totalAngle-=.001}getLabelRadius(e,t){return"Inside"===e.dataLabel.position?(ui(t.sliceRadius,this.pieBaseRadius)-this.innerRadius)/2+this.innerRadius:ui(t.sliceRadius,this.seriesRadius)+ui(e.dataLabel.connectorStyle.length||"4%",this.size/2)}findCenter(e,t){this.accumulation=e,this.pieBaseCenter={x:ui(e.center.x,e.initialClipRect.width)+e.initialClipRect.x,y:ui(e.center.y,e.initialClipRect.height)+e.initialClipRect.y};const i=this.getSeriesBound(t),s=new Ri(i.x+i.width/2,i.y+i.height/2);this.pieBaseCenter.x+=this.pieBaseCenter.x-s.x,this.pieBaseCenter.y+=this.pieBaseCenter.y-s.y,this.accumulation.origin=this.pieBaseCenter}initAngles(e){const t=(0,a.le)(e.endAngle)?e.startAngle:e.endAngle;this.totalAngle=(t-e.startAngle)%360,this.startAngle=e.startAngle-90,this.totalAngle=this.totalAngle<=0?360+this.totalAngle:this.totalAngle,this.startAngle=(this.startAngle<0?this.startAngle+360:this.startAngle)%360}defaultLabelBound(e,t,i){const s=this.getSeriesBound(e);e.accumulationBound=s,e.labelBound=new C(s.x,s.y,s.width+s.x,s.height+s.y),t&&"Outside"===i&&(e.labelBound=new C(1/0,1/0,-1/0,-1/0))}getSeriesBound(e){const t=new C(1/0,1/0,-1/0,-1/0);this.initAngles(e);const i=this.startAngle,s=this.totalAngle;let o=(this.startAngle+s)%360;o=0===o?360:o,e.findMaxBounds(t,this.getRectFromAngle(i)),e.findMaxBounds(t,this.getRectFromAngle(o)),e.findMaxBounds(t,new C(this.pieBaseCenter.x,this.pieBaseCenter.y,0,0));let l=(90*Math.floor(i/90)+90)%360,a=90*Math.floor(o/90)%360;a=0===a?360:a,(s>=90||a===l)&&(e.findMaxBounds(t,this.getRectFromAngle(l)),e.findMaxBounds(t,this.getRectFromAngle(a))),(0===i||i+s>=360)&&e.findMaxBounds(t,this.getRectFromAngle(0));const r=l===a?0:Math.floor(s/90);for(let n=1;n<r;n++)l+=90,(l<a||o<i||360===s)&&e.findMaxBounds(t,this.getRectFromAngle(l));return t.width-=t.x,t.height-=t.y,t}getRectFromAngle(e){const t=ft(e,this.pieBaseRadius,this.pieBaseCenter);return new C(t.x,t.y,0,0)}getPathArc(e,t,i,s,o){let l=i-t;l=l<0?l+360:l;const a=l<180?0:1;return o||0!==o?this.getDoughnutPath(e,ft(t,s,e),ft(i,s,e),s,ft(t,o,e),ft(i,o,e),o,a):this.getPiePath(e,ft(t,s,e),ft(i,s,e),s,a)}getPiePath(e,t,i,s,o){return"M "+e.x+" "+e.y+" L "+t.x+" "+t.y+" A "+s+" "+s+" 0 "+o+" 1 "+i.x+" "+i.y+" Z"}getDoughnutPath(e,t,i,s,o,l,a,r){return"M "+t.x+" "+t.y+" A "+s+" "+s+" 0 "+r+" 1 "+i.x+" "+i.y+" L "+l.x+" "+l.y+" A "+a+" "+a+" 0 "+r+",0 "+o.x+" "+o.y+" Z"}doAnimation(e,t){const i=t.startAngle-90,s=this.accumulation.duration?this.accumulation.duration:t.animation.duration;let o;this.pieBaseCenter.x+=1;let l=.75*Math.max(this.accumulation.availableSize.height,this.accumulation.availableSize.width);l+=.414*l;const r=Ft("Linear");new a.fw({}).animate(e,{duration:s,delay:t.animation.delay,progress:t=>{o=r(t.timeStamp,i,this.totalAngle,t.duration),e.setAttribute("d",this.getPathArc(this.pieBaseCenter,i,o,l,0))},end:()=>{this.pieBaseCenter.x-=1,e.setAttribute("d",this.getPathArc(this.pieBaseCenter,0,359.99999,l,0)),this.accumulation.trigger("animationComplete",this.accumulation.isBlazor?{}:{series:t,accumulation:this.accumulation,chart:this.accumulation}),Yt(this.accumulation.element.id+"_datalabel_Series_"+t.index).style.visibility=this.accumulation.isDestroyed?"hidden":"visible"}})}}class ro extends ao{renderPoint(e,t,i,s,o,l){const a=t.sumOfPoints;e.startAngle=this.startAngle;const r=a?Math.abs(e.visible?e.y:0)/a*this.totalAngle:null,n=Math.PI/180*(90-(360-this.startAngle)-90);this.radius=this.isRadiusMapped?ui(e.sliceRadius,this.seriesRadius):this.radius,s.d=this.getPathOption(e,r,this.startAngle%360),e.midAngle=(this.startAngle-r/2)%360,e.endAngle=this.startAngle%360,e.symbolLocation=ft(e.midAngle,(this.radius+this.innerRadius)/2,this.center),l?(o.appendChild(i.renderer.drawPath(s)),this.refresh(e,r,n,i,s)):(o.appendChild(i.renderer.drawPath(s)),e.degree=r,e.start=n)}findSeries(e){const t=0===this.innerRadius?this.radius+3:this.innerRadius-3;this.toggleInnerPoint(e,t,0===this.innerRadius?t+2:t-2)}toggleInnerPoint(e,t,i){const s=Mt(e.target.id,!0),o=e.target.id.substring(0,e.target.id.indexOf("Series")-1);let l,r=document.getElementById(this.accumulation.element.id+"PointHover_Border");const n=s.series,h=s.point,d=Yt(o+"_Series_"+n+"_Point_"+h);if(!isNaN(s.series)&&d){if(!((0,a.le)(n)||isNaN(n)||(0,a.le)(h)||isNaN(h))){const s=this.accumulation.visibleSeries[0].points[h],a=d.getAttribute("class")===o+"_ej2_deselected"?this.accumulation.tooltip.enable?.5:.3:this.accumulation.tooltip.enable?.5:1,c=this.getPathArc(this.accumulation.pieSeriesModule.center,s.startAngle%360,(s.startAngle+s.degree)%360,t,i);r&&o===this.accumulation.element.id&&(r.getAttribute("d")!==c||s.isExplode)&&(r.parentNode.removeChild(r),r=null);const p=Yt(o+"_Series_"+n);if(!r&&(!s.isExplode||s.isExplode&&"click"!==e.type)){const t=new I(o+"PointHover_Border",s.color,1,s.color,a,"",c);if(l=this.accumulation.renderer.drawPath(t),l.removeAttribute("transform"),"None"!==this.accumulation.selectionMode&&e.target.hasAttribute("class")&&this.accumulation.accumulationSelectionModule.addSvgClass(l,e.target.getAttribute("class")),p.appendChild(l),s.isExplode&&l){const e=d.getAttribute("transform");l.setAttribute("transform",e)}}}}else r&&(this.removeBorder(r,1e3),r=null)}removeBorder(e,t){e&&setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},t)}refresh(e,t,i,s,o){const l=Yt(o.id),r=s.duration?s.duration:300;new a.fw({}).animate((0,a.az)("div"),{duration:r,delay:0,progress:o=>{const a=Ot(o.timeStamp,e.degree,t-e.degree,o.duration);let r=Ot(o.timeStamp,e.start,i-e.start,o.duration);r=(r/(Math.PI/180)+360)%360,l.setAttribute("d",this.getPathOption(e,a,r)),e.isExplode&&s.accBaseModule.explodePoints(e.index,s,!0),l.style.visibility="visible"},end:()=>{l.style.visibility=e.visible?"visible":"hidden",l.setAttribute("d",o.d),e.degree=t,e.start=i}})}getPathOption(e,t,i){if(!t)return"";const s=this.getPathArc(this.center,i%360,(i+t)%360,this.isRadiusMapped?ui(e.sliceRadius,this.seriesRadius):this.radius,this.innerRadius);return this.startAngle+=t,s}animateSeries(e,t,i,s){const o=e.element.id+"SeriesGroup"+i.index;if(i.animation.enable&&e.animateSeries){const t=e.renderer.createClipPath({id:o+"_clipPath"}),l=new I(o+"_slice","transparent",1,"transparent",1,"",""),a=e.renderer.drawPath(l);t.appendChild(a),e.svgObject.appendChild(t),s.setAttribute("style","clip-path:url(#"+t.id+"); -webkit-clip-path:url(#"+t.id+");"),this.doAnimation(a,i)}}getModuleName(){return"PieSeries"}destroy(){}}var no=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};let ho=class extends a.wA{constructor(e,t){super(e,t),this.animateselected=!1,this.explodeDistance=0,this.chartid=57724}animate(e){this.duration=e||700,this.animateselected=!0,this.animateSeries=!1;let t=0;const i=[],s=[],o=[],l=this.visibleSeries[0];let a=[];if(a=l.dataSource,l.sumOfPoints=0,l.points.length<Object.keys(l.dataSource).length)this.refresh();else if(l.points.length>Object.keys(l.dataSource).length){const e=this.visibleSeries[0];e.points=e.points.filter(e=>(e.visible=!1,s.push(e.index),i.push(e.color),a.some(i=>{const s=i;return e.x===s.x&&(e.visible=!0,o.push(e.index),e.index=t,t++),e.x===s.x})));const l=s.filter(e=>o.indexOf(e)<0),r=s.length-l.length;for(let t=s.length-1;t>=r;t--)nt("container_Series_0_Point_"+s[t]);for(let t=0;t<e.points.length;t++)e.points[t].y=e.dataSource[t].y,e.points[t].color=i[t],e.sumOfPoints+=e.dataSource[t].y;this.redraw=this.enableAnimation,this.animateSeries=!1,this.calculateBounds(),this.renderElements()}else{for(let e=0;e<l.points.length;e++)l.points[e].y=l.dataSource[e][l.yName],l.points[e].color=null!=l.dataSource[e][l.pointColorMapping]?l.dataSource[e][l.pointColorMapping]:l.points[e].color,l.sumOfPoints+=l.dataSource[e][l.yName];this.redraw=this.enableAnimation,this.animateSeries=!1,this.removeSvg(),this.refreshPoints(l.points),this.renderElements()}}get type(){return this.series&&this.series.length?this.series[0].type:"Pie"}preRender(){if(this.isBlazor=window.Blazor,this.allowServerDataBinding=!1,this.unWireEvents(),this.setCulture(),this.animateSeries=!0,""===this.element.id){const e=document.getElementsByClassName("e-accumulationchart").length;this.element.id="acc_chart_"+this.chartid+"_"+e}fi(this),this.wireEvents()}setTheme(){this.themeStyle=V(this.theme)}render(){-1===this.element.className.indexOf("e-accumulationchart")&&this.element.classList.add("e-accumulationchart");const e={chart:this.isBlazor?{}:this,accumulation:this.isBlazor?{}:this,theme:this.theme,name:ne,cancel:!1};this.trigger(ne,e,()=>{this.theme=this.isBlazor?e.theme:this.theme,this.setTheme(),this.accBaseModule=new lo(this),this.pieSeriesModule=new ro(this),this.calculateVisibleSeries(),this.processData(),this.renderComplete(),this.allowServerDataBinding=!0})}unWireEvents(){const e=a.AR.touchStartEvent,t=a.AR.touchEndEvent,i=a.AR.isPointer?"pointerleave":"mouseleave";a.bi.remove(this.element,a.AR.touchMoveEvent,this.accumulationMouseMove),a.bi.remove(this.element,t,this.accumulationMouseEnd),a.bi.remove(this.element,e,this.accumulationMouseStart),a.bi.remove(this.element,"click",this.accumulationOnMouseClick),a.bi.remove(this.element,"contextmenu",this.accumulationRightClick),a.bi.remove(this.element,i,this.accumulationMouseLeave),window.removeEventListener(a.AR.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.accumulationResize)}wireEvents(){if(!this.element)return;const e=a.AR.touchStartEvent,t=a.AR.touchEndEvent,i=a.AR.isPointer?"pointerleave":"mouseleave";a.bi.add(this.element,a.AR.touchMoveEvent,this.accumulationMouseMove,this),a.bi.add(this.element,t,this.accumulationMouseEnd,this),a.bi.add(this.element,e,this.accumulationMouseStart,this),a.bi.add(this.element,"click",this.accumulationOnMouseClick,this),a.bi.add(this.element,"contextmenu",this.accumulationRightClick,this),a.bi.add(this.element,i,this.accumulationMouseLeave,this),window.addEventListener(a.AR.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.accumulationResize.bind(this)),new a.Xh(this.element),this.setStyle(this.element)}setMouseXY(e){let t,i;const s=Yt(this.element.id+"_svg");if(s&&this.element){const o=s.getBoundingClientRect(),l=this.element.getBoundingClientRect();e.type.indexOf("touch")>-1?(this.isTouch=!0,i=e.changedTouches[0].clientY,t=e.changedTouches[0].clientX):(this.isTouch="touch"===e.pointerType||"2"===e.pointerType,t=e.clientX,i=e.clientY),this.mouseY=i-l.top-Math.max(o.top-l.top,0),this.mouseX=t-l.left-Math.max(o.left-l.left,0)}}accumulationMouseEnd(e){return this.setMouseXY(e),this.trigger(Me,{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.isTouch&&(this.titleTooltip(e,this.mouseX,this.mouseY,this.isTouch),this.accumulationDataLabelModule&&this.visibleSeries[0].dataLabel.visible&&this.accumulationDataLabelModule.move(e,this.mouseX,this.mouseY,this.isTouch),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.move(e)),this.notify(a.AR.touchEndEvent,e),!1}accumulationMouseStart(e){return this.setMouseXY(e),this.trigger(Ce,{target:e.target.id,x:this.mouseX,y:this.mouseY}),!1}accumulationResize(){this.animateSeries=!1;const e={accumulation:this.isBlazor?{}:this,previousSize:new w(this.availableSize.width,this.availableSize.height),name:De,currentSize:new w(0,0),chart:this.isBlazor?{}:this};let t={name:"beforeResize",cancelResizedEvent:!1};return this.resizeTo&&clearTimeout(this.resizeTo),this.trigger(Re,t),t.cancelResizedEvent||(this.resizeTo=+setTimeout(()=>{this.isDestroyed?clearTimeout(this.resizeTo):(fi(this),e.currentSize=this.availableSize,this.trigger(De,e),this.refreshSeries(),this.refreshChart())},500)),!1}print(e){const t=document.getElementById(this.element.id+"_Series_0").style.clipPath;document.getElementById(this.element.id+"_Series_0").style.clipPath="",new ls(this).print(e),document.getElementById(this.element.id+"_Series_0").style.clipPath=t}export(e,t){this.exportModule&&(this.exportModule.export(e,t),this.afterExport&&this.exportModule.getDataUrl(this))}setStyle(e){e.style.touchAction="element",e.style.msTouchAction="element",e.style.msContentZooming="none",e.style.msUserSelect="none",e.style.webkitUserSelect="none",e.style.position="relative",e.style.display="block"}setAnnotationValue(e,t){const i=this.annotations[e];let s;const o=Yt(this.element.id+"_Annotation_Collections");t&&(i.content=t,o?(s=this.createElement("div"),nt(this.element.id+"_Annotation_"+e),this.annotationModule.processAnnotation(i,e,s),o.appendChild(s.children[0])):this.annotationModule.renderAnnotations(Yt(this.element.id+"_Secondary_Element")))}accumulationMouseMove(e){return!!Yt(this.element.id+"_svg")&&(this.setMouseXY(e),this.trigger(ye,{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.pointMove&&this.triggerPointEvent(xe,e.target,e),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.move(e),this.accumulationDataLabelModule&&this.visibleSeries[0]&&this.visibleSeries[0].dataLabel.visible&&this.accumulationDataLabelModule.move(e,this.mouseX,this.mouseY),this.isTouch||this.titleTooltip(e,this.mouseX,this.mouseY),this.enableBorderOnMouseMove&&"Pie"===this.type&&this.pieSeriesModule&&Dt(this.mouseX,this.mouseY,this.initialClipRect)&&this.pieSeriesModule.findSeries(e),this.notify(a.AR.touchMoveEvent,e),!1)}titleTooltip(e,t,i,s){const o=e.target.id,l=o===this.element.id+"_title"||o===this.element.id+"_subTitle"||o===this.element.id+"_chart_legend_title";e.target.textContent.indexOf("...")>-1&&l?dt(o===this.element.id+"_title"?this.title:o===this.element.id+"_subTitle"?this.subTitle:this.legendSettings.title,t,i,this.element.offsetWidth,this.element.id+"_EJ2_Title_Tooltip",Yt(this.element.id+"_Secondary_Element"),s):nt(this.element.id+"_EJ2_Title_Tooltip")}accumulationOnMouseClick(e){return this.setMouseXY(e),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.click(e),"None"!==this.selectionMode&&this.accumulationSelectionModule&&this.accumulationSelectionModule.calculateSelectedElements(this,e),this.visibleSeries[0].explode&&this.accBaseModule.processExplode(e),this.enableBorderOnMouseMove&&this.pieSeriesModule&&"Pie"===this.type&&this.pieSeriesModule.findSeries(e),this.trigger(ve,{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.pointClick&&this.triggerPointEvent(Se,e.target,e),!1}triggerPointEvent(e,t,i){const s=i,o=Mt(t.id,!0);o.series>=0&&o.point>=0&&this.trigger(e,{series:this.isBlazor?{}:this.series[o.series],point:this.series[o.series].points[o.point],seriesIndex:o.series,pointIndex:o.point,x:this.mouseX,y:this.mouseY,pageX:s.pageX,pageY:s.pageY})}accumulationRightClick(e){return 2!==e.buttons&&"touch"!==e.pointerType||(e.preventDefault(),e.stopPropagation(),!1)}accumulationMouseLeave(e){this.setMouseXY(e),this.trigger(we,{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.notify(a.AR.isPointer?"pointerleave":"mouseleave",e);let t=document.getElementById(this.element.id+"PointHover_Border");return t&&(this.pieSeriesModule.removeBorder(t,1e3),t=null),!1}setCulture(){this.intl=new a.eC}createPieSvg(){this.removeSvg(),yi(this)}removeSvg(){if(this.redraw)return null;if(Ci(this),nt(this.element.id+"_Secondary_Element"),this.svgObject){for(;this.svgObject.childNodes.length>0;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&(0,a.Od)(this.svgObject)}nt("EJ2_legend_tooltip"),nt("EJ2_datalabel_tooltip"),nt(this.element.id+"PointHover_Border")}createSecondaryElement(){const e=gi(this.redraw,this.element.id+"_Secondary_Element")||this.createElement("div",{id:this.element.id+"_Secondary_Element",styles:"position: relative"});$t(!1,this.element,e,this.redraw)}calculateVisibleSeries(){this.visibleSeries=[];for(let e=0,t=this.series.length;e<t;e++)if(this.series[e].index=e,this.series[e].type===this.type&&0===this.visibleSeries.length){this.visibleSeries.push(this.series[e]);break}}processData(e=!0){this.seriesCounts=0;for(const t of this.visibleSeries)t.dataModule=new Xi(t.dataSource||this.dataSource,t.query),t.refreshDataManager(this,e)}refreshChart(){this.doGrouppingProcess(),this.createPieSvg(),this.calculateBounds(),this.renderElements(),nt("chartmeasuretext")}doGrouppingProcess(){const e=this.visibleSeries[0];(0,a.le)(e.resultData)||(0,a.le)(e.lastGroupTo)||e.lastGroupTo===e.groupTo||e.getPoints(e.resultData,this)}calculateBounds(){this.initialClipRect=new C(this.margin.left,this.margin.top,this.availableSize.width,this.availableSize.height),this.titleCollection=[],this.subTitleCollection=[];let e=0,t=0,i=0,s=0;if(this.titleCollection=vi(this.title,this.titleStyle,this.initialClipRect.width),e=this.title?S(this.title,this.titleStyle).height*this.titleCollection.length:e,this.subTitle){for(const e of this.titleCollection)s=S(e,this.titleStyle).width,i=s>i?s:i;this.subTitleCollection=vi(this.subTitle,this.subTitleStyle,i),t=S(this.subTitle,this.subTitleStyle).height*this.subTitleCollection.length}var o,l;o=this.initialClipRect,l=new C(0,t+e,this.margin.right+this.margin.left,this.margin.bottom+this.margin.top),o.x+=l.x,o.y+=l.y,o.width-=l.x+l.width,o.height-=l.y+l.height,this.calculateLegendBounds()}calculateLegendBounds(){if(!this.accumulationLegendModule||!this.legendSettings.visible)return null;this.accumulationLegendModule.getLegendOptions(this,this.visibleSeries),this.accumulationLegendModule.calculateLegendBounds(this.initialClipRect,this.availableSize,null)}renderElements(){this.renderBorder(),this.createSecondaryElement(),this.renderSeries(),this.renderTitle(),this.renderLegend(),$t(!1,this.element,this.svgObject,this.redraw),this.processSelection(),this.processExplode(),this.renderAnnotation(),this.setSecondaryElementPosition(),(0,a.tx)(this.element.id+"_DataLabel","Template",this.series[0].dataLabel),this.trigger("loaded",{accumulation:this.isBlazor?{}:this,chart:this.isBlazor?{}:this}),this.animateSeries=!1}setSecondaryElementPosition(){const e=Yt(this.element.id+"_Secondary_Element");if(!e)return;const t=this.element.getBoundingClientRect(),i=Yt(this.element.id+"_svg").getBoundingClientRect();e.style.left=Math.max(i.left-t.left,0)+"px",e.style.top=Math.max(i.top-t.top,0)+"px"}renderAnnotation(){this.annotationModule&&this.annotationModule.renderAnnotations(Yt(this.element.id+"_Secondary_Element"))}processExplode(){return this.redraw?null:this.visibleSeries[0].explode?void this.accBaseModule.invokeExplode():null}renderSeries(){this.redraw||this.svgObject.appendChild(this.renderer.createGroup({id:this.element.id+"_SeriesCollection"}));for(const e of this.visibleSeries)e.visible&&this[kt(e.type)+"SeriesModule"]&&(this[kt(e.type)+"SeriesModule"].initProperties(this,e),e.renderSeries(this,this.redraw))}renderBorder(){const e=this.border.width;$t(!1,this.svgObject,this.renderer.drawRectangle(new Ti(this.element.id+"_border",this.background||this.themeStyle.background,this.border,1,new C(e/2,e/2,this.availableSize.width-e,this.availableSize.height-e))),this.redraw);const t=this.backgroundImage;if(t){const i=new Li(this.availableSize.height-e,this.availableSize.width-e,t,0,0,this.element.id+"_background","visible","none");$t(!1,this.svgObject,this.renderer.drawImage(i),this.redraw)}}renderLegend(){if(!this.accumulationLegendModule||!this.legendSettings.visible)return null;this.accumulationLegendModule.legendCollections.length&&("Pie"===this.visibleSeries[0].type&&this.accumulationLegendModule.getSmartLegendLocation(this.visibleSeries[0].labelBound,this.accumulationLegendModule.legendBounds,this.margin),this.accumulationLegendModule.renderLegend(this,this.legendSettings,this.accumulationLegendModule.legendBounds,this.redraw))}processSelection(){if(!this.accumulationSelectionModule||"None"===this.selectionMode)return null;const e=(0,a.l7)([],this.accumulationSelectionModule.selectedDataIndexes,null,!0);this.accumulationSelectionModule.invokeSelection(this),e.length>0&&(this.accumulationSelectionModule.selectedDataIndexes=e,this.accumulationSelectionModule.redrawSelection(this))}renderTitle(){const e=this.margin;if(!this.title)return null;const t=this.titleStyle.textAlignment,i="Near"===t?"start":"Far"===t?"end":"middle",s=S(this.title,this.titleStyle),o=new C(e.left,0,this.availableSize.width-e.left-e.right,0),l=new L(this.element.id+"_title",Si(o,this.titleStyle),this.margin.top+3*s.height/4,i,this.titleCollection,"","auto"),a=bi(this.renderer,l,this.titleStyle,this.titleStyle.color||this.themeStyle.chartTitle,this.svgObject,!1,this.redraw);a&&a.setAttribute("aria-label",this.title),this.subTitle&&this.renderSubTitle(l)}renderSubTitle(e){let t=0,i=0;const s=this.titleStyle.textAlignment,o=S(this.subTitle,this.subTitleStyle);for(const r of this.titleCollection)i=S(r,this.titleStyle).width,t=i>t?i:t;const l=new C("Center"===s?e.x-t/2:"Far"===s?e.x-t:e.x,0,t,0),a=new L(this.element.id+"_subTitle",Si(l,this.subTitleStyle),e.y*e.text.length+3*o.height/4+10,(e=>"Near"===e?"start":"Far"===e?"end":"middle")(this.subTitleStyle.textAlignment),this.subTitleCollection,"","auto");bi(this.renderer,a,this.subTitleStyle,this.subTitleStyle.color||this.themeStyle.chartTitle,this.svgObject,!1,this.redraw)}getSeriesElement(){return this.svgObject.getElementsByTagName("g")[0]}refreshSeries(){for(const e of this.visibleSeries)this.refreshPoints(e.points)}refreshPoints(e){for(const t of e)t.labelPosition=null,t.labelRegion=null,t.labelVisible=!0}getModuleName(){return"accumulationchart"}destroy(){this.element&&(this.unWireEvents(),super.destroy(),this.element.classList.remove("e-accumulationchart"),this.removeSvg(),this.svgObject=null)}requiredModules(){const e=[];let t=!1;return e.push({member:this.type+"Series",args:[this]}),this.legendSettings.visible&&e.push({member:"AccumulationLegend",args:[this]}),this.findDatalabelVisibility()&&e.push({member:"AccumulationDataLabel",args:[this]}),this.tooltip.enable&&e.push({member:"AccumulationTooltip",args:[this]}),"None"!==this.selectionMode&&e.push({member:"AccumulationSelection",args:[this]}),(this.enableExport||this.allowExport)&&e.push({member:"Export",args:[this]}),t=this.annotations.some(e=>null!==e.content),t&&e.push({member:"Annotation",args:[this]}),e}findDatalabelVisibility(){for(const e of this.series)if(e.dataLabel.visible)return!0;return!1}changeVisibleSeries(e,t){for(const i of e)if(t===i.index)return i;return null}getPersistData(){return""}onPropertyChanged(e,t){const i={refreshElements:!1,refreshBounds:!1};for(const s of Object.keys(e))switch(s){case"theme":this.animateSeries=!0;break;case"title":case"subTitle":case"height":case"width":case"margin":i.refreshBounds=!0;break;case"titleStyle":e.titleStyle&&(e.titleStyle.size||e.titleStyle.textOverflow)?i.refreshBounds=!0:i.refreshElements=!0;break;case"subTitleStyle":e.subTitleStyle&&(e.subTitleStyle.size||e.subTitleStyle.textOverflow)?i.refreshBounds=!0:i.refreshElements=!0;break;case"legendSettings":i.refreshBounds=!0,i.refreshElements=!0;break;case"dataSource":this.processData(!1),i.refreshBounds=!0;break;case"series":if(!this.animateselected){const s=this.series.length;let o,l,r=!1;for(let i=0;i<s;i++)o=e.series[i],this.isBlazor&&(o.startAngle||o.endAngle||o.explodeOffset||o.neckHeight||o.neckWidth||o.radius||o.innerRadius||o.groupMode||o.emptyPointSettings)&&(l=!0),e.series[i]&&(e.series[i].dataSource||e.series[i].yName||e.series[i].xName||e.series[i].dataLabel||l)&&((0,a.l7)(this.changeVisibleSeries(this.visibleSeries,i),o,null,!0),r=!0),e.series[i]&&e.series[i].explodeIndex&&e.series[i].explodeIndex!==t.series[i].explodeIndex&&(this.accBaseModule.explodePoints(e.series[i].explodeIndex,this),this.accBaseModule.deExplodeAll(e.series[i].explodeIndex,this.enableAnimation?300:0));r&&(this.processData(!1),i.refreshBounds=!0)}this.animateselected=!1,this.redraw=!1;break;case"locale":case"currencyCode":super.refresh();break;case"background":case"border":case"annotations":case"enableSmartLabels":i.refreshElements=!0;break;case"isMultiSelect":case"selectedDataIndexes":case"selectionMode":this.accumulationSelectionModule&&((0,a.le)(this.accumulationSelectionModule.selectedDataIndexes)?this.accumulationSelectionModule.invokeSelection(this):this.accumulationSelectionModule.redrawSelection(this))}!i.refreshBounds&&i.refreshElements?(this.createPieSvg(),this.renderElements()):i.refreshBounds&&(this.refreshSeries(),this.createPieSvg(),this.calculateBounds(),this.renderElements())}};no([(0,a.Z9)(null)],ho.prototype,"width",void 0),no([(0,a.Z9)(null)],ho.prototype,"height",void 0),no([(0,a.Z9)(null)],ho.prototype,"title",void 0),no([(0,a.Z9)(null)],ho.prototype,"backgroundImage",void 0),no([(0,a.Zz)({},to)],ho.prototype,"center",void 0),no([(0,a.Z9)("")],ho.prototype,"dataSource",void 0),no([(0,a.Zz)(B.chartTitleFont,q)],ho.prototype,"titleStyle",void 0),no([(0,a.Z9)(null)],ho.prototype,"subTitle",void 0),no([(0,a.Zz)(B.chartSubTitleFont,q)],ho.prototype,"subTitleStyle",void 0),no([(0,a.Zz)({},es)],ho.prototype,"legendSettings",void 0),no([(0,a.Zz)({},ie)],ho.prototype,"tooltip",void 0),no([(0,a.Z9)("None")],ho.prototype,"selectionMode",void 0),no([(0,a.Z9)("None")],ho.prototype,"highLightMode",void 0),no([(0,a.Z9)("None")],ho.prototype,"selectionPattern",void 0),no([(0,a.Z9)("None")],ho.prototype,"highlightPattern",void 0),no([(0,a.Z9)(!0)],ho.prototype,"enableBorderOnMouseMove",void 0),no([(0,a.Z9)(!1)],ho.prototype,"isMultiSelect",void 0),no([(0,a.Z9)(!0)],ho.prototype,"enableAnimation",void 0),no([(0,a.FE)([],J)],ho.prototype,"selectedDataIndexes",void 0),no([(0,a.Zz)({},U)],ho.prototype,"margin",void 0),no([(0,a.Z9)(!0)],ho.prototype,"enableSmartLabels",void 0),no([(0,a.Zz)({color:"#DDDDDD",width:0},G)],ho.prototype,"border",void 0),no([(0,a.Z9)(null)],ho.prototype,"background",void 0),no([(0,a.FE)([{}],so)],ho.prototype,"series",void 0),no([(0,a.FE)([{}],$s)],ho.prototype,"annotations",void 0),no([(0,a.Z9)("Material")],ho.prototype,"theme",void 0),no([(0,a.Z9)(!1)],ho.prototype,"useGroupingSeparator",void 0),no([(0,a.Z9)(!0)],ho.prototype,"enableExport",void 0),no([(0,a.Z9)(!1)],ho.prototype,"allowExport",void 0),no([(0,a.ju)()],ho.prototype,"loaded",void 0),no([(0,a.ju)()],ho.prototype,"load",void 0),no([(0,a.ju)()],ho.prototype,"seriesRender",void 0),no([(0,a.ju)()],ho.prototype,"legendRender",void 0),no([(0,a.ju)()],ho.prototype,"textRender",void 0),no([(0,a.ju)()],ho.prototype,"tooltipRender",void 0),no([(0,a.ju)()],ho.prototype,"pointRender",void 0),no([(0,a.ju)()],ho.prototype,"annotationRender",void 0),no([(0,a.ju)()],ho.prototype,"beforePrint",void 0),no([(0,a.ju)()],ho.prototype,"chartMouseMove",void 0),no([(0,a.ju)()],ho.prototype,"chartMouseClick",void 0),no([(0,a.ju)()],ho.prototype,"pointClick",void 0),no([(0,a.ju)()],ho.prototype,"pointMove",void 0),no([(0,a.ju)()],ho.prototype,"animationComplete",void 0),no([(0,a.ju)()],ho.prototype,"chartMouseDown",void 0),no([(0,a.ju)()],ho.prototype,"chartMouseLeave",void 0),no([(0,a.ju)()],ho.prototype,"chartMouseUp",void 0),no([(0,a.ju)()],ho.prototype,"beforeResize",void 0),no([(0,a.ju)()],ho.prototype,"resized",void 0),no([(0,a.ju)()],ho.prototype,"afterExport",void 0),no([(0,a.Z9)("USD")],ho.prototype,"currencyCode",void 0),ho=no([a.Zl],ho);class co extends lo{initProperties(e,t){const i=e.initialClipRect;t.triangleSize=new w(ui(t.width,i.width),ui(t.height,i.height)),t.neckSize=new w(ui(t.neckWidth,i.width),ui(t.neckHeight,i.height)),this.defaultLabelBound(t,t.dataLabel.visible,t.dataLabel.position,e),"30%"===t.explodeOffset&&(t.explodeOffset="25px"),e.explodeDistance=ui(t.explodeOffset,i.width),this.initializeSizeRatio(t.points,t)}initializeSizeRatio(e,t,i=!1){const s=t.sumOfPoints,o=Math.min(Math.max(t.gapRatio,0),1),l=1/(s*(1+o/(1-o))),a=o/(e.length-1);let r=0;for(let n=e.length-1;n>=0;n--){const t=i?e.length-1-n:n;if(e[t].visible){const i=l*e[t].y;e[t].yRatio=r,e[t].heightRatio=i,r+=i+a}}}setLabelLocation(e,t,i){const s=i.length-1,o="Funnel"===e.type?i.length-2:i.length-1,l=(i[0].x+i[o].x)/2;t.region=new C(l,i[0].y,(i[1].x+i[o-1].x)/2-l,i[o].y-i[0].y),t.symbolLocation={x:t.region.x+t.region.width/2,y:t.region.y+t.region.height/2},t.labelOffset={x:t.symbolLocation.x-(i[0].x+i[s].x)/2,y:t.symbolLocation.y-(i[0].y+i[s].y)/2}}findPath(e){let t="M";for(let i=0;i<e.length;i++)t+=e[i].x+" "+e[i].y,i!==e.length-1&&(t+=" L");return t}defaultLabelBound(e,t,i,s){const o=new C((s.initialClipRect.width-e.triangleSize.width)/2,(s.initialClipRect.height-e.triangleSize.height)/2,e.triangleSize.width,e.triangleSize.height);e.labelBound=new C(o.x,o.y,o.width+o.x,o.height+o.y),e.accumulationBound=o,t&&"Outside"===i&&(e.labelBound=new C(1/0,1/0,-1/0,-1/0))}}class po extends co{getSegmentData(e,t,i){let s,o,l,a,r,n,h,d;const c=t.triangleSize,p=(i.initialClipRect.width-t.triangleSize.width)/2+i.initialClipRect.x,u=i.initialClipRect.y+(i.initialClipRect.height-c.height)/2;let g=e.yRatio*c.height,m=g+e.heightRatio*c.height;const b=t.neckSize;s=b.width+(c.height-b.height-g)/(c.height-b.height)*(c.width-b.width),o=c.width/2-s/2,a=o+s,s=m>c.height-b.height||c.height===b.height?b.width:b.width+(c.height-b.height-m)/(c.height-b.height)*(c.width-b.width),l=c.width/2-s/2,r=l+s,g>=c.height-b.height?(o=l=n=c.width/2-b.width/2,a=r=h=c.width/2+b.width/2):m>c.height-b.height&&(n=l=c.width/2-s/2,h=r=n+s,d=c.height-b.height),g+=u,m+=u,d+=u;let f={x:p+0+r,y:m},y={x:p+0+l,y:m};d&&(f={x:p+0+h,y:d},y={x:p+0+n,y:d});const v=[{x:p+0+o,y:g},{x:p+0+a,y:g},f,{x:p+0+r,y:m},{x:p+0+l,y:m},y];return this.setLabelLocation(t,e,v),this.findPath(v)}renderPoint(e,t,i,s,o,l){if(!e.visible)return nt(s.id),null;const a=this.getSegmentData(e,t,i);e.midAngle=0,s.d=a,$t(!1,o,i.renderer.drawPath(s),l),e.isExplode&&i.accBaseModule.explodePoints(e.index,i,!0)}getModuleName(){return"FunnelSeries"}destroy(){}}class uo extends co{getSegmentData(e,t,i){const s=t.triangleSize,o=i.initialClipRect.y+(i.initialClipRect.height-s.height)/2,l=(i.initialClipRect.width-t.triangleSize.width)/2+i.initialClipRect.x;let a=e.yRatio,r=e.yRatio+e.heightRatio;const n=.5*(1-e.yRatio),h=.5*(1-r);a+=o/s.height,r+=o/s.height;const d=[{x:l+0+n*s.width,y:a*s.height},{x:l+0+(1-n)*s.width,y:a*s.height},{x:l+0+(1-h)*s.width,y:r*s.height},{x:l+0+h*s.width,y:r*s.height}];return this.setLabelLocation(t,e,d),this.findPath(d)}initializeSizeRatio(e,t){"Linear"===t.pyramidMode?super.initializeSizeRatio(e,t,!0):this.calculateSurfaceSegments(t)}calculateSurfaceSegments(e){const t=e.points.length,i=e.sumOfPoints,s=[],o=[],l=Math.min(0,Math.max(e.gapRatio,1))/(t-1),a=this.getSurfaceHeight(0,i);let r=0;for(let h=0;h<t;h++)e.points[h].visible&&(s[h]=r,o[h]=this.getSurfaceHeight(r,Math.abs(e.points[h].y)),r+=o[h]+l*a);const n=1/(r-l*a);for(let h=0;h<t;h++)e.points[h].visible&&(e.points[h].yRatio=n*s[h],e.points[h].heightRatio=n*o[h])}getSurfaceHeight(e,t){return this.solveQuadraticEquation(1,2*e,-t)}solveQuadraticEquation(e,t,i){let s,o;const l=t*t-4*e*i;if(l>=0){const i=Math.sqrt(l);return s=(-t-i)/(2*e),o=(-t+i)/(2*e),Math.max(s,o)}return 0}renderPoint(e,t,i,s,o,l){if(!e.visible)return D(s.id),null;s.d=this.getSegmentData(e,t,i),e.midAngle=0,$t(!1,o,i.renderer.drawPath(s),l),e.isExplode&&i.accBaseModule.explodePoints(e.index,i,!0)}getModuleName(){return"PyramidSeries"}destroy(){}}class go extends ts{constructor(e){super(e),this.library=this,this.titleRect=new C(0,e.margin.top,0,0)}getLegendOptions(e,t){this.legendCollections=[];for(let i=0;i<1;i++){let e=t[i].type;"Pie"!==e&&"Doughnut"!==e||(e="0"!==t[i].innerRadius&&"0%"!==t[i].innerRadius?"Doughnut":"Pie");for(const s of t[i].points)(0,a.le)(s.x)||(0,a.le)(s.y)||this.legendCollections.push(new is(s.x.toString(),s.color,t[i].legendShape,s.visible,e,s.legendImageUrl,null,null,s.index,t[i].index))}}getLegendBounds(e,t,i){this.calculateLegendTitle(i,t),this.isTitle=!!i.title;let s=0,o=0;const l=i.padding,a=i.titlePosition;let r=0;const n=this.arrowWidth,h=i.enablePages?0:this.arrowHeight;this.isVertical?s=i.width?0:e.width/100*5:o=i.height?0:e.height/100*5,t.width+=s,t.height+=o;const d=i.shapePadding;let c=0;const p=i.shapeWidth;let u=0,g=0;const m=[];let b,f=0,y=0,v=0;this.maxItemHeight=Math.max(S("MeasureText",i.textStyle).height,i.shapeHeight);let x=!1;for(const C of this.legendCollections)b={fill:C.fill,text:C.text,shape:C.shape,name:"legendRender",cancel:!1},this.chart.trigger("legendRender",b),C.render=!b.cancel,C.text=b.text.indexOf("&")>-1?this.convertHtmlEntities(b.text):b.text,C.fill=b.fill,C.shape=b.shape,C.textSize=S(C.text,i.textStyle),C.render&&""!==C.text&&(x=!0,y=p+d+C.textSize.width+l,this.isVertical?(++g,f=g*(this.maxItemHeight+l)+l+this.legendTitleSize.height+h,g*(this.maxItemHeight+l)+l+h>t.height&&(f=Math.max(f,g*(this.maxItemHeight+l)+l+h),u+=c,m.push(c),this.totalPages=Math.max(g,this.totalPages||1),c=0,g=1),c=Math.max(y,c)):(i.enablePages||(r=this.isTitle&&"Top"!==a?this.legendTitleSize.width+this.fivePixel:0,r+=n),u+=y,t.width<l+u+r&&(c=Math.max(c,u+l+r-y),0===g&&y!==u&&(g=1),u=y,g++,f=g*(this.maxItemHeight+l)+l+this.legendTitleSize.height)));v="Top"===a?this.legendTitleSize.height:0,this.isVertical?(u+=c,this.isPaging=t.width<u+l,f=Math.max(f,(this.totalPages||1)*(this.maxItemHeight+l)+l+h),this.isPaging=this.isPaging&&this.totalPages>1,m[m.length-1]!==c&&m.push(c)):(this.isPaging=t.height<f,f=!i.enablePages&&this.isPaging?this.maxItemHeight+l+l+v:f,this.totalPages=this.totalRowCount=g,f=Math.max(f,this.maxItemHeight+l+l+v),this.isPaging||(u+=this.isTitle&&"Top"!==a?this.fivePixel+this.legendTitleSize.width+this.fivePixel:0)),this.maxColumns=0;const w=this.isVertical?this.getMaxColumn(m,t.width,l,u+l):Math.max(u+l,c);x?this.setBounds(w,f,i,t):this.setBounds(0,0,i,t)}convertHtmlEntities(e){let t=e.replace("&amp;","&").replace("&lt;","<").replace("&gt;",">").replace("&quot;",'"').replace("&nbsp;"," ").replace("&cent;","\xa2").replace("&pound;","\xa3").replace("&yen;","\xa5").replace("&euro;","\u20ac").replace("&copy;","\xa9").replace("&reg;","\xae");return t=t.replace("&#38;","&").replace("&#60;","<").replace("&#62;",">").replace("&#34;",'"').replace("&#160;"," ").replace("&#162;","\xa2").replace("&#163;","\xa3").replace("&#165;","\xa5").replace("&#8364;","\u20ac").replace("&#169;","\xa9").replace("&#174;","\xae"),t}getMaxColumn(e,t,i,s){let o=i;this.maxColumnWidth=Math.max.apply(null,e);for(const l of e)if(o+=this.maxColumnWidth,this.maxColumns++,o+i>t){o-=this.maxColumnWidth,this.maxColumns--;break}return this.isPaging=o<s&&this.totalPages>1,o===i&&(o=t),this.maxColumns=Math.max(1,this.maxColumns),this.maxWidth=o,o}getAvailWidth(e,t){return this.isVertical&&(t=this.maxWidth),t-(2*this.legend.padding+this.legend.shapeWidth+this.legend.shapePadding)}getRenderPoint(e,t,i,s,o,l,a){const r=this.legend.padding;if(this.isVertical)l===a||s.location.y+1.5*this.maxItemHeight+2*r>o.y+o.height?(e.location.x=s.location.x+(l===a?0:this.maxColumnWidth),e.location.y=t.y,this.pageXCollections.push(e.location.x-this.legend.shapeWidth/2-r),this.totalPages++):(e.location.x=s.location.x,e.location.y=s.location.y+this.maxItemHeight+r);else{const n=s.location.x+i+s.textSize.width;n+(e.textSize.width+i)>o.x+o.width+this.legend.shapeWidth/2?(e.location.y=l===a?s.location.y:s.location.y+this.maxItemHeight+r,e.location.x=t.x):(e.location.y=s.location.y,e.location.x=l===a?s.location.x:n),this.totalPages=this.totalRowCount}const n=this.getAvailWidth(e.location.x,this.legendBounds.width);e.text=pi(+n.toFixed(4),e.text,this.legend.textStyle)}getSmartLegendLocation(e,t,i){let s;switch(this.position){case"Left":s=(e.x-t.width-i.left)/2,t.x=e.x-t.width<i.left?t.x:e.x-t.width-s;break;case"Right":s=(this.chart.availableSize.width-i.right-(e.x+e.width+t.width))/2,t.x=e.x+e.width+t.width>this.chart.availableSize.width-i.right?t.x:e.x+e.width+s;break;case"Top":this.getTitleRect(this.chart),s=(e.y-t.height-(this.titleRect.y+this.titleRect.height))/2,t.y=e.y-t.height<i.top?t.y:e.y-t.height-s;break;case"Bottom":s=(this.chart.availableSize.height-i.bottom-(e.y+e.height+t.height))/2,t.y=e.y+e.height+t.height>this.chart.availableSize.height-i.bottom?t.y:e.y+e.height+s}}getTitleRect(e){if(!e.title)return null;const t=S(e.title,e.titleStyle);this.titleRect=new C(e.availableSize.width/2-t.width/2,e.margin.top,t.width,t.height)}legendByIndex(e,t){for(const i of t)if(i.pointIndex===e)return i;return null}click(e){const t=e.target.id,i=this.chart,s=[this.legendID+"_text_",this.legendID+"_shape_",this.legendID+"_shape_marker_"];this.chart.accumulationSelectionModule&&(0,a.l7)([],this.chart.accumulationSelectionModule.selectedDataIndexes,null,!0),this.chart.animateSeries=!1;for(const o of s)if(t.indexOf(o)>-1){const e=parseInt(t.split(o)[1],10);if(this.chart.legendSettings.toggleVisibility&&!isNaN(e)){const t=this.chart.visibleSeries[0],s=oo(e,t.points),o=this.legendByIndex(e,this.legendCollections);s.visible=!s.visible,o.visible=s.visible,t.sumOfPoints+=s.visible?s.y:-s.y,i.redraw=i.enableAnimation,this.sliceVisibility(e,s.visible),i.removeSvg(),Ci(i),this.chart.refreshPoints(t.points),this.chart.renderElements()}else this.chart.accumulationSelectionModule&&!isNaN(e)&&this.chart.accumulationSelectionModule.legendSelection(this.chart,0,e)}t.indexOf(this.legendID+"_pageup")>-1?this.changePage(e,!0):t.indexOf(this.legendID+"_pagedown")>-1&&this.changePage(e,!1),i.redraw=!1}sliceVisibility(e,t){let i=this.chart.element.id+"_Series_0_Point_";this.chart.visibleSeries[0].dataLabel.visible&&(i=this.chart.element.id+"_datalabel_Series_0_",this.sliceAnimate(Yt(i+"g_"+e),t))}sliceAnimate(e,t){if(!e)return null;new a.fw({}).animate(e,{duration:300,delay:0,name:t?"FadeIn":"FadeOut",end:e=>{e.element.style.visibility=t?"visible":"hidden"}})}getModuleName(){return"AccumulationLegend"}destroy(){}}class mo extends lo{constructor(e){if(super(e),this.rightSideRenderingPoints=[],this.leftSideRenderingPoints=[],this.id=e.element.id+"_datalabel_Series_",e.title){const t=S(e.title,e.titleStyle);this.titleRect=new C(e.availableSize.width/2-t.width/2,e.margin.top,t.width,t.height)}}getDataLabelPosition(e,t,i,s){const o=this.isCircular()?this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],e):this.accumulation.pieSeriesModule.labelRadius:this.getLabelDistance(e,t);this.getLabelRegion(e,t.position,i,o,this.marginValue),e.labelAngle=e.midAngle,e.labelPosition=t.position,this.accumulation.enableSmartLabels&&this.getSmartLabel(e,t,i,s)}getLabelRegion(e,t,i,s,o,l=0){const a=l||e.midAngle,r=ft(a,s,this.isCircular()?this.center:this.getLabelLocation(e,t));r.y="Inside"===t?r.y-i.height/2:r.y,r.x="Inside"===t?r.x-i.width/2:r.x,e.labelRegion=new C(r.x,r.y,i.width+2*o,i.height+2*o),"Outside"===t&&(e.labelRegion.y-=e.labelRegion.height/2,a>=90&&a<=270?e.labelRegion.x-=e.labelRegion.width+10:e.labelRegion.x+=10)}getSmartLabel(e,t,i,s){const o=this.isCircular();let l=o?this.radius:this.getLabelDistance(e,t);l+=ui(o?t.connectorStyle.length||"4%":"0px",l);let a=this.findPreviousPoint(s,e.index,e.labelPosition);var r,n;if("Inside"===t.position?(e.labelRegion.height-=4,e.labelRegion.width-=4,(a&&a.labelRegion&&(li(e.labelRegion,a.labelRegion)||this.isOverlapping(e,s))||!o&&!((r=e.region).x<=(n=e.labelRegion).x&&r.x+r.width>=n.x+n.width&&r.y<=n.y&&r.height+r.y>=n.y+n.height))&&(e.labelPosition="Outside",o||(l=this.getLabelDistance(e,t)),this.getLabelRegion(e,e.labelPosition,i,l,this.marginValue),a=this.findPreviousPoint(s,e.index,e.labelPosition),a&&(li(e.labelRegion,a.labelRegion)||this.isConnectorLineOverlapping(e,a))&&this.setOuterSmartLabel(a,e,t.border.width,l,i,this.marginValue))):a&&a.labelRegion&&(li(e.labelRegion,a.labelRegion)||this.isOverlapping(e,s)||this.isConnectorLineOverlapping(e,a))&&this.setOuterSmartLabel(a,e,t.border.width,l,i,this.marginValue),this.isOverlapping(e,s)&&("Pyramid"===this.accumulation.type||"Funnel"===this.accumulation.type)){const l="OutsideLeft",r=10,n=e.midAngle||0,h=o?this.radius:this.getLabelDistance(e,t),d=ft(n,-h,this.isCircular()?this.center:this.getLabelLocation(e,l));e.labelRegion=new C(d.x,d.y,i.width+2*this.marginValue,i.height+2*this.marginValue),e.labelRegion.y-=e.labelRegion.height/2,e.labelRegion.x=e.labelRegion.x-r-e.labelRegion.width,a&&a.labelRegion&&(li(e.labelRegion,a.labelRegion)||this.isOverlapping(e,s)||this.isConnectorLineOverlapping(e,a))&&this.setOuterSmartLabel(a,e,t.border.width,h,i,this.marginValue)}}move(e,t,i,s){if(e.target.textContent.indexOf("...")>-1){const o=e.target.id.split(this.id);if(2===o.length){const e=parseInt(o[1].split("_text_")[0],10),l=parseInt(o[1].split("_text_")[1],10);if(!isNaN(e)&&!isNaN(l)){s&&nt(this.accumulation.element.id+"_EJ2_Datalabel_Tooltip");const o=function(e,t){for(let i of t)if(e===i.index)return i;return t[0]}(e,this.accumulation.visibleSeries).points[l];dt(o.text||o.y.toString(),t,i,this.areaRect.width,this.accumulation.element.id+"_EJ2_Datalabel_Tooltip",Yt(this.accumulation.element.id+"_Secondary_Element"))}}}else nt(this.accumulation.element.id+"_EJ2_Datalabel_Tooltip");s&&(clearTimeout(this.clearTooltip),this.clearTooltip=+setTimeout(()=>{nt(this.accumulation.element.id+"_EJ2_Datalabel_Tooltip")},1e3))}findPreviousPoint(e,t,i){let s=e[0];for(let o=t-1;o>=0;o--)if(s=e[o],s.visible&&s.labelVisible&&s.labelRegion&&s.labelPosition===i)return s;return null}isOverlapping(e,t){for(let i=e.index-1;i>=0;i--)if(t[i].visible&&t[i].labelVisible&&t[i].labelRegion&&e.labelRegion&&e.labelVisible&&li(e.labelRegion,t[i].labelRegion))return!0;return!1}textTrimming(e,t,i,s){if(li(e.labelRegion,t)){let o=e.labelRegion.width;"Right"===s?o=t.x-e.labelRegion.x:"Left"===s?(o=e.labelRegion.x-(t.x+t.width),o<0&&(o+=e.labelRegion.width,e.labelRegion.x=t.x+t.width)):"InsideRight"===s?o=t.x+t.width-e.labelRegion.x:"InsideLeft"===s?(o=e.labelRegion.x+e.labelRegion.width-t.x,o<e.labelRegion.width&&(e.labelRegion.x=t.x)):this.setPointVisibileFalse(e),e.labelVisible&&e.labelRegion&&(o<e.labelRegion.width&&(e.label=pi(o-2*this.marginValue,e.label,i),e.labelRegion.width=o),3===e.label.length&&e.label.indexOf("...")>-1&&this.setPointVisibileFalse(e))}}setPointVisibileFalse(e){e.labelVisible=!1,e.labelRegion=null}setPointVisibleTrue(e){e.labelVisible=!0}setOuterSmartLabel(e,t,i,s,o,l){if(this.isCircular()){let a=this.getOverlappedAngle(e.labelRegion,t.labelRegion,t.midAngle,2*i);for(this.getLabelRegion(t,"Outside",o,s,l,a),a>t.endAngle&&(a=t.midAngle),t.labelAngle=a;t.labelVisible&&(li(e.labelRegion,t.labelRegion)||a<=e.labelAngle||this.isConnectorLineOverlapping(t,e))&&!(a>t.endAngle);)t.labelAngle=a,this.getLabelRegion(t,"Outside",o,s,l,a),a+=.1}else this.setSmartLabelForSegments(t,e)}setSmartLabelForSegments(e,t){const i=e.labelRegion,s="Funnel"===this.accumulation.type?t.labelRegion.y-(i.y+i.height):e.labelRegion.y-(t.labelRegion.y+t.labelRegion.height);s<0&&(e.labelRegion.y+="Funnel"===this.accumulation.type?s:-s)}isConnectorLineOverlapping(e,t){let i;!this.isCircular()&&e.labelRegion.x<e.region.x&&(i="outsideLeft");const s=this.getLabelLocation(e,i),o=new Ri(0,0);this.getEdgeOfLabel(e.labelRegion,e.labelAngle,o,0,e);const l=this.getLabelLocation(t),a=new Ri(0,0);return this.getEdgeOfLabel(t.labelRegion,t.labelAngle,a,0,e),this.isLineRectangleIntersect(s,o,e.labelRegion)||this.isLineRectangleIntersect(s,o,t.labelRegion)||this.isLineRectangleIntersect(l,a,e.labelRegion)}isLineRectangleIntersect(e,t,i){const s=[new Ri(Math.round(i.x),Math.round(i.y)),new Ri(Math.round(i.x+i.width),Math.round(i.y)),new Ri(Math.round(i.x+i.width),Math.round(i.y+i.height)),new Ri(Math.round(i.x),Math.round(i.y+i.height))];e.x=Math.round(e.x),e.y=Math.round(e.y),t.x=Math.round(t.x),t.y=Math.round(t.y);for(let o=0;o<s.length;o++)if(this.isLinesIntersect(e,t,s[o],s[(o+1)%s.length]))return!0;return!1}isLinesIntersect(e,t,i,s){const o=t.y-e.y,l=e.x-t.x,a=o*e.x+l*e.y,r=s.y-i.y,n=i.x-s.x,h=r*i.x+n*i.y,d=o*n-r*l;if(0!==d){const c=(n*a-l*h)/d,p=(o*h-r*a)/d;let u=Math.min(e.x,t.x)<=c&&c<=Math.max(e.x,t.x);return u=u&&Math.min(e.y,t.y)<=p&&p<=Math.max(e.y,t.y),u=u&&Math.min(i.x,s.x)<=c&&c<=Math.max(i.x,s.x),u=u&&Math.min(i.y,s.y)<=p&&p<=Math.max(i.y,s.y),u}return!1}getOverlappedAngle(e,t,i,s){let o=e.x;return i>=90&&i<=270?(t.y=e.y-(s+t.height/2),o=e.x+e.width):t.y=e.y+e.height+s,function(e,t){let i=Math.atan2(t.y-e.y,t.x-e.x);return i=i<0?6.283+i:i,i*(180/Math.PI)}(this.center,new Ri(o,t.y))}getConnectorPath(e,t,i,s=0){const o=i.connectorStyle,l=this.isCircular()?this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],t):this.labelRadius:this.getLabelDistance(t,i),a=this.getConnectorStartPoint(t,o),r=this.accumulation.enableSmartLabels?t.midAngle:s||t.midAngle;let n=new Ri(0,0);const h=this.getEdgeOfLabel(e,r,n,o.width,t);if("Curve"===o.type){if(this.isCircular()){const e=l-(this.isVariousRadius()?ui(t.sliceRadius,this.accumulation.pieSeriesModule.seriesRadius):this.radius);return t.isLabelUpdated?n=this.getPerpendicularDistance(a,t):(n=ft(r,l-e/2,this.center),"Outside"===t.labelPosition&&"Inside"===i.position&&(n=ft(r,l-1.25*e,this.center))),"M "+a.x+" "+a.y+" Q "+n.x+" "+n.y+" "+h.x+" "+h.y}return this.getPolyLinePath(a,h)}return"M "+a.x+" "+a.y+" L "+n.x+" "+n.y+" L "+h.x+" "+h.y}getPolyLinePath(e,t){const i=[e,t];if(e.y===t.y)return"M "+e.x+" "+e.y+" L "+t.x+" "+t.y;let s="M";for(let o=0;o<=16;o++){const e=this.getBezierPoint(o/16,i,0,2);s+=e.x+","+e.y,16!==o&&(s+=" L")}return s}getBezierPoint(e,t,i,s){if(1===s)return t[i];const o=this.getBezierPoint(e,t,i,s-1),l=this.getBezierPoint(e,t,i+1,s-1);return{x:(1-e)*o.x+e*l.x,y:(1-e)*o.y+e*l.y}}getEdgeOfLabel(e,t,i,s=1,o){const l=new Ri(e.x,e.y);return t>=90&&t<=270?(l.x+=e.width+s/2,l.y+=e.height/2,i.x=l.x+10,i.y=l.y):o&&o.region&&o.region.x>o.labelRegion.x?(l.x+=2*s+e.width,l.y+=e.height/2,i.x=l.x+10,i.y=l.y):(l.x-=s/2,l.y+=e.height/2,i.x=l.x-10,i.y=l.y),l}getLabelDistance(e,t){if(e.labelPosition&&t.position!==e.labelPosition||t.connectorStyle.length){const e=ui(t.connectorStyle.length||"70px",this.accumulation.initialClipRect.width);if(e<this.accumulation.initialClipRect.width)return e}const i=(this.accumulation.initialClipRect.width-this.accumulation.visibleSeries[0].triangleSize.width)/2;let s;switch(e.labelPosition||t.position){case"Inside":return 0;case"Outside":return s=e.symbolLocation.x+e.labelOffset.x,this.accumulation.initialClipRect.width-s-i}}getLabelLocation(e,t="Outside"){if("Pie"!==this.accumulation.type){const i={x:e.symbolLocation.x,y:e.symbolLocation.y-e.labelOffset.y};switch(t="OutsideLeft"===t?"OutsideLeft":e.labelPosition||t){case"Inside":i.y=e.region.y+e.region.height/2;break;case"Outside":i.x+=e.labelOffset.x;break;case"OutsideLeft":i.x-=e.labelOffset.x}return i}return ft(e.midAngle,this.isVariousRadius()?ui(e.sliceRadius,this.accumulation.pieSeriesModule.seriesRadius):this.radius,this.center)}getConnectorStartPoint(e,t){let i;return!this.isCircular()&&e.region.x>e.labelRegion.x&&(i="OutsideLeft"),this.isCircular()?ft(e.midAngle,(this.isVariousRadius()?ui(e.sliceRadius,this.accumulation.pieSeriesModule.seriesRadius):this.radius)-t.width,this.center):this.getLabelLocation(e,i)}findAreaRect(){this.areaRect=new C(0,0,this.accumulation.availableSize.width,this.accumulation.availableSize.height);const e=this.accumulation.margin;bt(this.areaRect,new Ii(e.left,e.right,e.top,e.bottom))}renderDataLabel(e,t,i,s,o,l,r){const n=this.accumulation.element.id+"_datalabel_Series_"+o+"_",h=this.accumulation.renderer.createGroup({id:n+"g_"+e.index});e.label=e.originalText||e.y.toString();const d={width:t.border.width,color:t.border.color},c=(0,a.l7)({},(0,a.NA)("properties",t.font),null,!0),p={cancel:!1,name:de,series:this.accumulation.visibleSeries[0],point:e,text:e.label,border:d,color:t.fill,template:t.template,font:c};this.accumulation.trigger(de,p),e.argsData=p;const u=null!==p.template;e.labelVisible=!p.cancel,e.text=e.label=p.text,Number(e.label)&&(e.label=this.accumulation.intl.formatNumber(+e.label,{useGrouping:this.accumulation.useGroupingSeparator})),this.marginValue=p.border.width?5+p.border.width:1;const g=(0,a.az)("div",{id:this.accumulation.element.id+"_Series_0_DataLabel_"+e.index,styles:"position: absolute;background-color:"+p.color+";"+Qt(t.font)+";border:"+p.border.width+"px solid "+p.border.color+";"});this.calculateLabelSize(u,g,e,s,p,h,n,t,r)}calculateLabelSize(e,t,i,s,o,l,a,r,n,h,d){const c=e?d?{width:h.width,height:h.height}:this.getTemplateSize(t,i,o,n,e,s,l,a,r):S(i.label,r.font);c.height+=4,c.width+=4,i.textSize=c,i.templateElement=t,this.getDataLabelPosition(i,r,c,s),i.labelRegion&&this.correctLabelRegion(i.labelRegion,i.textSize)}drawDataLabels(e,t,i,s,o){let l,r;const n=e.leftSidePoints.concat(e.rightSidePoints);n.sort((e,t)=>e.index-t.index),"Pie"===e.type&&this.accumulation.enableSmartLabels&&this.extendedLabelsCalculation();for(const h of n)if(!(0,a.le)(h.argsData)&&!(0,a.le)(h.y)){this.finalizeDatalabels(h,n,t);const e=this.accumulation.element.id+"_datalabel_Series_0_",d=this.accumulation.renderer.createGroup({id:e+"g_"+h.index});let c,p,u;if(h.visible&&h.labelVisible){if(l=r=t.angle,h.argsData.template)this.setTemplateStyle(h.templateElement,h,s,t.font.color,h.color,o);else{p=new Ri(h.labelRegion.x+this.marginValue,h.labelRegion.y+3*h.textSize.height/4+this.marginValue),u=Yt(e+"shape_"+h.index);const i=u?new Ri(+u.getAttribute("x"),+u.getAttribute("y")):null;c=this.accumulation.renderer.drawRectangle(new Ti(e+"shape_"+h.index,h.argsData.color,h.argsData.border,1,h.labelRegion,t.rx,t.ry)),$t(!1,d,c,o,!0,"x","y",i,null,!1,!1,null,this.accumulation.duration);const s=h.textSize.width,a=h.textSize.height;let n;0!==l&&t.enableRotation?(r="Outside"===h.labelPosition?0:h.midAngle>=90&&h.midAngle<=270?h.midAngle+180:h.midAngle,n="rotate("+r+","+(p.x+s/2)+","+(p.y-a/4)+")"):(r=l?l>360?l-360:l<-360?l+360:l:0,n="rotate("+r+","+(p.x+s/2)+","+p.y+")"),h.transform=n,bi(this.accumulation.renderer,new L(e+"text_"+h.index,p.x,p.y,"start",h.label,n,"auto",r),h.argsData.font,h.argsData.font.color||this.getSaturatedColor(h,h.argsData.color),d,!1,o,!0,!1,this.accumulation.duration),u=null}if(this.accumulation.accumulationLegendModule&&("Outside"===t.position||this.accumulation.enableSmartLabels)&&this.accumulation.visibleSeries[0].findMaxBounds(this.accumulation.visibleSeries[0].labelBound,h.labelRegion),"Outside"===h.labelPosition){const i=Yt(e+"connector_"+h.index),s=i?i.getAttribute("d"):"";$t(!1,d,this.accumulation.renderer.drawPath(new I(e+"connector_"+h.index,"transparent",t.connectorStyle.width,t.connectorStyle.color||h.color,1,t.connectorStyle.dashArray,this.getConnectorPath((0,a.l7)({},h.labelRegion,null,!0),h,t,h.labelAngle))),o,!0,null,null,null,s,!1,!1,null,this.accumulation.duration)}$t(!1,i,d,o)}}}finalizeDatalabels(e,t,i){if((this.isOverlapping(e,t)||this.titleRect&&e.labelRegion&&li(e.labelRegion,this.titleRect))&&this.isCircular()&&"Outside"===e.labelPosition&&this.setPointVisibileFalse(e),this.accumulation.accumulationLegendModule&&e.labelVisible&&e.labelRegion){const t=this.accumulation.accumulationLegendModule.legendBounds,s=this.accumulation.legendSettings.border.width/2;this.textTrimming(e,new C(t.x-s,t.y-s,t.width+2*s,t.height+2*s),i.font,this.accumulation.accumulationLegendModule.position)}if(e.labelVisible&&e.labelRegion){const t=this.isCircular()?e.labelRegion.x>=this.center.x?"InsideRight":"InsideLeft":e.labelRegion.x>=e.region.x?"InsideRight":"InsideLeft";this.textTrimming(e,this.areaRect,i.font,t)}e.labelVisible&&e.labelRegion&&(e.labelRegion.y+e.labelRegion.height>this.areaRect.y+this.areaRect.height||e.labelRegion.y<this.areaRect.y||e.labelRegion.x<this.areaRect.x||e.labelRegion.x+e.labelRegion.width>this.areaRect.x+this.areaRect.width)&&this.setPointVisibileFalse(e)}getTemplateSize(e,t,i,s,o,l,a,r,n){const h=Jt(e=Xt(e,t.index,i.template,this.accumulation,t,this.accumulation.visibleSeries[0],this.accumulation.element.id+"_DataLabel",0,i,o,l,a,r,n,s),s);return{width:h.width,height:h.height}}setTemplateStyle(e,t,i,s,o,l){if(e.style.left=t.labelRegion.x+"px",e.style.top=t.labelRegion.y+"px",e.style.color=s||this.getSaturatedColor(t,o),this.accumulation.isBlazor){const i=this.isCircular()?t.labelRegion.x>=this.center.x?"InsideRight":"InsideLeft":t.labelRegion.x>=t.region.x?"InsideRight":"InsideLeft";e.style.transform="InsideRight"===i?"translate(0%, -50%)":"translate(-100%, -50%)"}e.childElementCount&&($t(!1,i,e,l,!0,"left","top"),this.doTemplateAnimation(this.accumulation,e))}getSaturatedColor(e,t){let i;i=this.marginValue>=1?"transparent"===t?this.getLabelBackground(e):t:this.getLabelBackground(e),i="transparent"===i?window.getComputedStyle(document.body,null).backgroundColor:i;const s=hi(di(i));return Math.round((299*s.r+587*s.g+114*s.b)/1e3)>=128?"black":"white"}doTemplateAnimation(e,t){const i=e.visibleSeries[0],s=i.animation.delay+i.animation.duration;i.animation.enable&&e.animateSeries&&(t.style.visibility="hidden",Ht(t,s,200,"ZoomIn"))}getLabelBackground(e){return"Outside"===e.labelPosition?this.accumulation.background||this.accumulation.themeStyle.background:e.color}correctLabelRegion(e,t,i=4){e.height-=i,e.width-=i,e.x+=i/2,e.y+=i/2,t.height-=i,t.width-=i}getModuleName(){return"AccumulationDataLabel"}destroy(){}extendedLabelsCalculation(){const e=this.accumulation.series[0];e.rightSidePoints.forEach((e,t,i)=>{e.initialLabelRegion=e.labelRegion,e.isLabelUpdated=0,this.skipPoints(e,i,t)}),e.leftSidePoints.forEach((e,t,i)=>{e.initialLabelRegion=e.labelRegion,e.isLabelUpdated=0,this.skipPoints(e,i,t)}),this.arrangeLeftSidePoints(e),this.isIncreaseAngle=!1,this.arrangeRightSidePoints(e)}arrangeRightSidePoints(e){let t,i;const s=e.rightSidePoints.filter(e=>e.labelVisible&&"Outside"===e.labelPosition);let o,l;this.rightSideRenderingPoints=s;const a=s[s.length-1];let r;a&&a.labelAngle>90&&a.labelAngle<270&&(this.isIncreaseAngle=!0,this.changeLabelAngle(a,89));for(let n=s.length-1;n>=0;n--)if(l=s[n],r=s[n+1],this.isOverlapWithNext(l,s,n)&&l.labelVisible||!(l.labelAngle<=90||l.labelAngle>=270))if(o=a.labelAngle+10,i=!0,t?this.isIncreaseAngle=!1:o>90&&o<270&&r.isLabelUpdated&&(this.isIncreaseAngle=!0),this.isIncreaseAngle)for(let t=n+1;t>0;t--)this.decreaseAngle(s[t],s[t-1],e,!0);else for(let t=n+1;t<s.length;t++)this.increaseAngle(s[t-1],s[t],e,!0);else i&&r&&!r.isLabelUpdated&&(t=!0)}arrangeLeftSidePoints(e){const t=e.leftSidePoints.filter(e=>e.labelVisible&&"Outside"===e.labelPosition);let i,s,o,l;this.leftSideRenderingPoints=t;for(let a=0;a<t.length;a++)if(s=t[a],i=t[a-1],this.isOverlapWithPrevious(s,t,a)&&s.labelVisible||!(s.labelAngle<270))if(o=!0,l&&(this.isIncreaseAngle=!1),this.isIncreaseAngle)for(let i=a;i<t.length;i++)this.increaseAngle(t[i-1],t[i],e,!1);else for(let i=a;i>0;i--)this.decreaseAngle(t[i],t[i-1],e,!1),t.filter((e,i)=>{e.isLabelUpdated&&t[i].labelAngle-10<100&&(this.isIncreaseAngle=!0)});else o&&i&&i.isLabelUpdated&&(l=!0)}decreaseAngle(e,t,i,s){if((0,a.le)(e)||(0,a.le)(t))return null;let o=1;if(s)for(;li(e.labelRegion,t.labelRegion)||!this.isVariousRadius()&&!(t.labelRegion.height+t.labelRegion.y<e.labelRegion.y);){let e=t.midAngle-o;if(e<0&&(e=360+e),e<=270&&e>=90){e=270,this.isIncreaseAngle=!0;break}this.changeLabelAngle(t,e),o++}else for(e.labelAngle>270&&(this.changeLabelAngle(e,270),t.labelAngle=270);li(e.labelRegion,t.labelRegion)||!this.isVariousRadius()&&e.labelRegion.y+e.labelRegion.height>t.labelRegion.y;){let s=t.midAngle-o;if(!(s<=270&&s>=90)){s=90,this.isIncreaseAngle=!0;break}if(this.changeLabelAngle(t,s),li(e.labelRegion,t.labelRegion)&&!i.leftSidePoints.indexOf(t)&&s-1<90&&s-1>270){this.changeLabelAngle(e,e.labelAngle+1),this.arrangeLeftSidePoints(i);break}o++}}increaseAngle(e,t,i,s){if((0,a.le)(e)||(0,a.le)(t))return null;let o=1;if(s)for(;li(e.labelRegion,t.labelRegion)||!this.isVariousRadius()&&!(e.labelRegion.y+e.labelRegion.height<t.labelRegion.y);){let s=t.midAngle+o;if(s<270&&s>90){s=90,this.isIncreaseAngle=!0;break}if(this.changeLabelAngle(t,s),li(e.labelRegion,t.labelRegion)&&s+1>90&&s+1<270&&this.rightSideRenderingPoints.indexOf(t)===this.rightSideRenderingPoints.length-1){this.changeLabelAngle(e,e.labelAngle-1),t.labelRegion=t.initialLabelRegion,this.arrangeRightSidePoints(i);break}o++}else for(;li(e.labelRegion,t.labelRegion)||!this.isVariousRadius()&&e.labelRegion.y<t.labelRegion.y+t.labelRegion.height;){let e=t.midAngle+o;if(!(e<270&&e>90)){e=270,this.isIncreaseAngle=!1;break}this.changeLabelAngle(t,e),o++}}changeLabelAngle(e,t){const i=this.accumulation.series[0].dataLabel;let s;this.isVariousRadius()&&(s=this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],e));const o="Outside"===e.labelPosition&&this.accumulation.enableSmartLabels&&"Inside"===i.position?this.radius+ui(i.connectorStyle.length||"4%",this.accumulation.pieSeriesModule.size/2):this.isVariousRadius()?s:this.accumulation.pieSeriesModule.labelRadius+10,l=this.isVariousRadius()?s:o;this.getLabelRegion(e,"Outside",e.textSize,l,this.marginValue,t),e.isLabelUpdated=1,e.labelAngle=t}isOverlapWithPrevious(e,t,i){for(let s=0;s<i;s++)if(s!==t.indexOf(e)&&t[s].visible&&t[s].labelVisible&&t[s].labelRegion&&e.labelRegion&&e.labelVisible&&li(e.labelRegion,t[s].labelRegion))return!0;return!1}isOverlapWithNext(e,t,i){for(let s=i;s<t.length;s++)if(s!==t.indexOf(e)&&t[s].visible&&t[s].labelVisible&&t[s].labelRegion&&e.labelRegion&&e.labelVisible&&li(e.labelRegion,t[s].labelRegion))return!0;return!1}skipPoints(e,t,i){if(i>0&&(e.midAngle<285&&e.midAngle>255||e.midAngle<105&&e.midAngle>75)){const s=t[i-1],o=e.endAngle%360-e.startAngle%360;s.endAngle%360-s.startAngle%360<=o&&o<5&&s.labelVisible&&this.setPointVisibleTrue(e)}else if(i>1&&(e.midAngle<300&&e.midAngle>240||e.midAngle<120&&e.midAngle>60)){const s=t[i-1],o=t[i-2],l=s.endAngle%360-s.startAngle%360,a=o.endAngle%360-o.startAngle%360;e.endAngle%360-e.startAngle%360<3&&l<3&&a<3&&s.labelVisible&&e.labelVisible&&this.setPointVisibleTrue(e)}}getPerpendicularDistance(e,t){let i;const s=10+10*Math.sin(t.midAngle*Math.PI/360);return i=t.midAngle>270&&t.midAngle<360?new Ri(e.x+s*Math.cos((360-t.midAngle)*Math.PI/180),e.y-s*Math.sin((360-t.midAngle)*Math.PI/180)):t.midAngle>0&&t.midAngle<90?new Ri(e.x+s*Math.cos(t.midAngle*Math.PI/180),e.y+s*Math.sin(t.midAngle*Math.PI/180)):t.midAngle>0&&t.midAngle<90?new Ri(e.x-s*Math.cos((t.midAngle-90)*Math.PI/180),e.y+s*Math.sin((t.midAngle-90)*Math.PI/180)):new Ri(e.x-s*Math.cos((t.midAngle-180)*Math.PI/180),e.y-s*Math.sin((t.midAngle-180)*Math.PI/180)),i}}class bo extends _s{constructor(e){super(e),this.accumulation=e,this.addEventListener()}addEventListener(){this.accumulation.isDestroyed||(this.accumulation.on(a.AR.isPointer?"pointerleave":"mouseleave",this.mouseLeaveHandler,this),this.accumulation.on(a.AR.touchMoveEvent,this.mouseMoveHandler,this),this.accumulation.on(a.AR.touchEndEvent,this.mouseUpHandler,this))}mouseLeaveHandler(e){this.removeTooltip(this.accumulation.tooltip.fadeOutDuration)}mouseUpHandler(e){let t=this.accumulation;t.tooltip.enable&&t.isTouch&&Dt(t.mouseX,t.mouseY,t.initialClipRect)&&(this.tooltip(e),this.removeTooltip(2e3))}mouseMoveHandler(e){let t=this.accumulation;t.tooltip.enable&&Dt(t.mouseX,t.mouseY,t.initialClipRect)&&this.tooltip(e)}tooltip(e){let t=this.getElement(this.element.id+"_tooltip_svg"),i=t&&parseInt(t.getAttribute("opacity"),10)>0,s=this.getTooltipElement(i);this.renderSeriesTooltip(e,this.accumulation,!i,s)}renderSeriesTooltip(e,t,i,s){let o=this.getPieData(e,t,t.mouseX,t.mouseY);if(this.currentPoints=[],!o.point||this.previousPoints[0]&&this.previousPoints[0].point===o.point)!o.point&&this.isRemove&&(this.removeTooltip(this.accumulation.tooltip.fadeOutDuration),this.isRemove=!1);else{if(this.previousPoints[0]&&o.point.index===this.previousPoints[0].point.index&&o.series.index===this.previousPoints[0].series.index)return null;this.pushData(o,i,s,!1)&&this.triggerTooltipRender(o,i,this.getTooltipText(o,t.tooltip),this.findHeader(o))}}triggerTooltipRender(e,t,i,s,o=!0){let l={cancel:!1,name:fe,text:i,point:e.point,textStyle:this.textStyle,series:this.accumulation.isBlazor?{}:e.series,headerText:s,data:{pointX:e.point.x,pointY:e.point.y,seriesIndex:e.series.index,pointIndex:e.point.index,pointText:e.point.text,seriesName:e.series.name}},r=i=>{i.cancel?(this.removeHighlight(),(0,a.Od)(this.getElement(this.element.id+"_tooltip"))):(this.formattedText=this.formattedText.concat(i.text),this.text=this.formattedText,this.headerText=i.headerText,this.createTooltip(this.chart,t,e.point.symbolLocation,e.series.clipRect,e.point,["Circle"],0,this.chart.initialClipRect,null,e.point,this.accumulation.tooltip.template?i.template:"")),this.isRemove=!0};r.bind(this,e),this.chart.trigger(fe,l,r)}getPieData(e,t,i,s){let o=Mt(e.target.id,!0);if(!isNaN(o.series)){let e=o.series,i=o.point;if(!((0,a.le)(e)||isNaN(e)||(0,a.le)(i)||isNaN(i))){let s=this.getSeriesFromIndex(e,t.visibleSeries);if(s.enableTooltip)return new Ei(s.points[i],s)}}return new Ei(null,null)}getSeriesFromIndex(e,t){return t[0]}getTooltipText(e,t){let i=this.accumulation.useGroupingSeparator?"${point.x} : <b>${point.separatorY}</b>":"${point.x} : <b>${point.y}</b>";return i=t.format?t.format:i,this.parseTemplate(e.point,e.series,i)}findHeader(e){return""===this.header?"":(this.header=this.parseTemplate(e.point,e.series,this.header),""!==this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()?this.header:"")}parseTemplate(e,t,i){let s,o;for(let l of Object.keys(e))s=new RegExp("${point."+l+"}","gm"),i=i.replace(s.source,e[l]);for(let l of Object.keys(Object.getPrototypeOf(t)))s=new RegExp("${series."+l+"}","gm"),o=t[l],i=i.replace(s.source,o);return i}getModuleName(){return"AccumulationTooltip"}destroy(e){}}function fo(e,t,i,s){return(e=function(e,t,i){const s=(e-t.min)/t.delta;return i?1-s:s}(e,t,s))*i}function yo(e,t,i,s){return(s?1-e/t:e/t)*i.delta+i.min}function vo(e,t,i){const s=[];return e.map(e=>{e.xValue>=t&&e.xValue<=i&&s.push({x:e.x,y:e.y})}),s}function So(e,t){return e.reduce((e,i)=>Math.abs(i-t)<Math.abs(e-t)?i:e)}class xo{constructor(e,t,i,s,o=!0){this.x=e,this.y=t,this.xValue=i,this.visible=o}}class wo extends cs{constructor(e){super(),this.dataSource=e.dataSource,this.xName=e.xName,this.yName=e.yName,this.query=e.query,this.xMin=1/0,this.xMax=-1/0,this.yMin=1/0,this.yMax=-1/0}renderChart(e){let t,i;this.seriesLength=0,e.rangeSlider.points=[],e.series.length?e.series.map(s=>{t=s.dataSource||e.dataSource,i=s.query||e.query,s.points=[],this.processDataSource(t,i,e,s)}):this.processDataSource(e.dataSource,e.query,e)}processDataSource(e,t,i,s){e instanceof r.hm||(0,a.le)(e)||!(0,a.le)(t)?(i.dataModule=new Xi(e,t),i.dataModule.getData(i.dataModule.generateQuery().requiresCount()).then(e=>this.dataManagerSuccess(e,i,s))):this.dataManagerSuccess({result:e,count:e.length},i,s)}dataManagerSuccess(e,t,i){const s=e.count?e.result:[];t.allowServerDataBinding=!1,this.processJsonData(s,t,Object.keys(s).length,i),this.seriesLength+=i?1:this.seriesLength,i&&this.seriesLength!==t.series.length||(this.processXAxis(t),this.calculateGroupingBounds(t),this.processYAxis(t),t.renderChart())}processJsonData(e,t,i,s){let o,l=0;const n=s&&s.xName||t.xName,h=s&&s.yName||t.yName;for(;l<i;){if(o=new xo((0,a.NA)(n,e[l]),(0,a.NA)(h,e[l])),o.yValue=t.isBlazor&&(0,a.le)(o.y)?0:+o.y,"DateTime"===t.valueType){const e=t.intl.getDateParser({skeleton:"full",type:"dateTime"}),i=t.intl.getDateFormat({skeleton:"full",type:"dateTime"});o.x=new Date(r.j4.parse.parseJson({val:o.x}).val),o.xValue=t.isBlazor?Date.parse(o.x.toString()):Date.parse(e(i(o.x)))}else o.xValue=t.isBlazor&&(0,a.le)(o.x)?0:+o.x;s&&s.points.push(o),this.xMin=Math.min(this.xMin,o.xValue),this.yMin=Math.min(this.yMin,o.yValue),this.xMax=Math.max(this.xMax,o.xValue),this.yMax=Math.max(this.yMax,o.yValue),t.rangeSlider.points.push(o),l++}}processXAxis(e){this.xAxis={minimum:e.minimum,maximum:e.maximum,interval:e.interval,valueType:e.valueType,isInversed:e.enableRtl,labelFormat:e.labelFormat,logBase:e.logBase,skeleton:e.skeleton,skeletonType:e.skeletonType},this.xAxis.intervalType=e.intervalType,this.xAxis.maximumLabels=3,this.xAxis.skeleton=e.skeleton,this.xAxis.intervalDivs=[10,5,2,1],this.xAxis.rect=e.bounds,this.xAxis.visibleLabels=[],this.xAxis.orientation="Horizontal";const t=e[kt(e.valueType)+"Module"];t.min=this.xMin,t.max=this.xMax,t.getActualRange(this.xAxis,e.bounds),"Double"!==this.xAxis.valueType&&"DateTime"!==this.xAxis.valueType||t.updateActualRange(this.xAxis,this.xAxis.actualRange.min,this.xAxis.actualRange.max,this.xAxis.actualRange.interval),this.xAxis.actualRange.delta=this.xAxis.actualRange.max-this.xAxis.actualRange.min,this.xAxis.visibleRange=this.xAxis.actualRange,t.calculateVisibleLabels(this.xAxis,e)}processYAxis(e){this.yAxis={majorGridLines:{width:0},rangePadding:"None",majorTickLines:{width:0},labelStyle:{size:"0"},visible:!1,valueType:"Double",minimum:null,maximum:null,interval:null},this.yAxis.rect=e.bounds,this.yAxis.maximumLabels=3,this.yAxis.intervalDivs=[10,5,2,1],this.yAxis.orientation="Vertical",e.doubleModule.min=this.yMin,e.doubleModule.max=this.yMax,e.doubleModule.getActualRange(this.yAxis,e.bounds),e.doubleModule.updateActualRange(this.yAxis,this.yAxis.actualRange.min,this.yAxis.actualRange.max,this.yAxis.actualRange.interval),this.yAxis.actualRange.delta=this.yAxis.actualRange.max-this.yAxis.actualRange.min,this.yAxis.visibleRange=this.yAxis.actualRange}renderSeries(e){this.chartGroup=e.renderer.createGroup({id:e.element.id+"_chart"});const t=Z(e.theme);e.series.map((i,s)=>{(!e.stockChart||e.stockChart.series[s].visible)&&(i.xAxis=this.xAxis,i.yAxis=this.yAxis,i.chart=e,i.index=s,i.xAxis.isInversed=e.enableRtl,i.interior=i.fill||t[s%t.length],this.createSeriesElement(e,i,s),e[kt(i.type)+"SeriesModule"]?e[kt(i.type)+"SeriesModule"].render(i,this.xAxis,this.yAxis,!1):e.lineSeriesModule.render(i,this.xAxis,this.yAxis,!1),this.chartGroup.appendChild(i.seriesElement),i.animation.enable&&e.animateSeries&&e[kt(i.type)+"SeriesModule"]&&e[kt(i.type)+"SeriesModule"].doAnimation(i))})}appendSeriesElements(e){e.svgObject.appendChild(this.chartGroup),e.series.length&&this.drawSeriesBorder(e)}createSeriesElement(e,t,i){const s=e.element.id;t.clipRect=new C(this.xAxis.rect.x,this.yAxis.rect.y,this.xAxis.rect.width,this.yAxis.rect.height),t.clipRectElement=e.renderer.drawClipPath(new Ti(s+"_RangeSeriesClipRect_"+i,"transparent",{width:1,color:"Gray"},1,{x:0,y:0,width:t.clipRect.width,height:t.clipRect.height})),t.seriesElement=e.renderer.createGroup({id:s+"SeriesGroup"+i,transform:"translate("+t.clipRect.x+","+t.clipRect.y+")","clip-path":"url(#"+s+"_RangeSeriesClipRect_"+i+")"}),t.seriesElement.appendChild(t.clipRectElement)}calculateGroupingBounds(e){const t=e.margin.bottom,i=S("string",e.labelStyle).height;this.calculateDateTimeNiceInterval(this.xAxis,new w(e.bounds.width,e.bounds.height),this.xMin,this.xMax,!1),!e.enableGrouping||"DateTime"!==e.valueType||"Years"===this.xAxis.actualIntervalType&&e.series.length||(e.bounds.height-="Outside"===e.labelPosition||0===e.series.length?t+i:i+2*t),e.series.length||(e.bounds.y+=e.bounds.height/4,e.bounds.height=e.bounds.height/2)}drawSeriesBorder(e){const t=new I(e.element.id+"_SeriesBorder","transparent",e.navigatorBorder.width,e.navigatorBorder.color,1,"","M "+e.bounds.x+" "+e.bounds.y+" L "+(e.bounds.x+e.bounds.width)+" "+e.bounds.y+(e.stockChart?"M":"L")+(e.bounds.x+e.bounds.width)+" "+(e.bounds.y+e.bounds.height)+" L "+e.bounds.x+" "+(e.bounds.y+e.bounds.height)+(e.stockChart?"":"Z")),i=e.renderer.drawPath(t);e.svgObject.appendChild(i)}}class Co extends ps{constructor(e){super(),this.firstLevelLabels=[],this.secondLevelLabels=[],this.rangeNavigator=e}renderGridLines(){let e=0;const t=this.rangeNavigator,i=t.majorGridLines,s=t.majorTickLines;let o="",l="";const a=t.bounds,r=t.chartSeries.xAxis,n=t.disableRangeSelector?"transparent":null;this.gridLines=t.renderer.createGroup({id:t.element.id+"_GridLines"});const h="Outside"===t.tickPosition||0===t.series.length?a.y+a.height+s.height:a.y+a.height-s.height;this.firstLevelLabels=[],r.labelStyle=t.labelStyle,r.skeleton=t.skeleton,r.skeletonType=t.skeletonType,r.isChart=!1,"DateTime"===t.valueType&&(this.calculateDateTimeNiceInterval(r,a,r.doubleRange.start,r.doubleRange.end,r.isChart),this.actualIntervalType=r.actualIntervalType,this.findAxisLabels(r)),this.firstLevelLabels=r.visibleLabels,this.lowerValues=[];const d=r.visibleLabels.length;for(let p=0;p<d;p++)this.lowerValues.push(this.firstLevelLabels[p].value),e=wt(this.firstLevelLabels[p].value,r)*a.width+a.x,e>=a.x&&a.x+a.width>=e&&(o=o.concat("M "+e+" "+(t.bounds.y+t.bounds.height)+" L "+e+" "+t.bounds.y+" "),l=l.concat("M "+e+" "+(a.y+a.height)+" L "+e+" "+h+" "));let c=new I(t.element.id+"_MajorGridLine","transparent",i.width,t.series.length?n||i.color||t.themeStyle.gridLineColor:"transparent",1,i.dashArray,o);this.gridLines.appendChild(t.renderer.drawPath(c)),c=new I(t.element.id+"_MajorTickLine","transparent",s.width,n||s.color||t.themeStyle.gridLineColor,1,i.dashArray,l),this.gridLines.appendChild(t.renderer.drawPath(c))}renderAxisLabels(){const e=this.rangeNavigator.chartSeries.xAxis,t=this.rangeNavigator;let i;const s=t.renderer.createGroup({id:t.element.id+"_AxisLabels"}),o=t.renderer.createGroup({id:t.element.id+"_FirstLevelAxisLabels"}),l=t.renderer.createGroup({id:t.element.id+"_SecondLevelAxisLabels"}),a=e;if(i=this.findLabelY(t,!1),this.placeAxisLabels(e,i,"_AxisLabel_",t,o),a.intervalType=a.actualIntervalType=t.groupBy||this.getSecondaryLabelType(e.actualIntervalType),a.labelFormat="",t.enableGrouping&&"DateTime"===t.valueType&&"Years"!==this.actualIntervalType){a.visibleRange.interval=1,a.visibleLabels=[],this.findAxisLabels(a),this.secondLevelLabels=a.visibleLabels,i=this.findLabelY(t,!0);const e=this.placeAxisLabels(a,i,"_SecondaryLabel_",t,l),s=new I(t.element.id+"_SecondaryMajorLines","transparent",t.majorTickLines.width,t.majorTickLines.color||t.themeStyle.gridLineColor,1,t.majorGridLines.dashArray,e);this.gridLines.appendChild(t.renderer.drawPath(s))}t.chartSeries.xAxis.visibleLabels=t.chartSeries.xAxis.visibleLabels.concat(a.visibleLabels),s.appendChild(o),s.appendChild(l),t.svgObject.appendChild(this.gridLines),t.svgObject.appendChild(s)}getSecondaryLabelType(e){const t=["Years","Quarter","Months","Weeks","Days","Hours","Minutes","Seconds"];return"Years"===e?"Years":t[t.indexOf(e)-1]}findAxisLabels(e){e.visibleLabels=[];let t,i,s=new Date(e.visibleRange.min);const o=this.rangeNavigator.interval?this.rangeNavigator.interval:1;switch(e.actualIntervalType){case"Years":s=new Date(s.getFullYear(),0,1);break;case"Quarter":s=s.getMonth()<=2?new Date(s.getFullYear(),0,1):s.getMonth()<=5?new Date(s.getFullYear(),3,1):s.getMonth()<=8?new Date(s.getFullYear(),6,1):new Date(s.getFullYear(),9,1);break;case"Months":s=new Date(s.getFullYear(),s.getMonth());break;case"Weeks":s=new Date(s.getFullYear(),s.getMonth(),s.getDate()-s.getDay());break;case"Days":s=new Date(s.getFullYear(),s.getMonth(),s.getDate());break;case"Hours":s=new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours());break;case"Minutes":s=new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes());break;case"Seconds":s=new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds())}for(t=s.getTime(),this.rangeNavigator.format=this.rangeNavigator.intl.getDateFormat({format:e.labelFormat||this.blazorFormat(e),type:kt(e.skeletonType),skeleton:this.getSkeleton(e,null,null,this.rangeNavigator.isBlazor)});t<=e.visibleRange.max;)i=this.dateFormats(this.rangeNavigator.format(new Date(t)),e,e.visibleLabels.length),e.visibleLabels.push(new lt(i,t,this.rangeNavigator.labelStyle,i)),t=this.increaseDateTimeInterval(e,t,o).getTime()}blazorFormat(e){return this.rangeNavigator.isBlazor&&"Years"===e.actualIntervalType?"yyyy":""}dateFormats(e,t,i){let s=e;const o=this.rangeNavigator.isBlazor,l=this.rangeNavigator.enableGrouping&&0===this.firstLevelLabels.length;switch(t.actualIntervalType){case"Quarter":e.indexOf("Jan")>-1?s=l?"Quarter1":e.replace(o?"January":"Jan","Quarter1"):e.indexOf("Apr")>-1?s=l?"Quarter2":e.replace(o?"April":"Apr","Quarter2"):e.indexOf("Jul")>-1?s=l?"Quarter3":e.replace(o?"July":"Jul","Quarter3"):e.indexOf("Oct")>-1&&(s=l?"Quarter4":e.replace(o?"October":"Oct","Quarter4"));break;case"Weeks":s="Week"+ ++i;break;default:s=e}return s}findLabelY(e,t){let i;const s=e.bounds.y+e.bounds.height,o=e.majorTickLines.height,l=S("Quarter1 2011",e.labelStyle).height;let a=8;return i="Outside"===e.labelPosition&&"Outside"===e.tickPosition||0===e.series.length?s+o+a+.75*l:"Inside"===e.labelPosition&&"Inside"===e.tickPosition?s-o-a:"Inside"===e.labelPosition&&"Outside"===e.tickPosition?s-a:s+a+.75*l,t&&(a=15,"Outside"===e.labelPosition||0===e.series.length?i+=a+.75*l:i="Outside"===e.tickPosition||0===e.series.length?s+o+a+.75*l:s+a+.75*l),i}placeAxisLabels(e,t,i,s,o){const l=e.visibleLabels.length;let a,r,n;const h=s.bounds;let d,c="";const p=s.disableRangeSelector?"transparent":null;let u=s.enableRtl?h.x+h.width:h.x;const g=e.actualIntervalType,m="DateTime"===s.valueType?l>1?e.visibleLabels[1].value-e.visibleLabels[0].value:(e.visibleRange.max-e.visibleLabels[0].value)/2:0;"DateTime"!==s.valueType||"Quarter"!==g&&"Weeks"!==g||this.findSuitableFormat(e,s);for(let b=0,f=l;b<f;b++){if(a=e.visibleLabels[b],a.size=S(a.text,e.labelStyle),"Middle"===s.secondaryLabelAlignment?n=wt(a.value+m/2,e)*h.width+h.x:i.indexOf("Secondary")>-1&&(n=this.findAlignment(e,b)),d=wt(a.value,e)*h.width+h.x,(0===b||b===e.visibleLabels.length-1&&s.enableRtl)&&n<h.x&&(n=h.x+a.size.width/2),(b===e.visibleLabels.length-1||0===b&&s.enableRtl)&&n+a.size.width>h.x+h.width&&(n=h.x+h.width-a.size.width/2),i.indexOf("_SecondaryLabel_")>-1&&n>=h.x&&h.x+h.width>=n&&(c=c.concat("M "+d+" "+t+" L "+d+" "+(t-a.size.height))),"Hide"===s.labelIntersectAction&&0!==b&&this.isIntersect(e,n,a.size.width,u,r.size.width))continue;"Middle"===s.secondaryLabelAlignment&&1===e.visibleLabels.length&&(n=wt(a.value,e)+(h.x+h.width/2));const l=s.labelStyle,g={cancel:!1,name:"labelRender",text:a.text,value:a.value,labelStyle:{size:l.size,color:p||l.color||s.themeStyle.labelFontColor,fontFamily:l.fontFamily,fontStyle:l.fontStyle||s.labelStyle.fontStyle,fontWeight:l.fontWeight||s.labelStyle.fontWeight,opacity:l.opacity||s.labelStyle.opacity,textAlignment:l.textAlignment||s.labelStyle.textAlignment,textOverflow:l.textOverflow||s.labelStyle.textOverflow},region:new C(n,t,a.size.width,a.size.height)};s.trigger("labelRender",g),g.cancel||(s.labels.push(g),bi(this.rangeNavigator.renderer,new L(this.rangeNavigator.element.id+i+b,n,t,"middle",g.text),g.labelStyle,g.labelStyle.color||s.themeStyle.labelFontColor,o).style.cursor="DateTime"===e.valueType?"cursor: pointer":"cursor: default",u=n,r=a)}return c}isIntersect(e,t,i,s,o){return e.isInversed?t+i/2>s-o/2:t-i/2<s+o/2}findSuitableFormat(e,t){const i=e.visibleLabels,s=i.length,o=t.bounds;let l,a;const r="DateTime"===t.valueType?s>1?i[1].value-i[0].value:e.visibleRange.interval:0;for(let n=0;n<s;n++)a=wt(i[n].value+r/2,e)*o.width+o.x,i[n].size=S(i[n].text,e.labelStyle),0===n&&a<o.x&&(a=o.x+i[n].size.width/2),"Quarter"===e.actualIntervalType?0!==n&&(i[n].text.indexOf("Quarter")>-1&&this.isIntersect(e,a,i[n].size.width,l,i[n-1].size.width)?(i.every(e=>(e.text=e.text.toString().replace("Quarter","QTR"),!0)),e.visibleLabels=i,this.findSuitableFormat(e,t)):this.isIntersect(e,a,i[n].size.width,l,i[n-1].size.width)&&(i.every(e=>(e.text=e.text.toString().replace("QTR","Q"),!0)),e.visibleLabels=i)):"Weeks"===e.actualIntervalType&&0!==n&&i[n].text.indexOf("Week")>-1&&this.isIntersect(e,a,i[n].size.width,l,i[n-1].size.width)&&(i.every(e=>(e.text=e.text.toString().replace("Week","W"),!0)),e.visibleLabels=i),l=a}findAlignment(e,t){const i=e.visibleLabels[t],s=e.visibleLabels[t+1],o=this.rangeNavigator.bounds;return"Near"===this.rangeNavigator.secondaryLabelAlignment?wt(i.value,e)*o.width+o.x+i.size.width/2:wt(s?s.value:e.visibleRange.max,e)*o.width+o.x-i.size.width}}var Mo=(()=>(function(e){e.axisLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.tooltipLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"}}(Mo||(Mo={})),Mo))(),To=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class Lo extends a.rt{constructor(){super(...arguments),this.clipRect=new C(0,0,0,0)}}To([(0,a.Z9)(null)],Lo.prototype,"dataSource",void 0),To([(0,a.Z9)(null)],Lo.prototype,"xName",void 0),To([(0,a.Z9)(null)],Lo.prototype,"yName",void 0),To([(0,a.Z9)()],Lo.prototype,"query",void 0),To([(0,a.Z9)("Line")],Lo.prototype,"type",void 0),To([(0,a.Zz)({enable:!1},Q)],Lo.prototype,"animation",void 0),To([(0,a.Zz)({color:"transparent",width:2},G)],Lo.prototype,"border",void 0),To([(0,a.Z9)(null)],Lo.prototype,"fill",void 0),To([(0,a.Z9)(1)],Lo.prototype,"width",void 0),To([(0,a.Z9)(1)],Lo.prototype,"opacity",void 0),To([(0,a.Z9)("0")],Lo.prototype,"dashArray",void 0);class Ao extends a.rt{}To([(0,a.Z9)(null)],Ao.prototype,"width",void 0),To([(0,a.Z9)(null)],Ao.prototype,"height",void 0),To([(0,a.Zz)({width:1,color:null},G)],Ao.prototype,"border",void 0),To([(0,a.Z9)(null)],Ao.prototype,"fill",void 0),To([(0,a.Z9)("Circle")],Ao.prototype,"type",void 0);class Do extends a.rt{}To([(0,a.Zz)({},Ao)],Do.prototype,"thumb",void 0),To([(0,a.Z9)(null)],Do.prototype,"selectedRegionColor",void 0),To([(0,a.Z9)(null)],Do.prototype,"unselectedRegionColor",void 0);class Ro extends a.rt{}To([(0,a.Z9)(!1)],Ro.prototype,"enable",void 0),To([(0,a.Z9)(.85)],Ro.prototype,"opacity",void 0),To([(0,a.Z9)(null)],Ro.prototype,"fill",void 0),To([(0,a.Z9)(null)],Ro.prototype,"format",void 0),To([(0,a.Zz)(Mo.tooltipLabelFont,q)],Ro.prototype,"textStyle",void 0),To([(0,a.Z9)(null)],Ro.prototype,"template",void 0),To([(0,a.Zz)({color:"#cccccc",width:.5},G)],Ro.prototype,"border",void 0),To([(0,a.Z9)("OnDemand")],Ro.prototype,"displayMode",void 0);class Io{constructor(e){this.control=e,this.points=[],this.isIOS=a.AR.isIos||a.AR.isIos7;const t=e.navigatorStyleSettings.thumb;this.thumbVisible=0!==e.themeStyle.thumbWidth&&0!==e.themeStyle.thumbHeight,this.elementId=e.element.id,this.thumpPadding=e.themeStyle.thumbWidth/2,this.addEventListener(),this.thumbColor=e.disableRangeSelector?"transparent":t.fill||e.themeStyle.thumbBackground}render(e){const t=e.renderer,i=e.navigatorStyleSettings,s=e.disableRangeSelector?"transparent":null,o=t.createGroup({id:this.elementId+"_sliders",style:e.disableRangeSelector?"pointer-events:none;":""}),l=new Ti(this.elementId+"_leftUnSelectedArea",s||i.unselectedRegionColor||e.themeStyle.unselectedRectColor,{width:0},1,{x:e.bounds.x,y:e.bounds.y,width:e.bounds.width/3,height:e.bounds.height});this.leftUnSelectedElement=t.drawRectangle(l),l.id=this.elementId+"_rightUnSelectedArea",this.rightUnSelectedElement=t.drawRectangle(l),l.id=this.elementId+"_SelectedArea",l.fill=s||i.selectedRegionColor||e.themeStyle.selectedRegionColor,this.selectedElement=t.drawRectangle(l),this.selectedElement.setAttribute("style","cursor: -webkit-grab"),this.leftSlider=t.createGroup({id:this.elementId+"_LeftSlider",style:"cursor: ew-resize"}),this.rightSlider=t.createGroup({id:this.elementId+"_RightSlider",style:"cursor: ew-resize"}),this.createThump(t,e.bounds,this.leftSlider,this.elementId+"_LeftSlider",o),this.createThump(t,e.bounds,this.rightSlider,this.elementId+"_RightSlider"),o.appendChild(this.leftUnSelectedElement),o.appendChild(this.rightUnSelectedElement),o.appendChild(this.selectedElement),o.appendChild(this.leftSlider),o.appendChild(this.rightSlider),e.svgObject.appendChild(o)}createThump(e,t,i,s,o){const l=this.control,a=l.navigatorStyleSettings.thumb,r=t.y+t.height/2,n=this.thumpPadding,h=l.themeStyle.thumbHeight/2-5,d=l.disableRangeSelector?"transparent":null,c=d||a.border.color||l.themeStyle.thumpLineColor;let p;i.appendChild(e.drawPath(new I(s+"_ThumpLine","transparent",a.border.width,l.series.length?c:"transparent",1,null,"M "+n+" "+t.y+" L "+n+" "+(t.y+t.height)+" "))),this.thumpY=r-l.themeStyle.thumbHeight/2,this.sliderY=t.y>this.thumpY?this.thumpY:t.y,o&&!l.disableRangeSelector&&(p=e.createDefs(),p.innerHTML='<rect xmlns="http://www.w3.org/2000/svg" id="'+this.control.element.id+'_shadow" x="0" y="'+this.thumpY+'" width="'+l.themeStyle.thumbWidth+'" height="'+l.themeStyle.thumbHeight+'" rx="'+("Circle"===a.type?"50%":"0%")+'"/><filter xmlns="http://www.w3.org/2000/svg" x="-25.0%" y="-20.0%" width="150.0%" height="150.0%" filterUnits="objectBoundingBox" id="ej2-range-shadow"><feOffset dx="0" dy="1" in="SourceAlpha"result="shadowOffsetOuter1"/><feGaussianBlur stdDeviation="1.5" in="shadowOffsetOuter1" result="shadowBlurOuter1"/><feComposite in="shadowBlurOuter1" in2="SourceAlpha" operator="out" result="shadowBlurOuter1"/><feColorMatrix values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.16 0" type="matrix" in="shadowBlurOuter1"/></filter>',o.appendChild(p)),i.innerHTML+='<use xmlns="http://www.w3.org/2000/svg" fill="black" fill-opacity="1" filter="url(#ej2-range-shadow)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#path-1"/>',i.appendChild("Circle"===a.type?qt({x:n,y:r},"Circle",{width:l.themeStyle.thumbWidth,height:l.themeStyle.thumbHeight},"",new I(s+"_ThumpSymbol",d||this.thumbColor,a.border.width,c,1,null)):e.drawRectangle(new Ti(s+"_ThumpSymbol",d||this.thumbColor,{width:a.border.width,color:c},1,{x:n-l.themeStyle.thumbWidth/2,y:r-l.themeStyle.thumbHeight/2,width:l.themeStyle.thumbWidth,height:l.themeStyle.thumbHeight},2,2))),this.thumbVisible&&i.appendChild(e.drawPath(new I(s+"_ThumpGrip","transparent",1,d||l.themeStyle.gripColor,1,null,"M "+(n+2)+" "+(r+h)+" L "+(n+2)+" "+(r-h)+" M "+n+" "+(r+h)+" L "+n+" "+(r-h)+" M "+(n-2)+" "+(r+h)+" L "+(n-2)+" "+(r-h)+" ")))}setSlider(e,t,i,s){const o=this.control,l=o.bounds.x,a=o.chartSeries.xAxis.actualRange,r=0===o.series.length;isNaN(e)&&isNaN(t)&&(e=0,t=o.bounds.width),t>=e||(e=[t,t=e][0]),e=t>=e?e:[t,t=e][0],e=Math.max(e,a.min),t=Math.min(t,a.max),this.startX=l+fo(e,a,o.bounds.width,o.enableRtl),this.endX=l+fo(t,a,o.bounds.width,o.enableRtl);const n=o.enableRtl?this.endX:this.startX,h=o.enableRtl?this.startX:this.endX;this.sliderWidth=Math.abs(this.endX-this.startX),this.selectedElement.setAttribute("x",n+""),this.selectedElement.setAttribute("width",this.sliderWidth+""),this.leftUnSelectedElement.setAttribute("width",n-l+""),this.rightUnSelectedElement.setAttribute("x",h+""),this.rightUnSelectedElement.setAttribute("width",o.bounds.width-(h-l)+""),this.leftSlider.setAttribute("transform","translate("+(this.startX-this.thumpPadding)+", 0)"),this.rightSlider.setAttribute("transform","translate("+(this.endX-this.thumpPadding)+", 0)");const d=this.control.svgObject.getBoundingClientRect().left-this.control.element.getBoundingClientRect().left,c=this.control.enableRtl?this.endX:this.startX,p=this.control.enableRtl?this.startX:this.endX;this.leftRect={x:r?d+l:l,y:r?0:o.bounds.y,width:r?c-l:c,height:r?this.thumpY:o.bounds.height},this.rightRect={x:r?d+p:p,y:r?0:o.bounds.y,width:o.bounds.width-(h-l),height:r?this.thumpY:o.bounds.height},this.midRect={x:r?c+d:0,y:r?0:o.bounds.y,width:r?Math.abs(this.endX-this.startX):p,height:r?this.thumpY:o.bounds.height},this.currentStart=e,this.currentEnd=t,s&&(this.control.rangeTooltipModule.renderLeftTooltip(this),this.control.rangeTooltipModule.renderRightTooltip(this)),i&&this.triggerEvent(a)}triggerEvent(e){const t=this.control.chartSeries.xAxis,i=t.valueType,s={cancel:!1,start:"DateTime"===i?new Date(this.currentStart):"Logarithmic"===i?Math.pow(t.logBase,this.currentStart):this.currentStart,end:"DateTime"===i?new Date(this.currentEnd):"Logarithmic"===i?Math.pow(t.logBase,this.currentEnd):this.currentEnd,name:"changed",selectedData:vo(this.points,this.currentStart,this.currentEnd),zoomPosition:(this.control.enableRtl?e.max-this.currentEnd:this.currentStart-e.min)/e.delta,zoomFactor:(this.currentEnd-this.currentStart)/e.delta};this.control.trigger("changed",s)}addEventListener(){this.control.isDestroyed||(this.control.on(a.AR.touchMoveEvent,this.mouseMoveHandler,this),this.control.on(a.AR.touchStartEvent,this.mouseDownHandler,this),this.control.on(a.AR.touchEndEvent,this.mouseUpHandler,this),this.control.on(a.AR.isPointer?"pointerleave":"mouseleave",this.mouseCancelHandler,this))}removeEventListener(){this.control.isDestroyed||(this.control.off(a.AR.touchMoveEvent,this.mouseMoveHandler),this.control.off(a.AR.touchStartEvent,this.mouseDownHandler),this.control.off(a.AR.touchEndEvent,this.mouseUpHandler),this.control.off(a.AR.isPointer?"pointerleave":"mouseleave",this.mouseCancelHandler))}mouseMoveHandler(e){const t=this.control,i=t.chartSeries.xAxis.actualRange,s=t.bounds;let o,l;if(this.getCurrentSlider(e.target.id),this.isDrag&&t.mouseX>=s.x){switch(this.currentSlider){case"Left":t.startValue=this.getRangeValue(Math.abs(t.mouseX-s.x));break;case"Right":t.endValue=this.getRangeValue(Math.abs(t.mouseX-s.x));break;case"Middle":o=Math.max(this.getRangeValue(Math.abs(this.startX-(this.previousMoveX-t.mouseX)-s.x)),i.min),l=Math.min(this.getRangeValue(Math.abs(this.endX-(this.previousMoveX-t.mouseX)-s.x)),i.max),Math.floor(Math.abs(fo(l,i,t.bounds.width,t.enableRtl)-fo(o,i,t.bounds.width,t.enableRtl)))===Math.floor(this.sliderWidth)&&(t.startValue=o,t.endValue=l)}e.preventDefault&&this.isIOS&&e.preventDefault(),this.setSlider(t.startValue,t.endValue,!t.enableDeferredUpdate,t.rangeTooltipModule&&t.tooltip.enable),this.previousMoveX=t.mouseX}}getRangeValue(e){const t=this.control;return yo(e,t.bounds.width,t.chartSeries.xAxis.actualRange,t.enableRtl)}mouseDownHandler(e){this.currentSlider=this.getCurrentSlider(e.target.id),this.selectedElement.setAttribute("style","cursor: -webkit-grabbing"),this.isDrag=!("UnSelectedArea"===this.currentSlider||!this.currentSlider),this.previousMoveX=this.control.mouseDownX}getCurrentSlider(e){const t=this.control.themeStyle.thumbHoverColor;return e.indexOf(this.elementId+"_LeftSlider")>-1?(this.leftSlider.childNodes[2].setAttribute("fill",t),"Left"):e.indexOf(this.elementId+"_RightSlider")>-1?(this.rightSlider.childNodes[2].setAttribute("fill",t),"Right"):e.indexOf(this.elementId+"_SelectedArea")>-1?"Middle":e.indexOf("UnSelectedArea")>-1?(this.leftSlider.childNodes[2].setAttribute("fill",this.thumbColor),this.rightSlider.childNodes[2].setAttribute("fill",this.thumbColor),"UnSelectedArea"):e.indexOf(this.elementId+"_AxisLabel_")>-1&&"DateTime"===this.control.valueType?(this.labelIndex=+e.substring(e.lastIndexOf("_")+1,e.length),"firstLevelLabels"):e.indexOf(this.elementId+"_SecondaryLabel")>-1&&"DateTime"===this.control.valueType?(this.labelIndex=+e.substring(e.lastIndexOf("_")+1,e.length),"secondLevelLabels"):(this.leftSlider.childNodes[2].setAttribute("fill",this.thumbColor),this.rightSlider.childNodes[2].setAttribute("fill",this.thumbColor),this.control.periodSelectorModule&&(this.control.periodSelectorModule.triggerChange=!0),null)}mouseUpHandler(){const e=this.control,t=e.chartSeries.xAxis.actualRange;let i=e.enableDeferredUpdate;const s=e.tooltip.enable;if(e.stockChart&&(e.stockChart.zoomChange=!1),"UnSelectedArea"===this.currentSlider){let s,o,l;const a=e.enableRtl,r=e.endValue-e.startValue;e.mouseDownX<this.startX?(s=Math.max(this.getRangeValue(e.mouseDownX-this.sliderWidth/2-e.bounds.x),t.min),l=a?s:s+r,o=a?s-r:s):(s=Math.min(this.getRangeValue(e.mouseDownX+this.sliderWidth/2-e.bounds.x),t.max),o=a?s:s-r,l=a?s+r:s),this.performAnimation(o,l,e),i=!1}else if("firstLevelLabels"===this.currentSlider||"secondLevelLabels"===this.currentSlider){const s=e.rangeAxis[this.currentSlider][this.labelIndex+1];this.performAnimation(e.rangeAxis[this.currentSlider][this.labelIndex].value,s?e.allowIntervalData?s.value-1:s.value:t.max,e),i=!1}this.isDrag&&e.allowSnapping&&(this.setAllowSnapping(e,this.currentStart,this.currentEnd,i,s),i=!1),i&&this.setSlider(this.currentStart,this.currentEnd,!0,s),null!==this.currentSlider&&this.control.periodSelectorSettings.periods.length>0&&(this.control.periodSelectorModule.triggerChange=!1,this.control.periodSelectorModule.datePicker.startDate=new Date(this.currentStart),this.control.periodSelectorModule.datePicker.endDate=new Date(this.currentEnd)),this.selectedElement.setAttribute("style","cursor: -webkit-grab"),e.startValue=this.currentStart,e.endValue=this.currentEnd,this.isDrag=!1,this.labelIndex=null,this.currentSlider=null}setAllowSnapping(e,t,i,s,o){const l=e.rangeAxis.lowerValues;l.push(e.chartSeries.xAxis.actualRange.max),this.setSlider(So(l,t),So(l,i),s,o),e.startValue=this.currentStart,e.endValue=this.currentEnd}performAnimation(e,t,i,s){const o=this.currentStart,l=this.currentEnd,r=i.enableDeferredUpdate,n=i.tooltip.enable;new a.fw({}).animate((0,a.az)("div"),{duration:(0,a.le)(s)?this.control.animationDuration:s,progress:i=>{this.setSlider(Ot(i.timeStamp,0,e-o,i.duration)+o,Ot(i.timeStamp,0,t-l,i.duration)+l,!r,n)},end:()=>{i.allowSnapping?this.setAllowSnapping(i,e,t,!0,n):this.setSlider(e,t,!0,n),this.control.startValue=this.currentStart,this.control.endValue=this.currentEnd,this.control.periodSelectorSettings.periods.length>0&&(this.control.periodSelectorModule.triggerChange=!1,this.control.periodSelectorModule.datePicker.startDate=new Date(this.currentStart),this.control.periodSelectorModule.datePicker.endDate=new Date(this.currentEnd))}})}mouseCancelHandler(){this.isDrag&&this.control.allowSnapping&&this.setAllowSnapping(this.control,this.currentStart,this.currentEnd,!1,this.control.tooltip.enable),this.isDrag=!1,this.currentSlider=null,this.control.startValue=this.currentStart,this.control.endValue=this.currentEnd}destroy(){this.removeEventListener()}}class Po{constructor(e){this.control={},this.rootControl=e}setControlValues(e){"rangeNavigator"===e.getModuleName()?(this.control.periods=this.rootControl.periodSelectorSettings.periods,this.control.seriesXMax=e.chartSeries.xMax,this.control.seriesXMin=e.chartSeries.xMin,this.control.rangeSlider=e.rangeSlider,this.control.rangeNavigatorControl=e,this.control.endValue=e.endValue,this.control.startValue=e.startValue):(this.control.periods=this.rootControl.periods,this.control.endValue=this.control.seriesXMax=e.seriesXMax,this.control.startValue=this.control.seriesXMin=e.seriesXMin,this.control.rangeNavigatorControl=this.rootControl.rangeNavigator,this.control.rangeNavigatorControl&&(this.control.rangeSlider=this.rootControl.rangeNavigator.rangeSlider)),this.control.element=e.element,this.control.disableRangeSelector=e.disableRangeSelector}appendSelector(e,t=0){this.renderSelectorElement(null,e,t),this.renderSelector()}renderSelectorElement(e,t,i){let s,o;this.periodSelectorSize=e?this.periodSelectorSize:new C(i,this.rootControl.titleSize.height,t.width,t.height),e?(s=e.themeStyle.thumbWidth,o=e.element):(s=t.thumbSize,o=t.element),Yt(o.id+"_Secondary_Element")&&(0,a.Od)(Yt(o.id+"_Secondary_Element")),this.periodSelectorDiv=(0,a.az)("div",{id:o.id+"_Secondary_Element",styles:"width: "+(this.periodSelectorSize.width-s)+"px;height: "+this.periodSelectorSize.height+"px;top:"+this.periodSelectorSize.y+"px;left:"+(this.periodSelectorSize.x+s/2)+"px; position: absolute"}),o.appendChild(this.periodSelectorDiv)}renderSelector(){this.setControlValues(this.rootControl);let e=!0;const t=this.control.element.id,i=(0,a.az)("div",{id:t+"_selector"}),s=this.control.periods,o=this.updateCustomElement(),l="text-transform: none; text-overflow: unset",r=t+"customRange";this.periodSelectorDiv.appendChild(i);for(let a=0;a<s.length;a++)o.push({align:"Left",text:s[a].text});"stockChart"===this.rootControl.getModuleName()&&(e=this.rootControl.enableCustomRange),e&&(this.calendarId=t+"_calendar",o.push({template:"<button id="+this.calendarId+"></button>",align:"Right"}));const n={selector:o,name:"RangeSelector",cancel:!1,enableCustomFormat:!0,content:"Date Range"};"stockChart"===this.rootControl.getModuleName()&&(o.push({template:(0,a.az)("button",{id:t+"_reset",innerHTML:"Reset",styles:l,className:"e-dropdown-btn e-btn"}),align:"Right"}),this.rootControl.exportType.indexOf("Print")>-1&&o.push({template:(0,a.az)("button",{id:t+"_print",innerHTML:"Print",styles:l,className:"e-dropdown-btn e-btn"}),align:"Right"}),this.rootControl.exportType.length&&o.push({template:(0,a.az)("button",{id:t+"_export",innerHTML:"Export",styles:l,className:"e-dropdown-btn e-btn"}),align:"Right"})),this.rootControl.trigger("selectorRender",n),this.toolbar=new d.o8({items:n.selector,height:this.periodSelectorSize.height,clicked:e=>{this.buttonClick(e,this.control)},created:()=>{this.nodes=this.toolbar.element.querySelectorAll(".e-toolbar-left")[0],(0,a.le)(this.selectedIndex)&&s.map((e,t)=>{e.selected&&(this.control.startValue=this.changedRange(e.intervalType,this.control.endValue,e.interval).getTime(),this.selectedIndex=this.nodes.childNodes.length-s.length+t)}),this.setSelectedStyle(this.selectedIndex)}}),this.toolbar.isStringTemplate=!0,this.toolbar.appendTo(i),this.triggerChange=!0,e&&(this.datePicker=new u.Dw({min:new Date(this.control.seriesXMin),max:new Date(this.control.seriesXMax),format:"dd'/'MM'/'yyyy",placeholder:"Select a range",showClearButton:!1,startDate:new Date(this.control.startValue),endDate:new Date(this.control.endValue),created:()=>{if(n.enableCustomFormat){const e=document.getElementsByClassName("e-date-range-wrapper");let i;for(let s=0;s<e.length;s++)-1!==e[s].children[0].id.indexOf(t)&&(i=e[s]);i.style.display="none",i.insertAdjacentElement("afterend",(0,a.az)("div",{id:r,innerHTML:n.content,className:"e-btn e-dropdown-btn",styles:'font-family: "Segoe UI"; font-size: 14px; font-weight: 500; text-transform: none '})),Yt(r).insertAdjacentElement("afterbegin",(0,a.az)("span",{id:t+"dateIcon",className:"e-input-group-icon e-range-icon e-btn-icon e-icons",styles:"font-size: 16px; min-height: 0px; margin: -3px 0 0 0; outline: none; min-width: 30px"})),document.getElementById(r).onclick=()=>{this.datePicker.show(Yt(r))}}},change:e=>{if(this.triggerChange&&(this.control.rangeSlider&&e.event?this.control.rangeSlider.performAnimation(e.startDate.getTime(),e.endDate.getTime(),this.control.rangeNavigatorControl):e.event&&this.rootControl.rangeChanged(e.startDate.getTime(),e.endDate.getTime()),this.nodes=this.toolbar.element.querySelectorAll(".e-toolbar-left")[0],!this.rootControl.resizeTo&&this.control.rangeSlider&&this.control.rangeSlider.isDrag))for(let t=0,i=this.nodes.childNodes.length;t<i;t++)this.nodes.childNodes[t].childNodes[0].classList.remove("e-active"),this.nodes.childNodes[t].childNodes[0].classList.remove("e-active")}}),this.datePicker.appendTo("#"+this.calendarId))}updateCustomElement(){const e=[],t=this.rootControl.element.id,i="text-transform: none; text-overflow: unset";return"stockChart"===this.rootControl.getModuleName()&&(this.rootControl.seriesType.length&&e.push({template:(0,a.az)("button",{id:t+"_seriesType",innerHTML:"Series",styles:i}),align:"Left"}),this.rootControl.indicatorType.length&&e.push({template:(0,a.az)("button",{id:t+"_indicatorType",innerHTML:"Indicators",styles:i}),align:"Left"}),this.rootControl.trendlineType.length&&e.push({template:(0,a.az)("button",{id:t+"_trendType",innerHTML:"Trendline",styles:i}),align:"Left"})),e}setSelectedStyle(e){if(this.control.disableRangeSelector||"stockChart"===this.rootControl.getModuleName()){for(let e=0,t=this.nodes.childNodes.length;e<t;e++)this.nodes.childNodes[e].childNodes[0].classList.remove("e-active"),this.nodes.childNodes[e].childNodes[0].classList.remove("e-active");this.nodes.childNodes[e].childNodes[0].classList.add("e-flat"),this.nodes.childNodes[e].childNodes[0].classList.add("e-active")}}buttonClick(e,t){const i=e.item,s=this.control.rangeSlider,o=this.control.periods,l=o.filter(e=>e.text===i.text);let r,n;o.map((t,i)=>{t.text===e.item.text&&(this.selectedIndex=this.nodes.childNodes.length-o.length+i)}),""!==e.item.text&&this.setSelectedStyle(this.selectedIndex),"all"===i.text.toLowerCase()?(r=t.seriesXMin,n=t.seriesXMax,s?s.performAnimation(r,n,this.control.rangeNavigatorControl):this.rootControl.rangeChanged(r,n)):"ytd"===i.text.toLowerCase()?s?(r=new Date(new Date(s.currentEnd).getFullYear().toString()).getTime(),n=s.currentEnd,s.performAnimation(r,n,this.control.rangeNavigatorControl)):(r=new Date(new Date(this.rootControl.currentEnd).getFullYear().toString()).getTime(),n=this.rootControl.currentEnd,this.rootControl.rangeChanged(r,n)):""!==i.text.toLowerCase()&&(s?(r=this.changedRange(l[0].intervalType,s.currentEnd,l[0].interval).getTime(),n=s.currentEnd,s.performAnimation(r,n,this.control.rangeNavigatorControl)):(r=this.changedRange(l[0].intervalType,this.rootControl.currentEnd,l[0].interval).getTime(),n=this.rootControl.currentEnd,this.rootControl.rangeChanged(r,n))),"stockChart"===this.rootControl.getModuleName()&&(this.rootControl.zoomChange=!1),Yt(this.calendarId+"_popup")&&!a.AR.isDevice&&(Yt(this.calendarId+"_popup").querySelectorAll(".e-range-header")[0].style.display="none")}changedRange(e,t,i){const s=new Date(t);switch(e){case"Quarter":s.setMonth(s.getMonth()-3*i);break;case"Months":s.setMonth(s.getMonth()-i);break;case"Weeks":s.setDate(s.getDate()-7*i);break;case"Days":s.setDate(s.getDate()-i);break;case"Hours":s.setHours(s.getHours()-i);break;case"Minutes":s.setMinutes(s.getMinutes()-i);break;case"Seconds":s.setSeconds(s.getSeconds()-i);break;default:s.setFullYear(s.getFullYear()-i)}return s}getModuleName(){return"PeriodSelector"}destroy(){}}var ko=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};let Eo=class extends a.wA{constructor(e,t){super(e,t),this.animateSeries=!0,this.chartid=57725}preRender(){if(this.isBlazor=window.Blazor,this.unWireEvents(),this.setCulture(),this.allowServerDataBinding=!1,""===this.element.id){const e=document.getElementsByClassName("e-rangenavigator").length;this.element.id="rangenavigator_"+this.chartid+"_"+e}this.wireEvents()}initPrivateVariables(){this.doubleModule=new ae,this.labels=[],this.rangeSlider=new Io(this),this.chartSeries=new wo(this),this.lineSeriesModule=new bs,this.rangeAxis=new Co(this)}setCulture(){this.intl=new a.eC}setSliderValue(){const e="DateTime"===this.valueType,t=this.chartSeries.xAxis.actualRange;this.startValue=this.startValue?this.startValue:this.value[0]?e?new Date(this.value[0].toString()).getTime():+this.value[0]:t.min,this.endValue=this.endValue?this.endValue:this.value[1]?e?new Date(this.value[1].toString()).getTime():+this.value[1]:t.max}render(){const e={name:"load",rangeNavigator:this.isBlazor?{}:this,theme:this.theme};this.trigger("load",e,()=>{this.theme=this.isBlazor?e.theme:this.theme,this.setTheme(),this.initPrivateVariables(),this.createRangeSvg(),this.calculateBounds(),this.chartSeries.renderChart(this),nt("chartmeasuretext"),this.renderComplete(),this.allowServerDataBinding=!0})}setTheme(){this.themeStyle=function(e,t){const i=t.navigatorStyleSettings.thumb,s=(0,a.le)(i.width)?a.AR.isDevice?15:20:i.width,o=(0,a.le)(i.height)?a.AR.isDevice?15:20:i.height,l="HighContrast"===e?"#969696":"#6F6C6C",r="HighContrast"===e?"#4A4848":"#414040",n="MaterialDark"===e?"#303030":"FabricDark"===e?"#201F1F":"1A1A1A";let h={gridLineColor:"#E0E0E0",axisLineColor:"#000000",labelFontColor:"#686868",unselectedRectColor:t.series.length?"rgba(255, 255, 255, 0.6)":"#EEEEEE",thumpLineColor:"rgba(189, 189, 189, 1)",thumbBackground:"rgba(250, 250, 250, 1)",gripColor:"#757575",background:"#FFFFFF",thumbHoverColor:"#EEEEEE",selectedRegionColor:t.series.length?"transparent":"#FF4081",tooltipBackground:"rgb(0, 8, 22)",tooltipFontColor:"#dbdbdb",thumbWidth:s,thumbHeight:o};switch(e){case"Fabric":h.selectedRegionColor=t.series.length?"transparent":"#007897";break;case"Bootstrap":h.selectedRegionColor=t.series.length?"transparent":"#428BCA";break;case"HighContrastLight":h={gridLineColor:"#bdbdbd",axisLineColor:"#969696",labelFontColor:"#ffffff",unselectedRectColor:t.series.length?"rgba(255, 255, 255, 0.3)":"#EEEEEE",thumpLineColor:"#ffffff",thumbBackground:"#262626",gripColor:"#ffffff",background:n,thumbHoverColor:"#BFBFBF",selectedRegionColor:t.series.length?"transparent":"#FFD939",tooltipBackground:"#ffffff",tooltipFontColor:"#000000",thumbWidth:s,thumbHeight:o};break;case"Highcontrast":case"HighContrast":h={gridLineColor:r,axisLineColor:l,labelFontColor:"#DADADA",unselectedRectColor:t.series.length?"rgba(43, 43, 43, 0.6)":"#514F4F",thumpLineColor:"#969696",thumbBackground:"#333232",gripColor:"#DADADA",background:"#000000",thumbHoverColor:"#BFBFBF",selectedRegionColor:t.series.length?"rgba(22, 22, 22, 0.6)":"#FFD939",tooltipBackground:"#F4F4F4",tooltipFontColor:"#282727",thumbWidth:s,thumbHeight:o};break;case"MaterialDark":case"FabricDark":case"BootstrapDark":h={labelFontColor:"#DADADA",axisLineColor:" #6F6C6C",gridLineColor:"#414040",tooltipBackground:"#F4F4F4",tooltipFontColor:"#333232",unselectedRectColor:t.series.length?"rgba(43, 43, 43, 0.6)":"#514F4F",thumpLineColor:"#969696",thumbBackground:"#333232",gripColor:"#DADADA",background:n,thumbHoverColor:"#BFBFBF",selectedRegionColor:t.series.length?"rgba(22, 22, 22, 0.6)":"FabricDark"===e?"#007897":"BootstrapDark"===e?"#428BCA":"#FF4081",thumbWidth:s,thumbHeight:o};break;case"Bootstrap4":h={gridLineColor:"#E0E0E0",axisLineColor:"#CED4DA",labelFontColor:"#212529",unselectedRectColor:t.series.length?"rgba(255, 255, 255, 0.6)":"#514F4F",thumpLineColor:"rgba(189, 189, 189, 1)",thumbBackground:"#FFFFFF",gripColor:"#495057",background:"rgba(255, 255, 255, 0.6)",thumbHoverColor:"#EEEEEE",selectedRegionColor:t.series.length?"transparent":"#FFD939",tooltipBackground:"rgba(0, 0, 0, 0.9)",tooltipFontColor:"rgba(255, 255, 255)",thumbWidth:s,thumbHeight:o};break;case"Tailwind":h={gridLineColor:"#E5E7EB",axisLineColor:"#D1D5DB",labelFontColor:"#6B7280",unselectedRectColor:t.series.length?"transparent":"#E5E7EB",thumpLineColor:"#9CA3AF",thumbBackground:"#FFFFFF",gripColor:"#6B7280",background:"rgba(255, 255, 255, 0.6)",thumbHoverColor:"#374151",selectedRegionColor:t.series.length?"rgba(79, 70, 229, 0.3)":"#4F46E5",tooltipBackground:"#111827",tooltipFontColor:"#F9FAFB",thumbWidth:s,thumbHeight:o};break;case"TailwindDark":h={gridLineColor:"#374151",axisLineColor:"#4B5563",labelFontColor:"#9CA3AF",unselectedRectColor:t.series.length?"transparent":"#4B5563",thumpLineColor:"#6B7280",thumbBackground:"#1F2937",gripColor:"#D1D5DB",background:"rgba(255, 255, 255, 0.6)",thumbHoverColor:"#E5E7EB",selectedRegionColor:t.series.length?"rgba(255, 255, 255, 0.6)":"#22D3EE",tooltipBackground:"#F9FAFB",tooltipFontColor:"#1F2937",thumbWidth:s,thumbHeight:o};break;default:h.selectedRegionColor=t.series.length?"transparent":"#FF4081"}return h}(this.theme,this)}createRangeSvg(){this.removeSvg(),yi(this),this.renderChartBackground()}calculateBounds(){const e=this.enableGrouping?15:8,t=this.navigatorStyleSettings.thumb,i=S("tempString",this.labelStyle).height,s=this.margin,o=!this.series.length,l=!this.disableRangeSelector&&o&&this.tooltip.enable?35:0;this.isBlazor&&!this.periodSelectorModule&&this.periodSelectorSettings.periods.length&&!this.stockChart&&(this.periodSelectorModule=new Po(this));const a=this.periodSelectorModule;this.periodSelectorModule&&this.periodSelectorSettings.periods.length>0&&(a.periodSelectorSize={x:0,y:0,height:0,width:0},a.periodSelectorSize.width=this.availableSize.width,a.periodSelectorSize.height=this.periodSelectorSettings.height,a.periodSelectorSize.y="Bottom"===this.periodSelectorSettings.position?this.availableSize.height-a.periodSelectorSize.height:0);let r=0,n=0;if(this.stockChart&&this.stockChart.stockLegendModule&&this.stockChart.legendSettings.visible&&("Left"===this.stockChart.legendSettings.position?r+=this.stockChart.stockLegendModule.legendBounds.width:"Top"===this.stockChart.legendSettings.position&&(n+=this.stockChart.stockLegendModule.legendBounds.height)),this.bounds=new C(this.themeStyle.thumbWidth/2+t.border.width+s.left+r,s.top+l+("Top"===this.periodSelectorSettings.position&&a?a.periodSelectorSize.y+a.periodSelectorSize.height:0)+n,this.availableSize.width-this.themeStyle.thumbWidth-2*t.border.width-s.left-s.right,this.availableSize.height-s.top-s.bottom-l-(a?a.periodSelectorSize.height:0)),this.bounds.height-=("Outside"===this.labelPosition||o?i+e:0)+("Outside"===this.tickPosition||o?this.majorTickLines.height:0),o){const t=this.enableGrouping?this.bounds.height-(i+e):this.bounds.height;this.bounds.y+=this.themeStyle.thumbHeight>t?(this.themeStyle.thumbHeight-t)/2:0}this.disableRangeSelector&&(this.bounds.y=0,this.bounds.height=this.periodSelectorSettings.periods.length>0?this.periodSelectorSettings.height:0)}renderChart(){this.chartSeries.renderSeries(this),this.rangeAxis.renderGridLines(),this.rangeAxis.renderAxisLabels(),this.chartSeries.appendSeriesElements(this),this.createSecondaryElement(),this.setSliderValue(),this.renderPeriodSelector(),this.renderSlider(),this.stockChart||this.element.appendChild(this.svgObject),this.trigger("loaded",{rangeNavigator:this.isBlazor?{}:this}),this.rangeSlider.setSlider(this.startValue,this.endValue,!1,this.tooltip.enable&&"Always"===this.tooltip.displayMode)}renderPeriodSelector(){this.periodSelectorModule&&(this.periodSelectorModule.renderSelectorElement(this),this.periodSelectorModule.renderSelector())}createSecondaryElement(){if(this.tooltip.enable){const e=this.createElement("div");e.id=this.element.id+"_Secondary_Element",e.setAttribute("style","position: relative"),this.element.appendChild(e)}}renderSlider(){this.rangeSlider.render(this),this.rangeSlider.setSlider(this.startValue,this.endValue,!0,this.tooltip.enable&&"Always"===this.tooltip.displayMode)}removeSvg(){if(Yt(this.element.id+"_Secondary_Element")&&((0,a.Od)(Yt(this.element.id+"_Secondary_Element")),this.isReact&&this.clearTemplate()),this.svgObject){for(;this.svgObject.childNodes.length>0;)this.svgObject.removeChild(this.svgObject.firstChild);this.svgObject.hasChildNodes()||!this.svgObject.parentNode||this.stockChart||(0,a.Od)(this.svgObject)}}unWireEvents(){const e=a.AR.touchMoveEvent,t=a.AR.touchEndEvent,i=a.AR.isPointer?"pointerleave":"mouseleave";a.bi.remove(this.element,a.AR.touchStartEvent,this.rangeOnMouseDown),a.bi.remove(this.element,e,this.mouseMove),a.bi.remove(this.element,t,this.mouseEnd),a.bi.remove(this.element,"click",this.rangeOnMouseClick),a.bi.remove(this.element,i,this.mouseLeave),window.removeEventListener(a.AR.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.rangeResize)}wireEvents(){const e=a.AR.isPointer?"pointerleave":"mouseleave";a.bi.add(this.element,a.AR.touchStartEvent,this.rangeOnMouseDown,this),a.bi.add(this.element,a.AR.touchMoveEvent,this.mouseMove,this),a.bi.add(this.element,a.AR.touchEndEvent,this.mouseEnd,this),a.bi.add(this.element,"click",this.rangeOnMouseClick,this),a.bi.add(this.element,e,this.mouseLeave,this),window.addEventListener(a.AR.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.rangeResize.bind(this));const t=this.element;t.style.touchAction="none",t.style.msTouchAction="none",t.style.msContentZooming="none",t.style.msUserSelect="none",t.style.webkitUserSelect="none",t.style.position="relative",t.style.display="block"}rangeResize(){if(!document.getElementById(this.element.id))return!1;this.animateSeries=!1,this.removeAllTooltip(),this.resizeTo&&clearTimeout(this.resizeTo);const e={rangeNavigator:this,name:"resized",currentSize:new w(0,0),previousSize:new w(this.availableSize.width,this.availableSize.height)};return this.resizeTo=+setTimeout(()=>{this.isDestroyed?clearTimeout(this.resizeTo):(this.createRangeSvg(),e.currentSize=this.availableSize,this.trigger("resized",e),this.calculateBounds(),this.chartSeries.processXAxis(this),this.chartSeries.calculateGroupingBounds(this),this.chartSeries.processYAxis(this),this.renderChart())},500),!1}removeAllTooltip(){this.tooltip.enable&&"Always"===this.tooltip.displayMode&&(Yt(this.element.id+"_leftTooltip")&&(0,a.Od)(Yt(this.element.id+"_leftTooltip")),Yt(this.element.id+"_rightTooltip")&&(0,a.Od)(Yt(this.element.id+"_rightTooltip")))}mouseMove(e){return Yt(this.stockChart?this.element.id:this.element.id+"_svg")&&(this.mouseX=this.setMouseX(e),this.notify(a.AR.touchMoveEvent,e)),!1}mouseLeave(e){const t=this.rangeSlider;if(t.isDrag){const e=t.control.tooltip.enable;t.control.allowSnapping&&(t.isDrag=!1,t.setAllowSnapping(t.control,t.currentStart,t.currentEnd,!1,e)),t.triggerEvent(this.chartSeries.xAxis.actualRange)}const i=a.AR.isPointer?"pointerleave":"mouseleave";return this.mouseX=this.setMouseX(e),this.notify(i,e),!1}rangeOnMouseClick(e){return this.notify("click",e),!1}print(e){new ls(this).print(e)}export(e,t,i,s,o,l,a){s=s||[this],new ls(this).export(e,t,i,s,o,l,a)}renderChartBackground(){if(this.stockChart)return;const e=new Ti(this.element.id+"_ChartBorder",this.background||this.themeStyle.background,{width:0,color:"transparent"},1,new C(0,0,this.availableSize.width,this.availableSize.height));this.svgObject.appendChild(this.renderer.drawRectangle(e))}rangeOnMouseDown(e){return this.mouseDownX=this.setMouseX(e),this.notify(a.AR.touchStartEvent,e),!1}mouseEnd(e){return this.mouseX=this.setMouseX(e),this.notify(a.AR.touchEndEvent,e),!1}setMouseX(e){const t=e.type.indexOf("touch")>-1?e.changedTouches[0].clientX:e.clientX,i=this.element.getBoundingClientRect(),s=this.stockChart?Yt(this.element.id).getBoundingClientRect():Yt(this.element.id+"_svg").getBoundingClientRect();return t-i.left-Math.max(s.left-i.left,0)}getPersistData(){return this.addOnPersist(["loaded"])}onPropertyChanged(e,t){let i=!1,s=!1,o=!1;this.animateSeries=!1;for(const l of Object.keys(e))switch(l){case"width":case"height":case"navigatorBorder":case"enableGrouping":case"labelPosition":case"tickPosition":case"labelStyle":s=!0;break;case"enableRtl":case"xName":case"yName":case"query":case"minimum":case"maximum":case"interval":case"intervalType":case"logBase":case"valueType":case"majorGridLines":case"minorGridLines":case"navigatorStyleSettings":case"labelFormat":case"skeleton":case"skeletonType":case"secondaryLabelAlignment":case"background":i=!0;break;case"dataSource":case"series":i=!0,s=!0;break;case"theme":this.animateSeries=!0;break;case"locale":super.refresh();break;case"value":this.startValue=null,this.endValue=null,o=!0}!s&&i&&(this.removeSvg(),this.chartSeries.xMin=1/0,this.chartSeries.xMax=-1/0,this.chartSeries.renderChart(this)),s&&i&&(this.removeSvg(),this.chartSeries.xMin=this.chartSeries.yMin=1/0,this.chartSeries.xMax=this.chartSeries.yMax=-1/0,this.calculateBounds(),this.chartSeries.renderChart(this)),s&&!i&&(this.removeSvg(),this.calculateBounds(),this.chartSeries.renderChart(this)),s||i||!o||(this.setSliderValue(),this.rangeSlider.setSlider(this.startValue,this.endValue,!0,this.tooltip.enable&&"Always"===this.tooltip.displayMode))}requiredModules(){const e=[];return this.series.map(t=>{e.push({member:t.type+"Series",args:[this]})}),this.periodSelectorSettings.periods.length>0&&e.push({member:"PeriodSelector",args:[this]}),"Double"!==this.valueType&&e.push({member:this.valueType,args:[this]}),this.tooltip.enable&&e.push({member:"RangeTooltip",args:[this]}),e}getModuleName(){return"rangeNavigator"}destroy(){this.unWireEvents(),this.isReact&&this.clearTemplate(),this.rangeSlider.destroy(),super.destroy(),this.element.innerHTML="",this.element.classList.remove("e-rangenavigator")}};ko([(0,a.Z9)(null)],Eo.prototype,"width",void 0),ko([(0,a.Z9)(null)],Eo.prototype,"height",void 0),ko([(0,a.Z9)(null)],Eo.prototype,"dataSource",void 0),ko([(0,a.Z9)(null)],Eo.prototype,"xName",void 0),ko([(0,a.Z9)(null)],Eo.prototype,"yName",void 0),ko([(0,a.Z9)()],Eo.prototype,"query",void 0),ko([(0,a.FE)([],Lo)],Eo.prototype,"series",void 0),ko([(0,a.Zz)({},Ro)],Eo.prototype,"tooltip",void 0),ko([(0,a.Z9)(null)],Eo.prototype,"minimum",void 0),ko([(0,a.Z9)(null)],Eo.prototype,"maximum",void 0),ko([(0,a.Z9)(null)],Eo.prototype,"interval",void 0),ko([(0,a.Z9)("Auto")],Eo.prototype,"intervalType",void 0),ko([(0,a.Z9)("Hide")],Eo.prototype,"labelIntersectAction",void 0),ko([(0,a.Z9)(10)],Eo.prototype,"logBase",void 0),ko([(0,a.Z9)("Double")],Eo.prototype,"valueType",void 0),ko([(0,a.Z9)("Outside")],Eo.prototype,"labelPosition",void 0),ko([(0,a.Z9)(500)],Eo.prototype,"animationDuration",void 0),ko([(0,a.Z9)(!1)],Eo.prototype,"enableGrouping",void 0),ko([(0,a.Z9)(!1)],Eo.prototype,"enableDeferredUpdate",void 0),ko([(0,a.Z9)(!1)],Eo.prototype,"disableRangeSelector",void 0),ko([(0,a.Z9)(!1)],Eo.prototype,"allowSnapping",void 0),ko([(0,a.Z9)(!1)],Eo.prototype,"allowIntervalData",void 0),ko([(0,a.Z9)(!1)],Eo.prototype,"useGroupingSeparator",void 0),ko([(0,a.Z9)()],Eo.prototype,"groupBy",void 0),ko([(0,a.Z9)("Outside")],Eo.prototype,"tickPosition",void 0),ko([(0,a.Zz)(Mo.axisLabelFont,q)],Eo.prototype,"labelStyle",void 0),ko([(0,a.Zz)({},Ke)],Eo.prototype,"majorGridLines",void 0),ko([(0,a.Zz)({},tt)],Eo.prototype,"majorTickLines",void 0),ko([(0,a.Zz)({},Do)],Eo.prototype,"navigatorStyleSettings",void 0),ko([(0,a.Zz)({},oe)],Eo.prototype,"periodSelectorSettings",void 0),ko([(0,a.Zz)({color:"#DDDDDD",width:1},G)],Eo.prototype,"navigatorBorder",void 0),ko([(0,a.Z9)("Material")],Eo.prototype,"theme",void 0),ko([(0,a.Z9)([])],Eo.prototype,"value",void 0),ko([(0,a.Z9)(null)],Eo.prototype,"background",void 0),ko([(0,a.Z9)("")],Eo.prototype,"labelFormat",void 0),ko([(0,a.Z9)("")],Eo.prototype,"skeleton",void 0),ko([(0,a.Z9)("DateTime")],Eo.prototype,"skeletonType",void 0),ko([(0,a.Z9)("Middle")],Eo.prototype,"secondaryLabelAlignment",void 0),ko([(0,a.Zz)({top:5,bottom:5,right:5,left:5},U)],Eo.prototype,"margin",void 0),ko([(0,a.ju)()],Eo.prototype,"load",void 0),ko([(0,a.ju)()],Eo.prototype,"loaded",void 0),ko([(0,a.ju)()],Eo.prototype,"resized",void 0),ko([(0,a.ju)()],Eo.prototype,"labelRender",void 0),ko([(0,a.ju)()],Eo.prototype,"changed",void 0),ko([(0,a.ju)()],Eo.prototype,"tooltipRender",void 0),ko([(0,a.ju)()],Eo.prototype,"selectorRender",void 0),ko([(0,a.ju)()],Eo.prototype,"beforePrint",void 0),Eo=ko([a.Zl],Eo);class Fo{constructor(e){this.stockChart=e}initializeChart(e){const t=this.stockChart,i="isProtectedOnChange";if(t[i]=!0,t.chartObject){const e=document.getElementById(t.chartObject.id);for(;e.firstChild;)e.removeChild(e.firstChild);Yt(t.chartObject+"_tooltip")&&(0,a.Od)(Yt(t.chartObject+"_tooltip"))}else t.chartObject=t.renderer.createGroup({id:t.element.id+"_stockChart_chart"}),t.mainObject.appendChild(t.chartObject);if(this.cartesianChartSize=this.calculateChartSize(),t.chart=new ds({chartArea:t.chartArea,margin:this.findMargin(t),primaryXAxis:this.copyObject(t.primaryXAxis),primaryYAxis:this.copyObject(t.primaryYAxis),rows:t.rows,indicators:t.indicators,axes:t.axes,tooltipRender:e=>{this.stockChart.trigger("tooltipRender",e)},axisLabelRender:e=>{this.stockChart.trigger("axisLabelRender",e)},seriesRender:t=>{t.data&&this.stockChart.startValue&&this.stockChart.endValue&&(t.data=t.data.filter(e=>new Date(Date.parse(e[t.series.xName])).getTime()>=this.stockChart.startValue&&new Date(Date.parse(e[t.series.xName])).getTime()<=this.stockChart.endValue)),t.data=e||t.data,this.stockChart.trigger("seriesRender",t)},onZooming:e=>{this.stockChart.trigger(Ze,e)},pointClick:e=>{this.stockChart.trigger("pointClick",e)},pointMove:e=>{this.stockChart.trigger("pointMove",e)},dataSource:t.dataSource,series:this.findSeriesCollection(t.series),zoomSettings:this.copyObject(t.zoomSettings),tooltip:t.tooltip,crosshair:t.crosshair,height:this.cartesianChartSize.height.toString(),selectedDataIndexes:t.selectedDataIndexes,selectionMode:t.selectionMode,isMultiSelect:t.isMultiSelect,annotations:t.annotations,theme:t.theme,legendSettings:{visible:!1},zoomComplete:e=>{if("DateTime"===e.axis.valueType&&t.rangeNavigator){this.stockChart.zoomChange=!0;const i=this.calculateUpdatedRange(e.currentZoomFactor,e.currentZoomPosition,e.axis);t.rangeSelector.sliderChange(i.start,i.end)}}}),0!==t.indicators.length){if(t.isSelect)for(let e=0;e<t.indicators.length;e++)t.chart.indicators[e].animation.enable=!1,t.chart.indicators[e].dataSource=(0,a.l7)([],t.chart.series[0].dataSource,null,!0);t.isSelect=!0}t.chart.stockChart=t,t.chart.appendTo(t.chartObject),t[i]=!1}findMargin(e){const t={};return t.top=e.stockLegendModule&&e.legendSettings.visible&&"Top"===e.legendSettings.position?e.margin.top:2*e.margin.top,t.left=e.margin.left,t.right=e.margin.right,t.bottom=e.margin.bottom,t}findSeriesCollection(e){const t=[];for(let i=0,s=e.length;i<s;i++)t.push(e[i]),t[i].high=e[i].high,t[i].low=e[i].low,t[i].open=e[i].open,t[i].close=e[i].close,t[i].xName=e[i].xName,t[i].volume=e[i].volume,t[i].animation=e[i].animation,e[i].localData&&(t[i].dataSource=e[i].localData),t[i].yName=""===e[i].yName?e[i].close:e[i].yName;return t}calculateChartSize(){const e=this.stockChart;return new w(e.availableSize.width,e.enablePeriodSelector&&e.enableSelector?e.availableSize.height-e.toolbarHeight-80:e.enableSelector&&!e.enablePeriodSelector?e.availableSize.height-80:e.enablePeriodSelector&&!e.enableSelector?e.availableSize.height-e.toolbarHeight:e.availableSize.height)}calculateUpdatedRange(e,t,i){let s,o;const l=i.actualRange;return s=l.min+t*l.delta,o=s+e*l.delta,{start:s,end:o}}cartesianChartRefresh(e,t){e.cartesianChart.initializeChart(t)}copyObject(e){return(0,a.l7)({},e,{},!0)}}class Oo{constructor(e){this.stockChart=e}initializeRangeNavigator(){const e=this.stockChart;if(e.selectorObject){const t=document.getElementById(e.selectorObject.id);for(;t.firstChild;)t.removeChild(t.firstChild);Yt(e.selectorObject.id+"_leftTooltip")&&(0,a.Od)(Yt(e.selectorObject.id+"_leftTooltip")),Yt(e.selectorObject.id+"_rightTooltip")&&(0,a.Od)(Yt(e.selectorObject.id+"_rightTooltip"))}else e.selectorObject=e.renderer.createGroup({id:e.element.id+"_stockChart_rangeSelector",transform:"translate(0,"+e.cartesianChart.cartesianChartSize.height+")"}),e.mainObject.appendChild(e.selectorObject);e.rangeNavigator=new Eo({locale:"en",valueType:e.primaryXAxis.valueType,theme:this.stockChart.theme,series:this.findSeriesCollection(e.series),height:this.calculateChartSize().height.toString(),value:[new Date(e.startValue),new Date(e.endValue)],margin:this.findMargin(),tooltip:{enable:e.tooltip.enable,displayMode:"Always"},dataSource:e.dataSource,changed:t=>{const i={name:"rangeChange",end:t.end,selectedData:t.selectedData,start:t.start,zoomFactor:t.zoomFactor,zoomPosition:t.zoomPosition,data:void 0};this.stockChart.trigger("rangeChange",i),this.stockChart.startValue=t.start,this.stockChart.endValue=t.end,this.stockChart.zoomChange||this.stockChart.cartesianChart.cartesianChartRefresh(this.stockChart,i.data),e.periodSelector&&e.periodSelector.datePicker&&(e.periodSelector.datePicker.startDate=new Date(t.start),e.periodSelector.datePicker.endDate=new Date(t.end),e.periodSelector.datePicker.dataBind())}}),e.rangeNavigator.stockChart=e,e.rangeNavigator.appendTo(e.selectorObject)}findMargin(){return{top:5,left:0,right:0,bottom:0}}findSeriesCollection(e){const t=[];for(let i=0,s=e.length;i<s;i++)t.push(e[i]),t[i].xName=e[i].xName,t[i].yName=""===e[i].yName?e[i].close:e[i].yName;return t}calculateChartSize(){const e=this.stockChart;return new w(e.availableSize.width,e.enableSelector?80:0)}sliderChange(e,t){this.stockChart.rangeNavigator.rangeSlider.performAnimation(e,t,this.stockChart.rangeNavigator,0)}}class No{constructor(e){this.selectedSeries="",this.selectedIndicator="",this.selectedTrendLine="",this.indicators=[],this.secondayIndicators=[],this.stockChart=e,this.selectedSeries=this.stockChart.series[0].type}initializePeriodSelector(){this.stockChart.periods=this.stockChart.tempPeriods,this.stockChart.periodSelector.rootControl=this.stockChart;const e=this.stockChart.chart.chartAxisLayoutPanel.seriesClipRect,t=Yt(this.stockChart.element.id+"_Secondary_Element");this.stockChart.periodSelector.appendSelector({thumbSize:0,element:t,width:e.width,height:this.stockChart.toolbarHeight},e.x),this.initializeSeriesSelector(),this.initializeIndicatorSelector(),this.initializeTrendlineSelector(),this.exportButton(),this.printButton(),this.resetButton()}getDropDownItems(e){const t=[];if(e===this.stockChart.seriesType){for(let i=0;i<e.length;i++)t.push({text:"&nbsp;&nbsp;&nbsp;"+e[i].toString()});for(let e=0;e<this.stockChart.series.length;e++)for(let i=0;i<t.length;i++){let s=t[i].text.replace("&nbsp;&nbsp;&nbsp;","");s="OHLC"===s?"HiloOpenClose":s,s===this.stockChart.series[e].type&&(t[i].text=t[i].text.replace("&nbsp;&nbsp;&nbsp;","&#10004&nbsp;"))}}else if(e===this.stockChart.exportType)for(let i=0;i<e.length;i++)t.push({text:e[i].toString()});else for(let i=0;i<e.length;i++)"Print"!==e[i].toString()&&t.push({text:"&nbsp;&nbsp;&nbsp;"+e[i].toString()});return t}addedSeries(e){const t=this.stockChart.series;for(let i=0;i<t.length;i++)if("volume"!==t[i].yName){t[i].type=e.indexOf("Candle")>-1?"Candle":e.indexOf("OHLC")>-1?"HiloOpenClose":e,t[i].enableSolidCandles="Candle"===e;for(let e=0;e<t[i].trendlines.length;e++){const s=t[i].trendlines[e];s.animation.enable=!1,s.enableTooltip=!1}}}initializeSeriesSelector(){new g.uw({items:this.getDropDownItems(this.stockChart.seriesType),select:e=>{this.selectedSeries=e.item.text;const t=this.tickMark(e);this.addedSeries(t),this.stockChart.cartesianChart.initializeChart(),this.stockChart.stockLegendModule&&this.stockChart.stockLegendModule.legendCollections.length&&this.stockChart.legendSettings.visible&&this.stockChart.stockLegendModule.renderLegend(this.stockChart,this.stockChart.legendSettings,this.stockChart.stockLegendModule.legendBounds)}}).appendTo("#"+this.stockChart.element.id+"_seriesType")}resetButton(){const e="isProtectedOnChange";this.stockChart[e]=!0,(new m.zx).appendTo("#"+this.stockChart.element.id+"_reset"),document.getElementById(this.stockChart.element.id+"_reset").onclick=()=>{let t=this.indicators.length;for(;t;)this.stockChart.indicators.pop(),t--;this.indicators=[],this.secondayIndicators=[],this.stockChart.isSingleAxis?this.stockChart.rows=[{}]:(this.stockChart.rows.length>2&&this.stockChart.rows.splice(2,this.stockChart.rows.length-1),this.stockChart.axes.length>2&&(this.stockChart.axes.splice(1,this.stockChart.axes.length-1),this.stockChart.axes[0].rowIndex=1));for(let e=0;e<this.stockChart.series.length;e++)"volume"!==this.stockChart.series[e].yName&&(this.stockChart.series[e].type=this.stockChart.tempSeriesType[e],0!==this.stockChart.series[e].trendlines.length&&(this.stockChart.series[e].trendlines[0].width=0));this.stockChart.indicatorElements=null,this.stockChart.resizeTo=null,this.stockChart.zoomChange=!1,this.stockChart.refresh(),this.stockChart[e]=!0}}initializeTrendlineSelector(){this.trendlineDropDown=new g.uw({items:this.stockChart.resizeTo?this.trendlineDropDown.items:this.getDropDownItems(this.stockChart.trendlineType),select:e=>{let t=this.tickMark(e);t=t.split(" ")[0].toLocaleLowerCase()+(t.split(" ")[1]?t.split(" ")[1]:""),t=t.substr(0,1).toUpperCase()+t.substr(1);const i=t;if(this.selectedTrendLine=""===this.selectedTrendLine?i:this.selectedTrendLine+","+i,this.trendline!==i){this.trendline=i;for(let e=0;e<this.stockChart.series.length;e++)if("volume"!==this.stockChart.series[e].yName)if(0===this.stockChart.series[0].trendlines.length){let e;this.stockChart.trendlinetriggered&&(e=[{type:i,width:1,enableTooltip:!1}],this.stockChart.trendlinetriggered=!1),this.stockChart.series[0].trendlines=e}else this.stockChart.series[0].trendlines[0].width=1,this.stockChart.series[0].trendlines[0].type=i,this.stockChart.series[0].trendlines[0].animation.enable=!!this.stockChart.trendlinetriggered;this.stockChart.cartesianChart.initializeChart()}else e.item.text="&nbsp;&nbsp;&nbsp;"+e.item.text.replace("&#10004&nbsp;",""),this.stockChart.series[0].trendlines[0].width=0,this.trendline=null,this.stockChart.cartesianChart.initializeChart()}}),this.trendlineDropDown.appendTo("#"+this.stockChart.element.id+"_trendType")}initializeIndicatorSelector(){this.indicatorDropDown=new g.uw({items:this.stockChart.resizeTo?this.indicatorDropDown.items:this.getDropDownItems(this.stockChart.indicatorType),select:e=>{for(let s=0;s<this.stockChart.series.length;s++)0!==this.stockChart.series[s].trendlines.length&&(this.stockChart.series[s].trendlines[0].animation.enable=!1);e.item.text=e.item.text.indexOf("&#10004&nbsp;")>=0?e.item.text.substr(e.item.text.indexOf(";")+1):e.item.text;let t=e.item.text.replace("&nbsp;&nbsp;&nbsp;","");t=t.split(" ")[0].toLocaleLowerCase()+(t.split(" ")[1]?t.split(" ")[1]:""),t=t.substr(0,1).toUpperCase()+t.substr(1);const i=t;if(this.selectedIndicator=-1===this.selectedIndicator.indexOf(i)?this.selectedIndicator+" "+i:this.selectedIndicator.replace(i,""),"Tma"===i||"BollingerBands"===i||"Sma"===i||"Ema"===i)if(-1===this.indicators.indexOf(i)){e.item.text="&#10004&nbsp;"+e.item.text.replace("&nbsp;&nbsp;&nbsp;","");const t=this.getIndicator(i,this.stockChart.series[0].yAxisName);this.indicators.push(i),this.stockChart.indicators=this.stockChart.indicators.concat(t),this.stockChart.cartesianChart.initializeChart()}else{e.item.text="&nbsp;&nbsp;&nbsp;"+e.item.text;for(let e=0;e<this.stockChart.indicators.length;e++)this.stockChart.indicators[e].type===i&&this.stockChart.indicators.splice(e,1);this.indicators.splice(this.indicators.indexOf(i),1),this.stockChart.cartesianChart.initializeChart()}else this.createIndicatorAxes(i,e)}}),this.indicatorDropDown.appendTo("#"+this.stockChart.element.id+"_indicatorType")}getIndicator(e,t){const i=this.stockChart.series[0];return[{type:e,period:3,yAxisName:t,dataSource:i.localData,xName:i.xName,open:i.open,close:i.close,high:i.high,low:i.low,volume:i.volume,fill:"Sma"===e?"#32CD32":"#6063ff",animation:{enable:!1},upperLine:{color:"#FFE200",width:1},periodLine:{width:2},lowerLine:{color:"#FAA512",width:1},fastPeriod:8,slowPeriod:5,macdType:"Both",width:1,macdPositiveColor:"#6EC992",macdNegativeColor:"#FF817F",bandColor:"rgba(245, 203, 35, 0.12)"}]}createIndicatorAxes(e,t){if(-1===this.indicators.indexOf(e)){t.item.text="&#10004&nbsp;"+t.item.text.replace("&nbsp;&nbsp;&nbsp;",""),this.indicators.push(e);const i=this.stockChart.rows.length;this.stockChart.rows[this.stockChart.rows.length-1].height="15%";const s=[{height:100-15*i+"px"}];if(1===this.stockChart.rows.length&&(this.stockChart.isSingleAxis=!0),this.stockChart.rows=this.stockChart.rows.concat(s),this.stockChart.isSingleAxis)for(let e=0;e<this.stockChart.axes.length;e++)this.stockChart.axes[e].rowIndex+=1;else this.stockChart.axes[0].rowIndex+=1;const o=[{plotOffset:10,opposedPosition:!0,rowIndex:this.stockChart.isSingleAxis?0:this.stockChart.axes.length,desiredIntervals:1,labelFormat:"n2",majorGridLines:this.stockChart.primaryYAxis.majorGridLines,lineStyle:this.stockChart.primaryYAxis.lineStyle,labelPosition:this.stockChart.primaryYAxis.labelPosition,majorTickLines:this.stockChart.primaryYAxis.majorTickLines,rangePadding:"None",name:e.toString()}];this.stockChart.axes=this.stockChart.axes.concat(o),this.stockChart.primaryYAxis.rowIndex=this.stockChart.isSingleAxis?i+1:0;const l=this.getIndicator(e,e.toString());this.stockChart.indicators=this.stockChart.indicators.concat(l),this.stockChart.cartesianChart.initializeChart()}else{t.item.text="&nbsp;&nbsp;&nbsp;"+t.item.text;for(let t=0;t<this.stockChart.indicators.length;t++)this.stockChart.indicators[t].type===e&&this.stockChart.indicators.splice(t,1);this.indicators.splice(this.indicators.indexOf(e),1);let i=0;for(let t=0;t<this.stockChart.axes.length;t++)this.stockChart.axes[t].name===e&&(i=this.stockChart.axes[t].rowIndex,this.stockChart.rows.splice(t,1),this.stockChart.axes.splice(t,1));for(let e=0;e<this.stockChart.axes.length;e++)0!==this.stockChart.axes[e].rowIndex&&this.stockChart.axes[e].rowIndex>i&&(this.stockChart.axes[e].rowIndex=this.stockChart.axes[e].rowIndex-1);this.stockChart.cartesianChart.initializeChart()}}tickMark(e){let t;const i=e.item.parentObj.items;for(let s=0;s<i.length;s++)i[s].text=i[s].text.indexOf("&#10004&nbsp;")>=0?i[s].text.substr(i[s].text.indexOf(";")+1):i[s].text,i[s].text.indexOf("&nbsp;&nbsp;&nbsp;")>=0||(i[s].text="&nbsp;&nbsp;&nbsp;"+i[s].text);return e.item.text.indexOf("&nbsp;&nbsp;&nbsp;")>=0?(t=e.item.text.replace("&nbsp;&nbsp;&nbsp;",""),e.item.text=e.item.text.replace("&nbsp;&nbsp;&nbsp;","&#10004&nbsp;")):t=e.item.text.replace("&#10004&nbsp;",""),t}printButton(){this.stockChart.exportType.indexOf("Print")>-1&&((new m.zx).appendTo("#"+this.stockChart.element.id+"_print"),document.getElementById(this.stockChart.element.id+"_print").onclick=()=>{this.stockChart.chart.print(this.stockChart.element.id)})}exportButton(){new g.uw({items:this.getDropDownItems(this.stockChart.exportType),select:e=>{const t=e.item.text,i=this.stockChart,s=i.element.id+"_stockChart_";let o;const l=i.svgObject.getBoundingClientRect();i.chart.exportModule&&(this.stockChart.svgObject.insertAdjacentElement("afterbegin",this.addExportSettings()),o=i.svgObject.firstElementChild.getBoundingClientRect(),this.stockChart.svgObject.setAttribute("height",(l.height+o.height).toString()),Yt(s+"chart").style.transform="translateY("+o.height+"px)",i.enableSelector&&Yt(s+"rangeSelector").setAttribute("transform","translate(0,"+(i.cartesianChart.cartesianChartSize.height+o.height)+")"),i.chart.exportModule.export(t,"StockChart",null,[i],null,i.svgObject.clientHeight),(0,a.Od)(Yt(this.stockChart.element.id+"_additionalExport")),Yt(s+"chart").style.transform="translateY(0px)",i.enableSelector&&Yt(s+"rangeSelector").setAttribute("transform","translate(0,"+i.cartesianChart.cartesianChartSize.height+")"),this.stockChart.svgObject.setAttribute("height",l.height.toString()))}}).appendTo("#"+this.stockChart.element.id+"_export")}calculateAutoPeriods(){let e=[];return e=this.findRange(this.stockChart.seriesXMin,this.stockChart.seriesXMax),e.push({text:"YTD",selected:!0},{text:"All"}),e}findRange(e,t){const i=[];return(t-e)/3154e7>=1?i.push({text:"1M",interval:1,intervalType:"Months"},{text:"3M",interval:3,intervalType:"Months"},{text:"6M",interval:6,intervalType:"Months"},{text:"1Y",interval:1,intervalType:"Years"}):(t-e)/1577e7>=1?i.push({text:"1M",interval:1,intervalType:"Months"},{text:"3M",interval:3,intervalType:"Months"},{text:"6M",interval:6,intervalType:"Months"}):(t-e)/2628e6>=1?i.push({text:"1D",interval:1,intervalType:"Days"},{text:"3W",interval:3,intervalType:"Weeks"},{text:"1M",interval:1,intervalType:"Months"}):(t-e)/864e5>=1&&i.push({text:"1H",interval:1,intervalType:"Hours"},{text:"12H",interval:12,intervalType:"Hours"},{text:"1D",interval:1,intervalType:"Days"}),i}addExportSettings(){const e=this.stockChart.renderer.createGroup({id:this.stockChart.element.id+"_additionalExport",width:this.stockChart.availableSize.width}),t=S(this.stockChart.title,this.stockChart.titleStyle).height,i=new L(e.id+"_Title",Si(new C(0,0,this.stockChart.availableSize.width,0),this.stockChart.titleStyle),0,"middle",this.stockChart.title,"","text-before-edge");bi(this.stockChart.renderer,i,this.stockChart.titleStyle,this.stockChart.titleStyle.color,e);const s={size:"15px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};let o=S("Series: "+this.selectedSeries,s).width/2;const l=t;return this.textElementSpan(new L(e.id+"_Series",o,l,"start",["Series : ",this.selectedSeries],"","text-before-edge"),s,"black",e),o+=S("Series: "+this.selectedSeries+" Z",s).width,""!==this.selectedIndicator&&(this.textElementSpan(new L(e.id+"_Indicator",o,l,"start",["Indicator :",this.selectedIndicator],"","text-before-edge"),s,"black",e),o+=S("Indicator: "+this.selectedIndicator+" Z",s).width),""!==this.selectedTrendLine&&this.textElementSpan(new L(e.id+"_TrendLine",o,l,"start",["Trendline :",this.selectedTrendLine],"","text-before-edge"),s,"black",e),e}textElementSpan(e,t,i,s,o=!1,l,a,r=!1,n){const h=new y("");let d,c={};c={id:e.id,"font-style":t.fontStyle,"font-family":t.fontFamily,"font-weight":t.fontWeight,"text-anchor":e.anchor,x:e.x,y:e.y,fill:i,"font-size":t.size,transform:e.transform,opacity:t.opacity,"dominant-baseline":e.baseLine};const p="string"==typeof e.text?e.text:o?e.text[e.text.length-1]:e.text[0],u=h.createText(c,p);if("string"!=typeof e.text&&e.text.length>1)for(let g=1,m=e.text.length;g<m;g++)e.text[g]=" "+e.text[g],d=h.createTSpan({x:e.x+S(p,t).width+5,id:e.id,y:e.y,opacity:.5},e.text[g]),u.appendChild(d);return $t(!1,s,u,l,a,"x","y",null,null,r,!1,null,n),u}}var zo=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class _o extends a.rt{}zo([(0,a.Z9)("")],_o.prototype,"color",void 0),zo([(0,a.Z9)("16px")],_o.prototype,"size",void 0),zo([(0,a.Z9)("Segoe UI")],_o.prototype,"fontFamily",void 0),zo([(0,a.Z9)("Normal")],_o.prototype,"fontStyle",void 0),zo([(0,a.Z9)("Normal")],_o.prototype,"fontWeight",void 0),zo([(0,a.Z9)(1)],_o.prototype,"opacity",void 0),zo([(0,a.Z9)("Trim")],_o.prototype,"textOverflow",void 0),zo([(0,a.Z9)("Center")],_o.prototype,"textAlignment",void 0);class Bo extends a.rt{}zo([(0,a.Z9)("")],Bo.prototype,"color",void 0),zo([(0,a.Z9)(1)],Bo.prototype,"width",void 0);class Zo extends a.rt{}zo([(0,a.Zz)({},Bo)],Zo.prototype,"border",void 0),zo([(0,a.Z9)("transparent")],Zo.prototype,"background",void 0),zo([(0,a.Z9)(1)],Zo.prototype,"opacity",void 0);class Vo extends a.rt{}zo([(0,a.Z9)(10)],Vo.prototype,"left",void 0),zo([(0,a.Z9)(10)],Vo.prototype,"right",void 0),zo([(0,a.Z9)(10)],Vo.prototype,"top",void 0),zo([(0,a.Z9)(10)],Vo.prototype,"bottom",void 0);class jo extends a.rt{}zo([(0,a.Z9)(!1)],jo.prototype,"startFromAxis",void 0),zo([(0,a.Z9)(!0)],jo.prototype,"visible",void 0),zo([(0,a.Z9)(null)],jo.prototype,"start",void 0),zo([(0,a.Z9)("#808080")],jo.prototype,"color",void 0),zo([(0,a.Z9)(null)],jo.prototype,"end",void 0),zo([(0,a.Z9)(null)],jo.prototype,"size",void 0),zo([(0,a.Z9)("Auto")],jo.prototype,"sizeType",void 0),zo([(0,a.Z9)(null)],jo.prototype,"dashArray",void 0),zo([(0,a.Z9)(!1)],jo.prototype,"isRepeat",void 0),zo([(0,a.Z9)(null)],jo.prototype,"repeatEvery",void 0),zo([(0,a.Z9)(!1)],jo.prototype,"isSegmented",void 0),zo([(0,a.Z9)(null)],jo.prototype,"repeatUntil",void 0),zo([(0,a.Z9)(null)],jo.prototype,"segmentStart",void 0),zo([(0,a.Z9)(null)],jo.prototype,"segmentAxisName",void 0),zo([(0,a.Z9)(null)],jo.prototype,"segmentEnd",void 0),zo([(0,a.Z9)(1)],jo.prototype,"opacity",void 0),zo([(0,a.Z9)("")],jo.prototype,"text",void 0),zo([(0,a.Zz)({color:"transparent",width:1},Bo)],jo.prototype,"border",void 0),zo([(0,a.Z9)(null)],jo.prototype,"rotation",void 0),zo([(0,a.Z9)("Behind")],jo.prototype,"zIndex",void 0),zo([(0,a.Z9)("Middle")],jo.prototype,"horizontalAlignment",void 0),zo([(0,a.Z9)("Middle")],jo.prototype,"verticalAlignment",void 0),zo([(0,a.Zz)(B.stripLineLabelFont,_o)],jo.prototype,"textStyle",void 0);class Ho extends a.rt{}zo([(0,a.Z9)(0)],Ho.prototype,"delay",void 0),zo([(0,a.Z9)(!1)],Ho.prototype,"enable",void 0),zo([(0,a.Z9)(1e3)],Ho.prototype,"duration",void 0);class qo extends a.rt{}zo([(0,a.Z9)(null)],qo.prototype,"fill",void 0),zo([(0,a.Z9)("Gap")],qo.prototype,"mode",void 0),zo([(0,a.Zz)({color:"transparent",width:0},Bo)],qo.prototype,"border",void 0);class Go extends a.rt{}zo([(0,a.Z9)("Line")],Go.prototype,"type",void 0),zo([(0,a.Z9)(null)],Go.prototype,"length",void 0),zo([(0,a.Z9)(null)],Go.prototype,"color",void 0),zo([(0,a.Z9)("")],Go.prototype,"dashArray",void 0),zo([(0,a.Z9)(1)],Go.prototype,"width",void 0);class Yo extends a.rt{constructor(){super(...arguments),this.localData=void 0}}zo([(0,a.Z9)("date")],Yo.prototype,"xName",void 0),zo([(0,a.Z9)("close")],Yo.prototype,"yName",void 0),zo([(0,a.Z9)("open")],Yo.prototype,"open",void 0),zo([(0,a.Z9)("close")],Yo.prototype,"close",void 0),zo([(0,a.Z9)("high")],Yo.prototype,"high",void 0),zo([(0,a.Z9)("low")],Yo.prototype,"low",void 0),zo([(0,a.Z9)("volume")],Yo.prototype,"volume",void 0),zo([(0,a.Z9)("")],Yo.prototype,"pointColorMapping",void 0),zo([(0,a.Z9)("SeriesType")],Yo.prototype,"legendShape",void 0),zo([(0,a.Z9)("")],Yo.prototype,"legendImageUrl",void 0),zo([(0,a.Zz)(null,Ho)],Yo.prototype,"animation",void 0),zo([(0,a.Z9)(null)],Yo.prototype,"xAxisName",void 0),zo([(0,a.Z9)(null)],Yo.prototype,"yAxisName",void 0),zo([(0,a.Z9)(null)],Yo.prototype,"fill",void 0),zo([(0,a.Z9)("0")],Yo.prototype,"dashArray",void 0),zo([(0,a.Z9)(1)],Yo.prototype,"width",void 0),zo([(0,a.Z9)("")],Yo.prototype,"name",void 0),zo([(0,a.Z9)("")],Yo.prototype,"dataSource",void 0),zo([(0,a.Z9)()],Yo.prototype,"query",void 0),zo([(0,a.Z9)("#e74c3d")],Yo.prototype,"bullFillColor",void 0),zo([(0,a.Z9)("#2ecd71")],Yo.prototype,"bearFillColor",void 0),zo([(0,a.Z9)(!1)],Yo.prototype,"enableSolidCandles",void 0),zo([(0,a.Z9)(!0)],Yo.prototype,"visible",void 0),zo([(0,a.Zz)({color:"transparent",width:0},Bo)],Yo.prototype,"border",void 0),zo([(0,a.Z9)(1)],Yo.prototype,"opacity",void 0),zo([(0,a.Z9)("Candle")],Yo.prototype,"type",void 0),zo([(0,a.Zz)(null,Vi)],Yo.prototype,"marker",void 0),zo([(0,a.FE)([],Hi)],Yo.prototype,"trendlines",void 0),zo([(0,a.Z9)(!0)],Yo.prototype,"enableTooltip",void 0),zo([(0,a.Z9)("")],Yo.prototype,"tooltipMappingName",void 0),zo([(0,a.Z9)(null)],Yo.prototype,"selectionStyle",void 0),zo([(0,a.Z9)(.5)],Yo.prototype,"cardinalSplineTension",void 0),zo([(0,a.Zz)(null,K)],Yo.prototype,"cornerRadius",void 0),zo([(0,a.Zz)(null,qo)],Yo.prototype,"emptyPointSettings",void 0),zo([(0,a.Z9)(null)],Yo.prototype,"columnWidth",void 0),zo([(0,a.Z9)(0)],Yo.prototype,"columnSpacing",void 0);class Wo extends a.rt{}zo([(0,a.Z9)("Sma")],Wo.prototype,"type",void 0),zo([(0,a.Z9)(14)],Wo.prototype,"period",void 0),zo([(0,a.Z9)(3)],Wo.prototype,"dPeriod",void 0),zo([(0,a.Z9)(14)],Wo.prototype,"kPeriod",void 0),zo([(0,a.Z9)(80)],Wo.prototype,"overBought",void 0),zo([(0,a.Z9)(20)],Wo.prototype,"overSold",void 0),zo([(0,a.Z9)("Close")],Wo.prototype,"field",void 0),zo([(0,a.Z9)(2)],Wo.prototype,"standardDeviation",void 0),zo([(0,a.Z9)(12)],Wo.prototype,"slowPeriod",void 0),zo([(0,a.Z9)(!0)],Wo.prototype,"showZones",void 0),zo([(0,a.Z9)(26)],Wo.prototype,"fastPeriod",void 0),zo([(0,a.Zz)({color:"#ff9933",width:2},Go)],Wo.prototype,"macdLine",void 0),zo([(0,a.Z9)("Both")],Wo.prototype,"macdType",void 0),zo([(0,a.Z9)("#e74c3d")],Wo.prototype,"macdNegativeColor",void 0),zo([(0,a.Z9)("#2ecd71")],Wo.prototype,"macdPositiveColor",void 0),zo([(0,a.Z9)("rgba(211,211,211,0.25)")],Wo.prototype,"bandColor",void 0),zo([(0,a.Zz)({color:"#ffb735",width:1},Go)],Wo.prototype,"upperLine",void 0),zo([(0,a.Z9)("")],Wo.prototype,"seriesName",void 0),zo([(0,a.Zz)({color:"#f2ec2f",width:1},Go)],Wo.prototype,"periodLine",void 0),zo([(0,a.Zz)({color:"#f2ec2f",width:1},Go)],Wo.prototype,"lowerLine",void 0),zo([(0,a.Z9)("")],Wo.prototype,"high",void 0),zo([(0,a.Z9)("")],Wo.prototype,"open",void 0),zo([(0,a.Z9)("")],Wo.prototype,"low",void 0),zo([(0,a.Z9)("")],Wo.prototype,"xName",void 0),zo([(0,a.Z9)("")],Wo.prototype,"close",void 0),zo([(0,a.Z9)("")],Wo.prototype,"pointColorMapping",void 0),zo([(0,a.Z9)("")],Wo.prototype,"volume",void 0),zo([(0,a.Z9)(null)],Wo.prototype,"xAxisName",void 0),zo([(0,a.Z9)(null)],Wo.prototype,"yAxisName",void 0),zo([(0,a.Zz)(null,Ho)],Wo.prototype,"animation",void 0),zo([(0,a.Z9)(null)],Wo.prototype,"fill",void 0),zo([(0,a.Z9)("0")],Wo.prototype,"dashArray",void 0),zo([(0,a.Z9)(1)],Wo.prototype,"width",void 0),zo([(0,a.Z9)()],Wo.prototype,"query",void 0),zo([(0,a.Z9)("")],Wo.prototype,"dataSource",void 0);class Uo extends a.rt{}zo([(0,a.Zz)({},st)],Uo.prototype,"crosshairTooltip",void 0),zo([(0,a.Zz)(B.axisLabelFont,_o)],Uo.prototype,"labelStyle",void 0),zo([(0,a.Z9)("")],Uo.prototype,"title",void 0),zo([(0,a.Zz)(B.axisTitleFont,_o)],Uo.prototype,"titleStyle",void 0),zo([(0,a.Z9)("")],Uo.prototype,"labelFormat",void 0),zo([(0,a.Z9)("DateTime")],Uo.prototype,"skeletonType",void 0),zo([(0,a.Z9)("")],Uo.prototype,"skeleton",void 0),zo([(0,a.Z9)(0)],Uo.prototype,"plotOffset",void 0),zo([(0,a.Z9)(10)],Uo.prototype,"logBase",void 0),zo([(0,a.Z9)(0)],Uo.prototype,"rowIndex",void 0),zo([(0,a.Z9)(1)],Uo.prototype,"span",void 0),zo([(0,a.Z9)(3)],Uo.prototype,"maximumLabels",void 0),zo([(0,a.Z9)(null)],Uo.prototype,"desiredIntervals",void 0),zo([(0,a.Z9)(1)],Uo.prototype,"zoomFactor",void 0),zo([(0,a.Z9)(0)],Uo.prototype,"zoomPosition",void 0),zo([(0,a.Z9)(!1)],Uo.prototype,"opposedPosition",void 0),zo([(0,a.Z9)(!0)],Uo.prototype,"enableAutoIntervalOnZooming",void 0),zo([(0,a.Z9)("Double")],Uo.prototype,"valueType",void 0),zo([(0,a.Z9)("Auto")],Uo.prototype,"rangePadding",void 0),zo([(0,a.Z9)("None")],Uo.prototype,"edgeLabelPlacement",void 0),zo([(0,a.Z9)("BetweenTicks")],Uo.prototype,"labelPlacement",void 0),zo([(0,a.Z9)("Auto")],Uo.prototype,"intervalType",void 0),zo([(0,a.Z9)("Outside")],Uo.prototype,"tickPosition",void 0),zo([(0,a.Z9)("")],Uo.prototype,"name",void 0),zo([(0,a.Z9)("Outside")],Uo.prototype,"labelPosition",void 0),zo([(0,a.Z9)(!0)],Uo.prototype,"visible",void 0),zo([(0,a.Z9)(0)],Uo.prototype,"labelRotation",void 0),zo([(0,a.Z9)(0)],Uo.prototype,"minorTicksPerInterval",void 0),zo([(0,a.Z9)(null)],Uo.prototype,"crossesAt",void 0),zo([(0,a.Z9)(null)],Uo.prototype,"crossesInAxis",void 0),zo([(0,a.Z9)(!0)],Uo.prototype,"placeNextToAxisLine",void 0),zo([(0,a.Z9)(null)],Uo.prototype,"minimum",void 0),zo([(0,a.Z9)(null)],Uo.prototype,"interval",void 0),zo([(0,a.Z9)(null)],Uo.prototype,"maximum",void 0),zo([(0,a.Z9)(34)],Uo.prototype,"maximumLabelWidth",void 0),zo([(0,a.Zz)({},tt)],Uo.prototype,"majorTickLines",void 0),zo([(0,a.Z9)(!1)],Uo.prototype,"enableTrim",void 0),zo([(0,a.Zz)({},it)],Uo.prototype,"minorTickLines",void 0),zo([(0,a.Zz)({},$e)],Uo.prototype,"minorGridLines",void 0),zo([(0,a.Zz)({},Ke)],Uo.prototype,"majorGridLines",void 0),zo([(0,a.Zz)({},et)],Uo.prototype,"lineStyle",void 0),zo([(0,a.Z9)(!1)],Uo.prototype,"isInversed",void 0),zo([(0,a.Z9)("Trim")],Uo.prototype,"labelIntersectAction",void 0),zo([(0,a.Z9)(100)],Uo.prototype,"coefficient",void 0),zo([(0,a.Z9)(0)],Uo.prototype,"startAngle",void 0),zo([(0,a.Z9)(2)],Uo.prototype,"tabIndex",void 0),zo([(0,a.FE)([],jo)],Uo.prototype,"stripLines",void 0),zo([(0,a.Z9)(null)],Uo.prototype,"description",void 0);class Xo extends a.rt{}zo([(0,a.Z9)("100%")],Xo.prototype,"height",void 0),zo([(0,a.Zz)({},Bo)],Xo.prototype,"border",void 0);class Qo extends a.rt{}zo([(0,a.Z9)(2)],Qo.prototype,"period",void 0),zo([(0,a.Z9)("")],Qo.prototype,"name",void 0),zo([(0,a.Z9)("Linear")],Qo.prototype,"type",void 0),zo([(0,a.Z9)(2)],Qo.prototype,"polynomialOrder",void 0),zo([(0,a.Z9)(0)],Qo.prototype,"forwardForecast",void 0),zo([(0,a.Z9)(0)],Qo.prototype,"backwardForecast",void 0),zo([(0,a.Zz)({},Ho)],Qo.prototype,"animation",void 0),zo([(0,a.Z9)(!0)],Qo.prototype,"enableTooltip",void 0),zo([(0,a.Zz)({},Vi)],Qo.prototype,"marker",void 0),zo([(0,a.Z9)(null)],Qo.prototype,"intercept",void 0),zo([(0,a.Z9)("")],Qo.prototype,"fill",void 0),zo([(0,a.Z9)("SeriesType")],Qo.prototype,"legendShape",void 0),zo([(0,a.Z9)(1)],Qo.prototype,"width",void 0);class Jo extends a.rt{}zo([(0,a.Z9)("0")],Jo.prototype,"y",void 0),zo([(0,a.Z9)("0")],Jo.prototype,"x",void 0),zo([(0,a.Z9)(null)],Jo.prototype,"content",void 0),zo([(0,a.Z9)("Chart")],Jo.prototype,"region",void 0),zo([(0,a.Z9)("Center")],Jo.prototype,"horizontalAlignment",void 0),zo([(0,a.Z9)("Pixel")],Jo.prototype,"coordinateUnits",void 0),zo([(0,a.Z9)("Middle")],Jo.prototype,"verticalAlignment",void 0),zo([(0,a.Z9)(null)],Jo.prototype,"yAxisName",void 0),zo([(0,a.Z9)(null)],Jo.prototype,"description",void 0),zo([(0,a.Z9)(null)],Jo.prototype,"xAxisName",void 0);class Ko extends a.rt{}zo([(0,a.Z9)(0)],Ko.prototype,"point",void 0),zo([(0,a.Z9)(0)],Ko.prototype,"series",void 0);class $o extends a.rt{}zo([(0,a.Z9)("Circle")],$o.prototype,"type",void 0),zo([(0,a.Z9)("")],$o.prototype,"text",void 0),zo([(0,a.Z9)("")],$o.prototype,"description",void 0),zo([(0,a.Z9)()],$o.prototype,"date",void 0),zo([(0,a.Zz)({color:"black",width:1},Bo)],$o.prototype,"border",void 0),zo([(0,a.Z9)("transparent")],$o.prototype,"background",void 0),zo([(0,a.Z9)(!0)],$o.prototype,"showOnSeries",void 0),zo([(0,a.Z9)("close")],$o.prototype,"placeAt",void 0),zo([(0,a.Zz)(B.stockEventFont,_o)],$o.prototype,"textStyle",void 0),zo([(0,a.Z9)([])],$o.prototype,"seriesIndexes",void 0);class el extends _s{constructor(e){super(e.chart),this.symbolLocations=[],this.stockChart=e,this.chartId=this.stockChart.element.id}renderStockEvents(){const e=this.stockChart;let t,i,s;const o=e.renderer.createGroup({id:this.chartId+"_StockEvents"});this.symbolLocations=function(e,t,i){const s=[];for(let o=0;o<e;++o){const e=[];for(let s=0;s<t;++s)e[s]=i;s[o]=e}return s}(e.series.length,e.stockEvents.length,new Ri(0,0));for(let l=0;l<e.stockEvents.length;l++){t=this.stockChart.stockEvents[l];for(const a of e.chart.series){const r={name:Fe,stockChart:e,text:t.text,type:t.type,cancel:!1,series:a};if(e.trigger(Fe,r),t.text=r.text,t.type=r.type,s=S(t.text+"W",t.textStyle),!r.cancel&&(i=e.renderer.createGroup({id:this.chartId+"_Series_"+a.index+"_StockEvents_"+l}),pt(this.stockChart.isBlazor?Date.parse(t.date.toString()):this.dateParse(t.date).getTime(),a.xAxis.visibleRange)))if(t.seriesIndexes.length>0)for(let e=0;e<t.seriesIndexes.length;e++)t.seriesIndexes[e]===a.index&&o.appendChild(this.creatEventGroup(i,a,t,l,s));else o.appendChild(this.creatEventGroup(i,a,t,l,s))}}return o}creatEventGroup(e,t,i,s,o){const l=this.findClosePoint(t,i);return i.showOnSeries||(l.y=t.yAxis.rect.y+t.yAxis.rect.height),this.symbolLocations[t.index][s]=l,this.createStockElements(e,i,t,s,l,o),e}findClosePoint(e,t){const i=this.stockChart.isBlazor?Date.parse(t.date.toString()):this.dateParse(t.date).getTime(),s=this.getClosest(e,i);let o,l,a;for(let n=0;n<e.points.length;n++)l=e.points[n],(s===l.xValue&&l.visible||0!==n&&n!==e.points.length&&s>e.points[n-1].xValue&&s<e.points[n+1].xValue)&&(o=new ki(l,e));const r=e.xAxis.rect.x+wt(o.point.xValue,e.xAxis)*e.xAxis.rect.width;return a=wt(o.point[t.placeAt],e.yAxis)*e.yAxis.rect.height,a=-1*a+(e.yAxis.rect.y+e.yAxis.rect.height),new Ri(r,a)}createStockElements(e,t,i,s,o,l){const a=new w(l.width>20?l.width:20,l.height>20?l.height:20);let r,n;const h=o.x,d=o.y,c=this.chartId+"_Series_"+i.index+"_StockEvents_"+s,p=t.border;switch(t.type){case"Flag":case"Circle":case"Square":e.appendChild(qt(new Ri(h,d),"Circle",new w(2,2),"",new I(c+"_Circle","transparent",p.width,p.color),this.dateParse(t.date).toISOString())),e.appendChild(qt(new Ri(h,d-5),"VerticalLine",new w(9,9),"",new I(c+"_Path",p.color,p.width,p.color),this.dateParse(t.date).toISOString())),e.appendChild(qt(new Ri("Flag"!==t.type?h:h+a.width/2,d-a.height),t.type,a,"",new I(c+"_Shape",t.background,p.width,p.color),this.dateParse(t.date).toISOString())),bi(this.stockChart.renderer,new L(c+"_Text","Flag"!==t.type?o.x:o.x+a.width/2,o.y-a.height,"middle",t.text,"","middle"),t.textStyle,t.textStyle.color,e);break;case"ArrowUp":case"ArrowDown":case"ArrowRight":case"ArrowLeft":r="M "+h+" "+d+" "+this.findArrowpaths(t.type),n=new I(c+"_Shape",t.background,p.width,p.color,1,"",r),e.appendChild(this.stockChart.renderer.drawPath(n));break;case"Triangle":case"InvertedTriangle":a.height=3*l.height,a.width=l.width+1.5*l.width,e.appendChild(qt(new Ri(o.x,o.y),t.type,new w(20,20),"",new I(c+"_Shape",t.background,p.width,p.color),this.dateParse(t.date).toISOString())),bi(this.stockChart.renderer,new L(c+"_Text",o.x,o.y,"middle",t.text,"","middle"),t.textStyle,t.textStyle.color,e);break;case"Text":l.height+=8,r="M "+h+" "+d+" L "+(h-5)+" "+(d-5)+" L "+(h-l.width/2)+" "+(d-5)+" L "+(h-l.width/2)+" "+(d-l.height)+" L "+(h+l.width/2)+" "+(d-l.height)+" L "+(h+l.width/2)+" "+(d-5)+" L "+(h+5)+" "+(d-5)+" Z",n=new I(c+"_Shape",t.background,p.width,p.color,1,"",r),e.appendChild(this.stockChart.renderer.drawPath(n)),bi(this.stockChart.renderer,new L(c+"_Text",h,d-l.height/2,"middle",t.text,"","middle"),t.textStyle,t.textStyle.color,e);break;default:r="M "+h+" "+d+" L "+(h-l.width/2)+" "+(d-l.height/3)+" L "+(h-l.width/2)+" "+(d-l.height)+" L "+(h+l.width/2)+" "+(d-l.height)+" L "+(h+l.width/2)+" "+(d-l.height/3)+" Z",n=new I(c+"_Shape",t.background,p.width,p.color,1,"",r),e.appendChild(this.stockChart.renderer.drawPath(n)),bi(this.stockChart.renderer,new L(c+"_Text",h,d-l.height/2,"middle",t.text,"","middle"),t.textStyle,t.textStyle.color,e)}}renderStockEventTooltip(e){const t=parseInt(e.split("_StockEvents_")[0].split(this.chartId+"_Series_")[1],10),i=parseInt(e.split("_StockEvents_")[1].replace(/\D+/g,""),10),s=this.symbolLocations[t][i],o=new Ri(s.x,s.y+this.stockChart.toolbarHeight+this.stockChart.titleSize.height);this.applyHighLights(i,t);const l=this.getElement(this.chartId+"_StockEvents_Tooltip_svg");if(l&&parseInt(l.getAttribute("opacity"),10)>0)this.stockEventTooltip.content=[this.stockChart.stockEvents[i].description],this.stockEventTooltip.location=o,this.stockEventTooltip.dataBind();else{Yt(this.chartId+"_StockEvents_Tooltip_svg")&&(0,a.Od)(Yt(this.chartId+"_StockEvents_Tooltip"));const e=(0,a.az)("div",{id:this.chartId+"_StockEvents_Tooltip",className:"ejSVGTooltip",attrs:{style:"pointer-events:none; position:absolute;z-index: 1"}});Yt(this.chartId+"_Secondary_Element").appendChild(e),this.stockEventTooltip=new _({opacity:1,header:"",content:[this.stockChart.stockEvents[i].description],enableAnimation:!0,location:o,theme:this.stockChart.theme,inverted:!0,areaBounds:this.stockChart.chart.chartAxisLayoutPanel.seriesClipRect}),this.stockEventTooltip.areaBounds.y+=this.stockChart.toolbarHeight+this.stockChart.titleSize.height,this.stockEventTooltip.appendTo("#"+e.id)}}removeStockEventTooltip(e){const t=this.getElement(this.chartId+"_StockEvents_Tooltip");this.stopAnimation(),t&&this.stockEventTooltip&&(this.toolTipInterval=+setTimeout(()=>{this.stockEventTooltip.fadeOut(),this.removeHighLights()},e))}findArrowpaths(e){let t="";switch(e){case"ArrowUp":t="l -10 10 l 5 0 l 0 10 l 10 0 l 0 -10 l 5 0 z";break;case"ArrowDown":t="l -10 -10 l 5 0 l 0 -10 l 10 0 l 0 10 l 5 0 z";break;case"ArrowLeft":t="l -10 -10 l 0 5 l -10 0 l 0 10 l 10 0 l 0 5 z";break;case"ArrowRight":t="l 10 -10 l 0 5 l 10 0 l 0 10 l -10 0 l 0 5 z"}return t}applyHighLights(e,t){this.pointIndex===e&&this.seriesIndex===t||this.removeHighLights(),this.pointIndex=e,this.seriesIndex=t;const i=this.chartId+"_Series_"+t+"_StockEvents_"+e;this.setOpacity(i+"_Shape",.5),this.setOpacity(i+"_Text",.5)}removeHighLights(){const e=this.chartId+"_Series_"+this.seriesIndex+"_StockEvents_"+this.pointIndex;this.setOpacity(e+"_Shape",1),this.setOpacity(e+"_Text",1)}setOpacity(e,t){Yt(e)&&Yt(e).setAttribute("opacity",t.toString())}dateParse(e){const t=this.chart.intl.getDateParser({skeleton:"full",type:"dateTime"}),i=this.chart.intl.getDateFormat({skeleton:"full",type:"dateTime"});return new Date(Date.parse(t(i(new Date(r.j4.parse.parseJson({val:e}).val)))))}}var tl=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class il extends a.rt{}tl([(0,a.Z9)(!1)],il.prototype,"visible",void 0),tl([(0,a.Z9)(null)],il.prototype,"height",void 0),tl([(0,a.Z9)(null)],il.prototype,"width",void 0),tl([(0,a.Zz)({x:0,y:0},$i)],il.prototype,"location",void 0),tl([(0,a.Z9)("Auto")],il.prototype,"position",void 0),tl([(0,a.Z9)("Series")],il.prototype,"mode",void 0),tl([(0,a.Z9)(8)],il.prototype,"padding",void 0),tl([(0,a.Z9)("Center")],il.prototype,"alignment",void 0),tl([(0,a.Zz)(B.legendLabelFont,_o)],il.prototype,"textStyle",void 0),tl([(0,a.Z9)(10)],il.prototype,"shapeHeight",void 0),tl([(0,a.Z9)(10)],il.prototype,"shapeWidth",void 0),tl([(0,a.Zz)({},Bo)],il.prototype,"border",void 0),tl([(0,a.Zz)({left:0,right:0,top:0,bottom:0},Vo)],il.prototype,"margin",void 0),tl([(0,a.Zz)({left:0,right:0,top:0,bottom:0},X)],il.prototype,"containerPadding",void 0),tl([(0,a.Z9)(5)],il.prototype,"shapePadding",void 0),tl([(0,a.Z9)("transparent")],il.prototype,"background",void 0),tl([(0,a.Z9)(1)],il.prototype,"opacity",void 0),tl([(0,a.Z9)(!0)],il.prototype,"toggleVisibility",void 0),tl([(0,a.Z9)(null)],il.prototype,"description",void 0),tl([(0,a.Z9)(3)],il.prototype,"tabIndex",void 0),tl([(0,a.Z9)(null)],il.prototype,"title",void 0),tl([(0,a.Zz)(B.legendTitleFont,_o)],il.prototype,"titleStyle",void 0),tl([(0,a.Z9)("Top")],il.prototype,"titlePosition",void 0),tl([(0,a.Z9)(100)],il.prototype,"maximumTitleWidth",void 0),tl([(0,a.Z9)(!0)],il.prototype,"enablePages",void 0),tl([(0,a.Z9)(!1)],il.prototype,"isInversed",void 0);var sl=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};let ol=class extends a.wA{constructor(e,t){super(e,t),this.isSingleAxis=!1,this.chartid=57723,this.tempSeriesType=[],this.zoomChange=!1,this.allowPan=!1,this.onPanning=!1,this.trendlinetriggered=!0,this.initialRender=!0,this.rangeFound=!1,this.tempPeriods=[],this.toolbarHeight=this.enablePeriodSelector?a.AR.isDevice?56:42:0}onPropertyChanged(e,t){for(const i of Object.keys(e))switch(i){case"series":this.render()}}rangeChanged(e,t){const i=document.getElementById(this.chartObject.id);if(i)for(;i.firstChild;)i.removeChild(i.firstChild);this.startValue=e,this.endValue=t,this.cartesianChart.initializeChart(),this.periodSelector.datePicker.startDate=new Date(e),this.periodSelector.datePicker.endDate=new Date(t),this.periodSelector.datePicker.dataBind()}preRender(){this.isBlazor=window.Blazor,this.unWireEvents(),this.initPrivateVariable(),this.allowServerDataBinding=!1,this.isProtectedOnChange=!0,this.setCulture(),this.wireEvents()}unWireEvents(){const e=a.AR.touchMoveEvent,t=a.AR.touchEndEvent,i=a.AR.isPointer?"pointerleave":"mouseleave";a.bi.remove(this.element,a.AR.touchStartEvent,this.stockChartOnMouseDown),a.bi.remove(this.element,e,this.stockChartOnMouseMove),a.bi.remove(this.element,t,this.stockChartMouseEnd),a.bi.remove(this.element,"click",this.stockChartOnMouseClick),a.bi.remove(this.element,"contextmenu",this.stockChartRightClick),a.bi.remove(this.element,i,this.stockChartOnMouseLeave),window.removeEventListener(a.AR.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.stockChartResize)}wireEvents(){const e=a.AR.isPointer?"pointerleave":"mouseleave";a.bi.add(this.element,a.AR.touchStartEvent,this.stockChartOnMouseDown,this),a.bi.add(this.element,a.AR.touchMoveEvent,this.stockChartOnMouseMove,this),a.bi.add(this.element,a.AR.touchEndEvent,this.stockChartMouseEnd,this),a.bi.add(this.element,"click",this.stockChartOnMouseClick,this),a.bi.add(this.element,"contextmenu",this.stockChartRightClick,this),a.bi.add(this.element,e,this.stockChartOnMouseLeave,this),window.addEventListener(a.AR.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.stockChartResize.bind(this)),this.setStyle(this.element)}initPrivateVariable(){if(""===this.element.id){const e=document.getElementsByClassName("e-stockChart").length;this.element.id="stockChart_"+this.chartid+"_"+e}this.seriesXMax=null,this.seriesXMin=null,this.startValue=null,this.endValue=null,this.currentEnd=null}setCulture(){this.intl=new a.eC}storeDataSource(){for(let e=0;e<this.series.length;e++){const t=this.series[e];this.tempSeriesType.push(t.type),t.localData=void 0}0===this.series.length&&this.series.push({}),this.initialRender=!0,this.rangeFound=!1,this.resizeTo=null,this.startValue=null,this.endValue=null}render(){const e={name:"load",stockChart:this.isBlazor?{}:this,theme:this.theme};this.trigger("load",e,()=>{this.theme=this.isBlazor?e.theme:this.theme,this.themeStyle=V(this.theme),this.storeDataSource(),this.drawSVG(),this.renderTitle(),this.renderLegend(),this.chartModuleInjection(),this.chartRender(),this.dataSource instanceof r.hm&&this.series[0].dataSource instanceof r.hm||(this.stockChartDataManagerSuccess(),this.initialRender=!1),this.renderComplete(),this.allowServerDataBinding=!0,this.isProtectedOnChange=!1})}stockChartDataManagerSuccess(){this.findRange(),this.renderRangeSelector(),this.renderPeriodSelector(),this.trigger("loaded",{stockChart:this.isBlazor?{}:this})}setStyle(e){const t=this.zoomSettings,i=t.enableSelectionZooming||t.enablePinchZooming||"None"!==this.selectionMode||this.crosshair.enable;e.style.msTouchAction=i?"none":"element",e.style.touchAction=i?"none":"element",e.style.msUserSelect="none",e.style.msContentZooming="none",e.style.position="relative",e.style.display="block",e.style.webkitUserSelect="none"}drawSVG(){this.removeSvg(),fi(this),this.renderer=new y(this.element.id),this.renderBorder(),this.createSecondaryElements(),this.calculateVisibleSeries(),this.calculateLegendBounds(),this.mainObject=this.renderer.createSvg({id:this.element.id+"_stockChart_svg",width:this.availableSize.width,height:this.availableSize.height-(this.enablePeriodSelector?this.toolbarHeight:0)-this.titleSize.height}),this.svgObject=this.mainObject,this.element.appendChild(this.mainObject)}calculateVisibleSeries(){let e;this.visibleSeries=[];const t=Z(this.theme),i=t.length,s=this.series.sort((e,t)=>e.zOrder-t.zOrder);for(let o=0,l=s.length;o<l;o++)e=s[o],e.category="Series",e.index=o,e.interior=e.fill||t[o%i],this.visibleSeries.push(e),s[o]=e}createSecondaryElements(){const e=gi(!1,this.element.id+"_Secondary_Element")||this.createElement("div");e.id=this.element.id+"_Secondary_Element",this.title?(this.titleSize=S(this.title,this.titleStyle),this.titleSize.height+=15):this.titleSize={height:null,width:null},e.setAttribute("style","position: relative; height:"+((this.enablePeriodSelector?this.toolbarHeight:0)+this.titleSize.height)+"px"),$t(!1,this.element,e,!1)}requiredModules(){const e=[];return this.legendSettings.visible&&e.push({member:"StockLegend",args:[this]}),e}findCurrentData(e,t){let i;return e&&this.startValue&&this.endValue&&(i=e.filter(e=>new Date(Date.parse(e[t])).getTime()>=this.startValue&&new Date(Date.parse(e[t])).getTime()<=this.endValue)),i}renderPeriodSelector(){this.enablePeriodSelector&&(this.toolbarSelector.initializePeriodSelector(),this.periodSelector.toolbar.refreshOverflow(),this.enableSelector||this.cartesianChart.cartesianChartRefresh(this))}chartRender(){this.cartesianChart=new Fo(this),this.cartesianChart.initializeChart()}renderRangeSelector(){this.enableSelector&&(this.rangeSelector=new Oo(this),this.rangeSelector.initializeRangeNavigator())}getModuleName(){return"stockChart"}getPersistData(){return""}removeSvg(){if(document.getElementById(this.element.id+"_Secondary_Element")&&(0,a.Od)(document.getElementById(this.element.id+"_Secondary_Element")),this.mainObject){for(;this.mainObject.childNodes.length>0;)this.mainObject.removeChild(this.mainObject.firstChild);!this.mainObject.hasChildNodes()&&this.mainObject.parentNode&&((0,a.Od)(this.mainObject),this.mainObject=null,this.selectorObject=null,this.chartObject=null)}}chartModuleInjection(){let e;for(const t of this.getInjectedModules())e=t.prototype.getModuleName().toLowerCase(),-1===e.indexOf("rangetooltip")?ds.Inject(t):Eo.Inject(t),"datetime"!==e&&"areaseries"!==e&&"steplineseries"!==e||Eo.Inject(t)}findRange(){this.seriesXMin=1/0,this.seriesXMax=-1/0;for(const e of this.chart.series)e.visible&&(this.seriesXMin=Math.min(this.seriesXMin,e.xMin),this.seriesXMax=Math.max(this.seriesXMax,e.xMax));this.endValue=this.currentEnd=this.seriesXMax,this.enablePeriodSelector?(this.toolbarSelector=new No(this),this.periodSelector=new Po(this),this.tempPeriods=this.periods.length?this.periods:this.toolbarSelector.calculateAutoPeriods(),this.tempPeriods.map(e=>{e.selected&&"ytd"===e.text.toLowerCase()?this.startValue=new Date(new Date(this.currentEnd).getFullYear().toString()).getTime():e.selected&&"all"===e.text.toLowerCase()?this.startValue=this.seriesXMin:e.selected&&(this.startValue=this.periodSelector.changedRange(e.intervalType,this.endValue,e.interval).getTime())})):this.startValue=this.seriesXMin,this.rangeFound=!0}stockChartResize(){return!!document.getElementById(this.element.id)&&(this.animateSeries=!1,this.resizeTo&&clearTimeout(this.resizeTo),this.resizeTo=+setTimeout(()=>{fi(this),this.renderBorder(),this.calculateLegendBounds(),this.renderTitle(),this.renderLegend(),this.cartesianChart.cartesianChartRefresh(this),this.mainObject.setAttribute("width",this.availableSize.width.toString()),this.enablePeriodSelector&&this.renderPeriodSelector()},500),!1)}stockChartOnMouseDown(e){let t,i,s,o;const l=this.chart.element.getBoundingClientRect();if(this.trigger("stockChartMouseDown",{target:e.target.id,x:this.mouseX,y:this.mouseY}),"touchstart"===e.type?(this.isTouch=!0,o=e,t=o.changedTouches[0].clientX,s=o.target,i=o.changedTouches[0].clientY):(this.isTouch="touch"===e.pointerType,t=e.clientX,i=e.clientY,s=e.target),s.id.indexOf(this.element.id+"_stockChart_chart")>-1){const s=Yt(this.element.id+"_stockChart_chart").getBoundingClientRect();this.mouseDownY=this.previousMouseMoveY=i-l.top-Math.max(s.top-l.top,0),this.mouseDownX=this.previousMouseMoveX=t-l.left-Math.max(s.left-l.left,0),this.setMouseXY(this.mouseDownX,this.mouseDownY),this.referenceXAxis=this.chart.primaryXAxis,Yt(this.element.id+"_stockChart_chart").setAttribute("cursor","pointer"),this.mouseDownXPoint=yo(this.mouseX-this.referenceXAxis.rect.x,this.referenceXAxis.rect.width,this.referenceXAxis.visibleRange,this.referenceXAxis.isInversed),this.allowPan=!0,this.notify(a.AR.touchStartEvent,e)}return!1}stockChartMouseEnd(e){let t,i,s;return"touchend"===e.type?(s=e,i=s.changedTouches[0].clientX,t=s.changedTouches[0].clientY,this.isTouch=!0):(t=e.clientY,i=e.clientX,this.isTouch="touch"===e.pointerType||"2"===e.pointerType),Yt(this.element.id+"_stockChart_chart").setAttribute("cursor","auto"),this.onPanning=!1,this.setMouseXY(i,t),this.stockChartOnMouseUp(e),!1}stockChartOnMouseUp(e){return this.trigger("stockChartMouseUp",{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.isChartDrag=!1,this.allowPan=!1,this.isTouch&&(this.threshold=(new Date).getTime()+300),this.notify(a.AR.touchEndEvent,e),this.stockEvent&&this.stockEvent.removeStockEventTooltip(0),!1}setMouseXY(e,t){const i=Yt(this.element.id+"_stockChart_chart");if(this.element&&i){const s=this.element.getBoundingClientRect(),o=i.getBoundingClientRect();this.mouseX=e-s.left-Math.max(o.left-s.left,0),this.mouseY=t-s.top-Math.max(o.top-s.top,0)}}stockChartOnMouseMove(e){let t,i,s;return"touchmove"===e.type?(this.isTouch=!0,i=e,s=i.changedTouches[0].clientY,t=i.changedTouches[0].clientX):(this.isTouch="touch"===e.pointerType||"2"===e.pointerType||this.isTouch,t=e.clientX,s=e.clientY),this.trigger("stockChartMouseMove",{target:e.target.id,x:this.mouseX,y:this.mouseY}),Yt(this.element.id+"_stockChart_chart")&&(this.setMouseXY(t,s),this.chartOnMouseMove(e)),!1}chartOnMouseMove(e){if(this.allowPan&&this.mouseDownXPoint&&this.mouseX!==this.previousMouseMoveX&&this.zoomSettings.enablePan){this.onPanning=!0,Yt(this.element.id+"_stockChart_chart").setAttribute("cursor","pointer"),this.mouseUpXPoint=yo(this.mouseX-this.referenceXAxis.rect.x,this.referenceXAxis.rect.width,this.referenceXAxis.visibleRange,this.referenceXAxis.isInversed);const e=Math.abs(this.mouseUpXPoint-this.mouseDownXPoint);this.mouseDownXPoint<this.mouseUpXPoint?this.seriesXMin<=this.referenceXAxis.visibleRange.min-e&&(this.startValue=this.referenceXAxis.visibleRange.min-e,this.endValue=this.referenceXAxis.visibleRange.max-e,this.cartesianChart.cartesianChartRefresh(this),this.rangeSelector.sliderChange(this.referenceXAxis.visibleRange.min-e,this.referenceXAxis.visibleRange.max-e)):this.seriesXMax>=this.referenceXAxis.visibleRange.max+e&&(this.startValue=this.referenceXAxis.visibleRange.min+e,this.endValue=this.referenceXAxis.visibleRange.max+e,this.cartesianChart.cartesianChartRefresh(this),this.rangeSelector.sliderChange(this.referenceXAxis.visibleRange.min+e,this.referenceXAxis.visibleRange.max+e))}if(this.notify(a.AR.touchMoveEvent,e),""===e.target.id){let e;(this.chart.tooltip.enable||this.crosshair.enable)&&(e=document.getElementById(this.element.id+"_stockChart_chart_tooltip"),e&&(0,a.Od)(e)),Yt(this.element.id+"_StockEvents_Tooltip")&&this.stockEvent.removeStockEventTooltip(0)}return-1!==e.target.id.indexOf("StockEvents")?(clearInterval(this.stockEvent.toolTipInterval),this.stockEvent.renderStockEventTooltip(e.target.id)):this.stockEvent&&this.stockEvent.removeStockEventTooltip(1e3),this.isTouch=!1,!1}stockChartOnMouseClick(e){return this.trigger("stockChartMouseClick",{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.notify("click",e),!1}stockChartRightClick(e){return!this.crosshair.enable||2!==e.buttons&&0!==e.which&&"touch"!==e.pointerType||(e.preventDefault(),e.stopPropagation(),!1)}stockChartOnMouseLeave(e){let t,i,s;return"touchleave"===e.type?(this.isTouch=!0,t=e,i=t.changedTouches[0].clientX,s=t.changedTouches[0].clientY):(i=e.clientX,s=e.clientY,this.isTouch="touch"===e.pointerType||"2"===e.pointerType),this.setMouseXY(i,s),this.allowPan=!1,this.stockChartOnMouseLeaveEvent(e),!1}stockChartOnMouseLeaveEvent(e){const t=a.AR.isPointer?"pointerleave":"mouseleave";return this.isChartDrag=!1,this.notify(t,e),this.stockEvent&&this.stockEvent.removeStockEventTooltip(1e3),!1}destroy(){}renderBorder(){if(this.border.width){const e=this.createElement("div");e.id=this.element.id+"_stock_border",e.style.width=this.availableSize.width+"px",e.style.height=this.availableSize.height+"px",e.style.position="absolute",e.style.border=this.border.width+"px solid "+this.border.color,e.style.pointerEvents="none",$t(!1,Yt(this.element.id),e)}}renderTitle(){let e;if(this.title){$t(!1,Yt(this.element.id+"_Secondary_Element"),this.renderer.createSvg({id:this.element.id+"_stockChart_Title",width:this.availableSize.width,height:this.titleSize.height,fill:this.background||this.themeStyle.background}),!1);const t=this.titleStyle.textAlignment,i="Near"===t?"start":"Far"===t?"end":"middle";e=new C(0,0,this.availableSize.width,0);const s=new L(this.element.id+"_ChartTitle",Si(e,this.titleStyle),this.titleSize.height-10,i,this.title,"","auto");bi(this.renderer,s,this.titleStyle,this.titleStyle.color||this.findTitleColor(),Yt(this.element.id+"_stockChart_Title"),!1,!1),this.availableSize.height-=this.titleSize.height+5}}calculateLegendBounds(){this.stockLegendModule&&this.legendSettings.visible&&this.stockLegendModule.getLegendOptions(this.visibleSeries,this);const e=this.titleSize.height,t=this.border.width,i=.5*this.chartArea.border.width+this.border.width;this.initialClipRect=new C(t,i,this.availableSize.width-this.border.width-t,this.availableSize.height-i-this.border.width-(this.enablePeriodSelector?this.toolbarHeight:0)-e),this.tempAvailableSize=new w(this.availableSize.width,this.availableSize.height-(this.enablePeriodSelector?this.toolbarHeight:0)-e),this.stockLegendModule&&this.legendSettings.visible&&this.stockLegendModule.calculateLegendBounds(this.initialClipRect,this.tempAvailableSize,null)}renderLegend(){this.stockLegendModule&&this.stockLegendModule.legendCollections.length&&this.legendSettings.visible&&(this.stockLegendModule.calTotalPage=!0,this.stockLegendModule.renderLegend(this,this.legendSettings,this.stockLegendModule.legendBounds),"Auto"===this.legendSettings.position||"Bottom"===this.legendSettings.position||"Top"===this.legendSettings.position?this.availableSize.height-=this.stockLegendModule.legendBounds.height:"Left"!==this.legendSettings.position&&"Right"!==this.legendSettings.position||(this.availableSize.width-=this.stockLegendModule.legendBounds.width))}findTitleColor(){return this.theme.toLocaleLowerCase().indexOf("highcontrast")>-1||this.theme.indexOf("Dark")>-1?"#ffffff":"#424242"}calculateStockEvents(){this.stockEvents.length&&(this.stockEvent=new el(this),$t(!1,this.chartObject,this.stockEvent.renderStockEvents()))}};sl([(0,a.Z9)(null)],ol.prototype,"width",void 0),sl([(0,a.Z9)(null)],ol.prototype,"height",void 0),sl([(0,a.Z9)("")],ol.prototype,"dataSource",void 0),sl([(0,a.Zz)({},Vo)],ol.prototype,"margin",void 0),sl([(0,a.Zz)({color:"#DDDDDD",width:1},Bo)],ol.prototype,"border",void 0),sl([(0,a.Z9)(null)],ol.prototype,"background",void 0),sl([(0,a.Z9)("Material")],ol.prototype,"theme",void 0),sl([(0,a.Zz)({name:"primaryXAxis",valueType:"DateTime"},Uo)],ol.prototype,"primaryXAxis",void 0),sl([(0,a.Zz)({border:{color:null,width:.5},background:"transparent"},Zo)],ol.prototype,"chartArea",void 0),sl([(0,a.Zz)({name:"primaryYAxis",opposedPosition:!0,labelPosition:"Inside"},Uo)],ol.prototype,"primaryYAxis",void 0),sl([(0,a.FE)([{}],Xo)],ol.prototype,"rows",void 0),sl([(0,a.FE)([{opposedPosition:!0}],Uo)],ol.prototype,"axes",void 0),sl([(0,a.FE)([],Yo)],ol.prototype,"series",void 0),sl([(0,a.FE)([],$o)],ol.prototype,"stockEvents",void 0),sl([(0,a.Z9)(!1)],ol.prototype,"isTransposed",void 0),sl([(0,a.Z9)("")],ol.prototype,"title",void 0),sl([(0,a.Zz)({size:"15px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},_o)],ol.prototype,"titleStyle",void 0),sl([(0,a.FE)([],Wo)],ol.prototype,"indicators",void 0),sl([(0,a.Zz)({shared:!0,enableMarker:!1},ie)],ol.prototype,"tooltip",void 0),sl([(0,a.Zz)({dashArray:"5"},ns)],ol.prototype,"crosshair",void 0),sl([(0,a.Zz)({},il)],ol.prototype,"legendSettings",void 0),sl([(0,a.Zz)({},hs)],ol.prototype,"zoomSettings",void 0),sl([(0,a.Z9)(!0)],ol.prototype,"enablePeriodSelector",void 0),sl([(0,a.Z9)(!0)],ol.prototype,"enableCustomRange",void 0),sl([(0,a.Z9)(!1)],ol.prototype,"isSelect",void 0),sl([(0,a.Z9)(!0)],ol.prototype,"enableSelector",void 0),sl([(0,a.FE)([],se)],ol.prototype,"periods",void 0),sl([(0,a.FE)([{}],Jo)],ol.prototype,"annotations",void 0),sl([(0,a.ju)()],ol.prototype,"selectorRender",void 0),sl([(0,a.ju)()],ol.prototype,"stockChartMouseMove",void 0),sl([(0,a.ju)()],ol.prototype,"stockChartMouseLeave",void 0),sl([(0,a.ju)()],ol.prototype,"stockChartMouseDown",void 0),sl([(0,a.ju)()],ol.prototype,"stockChartMouseUp",void 0),sl([(0,a.ju)()],ol.prototype,"stockChartMouseClick",void 0),sl([(0,a.ju)()],ol.prototype,"pointClick",void 0),sl([(0,a.ju)()],ol.prototype,"pointMove",void 0),sl([(0,a.ju)()],ol.prototype,"onZooming",void 0),sl([(0,a.ju)()],ol.prototype,"legendRender",void 0),sl([(0,a.ju)()],ol.prototype,"legendClick",void 0),sl([(0,a.Z9)("None")],ol.prototype,"selectionMode",void 0),sl([(0,a.Z9)(!1)],ol.prototype,"isMultiSelect",void 0),sl([(0,a.ju)()],ol.prototype,"load",void 0),sl([(0,a.ju)()],ol.prototype,"loaded",void 0),sl([(0,a.ju)()],ol.prototype,"rangeChange",void 0),sl([(0,a.ju)()],ol.prototype,"axisLabelRender",void 0),sl([(0,a.ju)()],ol.prototype,"tooltipRender",void 0),sl([(0,a.ju)()],ol.prototype,"seriesRender",void 0),sl([(0,a.ju)()],ol.prototype,"stockEventRender",void 0),sl([(0,a.FE)([],Ko)],ol.prototype,"selectedDataIndexes",void 0),sl([(0,a.Z9)(["Line","Hilo","OHLC","Hollow Candle","Spline","Candle"])],ol.prototype,"seriesType",void 0),sl([(0,a.Z9)(["EMA","TMA","SMA","Momentum","ATR","Accumulation Distribution","Bollinger Bands","MACD","Stochastic","RSI"])],ol.prototype,"indicatorType",void 0),sl([(0,a.Z9)(["PNG","JPEG","SVG","PDF","Print"])],ol.prototype,"exportType",void 0),sl([(0,a.Z9)(["Linear","Exponential","Polynomial","Logarithmic","Moving Average"])],ol.prototype,"trendlineType",void 0),ol=sl([a.Zl],ol);class ll{constructor(e){this.bulletChart=e,this.isVertical="Vertical"===e.orientation,this.isLabelsInside="Inside"===e.labelPosition,this.isHorizontal="Horizontal"===e.orientation,this.isLeft="Left"===e.titlePosition,this.isRight="Right"===e.titlePosition,this.isTop="Top"===e.titlePosition,this.majorTickSize=e.majorTickLines.height,this.location=10,this.labelOffset=15,this.labelSize=parseFloat(e.labelStyle.size),this.isLabelBelow=!this.bulletChart.opposedPosition}renderMajorTickLines(e,t){"Horizontal"===this.bulletChart.orientation?this.renderXMajorTickLines(e,t):this.renderYMajorTickLines(e,t)}renderMinorTickLines(e,t){"Horizontal"===this.bulletChart.orientation?this.renderXMinorTickLines(e,t):this.renderYMinorTickLines(e,t)}renderAxisLabels(e,t){"Horizontal"===this.bulletChart.orientation?this.renderXAxisLabels(e,t):this.renderYAxisLabels(e,t)}renderXMajorTickLines(e,t){const i=this.bulletChart,s=i.renderer.createGroup({id:i.svgObject.id+"_majorTickGroup"}),o=i.minimum,l=i.maximum,a=i.interval,r=i.enableRtl,n=i.initialClipRect.y+(i.opposedPosition?0:i.initialClipRect.height),h=n+(i.opposedPosition?"Inside"!==i.tickPosition?-this.majorTickSize:this.majorTickSize:"Inside"!==i.tickPosition?this.majorTickSize:-this.majorTickSize),d=i.majorTickLines;let c,p,u=d.color||i.themeStyle.majorTickLineColor;const g=i.initialClipRect.x+(i.enableRtl?i.initialClipRect.width:0);let m=i.initialClipRect.x+d.width/2+(r?i.initialClipRect.width:0);for(let b=o;b<=l;b+=a){p=i.enableRtl?b===o:b===l,p&&(m-=d.width/2),p=i.enableRtl?b===o:b===l,i.majorTickLines.useRangeColor&&(u=this.bindingRangeStrokes(m-(p?this.bulletChart.majorTickLines.width/2:0),g,this.bulletChart.orientation,i.enableRtl)),c=this.majorTicks(m,m,n,h,u,b);const a=i.renderer.drawLine(c);m+=r?-e:e,s.appendChild(a),t.appendChild(s)}}renderYMajorTickLines(e,t){const i=this.bulletChart,s=i.renderer.createGroup({id:i.svgObject.id+"_majorTickGroup"}),o=i.minimum,l=i.maximum,a=i.interval,r=i.enableRtl,n=i.initialClipRect,h=n.x+(i.opposedPosition?n.width:0),d=h-(i.opposedPosition?"Inside"!==i.tickPosition?-this.majorTickSize:this.majorTickSize:"Inside"!==i.tickPosition?this.majorTickSize:-this.majorTickSize),c=i.majorTickLines;let p,u,g=c.color||i.themeStyle.majorTickLineColor;const m=n.y+(i.enableRtl?0:n.height);let b=n.y+c.width/2+(r?0:n.height);for(let f=o;f<=l;f+=a){p=i.enableRtl?f===l:f===o,p&&(b-=c.width/2),p=i.enableRtl?f===o:f===l,i.majorTickLines.useRangeColor&&(g=this.bindingRangeStrokes(b-(p?this.bulletChart.majorTickLines.width/2:0),m,this.bulletChart.orientation,i.enableRtl)),u=this.majorTicks(h,d,b,b,g,f);const a=i.renderer.drawLine(u);b+=r?e:-e,s.appendChild(a),t.appendChild(s)}}majorTicks(e,t,i,s,o,l){return{id:this.bulletChart.svgObject.id+"_MajorTickLine_"+l,x1:e,y1:i,x2:t,y2:s,"stroke-width":this.bulletChart.majorTickLines.width,stroke:this.bulletChart.majorTickLines.useRangeColor&&o?o:this.bulletChart.majorTickLines.color||o}}bindingRangeStrokes(e,t,i,s){return"Vertical"===i&&!s||s&&"Horizontal"===i?this.backwardStrokeBinding(e,t):this.forwardStrokeBinding(e,t)}renderXMinorTickLines(e,t){const i=this.bulletChart.renderer.createGroup({id:this.bulletChart.svgObject.id+"_minorTickGroup"}),s=this.bulletChart,o=s.maximum,l=s.interval,a=s.minorTickLines.height,r=this.bulletChart.minorTicksPerInterval;let n,h,d=s.initialClipRect.x;const c=s.initialClipRect.y+(s.opposedPosition?0:s.initialClipRect.height),p=c+(s.opposedPosition?"Inside"!==s.tickPosition?-a:a:"Inside"!==s.tickPosition?a:-a);let u,g,m=s.minorTickLines.color||s.themeStyle.minorTickLineColor;const b=s.initialClipRect.x+(s.enableRtl?s.initialClipRect.width:0);for(let f=s.minimum;f<o;f+=l){n=e/r;for(let o=1;o<=r;o++)h=d+n-n/(r+1),s.minorTickLines.useRangeColor&&(m=this.bindingRangeStrokes(h,b,this.bulletChart.orientation,s.enableRtl)),u=this.minorXTicks(h,h,c,p,m,f.toString()+o.toString()),g=this.bulletChart.renderer.drawLine(u),i.appendChild(g),t.appendChild(i),n=e/r*(o+1);d+=e}}renderYMinorTickLines(e,t){const i=this.bulletChart.renderer.createGroup({id:this.bulletChart.svgObject.id+"_minorTickGroup"}),s=this.bulletChart,o=s.maximum,l=s.interval,a=s.minorTickLines.height,r=this.bulletChart.minorTicksPerInterval;let n,h,d=s.initialClipRect.y+(s.enableRtl?0:s.initialClipRect.height);const c=s.initialClipRect.x+(s.opposedPosition?s.initialClipRect.width:0),p=c-(s.opposedPosition?"Inside"!==s.tickPosition?-a:a:"Inside"!==s.tickPosition?a:-a);let u,g,m=s.minorTickLines.color||s.themeStyle.minorTickLineColor;const b=s.initialClipRect.y+(s.enableRtl?0:s.initialClipRect.height);for(let f=s.minimum;f<o;f+=l){n=e/r;for(let o=1;o<=r;o++)h=this.bulletChart.enableRtl?d+n-n/(r+1):d-n+n/(r+1),s.minorTickLines.useRangeColor&&(m=this.bindingRangeStrokes(h,b,this.bulletChart.orientation,s.enableRtl)),u=this.minorXTicks(c,p,h,h,m,f.toString()+o.toString()),g=this.bulletChart.renderer.drawLine(u),i.appendChild(g),t.appendChild(i),n=e/r*(o+1);d-=this.bulletChart.enableRtl?-e:e}}minorXTicks(e,t,i,s,o,l){return{id:this.bulletChart.svgObject.id+"_MajorTickLine_"+l,x1:e,x2:t,y1:i,y2:s,"stroke-width":this.bulletChart.minorTickLines.width,stroke:this.bulletChart.minorTickLines.useRangeColor&&o?o:this.bulletChart.minorTickLines.color||o}}forwardStrokeBinding(e,t){const i=this.bulletChart;let s=t;for(let o=0;o<=i.rangeCollection.length-1;o++)if(s+=o?i.rangeCollection[o-1]:0,e>=s&&e<s+i.rangeCollection[o])return i.ranges[o].color;return null}backwardStrokeBinding(e,t){const i=this.bulletChart;let s=t;for(let o=0;o<=i.rangeCollection.length-1;o++)if(s-=o?i.rangeCollection[o-1]:0,Math.round(e)>=Math.round(s-i.rangeCollection[o])&&e<=s)return i.ranges[o].color;return null}renderXAxisLabels(e,t){const i=this.bulletChart.renderer.createGroup({id:this.bulletChart.svgObject.id+"_axisLabelGroup"});let s;const o=this.bulletChart,l=this.bulletChart.locale,a=o.enableRtl,r=(o.tickPosition===o.labelPosition?o.majorTickLines.height:0)+10;let n=o.initialClipRect.y+(o.opposedPosition?"Inside"===o.labelPosition?r:-r:o.initialClipRect.height+("Inside"===o.labelPosition?-r:r)),h=o.initialClipRect.x+(a?o.initialClipRect.width:0);const d=o.minimum,c=o.maximum,p=o.interval,u=l&&this.bulletChart.enableGroupSeparator,g=this.getFormat(this.bulletChart);let m,b=o.labelStyle.color||o.themeStyle.labelFontColor;const f=null!==g.match("{value}");this.format=this.bulletChart.intl.getNumberFormat({format:f?"":g,useGrouping:this.bulletChart.enableGroupSeparator});const y=o.initialClipRect.x+(o.enableRtl?o.initialClipRect.width:0);n+=S(this.formatValue(this,f,g,this.bulletChart.maximum),o.labelStyle).height/3;for(let v=d;v<=c;v+=p){m=o.enableRtl?v===d:v===c,o.labelStyle.useRangeColor&&(b=this.bindingRangeStrokes(h-(m?this.bulletChart.majorTickLines.width/2:0),y,this.bulletChart.orientation,o.enableRtl)),s=u?v.toLocaleString(l):this.formatValue(this,f,g,v);const r=P(this.labelXOptions(h,n,s,v),this.bulletChart.labelStyle,b,t);i.appendChild(r),h+=a?-e:e}t.appendChild(i)}labelXOptions(e,t,i,s){return{id:this.bulletChart.svgObject.id+"_AxisLabel_"+s,anchor:"middle",text:i,transform:"",x:e,y:t,baseLine:"",labelRotation:0}}renderYAxisLabels(e,t){const i=this.bulletChart.renderer.createGroup({id:this.bulletChart.svgObject.id+"_axisLabelGroup"});let s;const o=this.bulletChart,l=o.locale,a=o.enableRtl,r=(o.tickPosition===o.labelPosition?o.majorTickLines.height:0)+10;let n=o.initialClipRect.y+(a?0:o.initialClipRect.height);const h=o.initialClipRect.x+(o.opposedPosition?o.initialClipRect.width+("Inside"===o.labelPosition?-(r+10):r):"Inside"===o.labelPosition?r+10:-r),d=o.minimum,c=o.maximum,p=o.interval,u=l&&this.bulletChart.enableGroupSeparator;let g=o.labelStyle.color||o.themeStyle.labelFontColor;const m=this.getFormat(this.bulletChart),b=null!==m.match("{value}");let f;this.format=this.bulletChart.intl.getNumberFormat({format:b?"":m,useGrouping:this.bulletChart.enableGroupSeparator});const y=o.initialClipRect.y+(o.enableRtl?0:o.initialClipRect.height),v=S(this.formatValue(this,b,m,this.bulletChart.maximum),o.labelStyle).width/2,x=S(this.formatValue(this,b,m,this.bulletChart.maximum),o.labelStyle).height/3;n+=x;for(let S=d;S<=c;S+=p){f=o.enableRtl?S===c:S===d,o.labelStyle.useRangeColor&&(g=this.bindingRangeStrokes(n-x-(f?this.bulletChart.majorTickLines.width/2:0),y,this.bulletChart.orientation,o.enableRtl)),s=u?S.toLocaleString(l):this.formatValue(this,b,m,S);const r=P(this.labelXOptions(h-(this.bulletChart.opposedPosition?-v:v),n,s,S),this.bulletChart.labelStyle,g,t);i.appendChild(r),n+=a?e:-e}t.appendChild(i)}getFormat(e){return e.labelFormat?e.labelFormat:""}formatValue(e,t,i,s){return t?i.replace("{value}",e.format(s)):e.format(s)}}var al=(()=>(function(e){e.axisLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Roboto-Regular"},e.tooltipLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.legendLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.dataLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.titleFont={size:"15px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Roboto-Regular"},e.subTitleFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Roboto-Regular"}}(al||(al={})),al))();class rl{constructor(e){this.comparative=[],this.dataSource=e.dataSource,this.isVertical="Vertical"===e.orientation,this.isTicksInside="Inside"===e.tickPosition,this.isLabelsInside="Inside"===e.labelPosition,this.isHorizontal="Horizontal"===e.orientation,this.isLeft="Left"===e.titlePosition,this.isRight="Right"===e.titlePosition,this.isTop="Top"===e.titlePosition,this.location=10,this.featureBarBounds=[],this.majorTickSize=e.majorTickLines.height,this.labelOffset=15,this.labelSize=12,this.bulletChart=e,this.isLabelBelow=!this.bulletChart.opposedPosition,this.scaleOrientation=this.bulletChart.orientation,this.rangeColor=[]}drawScaleGroup(e){const t=this.bulletChart.renderer.createGroup({id:this.bulletChart.svgObject.id+"_rangeGroup"}),i=this.bulletChart.maximum,s=this.bulletChart.ranges;let o;this.scaleSettingsGroup=e;const l=this.bulletChart,a=l.enableRtl,r=l.initialClipRect;let n=r.x+(a&&"Horizontal"===l.orientation?r.width:0),h=r.y+(a||"Vertical"!==l.orientation?0:r.height),d=0;l.rangeCollection=[];let c=0;const p="Horizontal"===l.orientation?r.width:r.height,u="Horizontal"===l.orientation?r.height:r.width;for(let g=0;g<s.length;g++){d=p*((s[g].end-c)/i),"Horizontal"===l.orientation?n-=a?d:0:h-=a?0:d,o=new Ti(l.svgObject.id+"_range_"+g,s[g].color||this.bulletChart.themeStyle.rangeStrokes[g].color,{width:1},s[g].opacity,new C(n,h,"Horizontal"===l.orientation?d:u,"Horizontal"===l.orientation?u:d));const r=l.renderer.drawRectangle(o);t.appendChild(r),e.appendChild(t),"Horizontal"===l.orientation?n+=a?0:d:h+=a?d:0,l.rangeCollection.push(d),c=s[g].end}return this.bulletChart.rangeCollection}sortRangeCollection(e,t){return e-t}renderFeatureBar(e){0!==e&&this.renderCommonFeatureBar(e,this.isHorizontal)}renderCommonFeatureBar(e,t){let i;const s=this.bulletChart,o=t?s.initialClipRect.y+s.initialClipRect.height:s.initialClipRect.x;let l;const r=s.renderer.createGroup({id:s.svgObject.id+"_featureGroup"});let n;const h=(t?s.initialClipRect.height:s.initialClipRect.width)/e;let d;for(let c=0;c<e;c++){if(n=s.dataSource[c],i=n[s.categoryField],l=t?o-h*c-(h+s.valueHeight)/2:o+h*c+h/2-s.valueHeight/2,d=this.calculateFeatureMeasureBounds(n[s.valueField],i,t),n&&"Dot"===s.type){const e=n[s.valueField];d.pointX=t?d.pointX+(e>0&&!s.enableRtl||e<0&&s.enableRtl?d.width:0)-3:d.pointX+(e>0&&s.enableRtl||e<0&&!s.enableRtl?d.width:0)-3,d.width=6}if(d){const e=t?this.featureBar(d.pointX,l,d.width,c):this.verticalFeatureBar(l,d.pointX,d.width,c);if(r.appendChild(e),this.feature=e,this.scaleSettingsGroup.appendChild(r),this.featureBarBounds[c]={x:d.pointX,y:l,width:d.width,height:s.valueHeight},!(0,a.le)(i)){const e=S(i,s.categoryLabelStyle),o=t?e.width:e.height,a=s.initialClipRect;let r,n;t?(r=s.enableRtl?a.x+a.width+5+o/2:a.x-5-o/2,n=this.drawcategory(r,l,i)):(r=s.enableRtl?a.y-5-o/2:a.y+a.height+5+o/2,n=this.drawcategory(l+s.valueHeight/2,r,i)),P(n,s.categoryLabelStyle,s.categoryLabelStyle.color||s.themeStyle.categoryFontColor,this.scaleSettingsGroup)}}s.animation.enable&&this.doValueBarAnimation()}}featureBar(e,t,i,s){const o=new Ti(this.bulletChart.svgObject.id+"_FeatureMeasure_"+s,this.bulletChart.valueFill,this.bulletChart.valueBorder,1,new C(e,t,i,this.bulletChart.valueHeight)),l=this.bulletChart.renderer.drawRectangle(o);return l.setAttribute("class",this.bulletChart.svgObject.id+"_FeatureMeasure"),l.id=this.bulletChart.svgObject.id+"_FeatureMeasure_"+s,l}verticalFeatureBar(e,t,i,s){const o=new Ti(this.bulletChart.svgObject.id+"_FeatureMeasure_"+s,this.bulletChart.valueFill,this.bulletChart.valueBorder,1,new C(e,t,this.bulletChart.valueHeight,i)),l=this.bulletChart.renderer.drawRectangle(o);return l.setAttribute("class",this.bulletChart.svgObject.id+"_FeatureMeasure"),l.id=this.bulletChart.svgObject.id+"_FeatureMeasure_"+s,l}drawcategory(e,t,i){return{id:"",anchor:"middle",x:e,y:t+this.bulletChart.valueHeight,transform:"",text:i,baseLine:"",labelRotation:0}}renderComparativeSymbol(e){0!==e&&this.renderCommonComparativeSymbol(e,this.isHorizontal)}renderCommonComparativeSymbol(e,t){const i=this.bulletChart;let s;const o=i.initialClipRect,l=t?o.width:o.height;let a,r,n;const h=t?o.y+o.height:o.x,d=i.renderer.createGroup({id:i.svgObject.id+"_comparativeGroup"}),c=i.minimum,p=i.maximum,u=p-c,g=i.targetWidth,m=t?o.x-g/2:o.y+o.height;let b,f=[];const y=i.targetTypes;let v="Rect";const S=y.length,x=(t?o.height:o.width)/e;let w;for(let C=0;C<e;C++){s=i.dataSource[C][i.targetField],f=f.concat(s);for(let e=0;e<f.length;e++)v=y[e%S],f[e]>=c&&f[e]<=p&&(b=t?h-x*C-x/2:h+x*C+x/2,a=b-1.5*g,r=b+1.5*g,b=l/(u/(u-(p-f[e]))),n=t?m+(i.enableRtl?l-b:b):m-(i.enableRtl?l-b:b),w=this.getTargetElement(v,t,n,a,r,f[e],C),this.comparative.push(w),d.appendChild(w),a=0,r=0),this.scaleSettingsGroup.appendChild(d);f=[],i.animation.enable&&this.doTargetBarAnimation(0)}}getTargetElement(e,t,i,s,o,l,a){let r,n;const h=this.bulletChart,d="Cross"===e?h.targetWidth-1:1,c="Circle"===e?h.targetWidth-1:h.targetWidth,p=t?i+c/2:s+(o-s)/2,u=t?s+(o-s)/2:i,g=h.svgObject.id+"_ComparativeMeasure_"+a,m=h.svgObject.id+"_ComparativeMeasure";return"Rect"===e?(r=t?this.compareMeasure(i,s,o,a,l):this.compareVMeasure(s,o,i,a),n=h.renderer.drawLine(r)):"Circle"===e?(r=new Ai(g,h.targetColor,{width:1,color:h.targetColor||"black"},1,p,u,c),n=h.renderer.drawCircle(r)):(r=new I(g,"transparent",d,h.targetColor,1,"","M "+(p-c)+" "+(u-c)+" L "+(p+c)+" "+(u+c)+" M "+(p-c)+" "+(u+c)+" L "+(p+c)+" "+(u-c)),n=h.renderer.drawPath(r)),n.setAttribute("class",m),n}compareMeasure(e,t,i,s,o){const l=this.bulletChart;return{class:l.svgObject.id+"_ComparativeMeasure",id:l.svgObject.id+"_ComparativeMeasure_"+s,x1:o===l.maximum?e-l.targetWidth/2:o===l.minimum?e+l.targetWidth/2:e,y1:t,x2:o===l.maximum?e-l.targetWidth/2:o===l.minimum?e+l.targetWidth/2:e,y2:i,"stroke-width":l.targetWidth,stroke:l.targetColor||"black"}}compareVMeasure(e,t,i,s){const o=this.bulletChart;return{class:o.svgObject.id+"_ComparativeMeasure",id:o.svgObject.id+"_ComparativeMeasure_"+s,x1:e,y1:i,x2:t,y2:i,"stroke-width":o.targetWidth,stroke:o.targetColor||"black"}}calculateFeatureMeasureBounds(e,t,i){const s=this.bulletChart,o=s.minimum;if((e=e<o&&o<=0?o:e)>=o){let l,r,n;const h=i?s.initialClipRect.x:s.initialClipRect.y,d=i?s.initialClipRect.width:s.initialClipRect.height,c=s.maximum-s.minimum,p=s.maximum-e,u=(s.enableRtl?"backward":"forward")+this.scaleOrientation.toLowerCase(),g=S((t=(0,a.le)(t)?"":t).toString(),s.labelStyle).width;switch(u){case"forwardhorizontal":case"backwardvertical":l=h+(o>0?0:d/c*Math.abs(o)),n=d/(c/(o>0?c-p:e)),e<0&&(n=Math.abs(n),l-=n),n=l+n<h+d?n:h+d-l,r=h-("forwardhorizontal"===u?g/2+5:this.labelOffset);break;default:l=h+(d-d/(c/(c-p))),n=o>0?d/(c/(c-p)):d/(c/e),e<0&&(n=Math.abs(n),l-=n),l<h&&(n=l+n-h,l=h),r=h+d+("backwardhorizontal"===u?g/2+5:5)}return{pointX:l,width:n,lastPointX:r}}return null}doValueBarAnimation(){const e=this.feature;if(!e)return null;const t=this.bulletChart.animation,i=this.bulletChart.animateSeries?this.bulletChart.animation.duration:t.duration,s=Ft("Linear"),o=this.bulletChart.dataSource<0;let l,r;const n=e.getBoundingClientRect().height;let h,d,c,p=e.getBoundingClientRect().width;"Horizontal"===this.bulletChart.orientation&&e&&(r=parseInt(e.getAttribute("height"),10),l=parseInt(e.getAttribute("x"),10),d=o?r:r+n,h=l),e.style.visibility="hidden",new a.fw({}).animate(e,{duration:i,delay:t.delay,progress:t=>{t.timeStamp>=t.delay&&(e.style.visibility="visible",p=p||1,c=s(t.timeStamp-t.delay,0,p,t.duration),e.setAttribute("transform","translate("+h+" "+d+") scale("+c/p+", 1) translate("+-h+" "+-d+")"))},end:()=>{e.setAttribute("transform","translate(0,0)"),e.style.visibility="visible"}})}doTargetBarAnimation(e){let t,i,s,o;const l=this.comparative[e];if(!l)return null;"Horizontal"===this.bulletChart.orientation&&l&&(i=parseFloat(l.getAttribute("y1"))+parseFloat(l.getAttribute("y2")),t=parseFloat(l.getAttribute("x1")),o=i,s=t),l.style.visibility="hidden",this.animateRect(l,s,o,e+1)}animateRect(e,t,i,s){const o=Ft("Linear");let l;const r=this.bulletChart.animation,n=this.comparative.length,h=this.bulletChart.animateSeries?this.bulletChart.animation.duration:r.duration;new a.fw({}).animate(e,{duration:h,delay:r.delay,progress:s=>{s.timeStamp>=s.delay&&(e.style.visibility="visible",l=o(s.timeStamp-s.delay,0,1,s.duration),e.setAttribute("transform","translate("+t+" "+i/2+") scale(1,"+l+") translate("+-t+" "+-i/2+")"))},end:()=>{e.setAttribute("transform","translate(0,0)"),s<n&&this.doTargetBarAnimation(s+1)}})}}var nl=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class hl extends a.rt{}nl([(0,a.Z9)(null)],hl.prototype,"end",void 0),nl([(0,a.Z9)(1)],hl.prototype,"opacity",void 0),nl([(0,a.Z9)(null)],hl.prototype,"color",void 0),nl([(0,a.Z9)(null)],hl.prototype,"index",void 0),nl([(0,a.Z9)(null)],hl.prototype,"name",void 0),nl([(0,a.Z9)("Rectangle")],hl.prototype,"shape",void 0),nl([(0,a.Z9)("")],hl.prototype,"legendImageUrl",void 0);class dl extends a.rt{}nl([(0,a.Z9)(12)],dl.prototype,"height",void 0),nl([(0,a.Z9)(1)],dl.prototype,"width",void 0),nl([(0,a.Z9)(null)],dl.prototype,"color",void 0),nl([(0,a.Z9)(!1)],dl.prototype,"useRangeColor",void 0);class cl extends a.rt{}nl([(0,a.Z9)(8)],cl.prototype,"height",void 0),nl([(0,a.Z9)(1)],cl.prototype,"width",void 0),nl([(0,a.Z9)(null)],cl.prototype,"color",void 0),nl([(0,a.Z9)(!1)],cl.prototype,"useRangeColor",void 0);class pl extends a.rt{}nl([(0,a.Z9)("Normal")],pl.prototype,"fontStyle",void 0),nl([(0,a.Z9)("16px")],pl.prototype,"size",void 0),nl([(0,a.Z9)("")],pl.prototype,"color",void 0),nl([(0,a.Z9)("Normal")],pl.prototype,"fontWeight",void 0),nl([(0,a.Z9)("Segoe UI")],pl.prototype,"fontFamily",void 0),nl([(0,a.Z9)("Center")],pl.prototype,"textAlignment",void 0),nl([(0,a.Z9)("None")],pl.prototype,"textOverflow",void 0),nl([(0,a.Z9)(1)],pl.prototype,"opacity",void 0),nl([(0,a.Z9)(!0)],pl.prototype,"enableTrim",void 0),nl([(0,a.Z9)(null)],pl.prototype,"maximumTitleWidth",void 0),nl([(0,a.Z9)(!1)],pl.prototype,"useRangeColor",void 0);class ul extends a.rt{}nl([(0,a.Z9)(!1)],ul.prototype,"enable",void 0),nl([(0,a.Z9)(null)],ul.prototype,"fill",void 0),nl([(0,a.Zz)(al.tooltipLabelFont,pl)],ul.prototype,"textStyle",void 0),nl([(0,a.Zz)({color:"#cccccc",width:.5},G)],ul.prototype,"border",void 0),nl([(0,a.Z9)(null)],ul.prototype,"template",void 0);class gl extends a.rt{}nl([(0,a.Z9)(!1)],gl.prototype,"enable",void 0),nl([(0,a.Zz)(al.dataLabelFont,pl)],gl.prototype,"labelStyle",void 0);class ml extends a.rt{}nl([(0,a.Z9)(!1)],ml.prototype,"visible",void 0),nl([(0,a.Zz)({x:0,y:0},$i)],ml.prototype,"location",void 0),nl([(0,a.Z9)(8)],ml.prototype,"padding",void 0),nl([(0,a.Z9)("Center")],ml.prototype,"alignment",void 0),nl([(0,a.Z9)(10)],ml.prototype,"shapeHeight",void 0),nl([(0,a.Z9)(10)],ml.prototype,"shapeWidth",void 0),nl([(0,a.Zz)(al.legendLabelFont,pl)],ml.prototype,"textStyle",void 0),nl([(0,a.Z9)("Auto")],ml.prototype,"position",void 0),nl([(0,a.Zz)({left:0,right:0,top:0,bottom:0},U)],ml.prototype,"margin",void 0),nl([(0,a.Zz)({},G)],ml.prototype,"border",void 0),nl([(0,a.Z9)(5)],ml.prototype,"shapePadding",void 0),nl([(0,a.Z9)("transparent")],ml.prototype,"background",void 0),nl([(0,a.Z9)(1)],ml.prototype,"opacity",void 0),nl([(0,a.Z9)(3)],ml.prototype,"tabIndex",void 0);var bl=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};let fl=class extends a.wA{constructor(e,t){super(e,t),this.bulletid=57726,this.animateSeries=!0,this.padding=5,this.leftSize=0,this.rightSize=0,this.topSize=0,this.bottomSize=0,this.maxLabelSize=new w(0,0),this.maxTitleSize=new w(0,0),this.intervalDivs=[10,5,2,1]}preRender(){this.isBlazor=window.Blazor,this.allowServerDataBinding=!1,this.unWireEvents(),this.initPrivateValues(),this.setCulture(),this.wireEvents()}initPrivateValues(){if(this.delayRedraw=!1,this.scale=new rl(this),this.bulletAxis=new ll(this),""===this.element.id){const e=document.getElementsByClassName("e-BulletChart").length;this.element.id="BulletChart_"+this.bulletid+"_"+e}}setCulture(){this.intl=new a.eC}render(){const e={bulletChart:this.isBlazor?{}:this,theme:this.theme,name:"load"};this.trigger("load",e,()=>{this.theme=this.isBlazor?e.theme:this.theme,this.setTheme(),this.createSvg(this),this.findRange(),this.bulletChartLegendModule&&this.legendSettings.visible&&(this.calculateVisibleElements(),this.bulletChartLegendModule.getLegendOptions(this.visibleRanges)),this.calculatePosition(),this.renderBulletElements(),this.trigger("loaded",{bulletChart:window.Blazor?{}:this}),this.allowServerDataBinding=!0,this.renderComplete()})}setTheme(){this.themeStyle=function(e){let t={majorTickLineColor:"#424242",minorTickLineColor:"#424242",background:"#FFFFFF",labelFontColor:"rgba(0,0,0,0.54)",categoryFontColor:"#666666",labelFontFamily:"SegoeUI",tooltipFill:"rgba(0, 8, 22, 0.75)",legendLabel:"#353535",tooltipBoldLabel:"#ffffff",featuredMeasureColor:"#181818",comparativeMeasureColor:"#181818",titleFontColor:"rgba(0,0,0,0.87)",dataLabelFontColor:"#ffffff",titleFontFamily:"SegoeUI",subTitleFontColor:" rgba(0,0,0,0.54)",subTitleFontFamily:"SegoeUI",firstRangeColor:"#959595",secondRangeColor:"#BDBDBD",thirdRangeColor:"#E3E2E2",rangeStrokes:[{color:"#959595"},{color:"#BDBDBD"},{color:"#E3E2E2"}]};switch(e){case"Fabric":t={majorTickLineColor:"#424242",minorTickLineColor:"#424242",background:"#FFFFFF",labelFontColor:"#666666",categoryFontColor:"#666666",labelFontFamily:"SegoeUI",tooltipFill:"rgba(0, 8, 22, 0.75)",legendLabel:"#353535",tooltipBoldLabel:"#ffffff",featuredMeasureColor:"#181818",comparativeMeasureColor:"#181818",titleFontColor:"#333333",dataLabelFontColor:"#ffffff",titleFontFamily:"SegoeUI",subTitleFontColor:"#666666",subTitleFontFamily:"SegoeUI",firstRangeColor:"#959595",secondRangeColor:"#BDBDBD",thirdRangeColor:"#E3E2E2",rangeStrokes:[{color:"#959595"},{color:"#BDBDBD"},{color:"#E3E2E2"}]};break;case"Bootstrap":t={majorTickLineColor:"#424242",minorTickLineColor:"#424242",background:"#FFFFFF",labelFontColor:"rgba(0,0,0,0.54)",categoryFontColor:"rgba(0,0,0,0.54)",labelFontFamily:"Helvetica",tooltipFill:"rgba(0, 0, 0, 0.9)",legendLabel:"#212529",tooltipBoldLabel:"rgba(255,255,255)",featuredMeasureColor:"#181818",comparativeMeasureColor:"#181818",titleFontColor:"rgba(0,0,0,0.87)",dataLabelFontColor:"#ffffff",titleFontFamily:"Helvetica-Bold",subTitleFontColor:" rgba(0,0,0,0.54)",subTitleFontFamily:"Helvetica",firstRangeColor:"#959595",secondRangeColor:"#BDBDBD",thirdRangeColor:"#E3E2E2",rangeStrokes:[{color:"#959595"},{color:"#BDBDBD"},{color:"#E3E2E2"}]};break;case"HighContrast":t={majorTickLineColor:"#FFFFFF",minorTickLineColor:"#FFFFFF",background:"#000000",labelFontColor:"#FFFFFF",categoryFontColor:"#FFFFFF",labelFontFamily:"SegoeUI",tooltipFill:"#ffffff",legendLabel:"#ffffff",tooltipBoldLabel:"#000000",featuredMeasureColor:"#000000",comparativeMeasureColor:"#000000",titleFontColor:"#FFFFFF",dataLabelFontColor:"#ffffff",titleFontFamily:"HelveticaNeue",subTitleFontColor:"#FFFFFF",subTitleFontFamily:"SegoeUI",firstRangeColor:"#959595",secondRangeColor:"#BDBDBD",thirdRangeColor:"#E3E2E2",rangeStrokes:[{color:"#757575"},{color:"#BDBDBD"},{color:"#EEEEEE"}]};break;case"MaterialDark":case"FabricDark":case"BootstrapDark":t={majorTickLineColor:"#F0F0F0",minorTickLineColor:"#F0F0F0",background:"#000000",labelFontColor:"#FFFFFF",categoryFontColor:"#FFFFFF",labelFontFamily:"Helvetica",tooltipFill:"#F4F4F4",legendLabel:"#DADADA",tooltipBoldLabel:"#282727",featuredMeasureColor:"#181818",comparativeMeasureColor:"#181818",titleFontColor:"#FFFFFF",dataLabelFontColor:"#ffffff",titleFontFamily:"Helvetica-Bold",subTitleFontColor:"#FFFFFF",subTitleFontFamily:"Helvetica",firstRangeColor:"#8D8D8D",secondRangeColor:"#ADADAD",thirdRangeColor:"#EEEEEE",rangeStrokes:[{color:"#8D8D8D"},{color:"#ADADAD"},{color:"#EEEEEE"}]};break;case"Bootstrap4":t={majorTickLineColor:"#424242",minorTickLineColor:"#424242",background:"#FFFFFF",labelFontColor:"#202528",categoryFontColor:"#202528",labelFontFamily:"HelveticaNeue",tooltipFill:"rgba(0, 0, 0, 0.9)",legendLabel:"#212529",tooltipBoldLabel:"rgba(255,255,255)",featuredMeasureColor:"#181818",comparativeMeasureColor:"#181818",titleFontColor:"#202528",dataLabelFontColor:"#ffffff",titleFontFamily:"HelveticaNeue-Bold",subTitleFontColor:"HelveticaNeue",subTitleFontFamily:"#202528",firstRangeColor:"#959595",secondRangeColor:"#BDBDBD",thirdRangeColor:"#E3E2E2",rangeStrokes:[{color:"#959595"},{color:"#BDBDBD"},{color:"#E3E2E2"}]};break;case"Tailwind":t={majorTickLineColor:"#D1D5DB",minorTickLineColor:"#D1D5DB",background:"transparent",labelFontColor:"#6B7280",categoryFontColor:"#6B7280",labelFontFamily:"Inter",tooltipFill:"#111827",legendLabel:"#374151",tooltipBoldLabel:"#F9FAFB",featuredMeasureColor:"#1F2937",comparativeMeasureColor:"#1F2937",titleFontColor:"#374151",dataLabelFontColor:"#F9FAFB",titleFontFamily:"Inter",subTitleFontColor:"#374151",subTitleFontFamily:"Inter",firstRangeColor:"#9CA3AF",secondRangeColor:"#D1D5DB",thirdRangeColor:"#E5E7EB",rangeStrokes:[{color:"#9CA3AF"},{color:"#D1D5DB"},{color:"#E5E7EB"}]};break;case"TailwindDark":t={majorTickLineColor:"#4B5563",minorTickLineColor:"#4B5563",background:"transparent",labelFontColor:"#9CA3AF",categoryFontColor:"#9CA3AF",labelFontFamily:"Inter",tooltipFill:"#F9FAFB",legendLabel:"#D1D5DB",tooltipBoldLabel:"#1F2937",featuredMeasureColor:"#1F2937",comparativeMeasureColor:"#1F2937",titleFontColor:"#D1D5DB",dataLabelFontColor:"#D1D5DB",titleFontFamily:"Inter",subTitleFontColor:"#D1D5DB",subTitleFontFamily:"Inter",firstRangeColor:"#6B7280",secondRangeColor:"#4B5563",thirdRangeColor:"#374151",rangeStrokes:[{color:"#6B7280"},{color:"#4B5563"},{color:"#374151"}]};break;default:t=t}return t}(this.theme)}findRange(){if(this.minimum||(this.minimum=0),!this.maximum){this.maximum=0;for(let e=0;e<this.ranges.length;e++)this.maximum=this.maximum>this.ranges[e].end?this.maximum:this.ranges[e].end}if(null===this.maximum)if((0,a.le)(this.dataSource))this.maximum=10;else for(let e=0;e<Object.keys(this.dataSource).length;e++)this.maximum=this.dataSource[e][this.targetField]>this.dataSource[e][this.valueField]?this.maximum>this.dataSource[e][this.targetField]?this.maximum+this.interval:this.dataSource[e][this.targetField]+this.interval:this.maximum>this.dataSource[e][this.valueField]?this.maximum+this.interval:this.dataSource[e][this.valueField]+this.interval;this.interval||(this.interval=this.calculateNumericNiceInterval(this.maximum-this.minimum))}getActualDesiredIntervalsCount(e){let t=3*("Horizontal"===this.orientation?.533:1);return t=Math.max(("Horizontal"===this.orientation?e.width:e.height)*(t/100),1),t}calculateNumericNiceInterval(e){const t=this.getActualDesiredIntervalsCount(this.availableSize);let i=e/t;const s=Math.pow(10,Math.floor(ht(i,10)));for(const o of this.intervalDivs){const l=s*o;if(t<e/l)break;i=l}return i}setSecondaryElementPosition(){const e=Yt(this.element.id+"_Secondary_Element");if(!e)return;const t=this.element.getBoundingClientRect(),i=Yt(this.element.id+"_svg").getBoundingClientRect();e.style.left=Math.max(i.left-t.left,0)+"px",e.style.top=Math.max(i.top-t.top,0)+"px",e.style.position="relative"}createSvg(e){this.removeSvg(),e.renderer=new y(e.element.id),this.calculateAvailableSize(this),e.svgObject=e.renderer.createSvg({id:e.element.id+"_svg",width:e.availableSize.width,height:e.availableSize.height}),this.renderChartBackground()}renderChartBackground(){const e=new Ti(this.element.id+"_ChartBorder",this.themeStyle.background,{width:this.border.width||0,color:this.border.color||"transparent"},1,new C(0,0,this.availableSize.width,this.availableSize.height));this.svgObject.appendChild(this.renderer.drawRectangle(e))}renderBulletElements(){const e=this.renderer.createGroup({id:this.svgObject.id+"_scaleGroup"});this.svgObject.appendChild(e),this.renderBulletChartTitle(),this.rangeCollection=this.scale.drawScaleGroup(e);const t=("Horizontal"===this.orientation?this.initialClipRect.width:this.initialClipRect.height)/((this.maximum-this.minimum)/this.interval);this.bulletAxis.renderMajorTickLines(t,e),this.bulletAxis.renderMinorTickLines(t,e),this.bulletAxis.renderAxisLabels(t,e),this.bulletChartRect.x="Left"===this.titlePosition||"Right"===this.titlePosition||"Vertical"===this.orientation?this.bulletChartRect.x:0;const i=this.element.id;if("g"!==this.element.tagName){const e=gi(this.redraw,i+"_Secondary_Element")||this.createElement("div");e.id=i+"_Secondary_Element",$t(!1,this.element,e,this.redraw)}this.tooltip.enable&&$t(!1,this.svgObject,this.renderer.createGroup({id:i+"_UserInteraction",style:"pointer-events:none;"}),this.redraw),this.bindData(),this.renderDataLabel(),this.renderBulletLegend(),this.element.appendChild(this.svgObject),this.setSecondaryElementPosition()}renderBulletLegend(){this.bulletChartLegendModule&&this.bulletChartLegendModule.legendCollections.length&&(this.bulletChartLegendModule.calTotalPage=!0,this.bulletChartLegendModule.renderLegend(this,this.legendSettings,this.bulletChartLegendModule.legendBounds))}bulletResize(){this.animateSeries=!1;const e={chart:this,name:De,currentSize:new w(0,0),previousSize:new w(this.availableSize.width,this.availableSize.height)};return this.resizeTo&&clearTimeout(this.resizeTo),this.resizeTo=+setTimeout(()=>{this.isDestroyed?clearTimeout(this.resizeTo):(this.createSvg(this),e.currentSize=this.availableSize,this.trigger(De,e),this.calculatePosition(),this.renderBulletElements())},500),!1}bindData(){null!=this.dataSource&&(this.dataCount=this.dataSource.length,this.drawMeasures(this.dataCount))}drawMeasures(e){this.scale.renderFeatureBar(e),this.scale.renderComparativeSymbol(e)}calculatePosition(){const e=this.margin;let t=0,i=0,s=new w(0,0);this.titleCollections=[],this.subTitleCollections=[];let o=0,l=0,a=5;if(this.title){this.titleCollections=vi(this.title,this.titleStyle,this.titleStyle.maximumTitleWidth),t=S(this.title,this.titleStyle).height*this.titleCollections.length+5;for(const e of this.titleCollections)s=S(e,this.titleStyle),o=s.width>o?s.width:o,l=s.height>l?s.height:l;if(a+=l,this.subTitleCollections=vi(this.subtitle,this.subtitleStyle,this.titleStyle.maximumTitleWidth),this.subtitle){for(const e of this.subTitleCollections)s=S(e,this.subtitleStyle),o=s.width>o?s.width:o,l=s.height>l?s.height:l;i=S(this.subtitle,this.subtitleStyle).height*this.subTitleCollections.length+5,a+=l}}this.maxTitleSize=new w(o,"Vertical"===this.orientation?a:l),this.maxLabelSize=this.getMaxLabelWidth(),this.initialClipRect=this.getBulletBounds("Vertical"===this.orientation?a:o,t,i,e),this.bulletChartRect=new C(this.initialClipRect.x,this.initialClipRect.y,this.initialClipRect.width,this.initialClipRect.height),this.bulletChartLegendModule&&this.bulletChartLegendModule.calculateLegendBounds(this.initialClipRect,this.availableSize,this.maxLabelSize)}getBulletBounds(e,t,i,s){const o=new C(0,0,0,0),l=this.enableRtl,a=this.labelPosition===this.tickPosition?5:0,r="Inside"===this.tickPosition?0:this.majorTickLines.height,n="Inside"===this.labelPosition?0:5+("Outside"===this.tickPosition?0:S(this.maximum.toString(),this.labelStyle).height);let h=0,d=0,c=0,p=0,u=0,g=0,m=0,b=0;const f=e,y=this.bulletAxis.getFormat(this),v=null!==y.match("{value}");this.bulletAxis.format=this.intl.getNumberFormat({format:v?"":y,useGrouping:this.enableGroupSeparator});const x=S(this.bulletAxis.formatValue(this.bulletAxis,v,y,this.maximum),this.labelStyle).width;let w;switch("Horizontal"===this.orientation?(w=this.maxLabelSize.width,h=this.opposedPosition?r+n+a:0,d=this.opposedPosition?0:r+n+a,m=w&&!l?w:0,m+=f&&"Left"===this.titlePosition?15:0,b=w&&l?w:0,b+=f&&"Right"===this.titlePosition?5:0):(w=this.maxLabelSize.height,p=this.opposedPosition?r+a:0,p+=this.opposedPosition&&"Inside"!==this.labelPosition?x:0,c=this.opposedPosition?0:r+a,c+=this.opposedPosition||"Inside"===this.labelPosition?0:x,u=w&&l?w+5:0,g=w&&!l?w+5:0),this.titlePosition){case"Left":o.x=s.left+f+m+c,o.width=this.availableSize.width-s.right-o.x-b-p,o.y=s.top+h+u,o.height=this.availableSize.height-o.y-s.bottom-d-g;break;case"Right":o.x=s.left+m+c,o.width=this.availableSize.width-p-s.right-o.x-(f+5)-b,o.y=s.top+h+u,o.height=this.availableSize.height-o.y-s.bottom-d-g;break;case"Top":o.x=s.left+c+m,o.width=this.availableSize.width-s.right-o.x-b-p,o.y=s.top+(t+i)+h+u,o.height=this.availableSize.height-o.y-s.bottom-d-g;break;case"Bottom":o.x=s.left+c+m,o.y=s.top+h+u,o.width=this.availableSize.width-s.right-o.x-b-p,o.height=this.availableSize.height-o.y-g-s.bottom-d-(t+i)}return o}getMaxLabelWidth(){if(this.maxLabelSize=new w(0,0),!this.categoryField)return this.maxLabelSize;let e;for(let t=0,i=Object.keys(this.dataSource).length;t<i;t++)e=S(this.dataSource[t][this.categoryField]||"",this.categoryLabelStyle),e.width>this.maxLabelSize.width&&(this.maxLabelSize.width=e.width),e.height>this.maxLabelSize.height&&(this.maxLabelSize.height=e.height);return this.maxLabelSize}calculateVisibleElements(){let e;const t=this.ranges;this.visibleRanges=[];for(let i=0,s=t.length;i<s;i++)e=t[i],e.index=i,e.color=e.color,this.visibleRanges.push(e),t[i]=e}renderBulletChartTitle(){const e=this.margin;let t=0,i=0,s="middle",o="";const l=this.titleStyle.textAlignment,a=S(this.title,this.titleStyle),r=this.subtitle?S(this.subtitle,this.subtitleStyle):new w(0,0);if(this.title){if("Horizontal"===this.orientation)switch(this.titlePosition){case"Top":t=this.findHorizontalAlignment(e),s="Far"===l?"end":"Near"===l?"start":"middle",i=e.top+a.height/2+5;break;case"Bottom":t=this.findHorizontalAlignment(e),s="Far"===l?"end":"Near"===l?"start":"middle",i=this.availableSize.height-e.bottom-a.height/3+10-(r.height?r.height+5:0);break;case"Left":s="end",t=e.left+this.maxTitleSize.width,i=this.margin.top+this.availableSize.height/2-a.height/3-(r.height?r.height:0);break;case"Right":s="start",t=this.availableSize.width-e.right-this.maxTitleSize.width+5,i=this.margin.top+this.availableSize.height/2-a.height/3-(r.height?r.height:0)}else{switch(this.titlePosition){case"Top":t=this.availableSize.width/2+10,i=this.margin.top+a.height/2+5;break;case"Bottom":t=this.availableSize.width/2,i=this.availableSize.height-this.margin.bottom-a.height/3+10-(r.height?r.height+5:0);break;case"Left":i=this.findVerticalAlignment(e),s="Far"===l?"start":"Near"===l?"end":"middle",t=e.left;break;case"Right":t=this.availableSize.width-e.right-a.height/3,s="Far"===l?"start":"Near"===l?"end":"middle",i=this.findVerticalAlignment(e)}o="Left"===this.titlePosition?"rotate(-90,"+t+","+i+")":"Right"===this.titlePosition?"rotate(90,"+t+","+i+")":""}const n=new L(this.element.id+"_BulletChartTitle",t,i,s,this.titleCollections,o,"auto"),h=bi(this.renderer,n,this.titleStyle,this.titleStyle.color||this.themeStyle.titleFontColor,this.svgObject);h&&(h.setAttribute("aria-label",this.title),h.setAttribute("tabindex",this.tabIndex.toString())),this.subtitle&&this.renderBulletChartSubTitle(t,i,s)}}renderDataLabel(){let e,t=0,i=0;const s=this.enableRtl;let o,l;const a=this.labelFormat?this.labelFormat:"",r=null!==a.match("{value}");if(this.dataLabel.enable)for(let n=0,h=Object.keys(this.dataSource).length;n<h;n++){o=this.dataSource[n],l=this.scale.featureBarBounds[n];let h=o[this.valueField].toString();this.format=this.intl.getNumberFormat({format:r?"":a,useGrouping:this.enableGroupSeparator}),h=r?a.replace("{value}",this.format(h)):h;const d=S(h,this.dataLabel.labelStyle),c=d.width,p=d.height;"Horizontal"===this.orientation?(e="Rect"===this.type||s?"end":"start",t=l.x+(s?"Rect"===this.type?c+10:-10:l.width)+("Rect"===this.type?-5:5),i=l.y+l.height/2):(e="middle",t=l.y+l.height/2,i=l.x+(s?l.width+("Rect"===this.type?-p:p):0)+("Rect"===this.type?10:-10));let u=new L(this.element.id+"_DataLabel_"+n,t,i,e,h,"","middle");bi(this.renderer,u,this.dataLabel.labelStyle,this.dataLabel.labelStyle.color||this.themeStyle.dataLabelFontColor,this.svgObject)}}findHorizontalAlignment(e){let t=0;switch(this.titleStyle.textAlignment){case"Center":t=(this.availableSize.width-e.left-e.right)/2;break;case"Near":t=e.left;break;case"Far":t=this.availableSize.width-e.right}return t}findVerticalAlignment(e){let t=0;switch(this.titleStyle.textAlignment){case"Center":t=(this.availableSize.height-e.top-e.bottom)/2;break;case"Near":t=e.top;break;case"Far":t=this.availableSize.height-e.bottom}return t}renderBulletChartSubTitle(e,t,i){const s=this.margin;let o="";const l=S(this.subtitle,this.subtitleStyle);if("Horizontal"===this.orientation)switch(this.titlePosition){case"Top":t=t+l.height+2.5;break;case"Bottom":t=this.availableSize.height-s.bottom-l.height/3+5;break;case"Left":case"Right":t=t+l.height+2.5}else{switch(this.titlePosition){case"Top":t=t+l.height+2.5;break;case"Bottom":t=this.availableSize.height-s.bottom-l.height/3+5;break;case"Left":e+=l.height+2.5;break;case"Right":e-=l.height+2.5}o="Left"===this.titlePosition?"rotate(-90,"+e+","+t+")":"Right"===this.titlePosition?"rotate(90,"+e+","+t+")":""}const a=new L(this.element.id+"_BulletChartSubTitle",e,t,i,this.subTitleCollections,o,"auto"),r=bi(this.renderer,a,this.subtitleStyle,this.subtitleStyle.color||this.themeStyle.subTitleFontColor,this.svgObject);r&&(r.setAttribute("aria-label",this.title),r.setAttribute("tabindex",this.tabIndex.toString()))}calculateAvailableSize(e){const t=this.element.clientWidth||this.element.offsetWidth||200,i=this.element.clientHeight||("Vertical"===this.orientation?450:"Left"===this.titlePosition||"Right"===this.titlePosition?83:126);e.availableSize=new w(ui(e.width,t)||t,ui(e.height,i)||i)}removeSvg(){const e=document.getElementById(this.element.id+"_svg");e&&(0,a.Od)(e)}getPersistData(){return this.addOnPersist(["loaded"])}unWireEvents(){const e=a.AR.touchMoveEvent,t=a.AR.isPointer?"pointerleave":"mouseleave";a.bi.remove(this.element,a.AR.touchStartEvent,this.bulletMouseDown),a.bi.remove(this.element,e,this.bulletMouseMove),a.bi.remove(this.element,t,this.bulletMouseLeave),a.bi.remove(this.element,"click",this.bulletChartOnMouseClick),window.removeEventListener(a.AR.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeBound)}wireEvents(){const e=a.AR.isPointer?"pointerleave":"mouseleave";a.bi.add(this.element,a.AR.touchMoveEvent,this.bulletMouseMove,this),a.bi.add(this.element,e,this.bulletMouseLeave,this),a.bi.add(this.element,a.AR.touchStartEvent,this.bulletMouseDown,this),a.bi.add(this.element,"click",this.bulletChartOnMouseClick,this),this.resizeBound=this.bulletResize.bind(this),window.addEventListener(a.AR.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeBound),this.setStyle(this.element)}setStyle(e){e.style.position="relative",e.style.display="block"}bulletMouseMove(e){this.setPointMouseXY(e.clientX,e.clientY);const t=e.target.id,i=e.target.className.baseVal;if(!(0,a.le)(this.dataSource))for(let s=0;s<Object.keys(this.dataSource).length;s++)document.getElementById(this.svgObject.id+"_FeatureMeasure_"+s).setAttribute("opacity","1"),document.getElementById(this.svgObject.id+"_ComparativeMeasure_"+s).setAttribute("opacity","1");if(!this.isTouchEvent(e)){const s=document.getElementById("tooltipDiv"+this.element.id);s&&(this.isReact&&this.clearTemplate(),(0,a.Od)(s)),this.bulletTooltipModule&&(this.bulletTooltipModule._elementTooltip(e,i,t,this.mouseX),this.bulletTooltipModule._displayTooltip(e,i,t,this.mouseX,this.mouseY))}}setPointMouseXY(e,t){const i=Yt(this.svgObject.id).getBoundingClientRect(),s=this.element.getBoundingClientRect();this.mouseX=e-s.left-Math.max(i.left-s.left,0),this.mouseY=t-s.top-Math.max(i.top-s.top,0)}bulletMouseLeave(e){if(!this.isTouchEvent(e)){const e=document.getElementById(".tooltipDiv"+this.element.id);e&&(this.isReact&&this.clearTemplate(),(0,a.Od)(e))}}isTouchEvent(e){return"touch"===e.pointerType||e.type.indexOf("touch")>-1}bulletMouseDown(e){if(this.isTouchEvent(e)){this.isReact&&this.clearTemplate(),(0,a.Od)(document.getElementById("tooltipDiv"+this.element.id));const t=e.target.id,i=e.target.className.baseVal;this.bulletTooltipModule&&(this.bulletTooltipModule._elementTooltip(e,i,t,this.mouseX),this.bulletTooltipModule._displayTooltip(e,i,t,this.mouseX,this.mouseY))}}bulletChartOnMouseClick(e){return this.trigger("bulletChartMouseClick",{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.notify("click",e),!1}print(e){new ls(this).print(e)}export(e,t,i,s,o,l,a){s=s||[this],new ls(this).export(e,t,i,s,o,l,a)}onPropertyChanged(e,t){let i=!1,s=!1;if(this.animateSeries=!1,!this.delayRedraw){for(const t of Object.keys(e))switch(t){case"height":case"width":this.createSvg(this),s=!0;break;case"subtitle":case"title":s=!0;break;case"tickPosition":case"labelPosition":case"titlePosition":i=!0;break;case"minimum":case"maximum":case"interval":s=!0;break;case"majorTickLines":case"minorTickLines":case"type":case"ranges":case"valueFill":case"targetColor":s=!0;break;case"titleStyle":e.titleStyle?s=!0:i=!0;break;case"subtitleStyle":e.subtitleStyle&&(e.subtitleStyle.size||e.subtitleStyle.textOverflow)?s=!0:i=!0;break;case"border":case"opposedPosition":i=!0;break;case"dataSource":this.bindData(),s=!0;break;case"theme":this.animateSeries=!0;break;case"locale":case"currencyCode":super.refresh()}!s&&i&&(this.removeSvg(),this.renderBulletElements(),this.trigger("loaded",{bulletChart:window.Blazor?{}:this})),s&&(this.render(),this.trigger("loaded",{bulletChart:window.Blazor?{}:this}),this.redraw=!1)}}requiredModules(){const e=[];let t;for(let i=0;i<this.ranges.length;i++)null!==this.ranges[i].name&&(t=!0);return this.isLegend=this.legendSettings.visible&&(t||!!this.isLegend||""!==this.targetField||""!==this.valueField),this.tooltip.enable&&e.push({member:"BulletTooltip",args:[this]}),this.isLegend&&e.push({member:"BulletChartLegend",args:[this]}),e}getModuleName(){return"bulletChart"}destroy(){this.unWireEvents(),super.destroy(),this.removeSvg(),this.svgObject=null,this.element.classList.remove("e-BulletChart"),this.element.innerHTML=""}};bl([(0,a.Z9)(null)],fl.prototype,"width",void 0),bl([(0,a.Z9)(null)],fl.prototype,"height",void 0),bl([(0,a.Z9)(null)],fl.prototype,"locale",void 0),bl([(0,a.Zz)({},dl)],fl.prototype,"majorTickLines",void 0),bl([(0,a.Zz)({},cl)],fl.prototype,"minorTickLines",void 0),bl([(0,a.Z9)(null)],fl.prototype,"minimum",void 0),bl([(0,a.Z9)(null)],fl.prototype,"maximum",void 0),bl([(0,a.Z9)(null)],fl.prototype,"interval",void 0),bl([(0,a.Z9)(4)],fl.prototype,"minorTicksPerInterval",void 0),bl([(0,a.Zz)(al.axisLabelFont,pl)],fl.prototype,"labelStyle",void 0),bl([(0,a.Zz)(al.axisLabelFont,pl)],fl.prototype,"categoryLabelStyle",void 0),bl([(0,a.Z9)("")],fl.prototype,"labelFormat",void 0),bl([(0,a.Z9)("")],fl.prototype,"title",void 0),bl([(0,a.Zz)(al.titleFont,pl)],fl.prototype,"titleStyle",void 0),bl([(0,a.Z9)("")],fl.prototype,"subtitle",void 0),bl([(0,a.Zz)(al.subTitleFont,pl)],fl.prototype,"subtitleStyle",void 0),bl([(0,a.Z9)("Horizontal")],fl.prototype,"orientation",void 0),bl([(0,a.Zz)({color:"#DDDDDD",width:0},G)],fl.prototype,"border",void 0),bl([(0,a.Zz)({},ul)],fl.prototype,"tooltip",void 0),bl([(0,a.FE)([{end:null,opacity:1,color:""},{end:null,opacity:1,color:""},{end:null,opacity:1,color:""}],hl)],fl.prototype,"ranges",void 0),bl([(0,a.Z9)("Outside")],fl.prototype,"labelPosition",void 0),bl([(0,a.Z9)("Outside")],fl.prototype,"tickPosition",void 0),bl([(0,a.Z9)("Top")],fl.prototype,"titlePosition",void 0),bl([(0,a.Z9)(!1)],fl.prototype,"opposedPosition",void 0),bl([(0,a.Z9)("Material")],fl.prototype,"theme",void 0),bl([(0,a.Zz)({},Q)],fl.prototype,"animation",void 0),bl([(0,a.Zz)({},gl)],fl.prototype,"dataLabel",void 0),bl([(0,a.Zz)({},ml)],fl.prototype,"legendSettings",void 0),bl([(0,a.Z9)(!1)],fl.prototype,"enableGroupSeparator",void 0),bl([(0,a.Zz)({top:15,bottom:10,left:15,right:15},U)],fl.prototype,"margin",void 0),bl([(0,a.Z9)(5)],fl.prototype,"targetWidth",void 0),bl([(0,a.Z9)("#191919")],fl.prototype,"targetColor",void 0),bl([(0,a.Z9)(6)],fl.prototype,"valueHeight",void 0),bl([(0,a.Z9)(null)],fl.prototype,"valueFill",void 0),bl([(0,a.Zz)({color:"transparent",width:0},G)],fl.prototype,"valueBorder",void 0),bl([(0,a.Z9)(null)],fl.prototype,"dataSource",void 0),bl([(0,a.Z9)(null)],fl.prototype,"query",void 0),bl([(0,a.Z9)(null)],fl.prototype,"categoryField",void 0),bl([(0,a.Z9)("Rect")],fl.prototype,"type",void 0),bl([(0,a.Z9)("")],fl.prototype,"valueField",void 0),bl([(0,a.Z9)("")],fl.prototype,"targetField",void 0),bl([(0,a.Z9)(["Rect","Cross","Circle"])],fl.prototype,"targetTypes",void 0),bl([(0,a.Z9)(1)],fl.prototype,"tabIndex",void 0),bl([(0,a.ju)()],fl.prototype,"tooltipRender",void 0),bl([(0,a.ju)()],fl.prototype,"load",void 0),bl([(0,a.ju)()],fl.prototype,"loaded",void 0),bl([(0,a.ju)()],fl.prototype,"bulletChartMouseClick",void 0),bl([(0,a.ju)()],fl.prototype,"legendRender",void 0),bl([(0,a.ju)()],fl.prototype,"beforePrint",void 0),fl=bl([a.Zl],fl);var yl=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class vl extends a.rt{}yl([(0,a.Z9)("Segoe UI")],vl.prototype,"fontFamily",void 0),yl([(0,a.Z9)("Normal")],vl.prototype,"fontStyle",void 0),yl([(0,a.Z9)("Regular")],vl.prototype,"fontWeight",void 0),yl([(0,a.Z9)("")],vl.prototype,"color",void 0),yl([(0,a.Z9)("12px")],vl.prototype,"size",void 0),yl([(0,a.Z9)(1)],vl.prototype,"opacity",void 0);class Sl extends a.rt{}yl([(0,a.Z9)(10)],Sl.prototype,"top",void 0),yl([(0,a.Z9)(10)],Sl.prototype,"bottom",void 0),yl([(0,a.Z9)(10)],Sl.prototype,"right",void 0),yl([(0,a.Z9)(10)],Sl.prototype,"left",void 0);class xl extends a.rt{}yl([(0,a.Z9)(0)],xl.prototype,"width",void 0),yl([(0,a.Z9)(1)],xl.prototype,"opacity",void 0),yl([(0,a.Z9)("transparent")],xl.prototype,"color",void 0);class wl{constructor(e,t,i,s){this.x=e,this.y=t,this.width=i,this.height=s}}class Cl{}class Ml extends class{}{}class Tl extends Ml{}class Ll{}class Al{}class Dl{}class Rl{constructor(e,t,i,s,o){this.id=e,this.fill=t,this.borderColor=i,this.borderWidth=s,this.opacity=o}}class Il{}class Pl{constructor(){this.counterclockwise=0,this.clockwise=1}}class kl{}class El{}class Fl{constructor(e,t){this.width=e,this.height=t}}class Ol{}function Nl(e){return document.getElementById(e)}function zl(e,t,i){let s=t,o=Yl(t,i).width;if(o>e)for(let l=t.length-1;l>=0;--l)if(s=t.substring(0,l)+"...",o=Yl(s,i).width,o<=e||s.length<4)return s.length<4&&(s=" "),s;return s}function _l(e){let t=null;try{document.querySelectorAll(e).length&&(t=(0,a.MY)(document.querySelector(e).innerHTML.trim()))}catch(i){t=(0,a.MY)(e)}return t}function Bl(e,t,i){let s=e[0].outerHTML;const o=Object.keys(i);for(let l=0;l<o.length;l++)s=s.replace(new RegExp("{{:"+o[l]+"}}","g"),i[o[l].toString()]);return(0,a.az)("div",{id:t,innerHTML:s,styles:"position: absolute"})}function Zl(){let e=1;for(;1+.5*e!=1;)e*=.5;return e}function Vl(e,t,i,s,o){let l,r;new a.fw({}).animate(t,{duration:s,delay:i,name:o,progress:e=>{l=(e.timeStamp-e.delay)/e.duration,r=0+1*l,e.element.style.opacity=r.toString()},end:t=>{t.element.style.opacity=1..toString(),e.trigger("animationComplete",event)}})}function jl(e,t){return null!=e?-1!==e.indexOf("%")?t/100*parseInt(e,10):parseInt(e,10):null}class Hl{constructor(e,t,i,s,o,l,a){this.id=e,this.opacity=o,this.fill=t,this.stroke=s,this["stroke-width"]=i,this["stroke-dasharray"]=l,this.d=a}}class ql extends Hl{constructor(e,t,i,s,o){super(e,t,i.width,i.color,s),this.y=o.y,this.x=o.x,this.height=o.height,this.width=o.width}}class Gl extends Hl{constructor(e,t,i,s,o,l,a,r){super(e,t,i.width,i.color,s),this.cy=l,this.cx=o,this.r=a,this["stroke-dasharray"]=r}}function Yl(e,t){let i=document.getElementById("smithchartmeasuretext");return null===i&&(i=(0,a.az)("text",{id:"smithchartmeasuretext"}),document.body.appendChild(i)),i.innerHTML=e,i.style.position="absolute",i.style.visibility="hidden",i.style.left="0",i.style.top="-100",i.style.whiteSpace="nowrap",i.style.fontSize=t.size,i.style.fontWeight=t.fontWeight,i.style.fontStyle=t.fontStyle,i.style.fontFamily=t.fontFamily,i.style.lineHeight="normal",new Fl(i.clientWidth,i.clientHeight)}class Wl{constructor(e,t,i,s,o){this.id=e,this.x=t,this.y=i,this.anchor=s,this.text=o}}function Ul(e){const t=document.getElementById(e);return t?(0,a.Od)(t):null}function Xl(e,t,i,s){return-i*Math.cos(e/s*(Math.PI/2))+i+t}function Ql(e,t,i,s){return-t*Math.sin(e/s*(Math.PI/2))+i+t}function Jl(e){let t;switch(e){case"Linear":t=Xl;break;case"Reverse":t=Ql}return t}function Kl(e,t,i,s){const o={id:e.id,x:e.x,y:e.y,fill:i,"font-size":t.size,"font-style":t.fontStyle,"font-family":t.fontFamily,"font-weight":t.fontWeight,"text-anchor":e.anchor,opacity:t.opacity},l=e.text,a=new y("").createText(o,l);return s.appendChild(a),a}var $l=(()=>(function(e){e.axisLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Roboto, Segoe UI, Noto, Sans-serif"},e.smithchartTitleFont={size:"15px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Roboto, Segoe UI, Noto, Sans-serif"},e.smithchartSubtitleFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Roboto, Segoe UI, Noto, Sans-serif"},e.dataLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Roboto, Segoe UI, Noto, Sans-serif"},e.legendLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Roboto, Segoe UI, Noto, Sans-serif"}}($l||($l={})),$l))(),ea=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class ta extends a.rt{}ea([(0,a.Z9)(!0)],ta.prototype,"visible",void 0),ea([(0,a.Z9)("")],ta.prototype,"text",void 0),ea([(0,a.Z9)("")],ta.prototype,"description",void 0),ea([(0,a.Z9)("Center")],ta.prototype,"textAlignment",void 0),ea([(0,a.Zz)($l.legendLabelFont,vl)],ta.prototype,"textStyle",void 0);class ia extends a.rt{}ea([(0,a.Z9)(0)],ia.prototype,"x",void 0),ea([(0,a.Z9)(0)],ia.prototype,"y",void 0);class sa extends a.rt{}ea([(0,a.Z9)(1)],sa.prototype,"width",void 0),ea([(0,a.Z9)(null)],sa.prototype,"color",void 0);class oa extends a.rt{}ea([(0,a.Z9)(10)],oa.prototype,"width",void 0),ea([(0,a.Z9)(10)],oa.prototype,"height",void 0),ea([(0,a.Zz)({},sa)],oa.prototype,"border",void 0);class la extends a.rt{}ea([(0,a.Z9)(1)],la.prototype,"width",void 0),ea([(0,a.Z9)(null)],la.prototype,"color",void 0);class aa extends a.rt{}ea([(0,a.Z9)(!1)],aa.prototype,"visible",void 0),ea([(0,a.Z9)("bottom")],aa.prototype,"position",void 0),ea([(0,a.Z9)("Center")],aa.prototype,"alignment",void 0),ea([(0,a.Z9)(null)],aa.prototype,"width",void 0),ea([(0,a.Z9)(null)],aa.prototype,"height",void 0),ea([(0,a.Z9)("circle")],aa.prototype,"shape",void 0),ea([(0,a.Z9)(null)],aa.prototype,"rowCount",void 0),ea([(0,a.Z9)(null)],aa.prototype,"columnCount",void 0),ea([(0,a.Z9)(8)],aa.prototype,"itemPadding",void 0),ea([(0,a.Z9)(5)],aa.prototype,"shapePadding",void 0),ea([(0,a.Z9)("")],aa.prototype,"description",void 0),ea([(0,a.Z9)(!0)],aa.prototype,"toggleVisibility",void 0),ea([(0,a.Zz)({},ta)],aa.prototype,"title",void 0),ea([(0,a.Zz)({},ia)],aa.prototype,"location",void 0),ea([(0,a.Zz)({},oa)],aa.prototype,"itemStyle",void 0),ea([(0,a.Zz)({},la)],aa.prototype,"border",void 0),ea([(0,a.Zz)($l.legendLabelFont,vl)],aa.prototype,"textStyle",void 0);var ra=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class na extends a.rt{}ra([(0,a.Z9)(1)],na.prototype,"width",void 0),ra([(0,a.Z9)("")],na.prototype,"dashArray",void 0),ra([(0,a.Z9)(!0)],na.prototype,"visible",void 0),ra([(0,a.Z9)(null)],na.prototype,"color",void 0),ra([(0,a.Z9)(1)],na.prototype,"opacity",void 0);class ha extends a.rt{}ra([(0,a.Z9)(1)],ha.prototype,"width",void 0),ra([(0,a.Z9)("")],ha.prototype,"dashArray",void 0),ra([(0,a.Z9)(!1)],ha.prototype,"visible",void 0),ra([(0,a.Z9)(null)],ha.prototype,"color",void 0),ra([(0,a.Z9)(8)],ha.prototype,"count",void 0);class da extends a.rt{}ra([(0,a.Z9)(!0)],da.prototype,"visible",void 0),ra([(0,a.Z9)(1)],da.prototype,"width",void 0),ra([(0,a.Z9)(null)],da.prototype,"color",void 0),ra([(0,a.Z9)("")],da.prototype,"dashArray",void 0);class ca extends a.rt{}ra([(0,a.Z9)(!0)],ca.prototype,"visible",void 0),ra([(0,a.Z9)("Outside")],ca.prototype,"labelPosition",void 0),ra([(0,a.Z9)("Hide")],ca.prototype,"labelIntersectAction",void 0),ra([(0,a.Zz)({},na)],ca.prototype,"majorGridLines",void 0),ra([(0,a.Zz)({},ha)],ca.prototype,"minorGridLines",void 0),ra([(0,a.Zz)({},da)],ca.prototype,"axisLine",void 0),ra([(0,a.Zz)($l.axisLabelFont,vl)],ca.prototype,"labelStyle",void 0);var pa=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class ua extends a.rt{}pa([(0,a.Z9)(!0)],ua.prototype,"visible",void 0),pa([(0,a.Z9)("")],ua.prototype,"text",void 0),pa([(0,a.Z9)("")],ua.prototype,"description",void 0),pa([(0,a.Z9)("Far")],ua.prototype,"textAlignment",void 0),pa([(0,a.Z9)(!0)],ua.prototype,"enableTrim",void 0),pa([(0,a.Z9)(null)],ua.prototype,"maximumWidth",void 0),pa([(0,a.Zz)($l.smithchartSubtitleFont,vl)],ua.prototype,"textStyle",void 0);class ga extends a.rt{}pa([(0,a.Z9)(!0)],ga.prototype,"visible",void 0),pa([(0,a.Z9)("")],ga.prototype,"text",void 0),pa([(0,a.Z9)("")],ga.prototype,"description",void 0),pa([(0,a.Z9)("Center")],ga.prototype,"textAlignment",void 0),pa([(0,a.Z9)(!0)],ga.prototype,"enableTrim",void 0),pa([(0,a.Z9)(null)],ga.prototype,"maximumWidth",void 0),pa([(0,a.Zz)({},ua)],ga.prototype,"subtitle",void 0),pa([(0,a.Zz)($l.smithchartTitleFont,vl)],ga.prototype,"font",void 0),pa([(0,a.Zz)($l.smithchartTitleFont,vl)],ga.prototype,"textStyle",void 0);var ma=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class ba extends a.rt{}ma([(0,a.Z9)(1)],ba.prototype,"width",void 0),ma([(0,a.Z9)(null)],ba.prototype,"color",void 0);class fa extends a.rt{}ma([(0,a.Z9)(!1)],fa.prototype,"visible",void 0),ma([(0,a.Z9)(null)],fa.prototype,"fill",void 0),ma([(0,a.Z9)(.95)],fa.prototype,"opacity",void 0),ma([(0,a.Z9)("")],fa.prototype,"template",void 0),ma([(0,a.Zz)({},ba)],fa.prototype,"border",void 0);class ya extends a.rt{}ma([(0,a.Z9)(3)],ya.prototype,"width",void 0),ma([(0,a.Z9)("white")],ya.prototype,"color",void 0);class va extends a.rt{}ma([(0,a.Z9)(.1)],va.prototype,"width",void 0),ma([(0,a.Z9)("white")],va.prototype,"color",void 0);class Sa extends a.rt{}ma([(0,a.Z9)(1)],Sa.prototype,"width",void 0),ma([(0,a.Z9)(null)],Sa.prototype,"color",void 0);class xa extends a.rt{}ma([(0,a.Z9)(!1)],xa.prototype,"visible",void 0),ma([(0,a.Z9)("")],xa.prototype,"template",void 0),ma([(0,a.Z9)(null)],xa.prototype,"fill",void 0),ma([(0,a.Z9)(1)],xa.prototype,"opacity",void 0),ma([(0,a.Zz)({},va)],xa.prototype,"border",void 0),ma([(0,a.Zz)({},Sa)],xa.prototype,"connectorLine",void 0),ma([(0,a.Zz)($l.dataLabelFont,vl)],xa.prototype,"textStyle",void 0);class wa extends a.rt{}ma([(0,a.Z9)(!1)],wa.prototype,"visible",void 0),ma([(0,a.Z9)("circle")],wa.prototype,"shape",void 0),ma([(0,a.Z9)(6)],wa.prototype,"width",void 0),ma([(0,a.Z9)(6)],wa.prototype,"height",void 0),ma([(0,a.Z9)("")],wa.prototype,"imageUrl",void 0),ma([(0,a.Z9)("")],wa.prototype,"fill",void 0),ma([(0,a.Z9)(1)],wa.prototype,"opacity",void 0),ma([(0,a.Zz)({},ya)],wa.prototype,"border",void 0),ma([(0,a.Zz)({},xa)],wa.prototype,"dataLabel",void 0);class Ca extends a.rt{}ma([(0,a.Z9)("visible")],Ca.prototype,"visibility",void 0),ma([(0,a.Z9)([])],Ca.prototype,"points",void 0),ma([(0,a.Z9)("")],Ca.prototype,"resistance",void 0),ma([(0,a.Z9)("")],Ca.prototype,"reactance",void 0),ma([(0,a.Z9)("")],Ca.prototype,"tooltipMappingName",void 0),ma([(0,a.Z9)(null)],Ca.prototype,"dataSource",void 0),ma([(0,a.Z9)("")],Ca.prototype,"name",void 0),ma([(0,a.Z9)(null)],Ca.prototype,"fill",void 0),ma([(0,a.Z9)(!1)],Ca.prototype,"enableAnimation",void 0),ma([(0,a.Z9)("2000ms")],Ca.prototype,"animationDuration",void 0),ma([(0,a.Z9)(!1)],Ca.prototype,"enableSmartLabels",void 0),ma([(0,a.Z9)(1)],Ca.prototype,"width",void 0),ma([(0,a.Z9)(1)],Ca.prototype,"opacity",void 0),ma([(0,a.Zz)({},wa)],Ca.prototype,"marker",void 0),ma([(0,a.Zz)({},fa)],Ca.prototype,"tooltip",void 0);class Ma{calculateAreaBounds(e,t,i){const s=e.margin,o=e.border,l=this.getLegendSpace(e,i),a=l.leftLegendWidth+s.left+o.width;return{x:a,y:s.top+2*e.elementSpacing+l.modelTitleHeight+l.modelsubTitleHeight+l.topLegendHeight+o.width,width:e.availableSize.width-(a+(l.rightLegendWidth+s.left+s.right+2*o.width)),height:e.availableSize.height-(l.modelTitleHeight+2*e.elementSpacing+l.modelsubTitleHeight+s.top+l.topLegendHeight+l.bottomLegendHeight)}}getLegendSpace(e,t){const i=e.title,s=e.legendSettings,o=s.position.toLowerCase();let l=0,a=0;const r=e.font;let n,h=0,d=0,c=0,p=0,u=0,g=0;return s.visible&&(n=t.width+5+e.elementSpacing+2*s.border.width,d="left"===o?n:0,c="right"===o?n:0,g=s.title.visible?Yl(s.title.text,r).height:0,p="top"===o?e.elementSpacing+t.height+g:0,u="bottom"===o?e.elementSpacing+t.height+g:0),l=Yl(i.subtitle.text,r).height,h=0,a=""!==i.subtitle.text&&i.subtitle.visible?l:0,{leftLegendWidth:d,rightLegendWidth:c,topLegendHeight:p,bottomLegendHeight:u,modelTitleHeight:0,modelsubTitleHeight:a}}}const Ta="animationComplete",La="titleRender",Aa="subtitleRender",Da="textRender",Ra="seriesRender",Ia="axisLabelRender";class Pa{constructor(){this.radialLabels=[-50,-20,-10,-5,-4,-3,-2,-1.5,-1,-.8,-.6,-.4,-.2,0,.2,.4,.6,.8,1,1.5,2,3,4,5,10,20,50],this.radialLabelCollections=[],this.horizontalLabelCollections=[],this.labelCollections=[],this.direction=new Pl}renderArea(e,t){this.calculateChartArea(e,t),this.calculateCircleMargin(e,t),this.calculateXAxisRange(e),this.calculateRAxisRange(e),this.measureHorizontalAxis(e),this.measureRadialAxis(e),e.horizontalAxis.visible&&this.updateHAxis(e),e.radialAxis.visible&&this.updateRAxis(e),e.horizontalAxis.visible&&this.drawHAxisLabels(e),e.radialAxis.visible&&this.drawRAxisLabels(e)}updateHAxis(e){const t=e.horizontalAxis.minorGridLines,i=e.horizontalAxis.axisLine;e.horizontalAxis.majorGridLines.visible&&this.updateHMajorGridLines(e),t.visible&&this.updateHMinorGridLines(e),i.visible&&this.updateHAxisLine(e)}updateRAxis(e){const t=e.radialAxis.minorGridLines,i=e.radialAxis.axisLine;e.radialAxis.majorGridLines.visible&&this.updateRMajorGridLines(e),t.visible&&this.updateRMinorGridLines(e),i.visible&&this.updateRAxisLine(e)}measureHorizontalAxis(e){const t=e.horizontalAxis.minorGridLines;this.measureHMajorGridLines(e),t.visible&&this.measureHMinorGridLines(e)}measureRadialAxis(e){const t=e.radialAxis.minorGridLines;this.measureRMajorGridLines(e),t.visible&&this.measureRMinorGridLines(e)}calculateChartArea(e,t){let i=e.availableSize.width,s=e.availableSize.height;i=t.width,s=t.height;const o=Math.min(i,s),l=Math.min(i,s);e.chartArea={x:t.x+(t.width/2-o/2),y:t.y+((s-l)/2>0?(s-l)/2:0),width:o,height:l}}calculateCircleMargin(e,t){let i=0;const s=e.chartArea.width,o=e.radius;i=this.maximumLabelLength(e);const l="Outside"===e.radialAxis.labelPosition?i+10:10,a=(s-2*l>0?s-2*l:0)/2,r=o>1?1:o<.1?.1:o;this.areaRadius=a*r,this.circleLeftX=e.chartArea.x+l+a*(1-r),this.circleTopY=e.chartArea.y+l+a*(1-r),this.circleCenterX=this.circleLeftX+this.areaRadius,this.circleCenterY=t.y+t.height/2}maximumLabelLength(e){let t=0;const i=e.horizontalAxis.labelStyle;let s,o;for(let l=0;l<this.radialLabels.length;l++)s=this.radialLabels[l].toString(),o=Yl(s,i),t<o.width&&(t=o.width);return t}calculateAxisLabels(){let e=0,t=0;const i=[],s=2*this.areaRadius;for(let l=0;l<2;l+=.1){l=Math.round(10*l)/10;let o=!1,a=!1;const r=s*(1/(l+1))/2*2;0!==e&&1!==l?(l<1&&(o=this.isOverlap(1,s,r,30)),l>1&&(a=this.isOverlap(2,s,r,30)),o||a||e-r>=30&&(i[t]=l,t++,e=r)):(e=r,i[t]=l,t++)}const o=[2,3,4,5,10,20,50];for(let l=0;l<o.length;l++)i[t]=o[l],t++;return i}isOverlap(e,t,i,s){return i-t*(1/(e+1))/2*2<s}calculateXAxisRange(e){let t,i,s,o;const l=2*this.areaRadius,a=this.calculateAxisLabels(),r=this.circleCenterY,n=this.circleLeftX;let h=this.circleLeftX;for(let d=0;d<a.length;d++)t=a[d],i=1/(t+1),s=l*i/2,"Impedance"===e.renderType&&(h=n+l-2*s),o=h+s,this.horizontalLabelCollections.push({centerX:o,centerY:r,radius:s,value:t,region:null})}calculateRAxisRange(e){let t,i;const s=2*this.areaRadius;let o;const l=new Dl;"Impedance"===e.renderType?(l.x=this.circleLeftX+s,l.y=this.circleTopY+this.areaRadius):(l.x=this.circleLeftX,l.y=this.circleTopY+this.areaRadius);for(let a=0;a<this.radialLabels.length;a++)o=this.radialLabels[a],i=Math.abs(1/o*s/2),t="Impedance"===e.renderType?o>0?l.y-i:l.y+i:o<0?l.y-i:l.y+i,this.radialLabelCollections.push({centerX:l.x,centerY:t,radius:i,value:o})}measureHMajorGridLines(e){let t,i,s,o,l,a=[];this.majorHGridArcPoints=[];for(let r=0;r<this.horizontalLabelCollections.length;r++){let n=new Ml;n=this.horizontalLabelCollections[r],a=this.calculateHMajorArcStartEndPoints(n.value),"Impedance"===e.renderType?(s=a[0],o=a[1]):(s=a[1],o=a[0]),l={width:n.radius,height:n.radius},0!==n.value&&50!==n.value?(t=this.intersectingCirclePoints(s[0].centerX,s[0].centerY,s[0].radius,n.centerX,n.centerY,n.radius,e.renderType),i=this.intersectingCirclePoints(o[0].centerX,o[0].centerY,o[0].radius,n.centerX,n.centerY,n.radius,e.renderType),this.majorHGridArcPoints.push({startPoint:t,endPoint:i,rotationAngle:2*Math.PI,sweepDirection:"Impedance"===e.renderType?this.direction.counterclockwise:this.direction.clockwise,isLargeArc:!0,size:l})):(t={x:n.centerX+n.radius,y:n.centerY},i={x:n.centerX+n.radius,y:n.centerY-.05},this.majorHGridArcPoints.push({startPoint:t,endPoint:i,rotationAngle:2*Math.PI,sweepDirection:this.direction.clockwise,isLargeArc:!0,size:l}))}}measureRMajorGridLines(e){let t,i,s,o,l,a,r,n,h,d,c=[];this.majorRGridArcPoints=[],this.labelCollections=[];const p=Zl();for(let u=0;u<this.radialLabelCollections.length;u++)t=this.radialLabelCollections[u],t.radius<=p||(i=t.value,c=this.calculateMajorArcStartEndPoints(t,Math.abs(i),e),s=c[0],o=c[1],l=this.circleXYRadianValue(this.circleCenterX,this.circleCenterY,o.x,o.y),a=l*(180/Math.PI),0!==i?(r={x:s.x,y:s.y},n={x:o.x,y:o.y},h={width:t.radius,height:t.radius},d=i>0?this.direction.clockwise:this.direction.counterclockwise,this.majorRGridArcPoints.push({startPoint:r,endPoint:n,size:h,rotationAngle:2*Math.PI,isLargeArc:!1,sweepDirection:d}),this.labelCollections.push({centerX:o.x,centerY:o.y,angle:a,value:i,radius:this.areaRadius,region:null})):(r={x:this.circleLeftX,y:this.circleCenterY},n={x:this.circleCenterX+this.areaRadius,y:this.circleCenterY},this.majorRGridArcPoints.push({startPoint:r,endPoint:n,size:null,rotationAngle:null,isLargeArc:null,sweepDirection:null}),this.labelCollections.push({centerX:"Impedance"===e.renderType?this.circleCenterX-this.areaRadius:this.circleCenterX+this.areaRadius,centerY:this.circleCenterY,angle:"Impedance"===e.renderType?180:360,value:i,radius:this.areaRadius,region:null})))}circleXYRadianValue(e,t,i,s){let o;return o=Math.atan2(s-t,i-e),o=o<0?o+360*Math.PI/180:o,o}calculateMajorArcStartEndPoints(e,t,i){const s=[];let o=[];const l=this.circleCenterX,a=this.circleCenterY;return t>=10?s[0]="Impedance"===i.renderType?{x:l+this.areaRadius,y:a}:{x:l-this.areaRadius,y:a}:o=this.horizontalLabelCollections.filter(t>=3?e=>10===e.value:t>=1?e=>5===e.value:e=>3===e.value),o.length>0&&(s[0]=this.intersectingCirclePoints(e.centerX,e.centerY,e.radius,o[0].centerX,o[0].centerY,o[0].radius,i.renderType)),s[1]=this.intersectingCirclePoints(e.centerX,e.centerY,e.radius,l,a,this.areaRadius,i.renderType),s}calculateHMajorArcStartEndPoints(e){const t=[];let i,s;return e<=.3?(i=2,s=-2):e<=1?(i=3,s=-3):e<=2?(i=5,s=-5):e<=5?(i=10,s=-10):(i=50,s=-50),t[0]=this.radialLabelCollections.filter(e=>e.value===i),t[1]=this.radialLabelCollections.filter(e=>e.value===s),t}calculateMinorArcStartEndPoints(e){let t,i;const s=[];return e<=.1?(t=1,i=-1):e<=.2?(t=.8,i=-.8):e<=.3?(t=.4,i=-.4):e<=.6?(t=1,i=-1):e<=1?(t=1.5,i=-1.5):e<=1.5?(t=2,i=-2):e<=2?(t=1,i=-1):e<=5?(t=3,i=-3):(t=10,i=-10),s[0]=this.radialLabelCollections.filter(e=>e.value===t),s[1]=this.radialLabelCollections.filter(e=>e.value===i),s}intersectingCirclePoints(e,t,i,s,o,l,a){const r={x:0,y:0},n=e-s,h=t-o,d=Math.sqrt(n*n+h*h),c=d*d,p=(i*i-l*l)/(2*c),u=i*i-l*l,g=Math.sqrt(2*(i*i+l*l)/c-u*u/(c*c)-1),m=(e+s)/2+p*(s-e),b=g*(o-t)/2,f=m+b,y=m-b,v=(t+o)/2+p*(o-t),S=g*(e-s)/2,x=v+S,w=v-S;return"Impedance"===a?y<f?(r.x=y,r.y=w):(r.x=f,r.y=x):f>y?(r.x=f,r.y=x):(r.x=y,r.y=w),{x:r.x,y:r.y}}updateHMajorGridLines(e){const t=e.horizontalAxis.majorGridLines,i=e.renderer.createGroup({id:e.element.id+"_svg_horizontalAxisMajorGridLines"}),s=this.calculateGridLinesPath(this.majorHGridArcPoints),o=new Hl(e.element.id+"_horizontalAxisMajorGridLines","none",t.width,t.color?t.color:e.themeStyle.majorGridLine,t.opacity,t.dashArray,s),l=e.renderer.drawPath(o);i.appendChild(l),e.svgObject.appendChild(i)}updateRMajorGridLines(e){const t=e.radialAxis.majorGridLines,i=e.renderer.createGroup({id:e.element.id+"_svg_radialAxisMajorGridLines"}),s=this.calculateGridLinesPath(this.majorRGridArcPoints),o=new Hl(e.element.id+"_radialAxisMajorGridLines","none",t.width,t.color?t.color:e.themeStyle.majorGridLine,t.opacity,t.dashArray,s),l=e.renderer.drawPath(o);i.appendChild(l),e.svgObject.appendChild(i)}updateHAxisLine(e){const t=this.areaRadius,i=e.horizontalAxis.axisLine,s=e.renderer.createGroup({id:e.element.id+"_svg_hAxisLine"}),o=2*Math.PI,l=new Hl(e.element.id+"_horizontalAxisLine","none",i.width,i.color?i.color:e.themeStyle.axisLine,1,i.dashArray,"M"+(this.circleCenterX+t)+" "+this.circleCenterY+" A "+t+" "+t+" "+o+" 1 "+this.direction.clockwise+" "+(this.circleCenterX+t)+" "+(this.circleCenterY-.05)),a=e.renderer.drawPath(l);s.appendChild(a),e.svgObject.appendChild(s)}updateRAxisLine(e){const t=this.areaRadius,i=e.radialAxis.axisLine,s=new Hl(e.element.id+"_radialAxisLine","none",i.width,i.color?i.color:e.themeStyle.axisLine,1,i.dashArray,"M "+(this.circleCenterX-t)+" "+this.circleCenterY+" A 0 0 0 0 "+this.direction.counterclockwise+" "+(this.circleCenterX+t)+" "+this.circleCenterY),o=e.renderer.createGroup({id:e.element.id+"_svg_rAxisLine"}),l=e.renderer.drawPath(s);o.appendChild(l),e.svgObject.appendChild(o)}drawHAxisLabels(e){const t=e.horizontalAxis;e.radialAxis.labelStyle.fontFamily=e.themeStyle.fontFamily||e.radialAxis.labelStyle.fontFamily;const i=e.horizontalAxis.labelStyle;let s,o,l,a,r,n,h,d,c,p,u,g,m;const b=e.renderer.createGroup({id:e.element.id+"_HAxisLabels"});for(let f=0;f<this.horizontalLabelCollections.length;f++)if(s=this.horizontalLabelCollections[f],o=this.horizontalLabelCollections[f].value.toString(),0!==s.value){if(l="Impedance"===e.renderType?s.centerX-s.radius:s.centerX+s.radius,a=s.centerY,r=Yl(o,i),l="Impedance"===e.renderType?l-r.width:l,"Outside"===t.labelPosition?a-=r.height/4:a+=r.height,this.horizontalLabelCollections[f].region=this.calculateRegion(o,r,l,a),"Hide"===t.labelIntersectAction){n=this.horizontalLabelCollections[f],h=n.region.bounds,d=h.width,c=h.x;for(let t=1;t<f;t++)p=this.horizontalLabelCollections[t],u=p.region.bounds,g=u.width,m=u.x,"Impedance"===e.renderType&&m+g>c&&(o=""),"Admittance"===e.renderType&&m<c+d&&(o="")}const y={text:o.toString(),x:l,y:a,name:Ia,cancel:!1},v=t=>{if(!t.cancel){const t=new Wl(e.element.id+"_HLabel_"+f,y.x,y.y,"none",y.text),s=i.color?i.color:e.themeStyle.axisLabel;i.fontFamily=i.fontFamily||e.themeStyle.labelFontFamily;const o=Kl(t,i,s,b);b.appendChild(o)}};v.bind(this),e.trigger(Ia,y,v)}e.svgObject.appendChild(b)}drawRAxisLabels(e){e.radialAxis.labelStyle.fontFamily=e.themeStyle.fontFamily||e.radialAxis.labelStyle.fontFamily;const t=e.radialAxis.labelStyle;let i,s,o,l,a,r,n,h,d,c,p,u,g,m,b,f,y,v=new Tl;const S=e.radialAxis,x=e.renderer.createGroup({id:e.element.id+"_RAxisLabels"});for(let w=0;w<this.labelCollections.length;w++){if(v=this.labelCollections[w],i=v.value.toString(),s=Yl(i,t),o=Math.round(100*v.angle)/100,"Outside"===S.labelPosition?(l=this.circlePointPosition(this.circleCenterX,this.circleCenterY,v.angle,this.areaRadius+2),a=this.setLabelsOutsidePosition(o,l.x,l.y,s)):(l=this.circlePointPosition(this.circleCenterX,this.circleCenterY,v.angle,this.areaRadius-2),a=this.setLabelsInsidePosition(o,l.x,l.y,s)),this.labelCollections[w].region=this.calculateRegion(i,s,a.x,a.y),"Hide"===S.labelIntersectAction){c=this.labelCollections[w],p=c.region.bounds,h=p.width,d=p.height,r=p.x,n=p.y;for(let e=0;e<w;e++)f=this.labelCollections[e],y=f.region.bounds,m=y.width,b=y.height,u=y.x,g=y.y,u<=r+h&&r<=u+m&&g<=n+d&&n<=g+b&&(i=" ")}const C={text:i.toString(),x:a.x,y:a.y,name:Ia,cancel:!1},M=i=>{if(!i.cancel){const i=new Wl(e.element.id+"_RLabel_"+w,C.x,C.y,"none",C.text),s=t.color?t.color:e.themeStyle.axisLabel;t.fontFamily=e.themeStyle.labelFontFamily?e.themeStyle.labelFontFamily:t.fontFamily;const o=Kl(i,t,s,x);x.appendChild(o)}};M.bind(this),e.trigger(Ia,C,M)}e.svgObject.appendChild(x)}calculateRegion(e,t,i,s){let o=new Cl;return o={bounds:{x:i,y:s,width:t.width,height:t.height},labelText:e},o}updateHMinorGridLines(e){const t=e.horizontalAxis.minorGridLines,i=e.renderer.createGroup({id:e.element.id+"_svg_horizontalAxisMinorGridLines"}),s=this.calculateGridLinesPath(this.minorHGridArcPoints),o=new Hl(e.element.id+"_horizontalAxisMinorGridLines","none",t.width,t.color?t.color:e.themeStyle.minorGridLine,t.opacity,t.dashArray,s),l=e.renderer.drawPath(o);i.appendChild(l),e.svgObject.appendChild(i)}updateRMinorGridLines(e){const t=e.radialAxis.minorGridLines,i=e.renderer.createGroup({id:e.element.id+"_svg_radialAxisMinorGridLines"}),s=this.calculateGridLinesPath(this.minorGridArcPoints),o=new Hl(e.element.id+"_radialAxisMinorGridLines","none",t.width,t.color?t.color:e.themeStyle.minorGridLine,t.opacity,t.dashArray,s),l=e.renderer.drawPath(o);i.appendChild(l),e.svgObject.appendChild(i)}calculateGridLinesPath(e){let t,i,s,o,l,a,r,n,h,d=new Ol,c="";for(let p=0;p<e.length;p++)d=e[p],t=d.startPoint.x,i=d.startPoint.y,s=d.endPoint.x,o=d.endPoint.y,l=d.size?d.size.width:0,a=d.size?d.size.height:0,r=d.rotationAngle?d.rotationAngle:0,n=d.isLargeArc?1:0,h=d.sweepDirection?d.sweepDirection:0,c=c+"M "+t+" "+i+" A "+l+" "+a+" "+r+" "+n+" "+h+" "+s+" "+o+" ";return c.toString()}measureHMinorGridLines(e){let t,i,s,o,l,a,r,n=[];const h=e.horizontalAxis.minorGridLines.count;let d,c,p,u,g,m,b;this.minorHGridArcPoints=[];const f=2*this.areaRadius;for(let y=0;y<this.horizontalLabelCollections.length-3;y++){d=this.horizontalLabelCollections[y],c=this.horizontalLabelCollections[y+1],p=2*(d.radius-c.radius),u=Math.floor(h/100*p),g=p/u;for(let h=0;h<u;h++)m=c.radius+h*g/2,b="Impedance"===e.renderType?this.circleLeftX+f-2*m:this.circleLeftX,r=b+m,s=c.value>5,n=this.calculateMinorArcStartEndPoints(c.value),"Impedance"===e.renderType?(t=n[0],i=n[1]):(t=n[1],i=n[0]),o=this.intersectingCirclePoints(t[0].centerX,t[0].centerY,t[0].radius,r,d.centerY,m,e.renderType),l=this.intersectingCirclePoints(i[0].centerX,i[0].centerY,i[0].radius,r,d.centerY,m,e.renderType),a={width:m,height:m},this.minorHGridArcPoints.push({startPoint:o,endPoint:l,rotationAngle:2*Math.PI,sweepDirection:"Impedance"===e.renderType?this.direction.counterclockwise:this.direction.clockwise,isLargeArc:s,size:a})}}measureRMinorGridLines(e){const t=e.radialAxis.minorGridLines.count;let i,s,o,l,a,r,n,h,d,c,p;const u=Math.PI*(2*this.areaRadius),g=i="Impedance"===e.renderType?this.circleCenterX+this.areaRadius:this.circleCenterX-this.areaRadius,m=this.circleCenterY;this.minorGridArcPoints=[];const b={x:g,y:m};for(let f=2;f<this.labelCollections.length-3;f++){a=this.labelCollections[f],r=this.labelCollections[f+1],"Impedance"===e.renderType?(s=360===r.angle?0:r.angle,o=Math.abs(s-a.angle)):(s=360===a.angle?0:a.angle,o=Math.abs(s-r.angle)),h=u/360*o,d=Math.floor(t/100*h),c=o/d,p=r.value>0?r.value:a.value,l=this.minorGridLineArcIntersectCircle(Math.abs(p));for(let t=1;t<d;t++){const o=c*t+(360===a.angle?s:a.angle),r=this.circlePointPosition(this.circleCenterX,this.circleCenterY,o,this.areaRadius),h=this.arcRadius(b,r,o),d=this.intersectingCirclePoints(i,o>180?this.circleCenterY-h:this.circleCenterY+h,h,l[0].centerX,l[0].centerY,l[0].radius,e.renderType);n={width:h,height:h},this.minorGridArcPoints.push({startPoint:{x:d.x,y:d.y},endPoint:{x:r.x,y:r.y},rotationAngle:2*Math.PI,sweepDirection:a.value>=0?this.direction.clockwise:this.direction.counterclockwise,isLargeArc:!1,size:n})}}}minorGridLineArcIntersectCircle(e){let t;return t=e>=3?20:e>=1.5?10:e>=.6?3:2,this.horizontalLabelCollections.filter(e=>e.value===t)}circlePointPosition(e,t,i,s){const o=i*(Math.PI/180);return{x:e+s*Math.cos(o),y:t+s*Math.sin(o)}}setLabelsInsidePosition(e,t,i,s){let o=t,l=i;return 0===e||360===e?(o-=s.width,l-=s.height/2):90===e?(o-=s.width,l+=s.height/8):180===e?l+=s.height:270===e?l+=s.height/2:e>0&&e<=20?o-=s.width:e>20&&e<=60?(o-=s.width+s.width/2,l+=s.height/2):e>60&&e<90?(o-=s.width+s.width/4,l+=s.height/4):e>90&&e<=135?(o-=s.width/2,l+=s.height/16):e>135&&e<=150?(o+=s.width/2,l+=s.height/2):e>150&&e<180?(o+=s.width/2,l+=s.height):e>180&&e<=210?(o+=s.width/6,l+=s.height/6):e>210&&e<240?l+=s.height/4:e>225&&e<270?l+=s.height/3:e>270&&e<=300?(o-=s.width+s.width/4,l+=s.height/4):e>300&&e<=330?(o-=s.width+s.width/3,l+=s.height/4):e>330&&e<=340?(o-=s.width+s.width/2,l+=s.height/4):e>340&&(o-=s.width,l+=s.height/8),{x:o,y:l}}setLabelsOutsidePosition(e,t,i,s){let o=t,l=i;return 90===e?(o-=s.width/2,l+=s.height):180===e?(o-=s.width+5,l-=s.height/4):270===e?(o-=s.width/2,l-=s.height/4):360===e?(o+=5,l-=s.height/2):e>0&&e<=30?(o+=s.width/4,l+=s.height/8):e>30&&e<=60?(o+=s.width/2,l+=s.height/4):e>60&&e<=90?(o-=s.width/2,l+=s.height):e>90&&e<=135?(o-=s.width,l+=s.height):e>135&&e<=180?(o-=s.width+s.width/4,l+=s.height/4):e>180&&e<=210?(o-=s.width+s.width/4,l-=s.height/4):e>210&&e<=270?(o-=s.width,l-=s.height/4):e>270&&e<=340?l-=s.height/4:e>340&&(l+=s.height/4,o+=s.width/6),{x:o,y:l}}arcRadius(e,t,i){const s=i>180?90*Math.PI/180:270*Math.PI/180,o=(t.x-e.x)/2,l=(t.y-e.y)/2,a=(l-o*((Math.cos(s)*l-Math.sin(s)*o)/(Math.cos(s)*o+Math.sin(s)*l)))/Math.sin(s),r=e.y+Math.sin(s)*a;return Math.abs(e.y-r)}}class ka{drawMarker(e,t,i,s){if(e.series[t].marker.visible){const o=e.series[t].marker,l=e.series[t].points.length-1,a=o.width,r=o.height,n=o.shape,h=e.renderer.createGroup({id:e.element.id+"_svg_series"+t+"_Marker"});i.appendChild(h);const d=o.border.width,c=o.border.color,p=o.opacity,u=o.fill?o.fill:e.series[t].fill||e.seriesColors[t%e.seriesColors.length];for(let i=0;i<l+1;i++){const l=s[i].point,g=new Rl(e.element.id+"_Series"+t+"_Points"+i+"_Marker"+i,u,c,d,p);h.appendChild(this.drawSymbol(n,o.imageUrl,l,new Fl(a,r),g,e))}}}drawSymbol(e,t,i,s,o,l){let a;const r=e.toLowerCase();let n,h,d;const c={color:o.borderColor,width:o.borderWidth},p=o.opacity,u=i.x,g=i.y,m=Math.sqrt(s.height*s.height+s.width*s.width)/2;switch(r){case"circle":n=new Gl(o.id,o.fill,c,p,i.x,i.y,m,null),a=l.renderer.drawCircle(n);break;case"rectangle":d="M "+(u+-s.width/2)+" "+(g+-s.height/2)+" L "+(u+s.width/2)+" "+(g+-s.height/2)+" L "+(u+s.width/2)+" "+(g+s.height/2)+" L "+(u+-s.width/2)+" "+(g+s.height/2)+" L "+(u+-s.width/2)+" "+(g+-s.height/2)+"z",h=new Hl(o.id,o.fill,c.width,c.color,p,"",d),a=l.renderer.drawPath(h);break;case"triangle":d="M "+(u+-s.width/2)+" "+(g+s.height/2)+" L "+u+" "+(g+-s.height/2)+" L "+(u+s.width/2)+" "+(g+s.height/2)+" L "+(u+-s.width/2)+" "+(g+s.height/2)+"z",h=new Hl(o.id,o.fill,c.width,c.color,p,"",d),a=l.renderer.drawPath(h);break;case"diamond":d="M "+(u+-s.width/2)+" "+g+" L "+u+" "+(g+-s.height/2)+" L "+(u+s.width/2)+" "+g+" L "+u+" "+(g+s.height/2)+" L "+(u+-s.width/2)+" "+g+"z",h=new Hl(o.id,o.fill,c.width,c.color,p,"",d),a=l.renderer.drawPath(h);break;case"pentagon":for(let e=0;e<=5;e++){const t=m*Math.cos(Math.PI/180*(72*e)),i=m*Math.sin(Math.PI/180*(72*e));d=0===e?"M "+(u+t)+" "+(g+i)+" ":d.concat("L "+(u+t)+" "+(g+i)+" ")}d=d.concat("Z"),h=new Hl(o.id,o.fill,c.width,c.color,p,"",d),a=l.renderer.drawPath(h)}return a}}class Ea{constructor(){this.textOptions=[],this.labelOptions=[],this.allPoints=[]}drawDataLabel(e,t,i,s,o){this.textOptions=[],this.allPoints=[];const l=e.margin;let a;const r=e.series[t].marker;let n,h,d,c;const p=r.dataLabel,u=p.textStyle,g=s.length;for(let b=0;b<g;b++){d=e.series[t].points[b].reactance.toString(),c=Yl(d,u),n=s[b].point;const i=n.x-c.width/2,o=n.y-(c.height+r.height+l.top),p=c.width+l.left/2+l.right/2,g=c.height+l.top/2+l.bottom/2;a=b,h=new Il,h={textX:i+l.left/2,textY:o+g/2+l.top/2,x:i,y:o},this.textOptions[b]={id:e.element.id+"_Series"+t+"_Points"+a+"_dataLabel_displayText"+b,x:h.textX,y:h.textY,fill:"black",text:d,font:u,xPosition:i,yPosition:o,width:p,height:g,location:n,labelOptions:h,visible:!0,connectorFlag:null}}const m=new El;m.textOptions=this.textOptions,this.labelOptions.push(m),this.drawDatalabelSymbol(e,t,p,i,o,s)}calculateSmartLabels(e,t){const i=e.textOptions.length;for(let s=0;s<i;s++)this.allPoints[this.allPoints.length]=e.textOptions[s],this.connectorFlag=!1,this.compareDataLabels(s,e,0,t),this.labelOptions[t].textOptions[s]=e.textOptions[s],this.labelOptions[t].textOptions[s].connectorFlag=this.connectorFlag}compareDataLabels(e,t,i,s){const o=this.allPoints.length,l=10;let a,r,n;for(let h=0;h<o;h++)if(n=this.allPoints[h],r=this.allPoints[o-1],a=this.isCollide(n,r),a)switch(this.connectorFlag=!0,i){case 0:this.resetValues(r),this.prevLabel=n,r.xPosition=this.prevLabel.xPosition+(this.prevLabel.width/2+r.width/2+l),r.x=r.xPosition+5,this.compareDataLabels(e,t,i+=1,s);break;case 1:this.resetValues(r),r.xPosition=this.prevLabel.xPosition+this.prevLabel.width/2+r.width/2+l,r.x=r.xPosition+5,r.yPosition=r.location.y+r.height/2+5,r.y=r.yPosition+r.height/2+5,this.compareDataLabels(e,t,i+=1,s);break;case 2:this.resetValues(r),r.yPosition=r.location.y+r.height/2+5,r.y=r.yPosition+r.height/2+5,this.compareDataLabels(e,t,i+=1,s);break;case 3:this.resetValues(r),r.xPosition=this.prevLabel.xPosition-this.prevLabel.width/2-r.width/2-l,r.x=r.xPosition+5,r.yPosition=r.height/2+r.location.y+5,r.y=r.yPosition+r.height/2+5,this.compareDataLabels(e,t,i+=1,s);break;case 4:this.resetValues(r),r.xPosition=this.prevLabel.xPosition-this.prevLabel.width/2-r.width/2-l,r.x=r.xPosition+5,this.compareDataLabels(e,t,i+=1,s);break;case 5:this.resetValues(r),r.xPosition=this.prevLabel.xPosition-this.prevLabel.width/2-r.width/2-l,r.x=r.xPosition+5,r.yPosition=this.prevLabel.yPosition-r.height-l,r.y=r.yPosition+r.height/2+5,this.compareDataLabels(e,t,i+=1,s);break;case 6:this.resetValues(r),r.yPosition=this.prevLabel.yPosition-(r.height+l),r.y=r.yPosition+r.height/2+5,this.compareDataLabels(e,t,i+=1,s);break;case 7:this.resetValues(r),r.xPosition=this.prevLabel.xPosition+this.prevLabel.width/2+r.width/2+l,r.x=r.xPosition+5,r.yPosition=this.prevLabel.yPosition-r.height-l,r.y=r.yPosition+r.height/2+5,this.compareDataLabels(e,t,i+=1,s);break;case 8:this.compareDataLabels(e,t,i=0,s)}}isCollide(e,t){let i=!1;return e!==t&&(i=!(e.y+e.height<t.y||e.y>t.y+t.height||e.x+e.width/2<t.x-t.width/2||e.x-e.width/2>t.x+t.width/2)),i}resetValues(e){e.xPosition=e.labelOptions.x,e.yPosition=e.labelOptions.y,e.x=e.labelOptions.textX,e.y=e.labelOptions.textY}drawConnectorLines(e,t,i,s,o){const l=s.location;let a;a=l.y>s.y?s.y:s.y-s.height/2;const r=e.series[t].marker.dataLabel.connectorLine,n=new Hl(e.element.id+"_dataLabelConnectorLine_series"+t+"_point"+i,"none",r.width,r.color?r.color:e.series[t].fill||e.seriesColors[t%e.seriesColors.length],1,"none","M "+l.x+" "+l.y+" L "+s.x+" "+a),h=e.renderer.drawPath(n);o.appendChild(h)}drawDatalabelSymbol(e,t,i,s,o,l){for(let r=0;r<e.series[t].points.length;r++)if(i.template){const s=(0,a.az)("div",{id:e.element.id+"_seriesIndex_"+t+"_Label_Template_Group",className:"template",styles:"position: absolute;"});document.getElementById(e.element.id+"_Secondary_Element").appendChild(s);const o=i.template+"_seriesIndex"+t+"_pointIndex"+r+e.element.id,n={point:e.series[t].points[r].reactance},h=Bl(_l(i.template)(e),o,n);s.appendChild(h),h.style.left=l[r].point.x-h.offsetWidth/2+"px",h.style.top=l[r].point.y-h.offsetHeight-e.series[t].marker.height/2+"px",(0,a.tx)("_seriesIndex"+t+"_pointIndex"+r+e.element.id+"Template","Template");const d=parseInt(h.style.left,10),c=parseInt(h.style.top,10);this.labelOptions[t].textOptions[r]={id:o,x:d,y:c,fill:"black",text:"",font:i.textStyle,xPosition:d,yPosition:c,width:h.offsetWidth,height:h.offsetHeight,location:l[r].point,labelOptions:{textX:d,textY:c,x:d,y:c},visible:!0,connectorFlag:null}}}}class Fa{constructor(){this.xValues=[],this.yValues=[],this.pointsRegion=[],this.lineSegments=[],this.location=[],this.dataLabel=new Ea}processData(e){const t=e.dataSource,i=e.resistance,s=e.reactance,o=e.tooltipMappingName;e.points=[];for(let l=0;l<t.length;l++)e.points.push({resistance:t[l][i],reactance:t[l][s],tooltip:t[l][o]})}draw(e,t,i){let s,o,l,a,r=e.renderer.createGroup({id:e.element.id+"_svg_seriesCollections"}),n=e.series,h=n.length,d=t.areaRadius;for(let c=0;c<h;c++){let h=c;n[c].dataSource&&n[c].resistance&&n[c].reactance&&this.processData(n[c]),this.pointsRegion[c]=[],this.location[c]=[];for(let e=0;e<n[c].points.length;e++)this.xValues[e]=n[c].points[e].resistance,this.yValues[e]=n[c].points[e].reactance;let p=t.circleCenterY,u=2*t.areaRadius,g=p,m=t.circleCenterX+("Impedance"===e.renderType?d:-d);for(let i=0;i<n[c].points.length;i++){let a=this.xValues[i],r=u*(1/(a+1))/2,n=this.yValues[i],h=Math.abs(1/n*u/2);"Impedance"===e.renderType?(o=n>0?p-h:p+h,s=t.circleLeftX+u-r):(o=n<0?p-h:p+h,s=t.circleLeftX+r),l=t.intersectingCirclePoints(m,o,h,s,g,r,e.renderType);let d=Zl();Math.abs(n)<d&&(l.x="Impedance"===e.renderType?s-r:s+r,l.y=p),this.pointsRegion[c][i]=new Al,this.pointsRegion[c][i]={point:l,x:a,y:n},this.location[c][i]={x:l.x,y:l.y}}for(let e=0;e<n[c].points.length-1;e++)a=e+1,this.lineSegments[e]=new Ll,this.lineSegments[e]={x1:this.xValues[e],y1:this.yValues[e],x2:this.xValues[a],y2:this.yValues[a]};e.svgObject.appendChild(r),this.drawSeries(e,h,r,i)}for(let c=0;c<e.series.length;c++)if(e.series[c].enableSmartLabels&&e.series[c].marker.dataLabel.visible){let t=e.renderer.createGroup({id:e.element.id+"_svg_series"+c+"_Datalabel_connectorLines"}),i=document.getElementById(e.element.id+"_svg_seriesCollection"+c);i&&i.appendChild(t),this.dataLabel.calculateSmartLabels(this.dataLabel.labelOptions[c],c);for(let s=0;s<e.series[c].points.length;s++){let i=this.dataLabel.labelOptions[c].textOptions[s];(i.xPosition+i.width>e.chartArea.x+e.chartArea.width||i.xPosition<e.chartArea.x||i.yPosition<e.chartArea.y||i.yPosition+i.height>e.chartArea.y+e.chartArea.height)&&(this.dataLabel.labelOptions[c].textOptions[s].connectorFlag=!1,this.dataLabel.labelOptions[c].textOptions[s].visible=!1),i.connectorFlag&&this.dataLabel.drawConnectorLines(e,c,s,i,t)}}for(let c=0;c<e.series.length;c++){let t=e.series[c].marker.dataLabel;if(e.series[c].marker.dataLabel.visible){let i=document.getElementById(e.element.id+"_svg_seriesCollection"+c),s=e.renderer.createGroup({id:e.element.id+"_svg_series"+c+"_Datalabel"});i&&i.appendChild(s);for(let o=0;o<e.series[c].points.length;o++){let i=this.dataLabel.labelOptions[c].textOptions[o];if(!t.template&&i.visible){let i=new kl;i=this.dataLabel.labelOptions[c].textOptions[o];let l=t.textStyle,a=new ql(e.element.id+"_Series"+c+"_Points"+o+"_dataLabel_symbol"+o,t.fill?t.fill:e.series[c].fill||e.seriesColors[c%e.seriesColors.length],e.series[c].marker.dataLabel.border,i.opacity,new wl(i.xPosition,i.yPosition,i.width,i.height)),r=e.renderer.drawRectangle(a);s.appendChild(r);let n={text:i.text,x:i.x,y:i.y,seriesIndex:c,pointIndex:o,name:Da,cancel:!1},h=t=>{if(!t.cancel){let o=Kl(new Wl(i.id,t.x,t.y,"start",t.text),l,l.color?l.color:e.themeStyle.dataLabel,s);s.appendChild(o)}};h.bind(this),e.trigger(Da,n,h)}else if(t.template){let i=document.getElementById(t.template+"_seriesIndex"+c+"_pointIndex"+o+e.element.id);i.style.left=this.dataLabel.labelOptions[c].textOptions[o].xPosition+"px",i.style.top=this.dataLabel.labelOptions[c].textOptions[o].yPosition+"px"}}}}for(let c=0;c<e.series.length;c++)if(e.series[c].enableAnimation&&e.animateSeries){e.series[c].marker.dataLabel.template&&this.animateDataLabelTemplate(c,e);let t=document.getElementById(e.element.id+"_svg_seriesCollection"+c);this.performAnimation(e,t,c)}}drawSeries(e,t,i,s){let o=e.renderer.createGroup({id:e.element.id+"_svg_seriesCollection"+t,"clip-path":"url(#"+e.element.id+"_ChartSeriesClipRect_"+t+")"});o.setAttribute("visibility",e.series[t].visibility),i.appendChild(o);let l,a,r="",n=e.series[t].points.length-1;for(let c=0;c<n;c++){let e=this.pointsRegion[t][c].point,i=this.pointsRegion[t][c+1].point;r=r+"M "+e.x+" "+e.y+" L "+i.x+" "+i.y+" "}l=r.toString();let h={text:e.series[t].name,fill:e.series[t].fill||e.seriesColors[t%e.seriesColors.length],name:Ra,cancel:!1},d=i=>{if(!i.cancel){let i=new Hl(e.element.id+"_series"+t+"_points","none",e.series[t].width,h.fill,e.series[t].opacity,"none",l);this.clipRectElement=e.renderer.drawClipPath(new ql(e.element.id+"_ChartSeriesClipRect_"+t,"transparent",{width:1,color:"Gray"},1,{x:s.x,y:s.y,width:e.availableSize.width,height:e.availableSize.height})),o.appendChild(this.clipRectElement);let r=e.renderer.createGroup({id:e.element.id+"_svg"+t});a=e.renderer.drawPath(i),r.appendChild(a),o.appendChild(r)}};d.bind(this),e.trigger(Ra,h,d),(new ka).drawMarker(e,t,o,this.pointsRegion[t]),this.dataLabel.drawDataLabel(e,t,o,this.pointsRegion[t],s)}animateDataLabelTemplate(e,t){let i=t.series[e].points.length,s=parseFloat(t.series[e].animationDuration);for(let o=0;o<i;o++){let i=document.getElementById(t.series[e].marker.dataLabel.template+"_seriesIndex"+e+"_pointIndex"+o+t.element.id);i.style.visibility="hidden",Vl(t,i,0,s,"FadeIn")}}performAnimation(e,t,i){let s,o=new a.fw({}),l=(document.getElementById("container_svg_seriesCollections"),t.childNodes[0].childNodes[0].childNodes[0]),r=Jl("Linear"),n=Jl("Reverse"),h=+l.getAttribute("width"),d=+l.getAttribute("x");o.animate(l,{duration:parseFloat(e.series[i].animationDuration),progress:t=>{"Impedance"===e.renderType?(s=r(t.timeStamp-t.delay,0,h,t.duration),l.setAttribute("width",s.toString())):(s=n(t.timeStamp-t.delay,h,0,t.duration),l.setAttribute("x",s.toString()))},end:t=>{"Impedance"===e.renderType?l.setAttribute("width",h.toString()):l.setAttribute("x",d.toString()),e.trigger(Ta,{cancel:!1,name:Ta,smithchart:e.isBlazor?null:e})}})}getLocation(e,t){let i,s;return i=this.location[e][t].x,s=this.location[e][t].y,{x:i,y:s}}}const Oa="beforePrint";class Na{constructor(e){this.control=e}print(e){this.smithchartPrint=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),this.smithchartPrint.moveTo(0,0),this.smithchartPrint.resizeTo(screen.availWidth,screen.availHeight);const t={cancel:!1,htmlContent:this.getHTMLContent(e),name:Oa};this.control.trigger(Oa,t),t.cancel||(0,a.S0)(t.htmlContent,this.smithchartPrint)}getHTMLContent(e){const t=(0,a.az)("div");return e?e instanceof Array?e.forEach(e=>{t.appendChild(Nl(e).cloneNode(!0))}):e instanceof Element?t.appendChild(e.cloneNode(!0)):t.appendChild(Nl(e).cloneNode(!0)):t.appendChild(this.control.element.cloneNode(!0)),t}export(e,t,i){const s=(0,a.az)("canvas",{id:"ej2-canvas",attrs:{width:this.control.availableSize.width.toString(),height:this.control.availableSize.height.toString()}}),o=!(a.AR.userAgent.toString().indexOf("HeadlessChrome")>-1);i=(0,a.le)(i)?f.xjJ.Landscape:i;const l=window.URL.createObjectURL(new Blob("SVG"===e?['<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+this.control.svgObject.outerHTML+"</svg>"]:[(new XMLSerializer).serializeToString(this.control.svgObject)],{type:"image/svg+xml"}));if("SVG"===e)this.triggerDownload(t,e,l,o);else{const a=new Image,r=s.getContext("2d");a.onload=()=>{if(r.drawImage(a,0,0),window.URL.revokeObjectURL(l),"PDF"===e){const e=new f.ZlO;let l=s.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream");e.pageSettings.orientation=i,l=l.slice(l.indexOf(",")+1),e.pages.add().graphics.drawImage(new f.bjq(l),0,0,this.control.availableSize.width-60,this.control.availableSize.height),o&&(e.save(t+".pdf"),e.destroy())}else this.triggerDownload(t,e,s.toDataURL("image/png").replace("image/png","image/octet-stream"),o)},a.src=l}}triggerDownload(e,t,i,s){(0,a.az)("a",{attrs:{download:e+"."+t.toLocaleLowerCase(),href:i}}).dispatchEvent(new MouseEvent(s?"click":"move",{view:window,bubbles:!1,cancelable:!0}))}}var za=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};let _a=class extends a.wA{constructor(e,t){super(e,t)}getModuleName(){return"smithchart"}getPersistData(){return""}createChartSvg(){var e;this.removeSvg(),(e=this).renderer=new y(e.element.id),function(e){const t=e.element.clientWidth,i=e.element.clientHeight;e.availableSize=new Fl(jl(e.width,t)||t||600,jl(e.height,i)||i||450)}(e),e.svgObject=e.renderer.createSvg({id:e.element.id+"_svg",width:e.availableSize.width,height:e.availableSize.height})}renderTitle(e,t,i){const s=e.font?e.font:e.textStyle;let o,l=Yl(e.text,s);const r=e.textAlignment;let n=e.text;const h=(0,a.le)(e.maximumWidth)?Math.abs(this.margin.left+this.margin.right-this.availableSize.width):e.maximumWidth;o=l.width>this.availableSize.width?this.margin.left+this.border.width:"Center"===r?this.availableSize.width/2-l.width/2:"Near"===r?this.margin.left+this.elementSpacing+this.border.width:this.availableSize.width-l.width-(this.margin.right+this.elementSpacing+this.border.width);const d=this.margin.top+l.height/2+this.elementSpacing;e.enableTrim&&l.width>h&&(n=zl(h,e.text,s),l=Yl(n,s)),i=this.renderer.createGroup({id:this.element.id+"_Title_Group"});const c={text:n,x:o,y:d,name:La,cancel:!1};let p;const u=o=>{if(!o.cancel){p=new Wl(this.element.id+"_Smithchart_"+t,o.x,o.y,"start",o.text),s.fontFamily=this.themeStyle.fontFamily||e.textStyle.fontFamily,s.size=this.themeStyle.fontSize||e.textStyle.size,Kl(p,s,this.themeStyle.chartTitle,i).setAttribute("aria-label",e.description||o.text);const a={x:o.x,y:o.y,textSize:l};this.svgObject.appendChild(i),""!==e.subtitle.text&&e.subtitle.visible&&this.renderSubtitle(e,t,l,this.availableSize,a,i)}};u.bind(this),this.trigger(La,c,u)}renderSubtitle(e,t,i,s,o,l){const r=e.subtitle.textStyle,n=e.subtitle,h=Yl(n.text,r);let d=n.text;const c=(0,a.le)(n.maximumWidth)?.75*this.bounds.width:n.maximumWidth;n.enableTrim&&h.width>c&&(d=zl(c,n.text,r));const p="Far"===e.subtitle.textAlignment?"end":"Near"===e.subtitle.textAlignment?"start":"middle",u={text:d,x:"Far"===e.subtitle.textAlignment?o.x+o.textSize.width:"Near"===e.subtitle.textAlignment?o.x:o.x+o.textSize.width/2,y:o.y+2*this.elementSpacing,name:Aa,cancel:!1},g=e=>{if(!e.cancel){const i=Kl(new Wl(this.element.id+"_Smithchart_"+t,e.x,e.y,p,e.text),r,this.themeStyle.chartTitle,l);i.setAttribute("aria-label",n.description||e.text),l.appendChild(i)}};g.bind(this),this.trigger(Aa,u,g)}renderBorder(){const e=this.border;this.background=this.background?this.background:this.themeStyle.background;const t=new ql(this.element.id+"_SmithchartBorder",this.background,e,1,new wl(e.width/2,e.width/2,this.availableSize.width-e.width,this.availableSize.height-e.width));this.svgObject.appendChild(this.renderer.drawRectangle(t))}onPropertyChanged(e,t){let i=!1;for(const s of Object.keys(e))switch(s){case"background":case"border":case"series":case"legendSettings":case"radius":i=!0;break;case"size":this.createChartSvg(),i=!0;break;case"theme":case"renderType":this.animateSeries=!0,i=!0}i&&this.render()}preRender(){this.isBlazor=(0,a.xr)(),this.allowServerDataBinding=!1,this.trigger("load",{smithchart:this.isBlazor?null:this}),this.unWireEVents(),this.initPrivateVariable(),this.wireEVents()}initPrivateVariable(){this.animateSeries=!0}setTheme(){this.themeStyle=function(e){let t;switch(e.toLowerCase()){case"highcontrast":t={axisLabel:"#ffffff",axisLine:"#ffffff",majorGridLine:"#BFBFBF",minorGridLine:"#969696",chartTitle:"#ffffff",legendLabel:"#ffffff",background:"#000000",areaBorder:"#ffffff",tooltipFill:"#ffffff",dataLabel:"#ffffff",tooltipBoldLabel:"#000000",tooltipLightLabel:"#000000",tooltipHeaderLine:"#969696"};break;case"materialdark":case"bootstrapdark":case"fabricdark":t={axisLabel:"#DADADA",axisLine:" #6F6C6C",majorGridLine:"#414040",minorGridLine:"#514F4F",chartTitle:"#ffffff",legendLabel:"#DADADA",background:"#000000",areaBorder:" #9A9A9A",tooltipFill:"#F4F4F4",dataLabel:"#DADADA",tooltipBoldLabel:"#282727",tooltipLightLabel:"#333232",tooltipHeaderLine:"#9A9A9A"};break;case"bootstrap4":t={axisLabel:"#212529",axisLine:"#ADB5BD",majorGridLine:"#CED4DA",minorGridLine:"#DEE2E6",chartTitle:"#212529",legendLabel:"#212529",background:"#FFFFFF",areaBorder:"#DEE2E6",tooltipFill:"#000000",dataLabel:"#212529",tooltipBoldLabel:"#FFFFFF",tooltipLightLabel:"#FFFFFF",tooltipHeaderLine:"#FFFFFF",fontFamily:"HelveticaNeue-Medium",fontSize:"16px",labelFontFamily:"HelveticaNeue",tooltipFillOpacity:1,tooltipTextOpacity:.9};break;case"tailwind":t={axisLabel:"#6B7280",axisLine:"#D1D5DB",majorGridLine:"#E5E7EB",minorGridLine:"#D1D5DB",chartTitle:"#374151",legendLabel:"#374151",background:"#FFFFFF",areaBorder:"#D1D5DB6",tooltipFill:"#111827",dataLabel:"#F9FAFB",tooltipBoldLabel:"#F9FAFB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#9CA3AF",fontFamily:"Inter",fontSize:"14px",labelFontFamily:"inter",tooltipFillOpacity:1,tooltipTextOpacity:1};break;case"tailwinddark":t={axisLabel:"#9CA3AF",axisLine:"#4B5563",majorGridLine:"#374151",minorGridLine:"#4B5563",chartTitle:"#D1D5DB",legendLabel:"#D1D5DB",background:"transprent",areaBorder:"#4B5563",tooltipFill:"#F9FAFB",dataLabel:"#D1D5DB",tooltipBoldLabel:"#1F2937",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#9CA3AF",fontFamily:"Inter",fontSize:"14px",labelFontFamily:"inter",tooltipFillOpacity:1,tooltipTextOpacity:1};break;default:t={axisLabel:"#686868",axisLine:"#b5b5b5",majorGridLine:"#dbdbdb",minorGridLine:"#eaeaea",chartTitle:"#424242",legendLabel:"#353535",background:"#FFFFFF",areaBorder:"Gray",tooltipFill:"rgba(0, 8, 22, 0.75)",dataLabel:"#424242",tooltipBoldLabel:"#ffffff",tooltipLightLabel:"#dbdbdb",tooltipHeaderLine:"#ffffff"}}return t}(this.theme),this.seriesColors=function(e){let t;switch(e.toLowerCase()){case"highcontrastlight":t=["#79ECE4","#E98272","#DFE6B6","#C6E773","#BA98FF","#FA83C3","#00C27A","#43ACEF","#D681EF","#D8BC6E"];break;case"fabric":t=["#4472c4","#ed7d31","#ffc000","#70ad47","#5b9bd5","#c1c1c1","#6f6fe2","#e269ae","#9e480e","#997300"];break;case"bootstrap":t=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"tailwind":t=["#5A61F6","#65A30D","#334155","#14B8A6","#8B5CF6","#0369A1","#F97316","#9333EA","#F59E0B","#15803D"];break;case"tailwinddark":t=["#8B5CF6","#22D3EE","#F87171","#4ADE80","#E879F9","#FCD34D","#F97316","#2DD4BF","#F472B6","#10B981"];break;default:t=["#00bdae","#404041","#357cd2","#e56590","#f8b883","#70ad47","#dd8abd","#7f84e8","#7bb4eb","#ea7a57"]}return t}(this.theme)}render(){this.createChartSvg(),this.element.appendChild(this.svgObject),this.setTheme(),this.createSecondaryElement(),this.renderBorder(),this.smithchartLegendModule&&this.legendSettings.visible&&(this.legendBounds=this.smithchartLegendModule.renderLegend(this)),this.legendBounds=this.legendBounds?this.legendBounds:{x:0,y:0,width:0,height:0};const e=new Ma;this.bounds=e.calculateAreaBounds(this,this.title,this.legendBounds),""!==this.title.text&&this.title.visible&&this.renderTitle(this.title,"title",null);const t=new Pa;t.renderArea(this,this.bounds),this.seriesrender=new Fa,this.seriesrender.draw(this,t,this.bounds),this.renderComplete(),this.allowServerDataBinding=!0,this.trigger("loaded",{smithchart:this.isBlazor?null:this})}createSecondaryElement(){if((0,a.le)(document.getElementById(this.element.id+"_Secondary_Element"))){const e=(0,a.az)("div",{id:this.element.id+"_Secondary_Element",styles:"z-index:1;"});this.element.appendChild(e);const t=this.element.getBoundingClientRect(),i=document.getElementById(this.element.id+"_svg");if(i){const s=i.getBoundingClientRect();e.style.left=Math.max(s.left-t.left,0)+"px",e.style.top=Math.max(s.top-t.top,0)+"px"}}else Ul(this.element.id+"_Secondary_Element")}destroy(){this.element&&(this.unWireEVents(),super.destroy(),this.element.classList.remove("e-smithchart"),this.removeSvg(),this.svgObject=null)}wireEVents(){a.bi.add(this.element,"click",this.smithchartOnClick,this),a.bi.add(this.element,a.AR.touchMoveEvent,this.mouseMove,this),a.bi.add(this.element,a.AR.touchEndEvent,this.mouseEnd,this),window.addEventListener(a.AR.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.smithchartOnResize.bind(this))}mouseMove(e){this.isTouch="touchmove"===e.type||"touch"===e.pointerType||"2"===e.pointerType||this.isTouch,this.tooltipRenderModule&&!this.isTouch&&this.tooltipRenderModule.smithchartMouseMove(this,e)}mouseEnd(e){if(this.isTouch="touchend"===e.type||"touch"===e.pointerType||"2"===e.pointerType,this.tooltipRenderModule&&this.isTouch){const t=this.tooltipRenderModule.smithchartMouseMove(this,e);t&&(this.fadeoutTo=+setTimeout(()=>{t.fadeOut()},2e3))}}smithchartOnClick(e){const t=document.getElementById(e.target.id).parentElement;if("containerlegendItem_Group"===document.getElementById(t.id).parentElement.id&&this.legendSettings.toggleVisibility){const e=t.childNodes[0],i=t.childNodes[1].textContent;let s,o;for(let t=0;t<this.smithchartLegendModule.legendSeries.length;t++)i===this.smithchartLegendModule.legendSeries[t].text&&(s=this.smithchartLegendModule.legendSeries[t].seriesIndex,o=this.smithchartLegendModule.legendSeries[t].fill);const l=document.getElementById(this.element.id+"_svg_seriesCollection"+s);"visible"===l.getAttribute("visibility")?(e.setAttribute("fill","gray"),l.setAttribute("visibility","hidden"),this.series[s].visibility="hidden"):(e.setAttribute("fill",o),l.setAttribute("visibility","visible"),this.series[s].visibility="visible")}}unWireEVents(){a.bi.remove(this.element,"click",this.smithchartOnClick),a.bi.remove(this.element,a.AR.touchMoveEvent,this.mouseMove),a.bi.remove(this.element,a.AR.touchEndEvent,this.mouseEnd),window.removeEventListener(a.AR.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.smithchartOnResize)}print(e){new Na(this).print(e)}export(e,t,i){new Na(this).export(e,t,i)}smithchartOnResize(){return this.animateSeries=!1,this.resizeTo&&clearTimeout(this.resizeTo),this.resizeTo=+setTimeout(()=>{this.render()},500),!1}requiredModules(){const e=[];this.legendSettings.visible&&e.push({member:"SmithchartLegend",args:[this]});for(let t=0;t<this.series.length;t++)if(this.series[t].tooltip.visible){e.push({member:"TooltipRender",args:[this]});break}return e}removeSvg(){if(Ul(this.element.id+"_Secondary_Element"),this.svgObject){for(;this.svgObject.childNodes.length>0;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&(0,a.Od)(this.svgObject)}}};za([(0,a.Z9)("Impedance")],_a.prototype,"renderType",void 0),za([(0,a.Z9)("")],_a.prototype,"width",void 0),za([(0,a.Z9)("")],_a.prototype,"height",void 0),za([(0,a.Z9)("Material")],_a.prototype,"theme",void 0),za([(0,a.Zz)({},Sl)],_a.prototype,"margin",void 0),za([(0,a.Zz)({},vl)],_a.prototype,"font",void 0),za([(0,a.Zz)({},xl)],_a.prototype,"border",void 0),za([(0,a.Zz)({},ga)],_a.prototype,"title",void 0),za([(0,a.FE)([{}],Ca)],_a.prototype,"series",void 0),za([(0,a.Zz)({},aa)],_a.prototype,"legendSettings",void 0),za([(0,a.Zz)({},ca)],_a.prototype,"horizontalAxis",void 0),za([(0,a.Zz)({},ca)],_a.prototype,"radialAxis",void 0),za([(0,a.Z9)(null)],_a.prototype,"background",void 0),za([(0,a.Z9)(10)],_a.prototype,"elementSpacing",void 0),za([(0,a.Z9)(1)],_a.prototype,"radius",void 0),za([(0,a.ju)()],_a.prototype,"beforePrint",void 0),za([(0,a.ju)()],_a.prototype,"animationComplete",void 0),za([(0,a.ju)()],_a.prototype,"load",void 0),za([(0,a.ju)()],_a.prototype,"loaded",void 0),za([(0,a.ju)()],_a.prototype,"legendRender",void 0),za([(0,a.ju)()],_a.prototype,"titleRender",void 0),za([(0,a.ju)()],_a.prototype,"subtitleRender",void 0),za([(0,a.ju)()],_a.prototype,"textRender",void 0),za([(0,a.ju)()],_a.prototype,"axisLabelRender",void 0),za([(0,a.ju)()],_a.prototype,"seriesRender",void 0),za([(0,a.ju)()],_a.prototype,"tooltipRender",void 0),_a=za([a.Zl],_a);var Ba=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class Za extends a.rt{}Ba([(0,a.Z9)("")],Za.prototype,"color",void 0),Ba([(0,a.Z9)(0)],Za.prototype,"width",void 0);class Va extends a.rt{}Ba([(0,a.Z9)(null)],Va.prototype,"size",void 0),Ba([(0,a.Z9)(null)],Va.prototype,"color",void 0),Ba([(0,a.Z9)("Roboto, Segoe UI, Noto, Sans-serif")],Va.prototype,"fontFamily",void 0),Ba([(0,a.Z9)(null)],Va.prototype,"fontWeight",void 0),Ba([(0,a.Z9)(null)],Va.prototype,"fontStyle",void 0),Ba([(0,a.Z9)(1)],Va.prototype,"opacity",void 0);class ja extends a.rt{}Ba([(0,a.Z9)(!1)],ja.prototype,"visible",void 0),Ba([(0,a.Z9)(null)],ja.prototype,"color",void 0),Ba([(0,a.Z9)(1)],ja.prototype,"width",void 0);class Ha extends a.rt{}Ba([(0,a.Z9)(!1)],Ha.prototype,"visible",void 0),Ba([(0,a.Z9)("")],Ha.prototype,"fill",void 0),Ba([(0,a.Z9)("")],Ha.prototype,"template",void 0),Ba([(0,a.Z9)("")],Ha.prototype,"format",void 0),Ba([(0,a.Zz)({color:"#cccccc",width:.5},Za)],Ha.prototype,"border",void 0),Ba([(0,a.Zz)({size:"13px",fontWeight:"Normal",fontStyle:"Normal",fontFamily:"Roboto, Segoe UI, Noto, Sans-serif"},Va)],Ha.prototype,"textStyle",void 0),Ba([(0,a.Zz)({},ja)],Ha.prototype,"trackLineSettings",void 0);class qa extends a.rt{}Ba([(0,a.Z9)("transparent")],qa.prototype,"background",void 0),Ba([(0,a.Zz)({},Za)],qa.prototype,"border",void 0);class Ga extends a.rt{}Ba([(0,a.Z9)(!1)],Ga.prototype,"visible",void 0),Ba([(0,a.Z9)(null)],Ga.prototype,"color",void 0),Ba([(0,a.Z9)("")],Ga.prototype,"dashArray",void 0),Ba([(0,a.Z9)(1)],Ga.prototype,"width",void 0),Ba([(0,a.Z9)(1)],Ga.prototype,"opacity",void 0);class Ya extends a.rt{}Ba([(0,a.Z9)(null)],Ya.prototype,"startRange",void 0),Ba([(0,a.Z9)(null)],Ya.prototype,"endRange",void 0),Ba([(0,a.Z9)(null)],Ya.prototype,"color",void 0),Ba([(0,a.Z9)(1)],Ya.prototype,"opacity",void 0);class Wa extends a.rt{}Ba([(0,a.Z9)(null)],Wa.prototype,"minX",void 0),Ba([(0,a.Z9)(null)],Wa.prototype,"maxX",void 0),Ba([(0,a.Z9)(null)],Wa.prototype,"minY",void 0),Ba([(0,a.Z9)(null)],Wa.prototype,"maxY",void 0),Ba([(0,a.Z9)(0)],Wa.prototype,"value",void 0),Ba([(0,a.Zz)({},Ga)],Wa.prototype,"lineSettings",void 0);class Ua extends a.rt{}Ba([(0,a.Z9)(5)],Ua.prototype,"left",void 0),Ba([(0,a.Z9)(5)],Ua.prototype,"right",void 0),Ba([(0,a.Z9)(5)],Ua.prototype,"bottom",void 0),Ba([(0,a.Z9)(5)],Ua.prototype,"top",void 0);class Xa extends a.rt{}Ba([(0,a.Z9)([])],Xa.prototype,"visible",void 0),Ba([(0,a.Z9)(1)],Xa.prototype,"opacity",void 0),Ba([(0,a.Z9)(5)],Xa.prototype,"size",void 0),Ba([(0,a.Z9)("#00bdae")],Xa.prototype,"fill",void 0),Ba([(0,a.Zz)({width:1},Za)],Xa.prototype,"border",void 0);class Qa extends a.rt{}Ba([(0,a.Z9)(0)],Qa.prototype,"x",void 0),Ba([(0,a.Z9)(0)],Qa.prototype,"y",void 0);class Ja extends a.rt{}Ba([(0,a.Z9)([])],Ja.prototype,"visible",void 0),Ba([(0,a.Z9)(1)],Ja.prototype,"opacity",void 0),Ba([(0,a.Z9)("transparent")],Ja.prototype,"fill",void 0),Ba([(0,a.Z9)("")],Ja.prototype,"format",void 0),Ba([(0,a.Zz)({color:"transparent",width:0},Za)],Ja.prototype,"border",void 0),Ba([(0,a.Zz)({size:"14px",fontWeight:"Medium",fontStyle:"Medium",fontFamily:"Roboto, Segoe UI, Noto, Sans-serif"},Va)],Ja.prototype,"textStyle",void 0),Ba([(0,a.Zz)({},Qa)],Ja.prototype,"offset",void 0),Ba([(0,a.Z9)("None")],Ja.prototype,"edgeLabelMode",void 0);class Ka{constructor(e,t){this.width=e,this.height=t}}function $a(e,t){return null!=e?-1!==e.indexOf("%")?t/100*parseInt(e,10):parseInt(e,10):null}class er{constructor(e,t,i,s){this.x=e,this.y=t,this.width=i,this.height=s}}class tr{constructor(e,t,i,s,o,l,a){this.id=e,this.fill=t,this.opacity=o,this["stroke-width"]=i,this.stroke=s,this.d=a,this["stroke-dasharray"]=l}}class ir extends tr{constructor(e,t,i,s,o,l=0,a=0,r=0,n=0){super(e,t,i.width,i.color,s),this.rect=o,this.topLeft=l,this.topRight=a,this.bottomLeft=r,this.bottomRight=n}}class sr extends tr{constructor(e,t,i,s,o,l,a,r){super(e,t,i.width,i.color,s),this.cy=l,this.cx=o,this.r=a,this["stroke-dasharray"]=r}}function or(e,t){return t&&t.appendChild(e),e}function lr(e,t,i){return or(e.renderer.drawCircle(t),i)}function ar(e,t,i){var s,o,l,a,r;return t.d="M "+(s=t.rect).x+" "+((o=t.topLeft)+s.y)+" Q "+s.x+" "+s.y+" "+(s.x+o)+" "+s.y+" L "+(s.x+s.width-(l=t.topRight))+" "+s.y+" Q "+(s.x+s.width)+" "+s.y+" "+(s.x+s.width)+" "+(s.y+l)+" L "+(s.x+s.width)+" "+(s.y+s.height-(r=t.bottomRight))+" Q "+(s.x+s.width)+" "+(s.y+s.height)+" "+(s.x+s.width-r)+" "+(s.y+s.height)+" L "+(s.x+(a=t.bottomLeft))+" "+(s.y+s.height)+" Q "+s.x+" "+(s.y+s.height)+" "+s.x+" "+(s.y+s.height-a)+" L "+s.x+" "+(o+s.y)+" Z",or(e.renderer.drawPath(t),i)}function rr(e,t,i){return or(e.renderer.drawPath(t),i)}function nr(e,t){let i=document.getElementById("sparklinesmeasuretext");return null===i&&(i=(0,a.az)("text",{id:"sparklinesmeasuretext"}),document.body.appendChild(i)),i.innerHTML=e,i.style.fontStyle=t.fontStyle,i.style.fontFamily=t.fontFamily,i.style.visibility="hidden",i.style.top="-100",i.style.left="0",i.style.position="absolute",i.style.fontSize=t.size,i.style.fontWeight=t.fontWeight,i.style.whiteSpace="nowrap",i.style.lineHeight="normal",new Ka(i.clientWidth,i.clientHeight)}class hr{constructor(e,t,i,s,o,l,a=""){this.transform="",this.baseLine="auto",this.id=e,this.x=t,this.y=i,this.anchor=s,this.text=o,this.transform=a,this.baseLine=l}}function dr(e,t,i,s){const o={id:e.id,x:e.x,y:e.y,transform:e.transform,opacity:t.opacity,fill:i,"font-family":t.fontFamily,"font-weight":t.fontWeight,"font-size":t.size,"font-style":t.fontStyle,"text-anchor":e.anchor,"dominant-baseline":e.baseLine},l=new y("").createText(o,e.text);return l.style["user-select"]="none",l.style["-moz-user-select"]="none",l.style["-webkit-touch-callout"]="none",l.style["-webkit-user-select"]="none",l.style["-khtml-user-select"]="none",l.style["-ms-user-select"]="none",l.style["-o-user-select"]="none",s.appendChild(l),l}function cr(e){return document.getElementById(e)}var pr=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&(i[s[o]]=e[s[o]])}return i};class ur{constructor(e){this.sparkline=e}processData(){let e=this.sparkline.dataSource;!(0,a.le)(e)&&e.length&&(isNaN(this.sparkline.dataSource[0])&&"Numeric"!==this.sparkline.valueType?this["process"+this.sparkline.valueType]():(e=this.sparkline.enableRtl?e.reverse():e,this.sparkline.sparklineData=e),this.axisCalculation())}processDataManager(){let e,t;this.sparkline.dataSource instanceof r.hm?(e=this.sparkline.dataSource,t=this.sparkline.query instanceof r.AE?this.sparkline.query:new r.AE,e.executeQuery(t).then(e=>{this.sparkline.setProperties({dataSource:e.result},!0),this.sparkline.sparklineData=this.sparkline.dataSource,this.sparkline.processSparklineData()})):this.sparkline.processSparklineData()}processCategory(e=this.sparkline.dataSource,t=this.sparkline.xName,i=this.sparkline.yName){const s=[],o=[];e.forEach(e=>{-1===o.indexOf(e[t])&&o.push(e[t]);const l={};l[this.sparkline.xName]=o.indexOf(e[t]),l[this.sparkline.yName]=e[i],s.push(l)}),this.sparkline.sparklineData=s}processDateTime(e=this.sparkline.dataSource,t=this.sparkline.xName,i=this.sparkline.yName){const s=[];e.forEach(e=>{const o={};o[t]=e[t].getTime(),o[i]=e[i],s.push(o)}),this.sparkline.sparklineData=s}renderSeries(){const e=this.sparkline;this.clipId=e.element.id+"_sparkline_clip_path",this.drawAxis();const t={name:"seriesRendering",cancel:!1,lineWidth:e.lineWidth,border:e.border,fill:e.fill,sparkline:this.sparkline.isBlazor?null:e},i=t=>{if(this.visiblePoints&&!t.cancel){if("Pie"!==e.type&&"WinLoss"!==e.type&&e.rangeBandSettings.length){const t=this.sparkline.renderer.createGroup({id:this.sparkline.element.id+"_sparkline_rangeband_g"});for(let i=0;i<e.rangeBandSettings.length;i++)(e.axisSettings.minY<=e.rangeBandSettings[i].startRange||e.axisSettings.maxY>=e.rangeBandSettings[i].endRange)&&this.rangeBand(e.rangeBandSettings[i],t,i);this.sparkline.svgObject.appendChild(t)}this["render"+e.type](this.visiblePoints,t),this.renderMarker(this.visiblePoints),this.renderLabel(this.visiblePoints)}};i.bind(this),e.trigger("seriesRendering",t,i)}rangeBand(e,t,i){const s=this.sparkline,o=s.availableSize.height-2*s.padding.top,l=s.availableSize.width-2*s.padding.left;let a=o-o/this.unitY*(e.startRange-this.min)+s.padding.top,r=o-o/this.unitY*(e.endRange-this.min)+s.padding.top;r>o+s.padding.top?r=o+s.padding.top:r<0+s.padding.top&&(r=0+s.padding.top),a>o+s.padding.top?a=o+s.padding.top:a<0+s.padding.top&&(a=0+s.padding.top),rr(this.sparkline,{id:s.element.id+"_rangeBand_"+i,fill:e.color||this.sparkline.sparkTheme.rangeBandColor,opacity:e.opacity,stroke:"transparent","stroke-width":s.lineWidth,d:"M "+s.padding.left+" "+a+" L "+(l+s.padding.left)+" "+a+" L "+(l+s.padding.left)+" "+r+" L "+s.padding.left+" "+r+" Z ","stroke-dasharray":""},t)}renderLine(e,t){const i=this.sparkline,s=this.sparkline.renderer.createGroup({id:i.element.id+"_sparkline_g","clip-path":"url(#"+this.clipId+")"});let o=this.sparkline.fill;o="#00bdae"===this.sparkline.fill&&"Bootstrap4"===this.sparkline.theme?this.sparkline.sparkTheme.axisLineColor:o;const l=new tr(i.element.id+"_sparkline_line","transparent",t.lineWidth,o,i.opacity);let a="";for(let r=0,n=e.length;r<n;r++)0===r&&(a="M "+e[0].x+" "+e[r].y+" "),a+="L "+e[r].x+" "+e[r].y+" ";l.d=a,rr(this.sparkline,l,s),this.sparkline.svgObject.appendChild(s)}renderPie(e,t){const i=this.sparkline,s=i.availableSize.height-(i.padding.top+i.padding.bottom),o=i.availableSize.width-(i.padding.left+i.padding.right),l=s<=o?s/2:o/2,r=i.availableSize.width/2,n=i.availableSize.height/2;let h,d,c=0;const p=t.border.color,u=i.opacity,g=t.border.width,m=i.palette.length?i.palette:["#00bdae","#404041","#357cd2","#e56590","#f8b883","#70ad47","#dd8abd","#7f84e8","#7bb4eb","#ea7a57"],b=this.sparkline.renderer.createGroup({id:i.element.id+"_sparkline_g"});let f,y;const v=(0,a.l7)([],[],e);if(i.highPointColor||i.lowPointColor){const e=v.map(e=>e.yVal);f=Math.min.apply(null,e),y=Math.max.apply(null,e)}this.negativePointIndexes=[];for(let a,S,x=0,w=90;x<e.length;x++){w+=c,c=e[x].degree,a=w+c,h=(w-90)*Math.PI/180,d=(a-90)*Math.PI/180,e[x].stAng=h,e[x].endAng=d,S=c<180?"0":"1";const t=e[x].coordinates={sX:r+l*Math.cos(h),sY:n+l*Math.sin(h),eX:r+l*Math.cos(d),eY:n+l*Math.sin(d)},s={id:i.element.id+"_sparkline_pie_"+x,opacity:u,fill:m[x%m.length],stroke:p,"stroke-width":g,d:"M "+r+" "+n+" L "+t.eX+" "+t.eY+" A "+l+" "+l+" 0 "+S+",0 "+t.sX+" "+t.sY+" Z","stroke-dasharray":""};this.getPieSpecialPoint(e[x],i,s,x,y,f,e.length);const o=this.triggerPointRender("pointRendering",x,s.fill,{color:p,width:g});s.fill=o.fill,s.stroke=o.border.color,s["stroke-width"]=o.border.width,o.cancel||rr(this.sparkline,s,b).setAttribute("aria-label",i.dataSource[x][i.xName]+" : "+e[x].yVal);const v=d-h,C={x:r+l/2*Math.cos(h+v/2),y:n+l/2*Math.sin(h+v/2)};e[x].location.x=C.x,e[x].location.y=C.y}this.sparkline.svgObject.appendChild(b)}getPieSpecialPoint(e,t,i,s,o,l,a){e.yVal<0&&t.negativePointColor&&(i.fill=t.negativePointColor,this.negativePointIndexes.push(s)),0===s&&t.startPointColor?(i.fill=t.startPointColor,this.startPointIndex=s):s===a-1&&t.endPointColor&&(i.fill=t.endPointColor,this.endPointIndex=s),e.yVal===o&&t.highPointColor?(i.fill=t.highPointColor,this.highPointIndex=s):e.yVal===l&&t.lowPointColor&&(i.fill=t.lowPointColor,this.lowPointIndex=s)}renderArea(e,t){const i=this.sparkline,s=this.sparkline.renderer.createGroup({id:i.element.id+"_sparkline_g","clip-path":"url(#"+this.clipId+")"});let o=new tr(i.element.id+"_sparkline_area",t.fill,0,"transparent",i.opacity),l="",a="";for(let r=0,n=e.length;r<n;r++)0!==r?a+="L "+e[r].x+" "+e[r].y+" ":(l="M "+e[r].x+" "+this.axisHeight+" ",a="M "+e[r].x+" "+e[r].y+" "),l+="L "+e[r].x+" "+e[r].y+" ",r===n-1&&(l+="L "+e[r].x+" "+this.axisHeight+" Z");o.d=l,rr(this.sparkline,o,s),o=new tr(i.element.id+"_sparkline_area_str","transparent",t.border.width,t.border.color,i.opacity,"",a),rr(this.sparkline,o,s),this.sparkline.svgObject.appendChild(s)}renderColumn(e,t){const i=this.sparkline,s=(0,a.l7)([],[],e),o=this.sparkline.renderer.createGroup({id:i.element.id+"_sparkline_g","clip-path":"url(#"+this.clipId+")"});let l,r;if(this.sparkline.highPointColor||this.sparkline.lowPointColor){const e=s.map(e=>e.markerPosition);r=Math.min.apply(null,e),l=Math.max.apply(null,e)}const n=i.element.id+"_sparkline_column_",h=new ir(n,"",t.border,i.opacity,null),d=i.palette.length;let c;const p=e.length;this.negativePointIndexes=[];for(let a=0;a<p;a++){c=e[a],h.id=n+a,h.fill=d?i.palette[a%d]:t.fill,h.rect=new er(c.x,c.y,c.width,c.height),this.getSpecialPoint(!0,c,i,h,a,r,l,p),c.location.y=c.markerPosition<=this.axisHeight?c.y:c.y+c.height,c.location.x=c.x+c.width/2,h.stroke=t.border.color?t.border.color:h.fill;let s={name:"pointRendering",cancel:!1,pointIndex:a,fill:h.fill,border:{color:h.stroke,width:t.border.width}};if(this.sparkline.isBlazor){const e=pr(s,[]);s=e}this.sparkline.trigger("pointRendering",s,()=>{if(c=e[a],h.id=n+a,h.rect=new er(c.x,c.y,c.width,c.height),this.getSpecialPoint(!0,c,i,h,a,r,l,p),h.fill=s.fill,h.stroke=s.border.color,c.location.y=c.markerPosition<=this.axisHeight?c.y:c.y+c.height,h["stroke-width"]=s.border.width,c.location.x=c.x+c.width/2,!s.cancel){const t=ar(i,h,o);t.setAttribute("aria-label",i.dataSource[a][i.xName]+" : "+e[a].yVal),o.appendChild(t)}})}this.sparkline.svgObject.appendChild(o)}renderWinLoss(e,t){const i=this.sparkline,s=this.sparkline.renderer.createGroup({id:i.element.id+"_sparkline_g","clip-path":"url(#"+this.clipId+")"}),o=i.element.id+"_sparkline_winloss_",l=new ir(o,"",t.border,i.opacity,null);let a;const r=e.length,n=i.palette.length;for(let h=0;h<r;h++){a=e[h],l.id=o+h,l.fill=n?i.palette[h%n]:a.yVal===this.axisValue?this.sparkline.tiePointColor||"#a216f3":a.yVal>this.axisValue?t.fill:i.negativePointColor||"#e20f07",l.stroke=t.border.color?t.border.color:l.fill,l.rect=new er(a.x,a.y,a.width,a.height),a.location.x=a.x+a.width/2,a.location.y=a.yVal>=this.axisValue?a.y:a.y+a.height;const r=this.triggerPointRender("pointRendering",h,l.fill,{color:l.stroke,width:t.border.width});l.fill=r.fill,l.stroke=r.border.color,l["stroke-width"]=r.border.width,r.cancel||ar(i,l,s).setAttribute("aria-label",i.dataSource[h][i.xName]+" : "+e[h].yVal)}this.sparkline.svgObject.appendChild(s)}renderMarker(e){const t=this.sparkline,i=t.markerSettings;if("Pie"===t.type||"WinLoss"===t.type||!i.visible.length)return;const s=(0,a.l7)([],[],e),o=this.sparkline.renderer.createGroup({id:t.element.id+"_sparkline_marker_g","clip-path":"url(#"+this.clipId+")"});let l;const r=t.element.id+"_sparkline_marker_",n=new sr("",i.fill,i.border,i.opacity,0,0,i.size/2,"");let h,d;const c=i.visible.join();if(c.toLowerCase().indexOf("high")>-1||c.toLowerCase().indexOf("low")>-1){const e=s.map(e=>e.markerPosition);h=Math.min.apply(null,e),d=Math.max.apply(null,e)}this.negativePointIndexes=[];for(let a=0,p=e.length;a<p;a++){l=e[a],n.id=r+a,n.cx=l.location.x,n.cy=l.location.y,n.fill=i.fill;let s=c.toLowerCase().indexOf("all")>-1;s=this.getSpecialPoint(s,l,t,n,a,h,d,p,c.toLowerCase()),n.stroke=i.border.color||n.fill;let u={name:"markerRendering",cancel:!1,border:{color:n.stroke,width:i.border.width},fill:n.fill,pointIndex:a,sparkline:this.sparkline.isBlazor?null:this.sparkline,x:n.cx,y:n.cy,size:i.size};if(this.sparkline.isBlazor){const e=pr(u,[]);u=e}this.sparkline.trigger("markerRendering",u,()=>{if(s&&!u.cancel){n.id=r+a,n.cx=u.x,n.cy=u.y,n.fill=u.fill,n.stroke=u.border.color,n["stroke-width"]=u.border.width,n.r=u.size/2;const i=lr(t,n,o);i.setAttribute("aria-label",t.dataSource[a][t.xName]+" : "+e[a].yVal),o.appendChild(i)}})}this.sparkline.svgObject.appendChild(o)}getSpecialPoint(e,t,i,s,o,l,a,r,n=""){return t.markerPosition>this.axisHeight&&(s.fill=i.negativePointColor||s.fill,this.negativePointIndexes.push(o),e=e||n.indexOf("negative")>-1),0===o?(s.fill=i.startPointColor||s.fill,this.startPointIndex=o,e=e||n.indexOf("start")>-1):o===r-1&&(s.fill=i.endPointColor||s.fill,this.endPointIndex=o,e=e||n.indexOf("end")>-1),t.markerPosition===l?(s.fill=i.highPointColor||s.fill,this.highPointIndex=o,e=e||n.indexOf("high")>-1):t.markerPosition===a&&(s.fill=i.lowPointColor||s.fill,this.lowPointIndex=o,e=e||n.indexOf("low")>-1),n.indexOf("none")>-1&&(e=!1),e}renderLabel(e){const t=this.sparkline,i=t.dataLabelSettings,s=i.textStyle.color||t.sparkTheme.dataLabelColor;if("WinLoss"===t.type||!i.visible.length)return;const o=(0,a.l7)([],[],e),l=t.element.id+"_sparkline_label_",r=this.sparkline.renderer.createGroup({id:t.element.id+"_sparkline_label_g",style:"pointer-events: none;"});let n,h;const d=l+"text_",c=l+"rect_",p=new hr("",0,0,"middle","","middle"),u=i.textStyle,g=o.map(e=>e.markerPosition),m=Math.min.apply(null,g),b=Math.max.apply(null,g),f="transparent"!==i.fill||i.border.width?2:0;let y=nr("sparkline_measure_text",u);const v=new ir("",i.fill,i.border,i.opacity,null);let S;u.fontFamily=t.sparkTheme.labelFontFamily||u.fontFamily;for(let a=0,x=e.length;a<x;a++){h=e[a],p.id=d+a,p.x=h.location.x+i.offset.x,p.y=("Pie"===t.type?h.location.y:h.markerPosition>this.axisHeight?h.location.y+y.height/2+1+2+f:h.location.y-y.height/2-1-f)+i.offset.y,p.text=""!==i.format?this.formatter(i.format,this.sparkline.dataSource[a]):h.yVal.toString();let o={name:"dataLabelRendering",cancel:!1,border:i.border,fill:i.fill,pointIndex:a,sparkline:this.sparkline.isBlazor?null:this.sparkline,x:p.x,y:p.y,text:p.text,color:s};if(this.sparkline.isBlazor){const e=pr(o,[]);o=e}this.sparkline.trigger("dataLabelRendering",o,()=>{y=nr(o.text,u),p.text=o.text;let e=i.visible.join().toLowerCase().indexOf("all")>-1;e=this.getLabelVisible(e,h,a,i,x,m,b),S=this.arrangeLabelPosition(i.edgeLabelMode,e,o.x,a,x,y,f),e&&!o.cancel&&S.render&&(v.id=c+a,v.fill=o.fill,v.stroke=o.border.color,v["stroke-width"]=o.border.width,p.y=o.y,p.x=S.x,v.rect=new er(p.x-(y.width/2+f),p.y-f-y.height/1.75,y.width+2*f,y.height+2*f),n=this.sparkline.renderer.createGroup({id:l+"g"+a}),ar(t,v,n),dr(p,u,o.color,n),r.appendChild(n))})}this.sparkline.svgObject.appendChild(r)}arrangeLabelPosition(e,t,i,s,o,l,a){return"None"===e||(0===s&&i-l.width/2-a<=0?"Hide"===e?t=!1:i=this.sparkline.padding.left+a+l.width/2:s===o-1&&i+l.width/2+a>=this.sparkline.availableSize.width&&("Hide"===e?t=!1:i-=l.width/2+a)),{x:i,render:t}}getLabelVisible(e,t,i,s,o,l,a){const r=s.visible.join().toLowerCase();return t.markerPosition>this.axisHeight&&(e=e||r.indexOf("negative")>-1),0===i?e=e||r.indexOf("start")>-1:i===o-1&&(e=e||r.indexOf("end")>-1),t.markerPosition===l?e=e||r.indexOf("high")>-1:t.markerPosition===a&&(e=e||r.indexOf("low")>-1),s.visible.join().toLowerCase().indexOf("none")>-1&&(e=!1),e}formatter(e,t){if((0,a.le)(e))return null;const i=Object.keys(t);for(const s of i)e=e.split("${"+s+"}").join(t[s]);return e}axisCalculation(){this.findRanges(this.sparkline.sparklineData)}getInterval(e,t){let i=1;const s=e[0][t],o=(0,a.le)(e[1])?void 0:e[1][t];if(!(0,a.le)(s)&&!(0,a.le)(o)){const s=(0,a.l7)([],e);let o=[];s.forEach(e=>{(0,a.le)(e[t])||o.push(e)}),o.sort((e,i)=>(0,a.le)(e[t])||(0,a.le)(i[t])?0:e[t]-i[t]),o=this.sparkline.enableRtl?o.reverse():o,i=o[1][t]-o[0][t]}return i}getPaddingInterval(e,t,i,s){let o=1*e.length;o=Math.max(this.sparkline.availableSize.height*(o/100),1);let l=s/o;for(const a of this.sparkline.intervalDivs){const e=1*a;if(o<s/e)break;l=e}return l}findRanges(e){const t=this.sparkline;let i,s,o,l;const r=e.length;let n,h=0;const d=Array.isArray(e)&&"object"!=typeof e[0];if(d)if("Pie"===t.type)for(let a=0;a<r;a++)h+=Math.abs(e[a]);else i=Math.max.apply(null,e),s=Math.min.apply(null,e),o=0,l=r-1;else if("Pie"===t.type)for(let a=0;a<r;a++)h+=Math.abs(e[a][t.yName]);else{if((0,a.le)(e[0][t.xName])){const o=e.map(e=>e[t.yName]);i=Math.max.apply(null,o),s=Math.min.apply(null,o)}else n=(0,a.l7)([],e),n=n.sort((e,i)=>e[t.yName]-i[t.yName]),i=n[n.length-1][t.yName],s=n[0][t.yName];(0,a.le)(e[0][t.xName])?(o=0,l=r-1):(n=n.sort((e,i)=>e[t.xName]-i[t.xName]),n=this.sparkline.enableRtl?n.reverse():n,l=n[n.length-1][t.xName],o=n[0][t.xName])}let c,p,u,g,m=0;const b=t.padding;let f;const y=t.axisSettings;let v=y.value;if("Pie"!==t.type){this.maxLength=r,p=t.availableSize.height-(b.bottom+b.top),u=t.availableSize.width-(b.left+b.right),l=(0,a.le)(y.maxX)?l:y.maxX,o=(0,a.le)(y.minX)?o:y.minX,i=(0,a.le)(y.maxY)?i:y.maxY,s=(0,a.le)(y.minY)?s:y.minY;const e={name:"axisRendering",cancel:!1,sparkline:this.sparkline.isBlazor?null:t,maxX:l,minX:o,maxY:i,minY:s,value:y.value,lineColor:y.lineSettings.color||this.sparkline.sparkTheme.axisLineColor,lineWidth:y.lineSettings.width};if(t.trigger("axisRendering",e),e.cancel)return void(this.visiblePoints=[]);l=e.maxX,o=e.minX,i=e.maxY,s=e.minY,v=this.axisValue=e.value,this.axisColor=e.lineColor,this.axisWidth=e.lineWidth}let S,x,w,C=l-o,M=i-s;C=0===C?1:C,M=0===M?1:M,this.unitX=C,this.unitY=M,this.min=s,m=0,g=p-p/M*-s,g=s<0&&i<=0?0:s<0&&i>0?g:p,v>=s&&v<=i&&(g=p-Math.round(p*((v-s)/this.unitY))),this.axisHeight=g+b.top;const T=[],L=i-s,A=this.getInterval(e,t.xName),D=this.getPaddingInterval(e,t.xName,t.valueType,L);for(let R=0;R<r;R++)if((0,a.le)(e[R][t.xName])&&(0,a.le)(e[R][t.yName])&&0!==e[R][t.yName]&&d?(x=R,w=e[R]):(0,a.le)(e[R][t.xName])?(x=R,w=e[R][t.yName]):(x=e[R][t.xName],w=e[R][t.yName]),!(0,a.le)(x)&&!(0,a.le)(w)){if("Line"===t.type||"Area"===t.type)c=s!==i&&1!==r?p-Math.round(p*((w-s)/this.unitY)):b.top,f={x:o!==l?Math.round(u*((x-o)/this.unitX)):u/2,y:c,markerPosition:c};else if("Column"===t.type||"WinLoss"===t.type){let e=u/((l-o)/A+1);const a=1;if(e-=a,m=(x-o)/A*(e+a)+a/2,"WinLoss"===t.type){const t=.5,i=40;c=w>v?p/4:w<v?p*t:p*t-p/i,f={x:m,y:c,height:w!==v?p/4:p/20,width:e,markerPosition:c>g?g+Math.abs(c-g):c}}else{0===R&&"None"!==t.rangePadding&&(s-="Additional"===t.rangePadding?D+b.top:D,i+="Additional"===t.rangePadding?D+b.top:D,C=l-o,M=i-s,C=0===C?1:C,M=0===M?1:M,this.unitX=C,this.unitY=M,this.min=s);const a=p/this.unitY*(w-s);c=Math.abs(p-(w===s&&w>v?1!==r&&1!==this.unitY?p/this.unitY*(s/2):1|a:w===i&&w<v&&1!==r&&1!==this.unitY?p/this.unitY*(-i/2):a)),f={x:m,y:c>g?g:c,height:Math.abs(c-g),width:e,markerPosition:c>g?g+Math.abs(c-g):c}}}else"Pie"===t.type&&(S=Math.abs(w)/h*100,f={percent:S,degree:Math.abs(w)/h*360});"Pie"!==t.type&&(f.x+=b.left,f.y+=b.top),"WinLoss"!==t.type&&(f.markerPosition+=b.top),f.location={x:f.x,y:f.y},f.xVal=x,f.yVal=w,T.push(f)}T.sort((e,t)=>e.x-t.x),this.visiblePoints=T}drawAxis(){const e=this.sparkline,t=this.axisHeight;"WinLoss"!==e.type&&"Pie"!==e.type&&e.axisSettings.lineSettings.visible&&e.svgObject.appendChild(e.renderer.drawLine({id:e.element.id+"_Sparkline_XAxis",x1:e.padding.left,y1:t,x2:e.availableSize.width-e.padding.right,y2:t,stroke:this.axisColor,opacity:e.axisSettings.lineSettings.opacity,"stroke-dasharray":e.axisSettings.lineSettings.dashArray,"stroke-width":this.axisWidth,"clip-path":"url(#"+this.clipId+")"}))}triggerPointRender(e,t,i,s){const o={name:e,cancel:!1,border:s,fill:i,sparkline:this.sparkline.isBlazor?null:this.sparkline,pointIndex:t};return this.sparkline.trigger(e,o),o}}var gr=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};let mr=class extends a.wA{constructor(e,t){super(e,t),this.isDevice=a.AR.isDevice,this.intervalDivs=[10,5,2,1]}preRender(){this.isBlazor=(0,a.xr)(),this.allowServerDataBinding=!1,this.unWireEvents(),this.trigger("load",{sparkline:this.isBlazor?null:this}),this.sparkTheme=function(e){let t;switch(e.toLowerCase()){case"bootstrapdark":case"fabricdark":case"materialdark":case"highcontrast":t={axisLineColor:"#ffffff",dataLabelColor:"#ffffff",rangeBandColor:"#ffffff",tooltipFill:"#ffffff",background:"#000000",tooltipFontColor:"#363F4C",trackerLineColor:"#ffffff"};break;case"bootstrap4":t={axisLineColor:"#6C757D",dataLabelColor:"#212529",rangeBandColor:"#212529",tooltipFill:"#000000",background:"#FFFFFF",tooltipFontColor:"#FFFFFF",trackerLineColor:"#212529",fontFamily:"HelveticaNeue-Medium",tooltipFillOpacity:1,tooltipTextOpacity:.9,labelFontFamily:"HelveticaNeue"};break;case"tailwind":t={axisLineColor:"#4B5563",dataLabelColor:"#212529",rangeBandColor:"#212529",background:"#FFFFFF",tooltipFill:"#111827",tooltipFontColor:"#F9FAFB",trackerLineColor:"#1F2937",fontFamily:"Inter",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Inter"};break;case"tailwinddark":t={axisLineColor:"#D1D5DB",dataLabelColor:"#F9FAFB",rangeBandColor:"#F9FAFB",background:"transparent",tooltipFill:"#F9FAFB",tooltipFontColor:"#1F2937",trackerLineColor:"#9CA3AF",fontFamily:"Inter",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Inter"};break;default:t={axisLineColor:"#000000",dataLabelColor:"#424242",rangeBandColor:"#000000",background:"#FFFFFF",tooltipFill:"#363F4C",tooltipFontColor:"#ffffff",trackerLineColor:"#000000"}}return t}(this.theme),this.sparklineRenderer=new ur(this),this.createSVG(),this.wireEvents(),this.setCulture()}render(){this.sparklineRenderer.processDataManager(),this.renderComplete(),this.allowServerDataBinding=!0}processSparklineData(){this.sparklineRenderer.processData(),this.renderSparkline(),this.element.appendChild(this.svgObject),this.setSecondaryElementPosition(),this.trigger("loaded",{sparkline:this.isBlazor?null:this})}renderSparkline(){this.renderBorder(),this.createDiv(),this.sparklineRenderer.renderSeries()}createDiv(){let e=document.createElement("div");e.id=this.element.id+"_Secondary_Element",e.setAttribute("style","position: relative"),this.element.appendChild(e),this.element.style.display="block",this.element.style.position="relative"}setSecondaryElementPosition(){let e=cr(this.element.id+"_Secondary_Element");if(!e)return;let t=this.element.getBoundingClientRect(),i=cr(this.element.id+"_svg").getBoundingClientRect();e.style.left=Math.max(i.left-t.left,0)+"px",e.style.top=Math.max(i.top-t.top,0)+"px"}renderBorder(){let e,t=this.containerArea.border.width;(t>0||"transparent"!==this.containerArea.background)&&(e=new ir(this.element.id+"_SparklineBorder",this.sparkTheme.background,this.containerArea.border,1,new er(t/2,t/2,this.availableSize.width-t,this.availableSize.height-t)),this.svgObject.appendChild(ar(this,e)));let i=this.padding;this.markerSettings.visible.length&&(i.left=0,i.right=0,i.bottom=0,i.top=0),e=new ir(this.element.id+"_sparkline_clip_rect","transparent",{color:"transparent",width:0},1,new er(i.left,i.top,this.availableSize.width-(i.left+i.right),this.availableSize.height-(i.top+i.bottom)));let s=this.renderer.createClipPath({id:this.element.id+"_sparkline_clip_path"});ar(this,e,s),this.svgObject.appendChild(s)}createSVG(){var e;this.removeSvg(),(e=this).renderer=new y(e.element.id),function(e){const t=e.element.clientWidth?e.element.clientWidth:e.element.parentElement?e.element.parentElement.clientWidth?e.element.parentElement.clientWidth:window.innerWidth:100,i=e.element.clientHeight?e.element.clientHeight:e.element.parentElement?e.element.parentElement.clientHeight:50;e.availableSize=new Ka($a(e.width,t)||t,$a(e.height,i)||i||(e.isDevice?Math.min(window.innerWidth,window.innerHeight):i))}(e),e.svgObject=e.renderer.createSvg({id:e.element.id+"_svg",width:e.availableSize.width,height:e.availableSize.height})}removeSvg(){if(this.svgObject){for(;this.svgObject.childNodes.length>0;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&(0,a.Od)(this.svgObject)}!function(e){const t=document.getElementById(e);t&&(0,a.Od)(t)}(this.element.id+"_Secondary_Element"),this.sparklineTooltipModule&&this.sparklineTooltipModule.removeTooltipElements()}setCulture(){this.intl=new a.eC,this.localeObject=new a.E7(this.getModuleName(),this.defaultLocalConstants,this.locale)}requiredModules(){let e=[];return(this.tooltipSettings.visible||this.tooltipSettings.trackLineSettings.visible)&&e.push({member:"SparklineTooltip",args:[this]}),e}unWireEvents(){let e=a.AR.isPointer?"pointerleave":"mouseleave";a.bi.remove(this.element,a.AR.touchMoveEvent,this.sparklineMove),a.bi.remove(this.element,e,this.sparklineMouseLeave),a.bi.remove(this.element,a.AR.touchEndEvent,this.sparklineMouseEnd),window.removeEventListener(a.AR.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.sparklineResize)}wireEvents(){let e=a.AR.isPointer?"pointerleave":"mouseleave";a.bi.add(this.element,a.AR.touchMoveEvent,this.sparklineMove,this),a.bi.add(this.element,"click",this.sparklineClick,this),a.bi.add(this.element,e,this.sparklineMouseLeave,this),a.bi.add(this.element,a.AR.touchEndEvent,this.sparklineMouseEnd,this),window.addEventListener(a.AR.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.sparklineResize.bind(this)),new a.Xh(this.element)}sparklineResize(e){let t={name:"resize",previousSize:this.availableSize,sparkline:this.isBlazor?null:this,currentSize:new Ka(0,0)};return this.resizeTo&&clearTimeout(this.resizeTo),this.resizeTo=+setTimeout(()=>{this.isDestroyed?clearTimeout(this.resizeTo):(this.unWireEvents(),this.createSVG(),this.refreshing=!0,this.wireEvents(),t.currentSize=this.availableSize,this.trigger("resize",t),this.render())},500),!1}sparklineMove(e){this.setSparklineMouseXY(e),this.notify(a.AR.touchMoveEvent,e);let t={name:"sparklineMouseMove",cancel:!1,sparkline:this.isBlazor?null:this,event:e};this.trigger(t.name,t);let i=this.isPointRegion(e);if(i.isPointRegion){let t={name:"pointRegionMouseMove",cancel:!1,event:e,sparkline:this.isBlazor?null:this,pointIndex:i.pointIndex};this.trigger(t.name,t)}return!1}sparklineClick(e){this.setSparklineMouseXY(e);let t={name:"sparklineMouseClick",cancel:!1,sparkline:this.isBlazor?null:this,event:e};this.trigger(t.name,t);let i=this.isPointRegion(e);if(i.isPointRegion){let t={name:"pointRegionMouseClick",cancel:!1,event:e,sparkline:this.isBlazor?null:this,pointIndex:i.pointIndex};this.trigger(t.name,t)}return!1}isPointRegion(e){let t=e.target.id.replace(this.element.id+"_","").split("_");if(t[1]===this.type.toLowerCase()){let e=parseInt(t[2],10);return!(0,a.le)(e)&&!isNaN(e)||"Line"!==this.type&&"Area"!==this.type||this.sparklineRenderer.visiblePoints.forEach((t,i)=>{var s,o,l;o=this.mouseY,(s=this.mouseX)>=(l=new er(t.x-5,t.y-5,10,10)).x&&s<=l.x+l.width&&o>=l.y&&o<=l.y+l.height&&(e=i)}),{isPointRegion:!0,pointIndex:e}}return{isPointRegion:!1,pointIndex:null}}sparklineMouseEnd(e){return this.setSparklineMouseXY(e),this.notify(a.AR.touchEndEvent,e),!1}sparklineMouseLeave(e){return this.setSparklineMouseXY(e),this.notify(a.AR.isPointer?"pointerleave":"mouseleave",e),!1}setSparklineMouseXY(e){let t,i;e.type.indexOf("touch")>-1?(this.isTouch=!0,i=e.changedTouches[0].clientX,t=e.changedTouches[0].clientY):(this.isTouch="touch"===e.pointerType||"2"===e.pointerType,t=e.clientY,i=e.clientX);let s=this.element.getBoundingClientRect(),o=cr(this.element.id+"_svg").getBoundingClientRect();this.mouseY=t-s.top-Math.max(o.top-s.top,0),this.mouseX=i-s.left-Math.max(o.left-s.left,0)}onPropertyChanged(e,t){let i=!1,s=!1;for(let o of Object.keys(e))switch(o){case"xName":case"yName":case"axisSettings":case"rangeBandSettings":case"type":case"valueType":case"enableRtl":s=!0;break;case"dataSource":if(this.isBlazor){this.sparklineRenderer.processDataManager(),this.createSVG();break}s=!0;break;case"border":case"markerSettings":case"dataLabelSettings":case"tooltipSettings":case"startPointColor":case"highPointColor":case"lowPointColor":case"endPointColor":case"negativePointColor":case"theme":i=!0}s?(this.createSVG(),this.sparklineRenderer.processData(),this.refreshSparkline()):i&&(this.createSVG(),this.refreshSparkline())}refreshSparkline(){this.renderSparkline(),this.element.appendChild(this.svgObject),this.setSecondaryElementPosition()}getModuleName(){return"sparkline"}destroy(){super.destroy()}getPersistData(){return""}};gr([(0,a.Z9)(null)],mr.prototype,"width",void 0),gr([(0,a.Z9)(null)],mr.prototype,"height",void 0),gr([(0,a.Zz)({},Za)],mr.prototype,"border",void 0),gr([(0,a.Z9)("Line")],mr.prototype,"type",void 0),gr([(0,a.Z9)("None")],mr.prototype,"rangePadding",void 0),gr([(0,a.Z9)(null)],mr.prototype,"dataSource",void 0),gr([(0,a.Z9)(null)],mr.prototype,"query",void 0),gr([(0,a.Z9)("Numeric")],mr.prototype,"valueType",void 0),gr([(0,a.Z9)(null)],mr.prototype,"xName",void 0),gr([(0,a.Z9)(null)],mr.prototype,"yName",void 0),gr([(0,a.Z9)("#00bdae")],mr.prototype,"fill",void 0),gr([(0,a.Z9)("")],mr.prototype,"highPointColor",void 0),gr([(0,a.Z9)("")],mr.prototype,"lowPointColor",void 0),gr([(0,a.Z9)("")],mr.prototype,"startPointColor",void 0),gr([(0,a.Z9)("")],mr.prototype,"endPointColor",void 0),gr([(0,a.Z9)("")],mr.prototype,"negativePointColor",void 0),gr([(0,a.Z9)("")],mr.prototype,"tiePointColor",void 0),gr([(0,a.Z9)([])],mr.prototype,"palette",void 0),gr([(0,a.Z9)(1)],mr.prototype,"lineWidth",void 0),gr([(0,a.Z9)(1)],mr.prototype,"opacity",void 0),gr([(0,a.Z9)(null)],mr.prototype,"format",void 0),gr([(0,a.Z9)(!1)],mr.prototype,"useGroupingSeparator",void 0),gr([(0,a.Zz)({},Ha)],mr.prototype,"tooltipSettings",void 0),gr([(0,a.Zz)({},qa)],mr.prototype,"containerArea",void 0),gr([(0,a.FE)([],Ya)],mr.prototype,"rangeBandSettings",void 0),gr([(0,a.Zz)({},Wa)],mr.prototype,"axisSettings",void 0),gr([(0,a.Zz)({},Xa)],mr.prototype,"markerSettings",void 0),gr([(0,a.Zz)({},Ja)],mr.prototype,"dataLabelSettings",void 0),gr([(0,a.Zz)({},Ua)],mr.prototype,"padding",void 0),gr([(0,a.Z9)("Material")],mr.prototype,"theme",void 0),gr([(0,a.ju)()],mr.prototype,"loaded",void 0),gr([(0,a.ju)()],mr.prototype,"load",void 0),gr([(0,a.ju)()],mr.prototype,"tooltipInitialize",void 0),gr([(0,a.ju)()],mr.prototype,"seriesRendering",void 0),gr([(0,a.ju)()],mr.prototype,"axisRendering",void 0),gr([(0,a.ju)()],mr.prototype,"pointRendering",void 0),gr([(0,a.ju)()],mr.prototype,"pointRegionMouseMove",void 0),gr([(0,a.ju)()],mr.prototype,"pointRegionMouseClick",void 0),gr([(0,a.ju)()],mr.prototype,"sparklineMouseMove",void 0),gr([(0,a.ju)()],mr.prototype,"sparklineMouseClick",void 0),gr([(0,a.ju)()],mr.prototype,"dataLabelRendering",void 0),gr([(0,a.ju)()],mr.prototype,"markerRendering",void 0),gr([(0,a.ju)()],mr.prototype,"resize",void 0),mr=gr([a.Zl],mr);class br{static getType(e){let t,i=new Date(e);return t="boolean"==typeof e?"boolean":isNaN(Number(e))?i instanceof Date&&!isNaN(i.valueOf())?i&&i.getDay()&&(i.getHours()>0||i.getMinutes()>0||i.getSeconds()>0||i.getMilliseconds()>0)?"datetime":"date":typeof e:"number",t}static resetTime(e){return e.setHours(0,0,0,0),e}static getClonedData(e){let t=[];if(e)for(let i of e){let e=Object.keys(i),s=0,o={};for(;s<e.length;)o[e[s]]=i[e[s]],s++;t.push(o)}return t}static getClonedPivotValues(e){let t=[];for(let i=0;i<e.length;i++)if(e[i]){t[i]=[];for(let s=0;s<e[i].length;s++)e[i][s]&&(t[i][s]=this.getClonedPivotValueObj(e[i][s]))}return t}static getClonedPivotValueObj(e){let t=0,i={};if(null!=e){let s=Object.keys(e);for(;t<s.length;)i[s[t]]=e[s[t]],t++}else i=e;return i}static getDefinedObj(e){let t=0,i={};if(null!=e){let s=Object.keys(e);for(;t<s.length;)null!=e[s[t]]&&(i[s[t]]=e[s[t]]),t++}else i=e;return i}static inArray(e,t){if(t)for(let i=0,s=t.length;i<s;i++)if(t[i]===e)return i;return-1}static isContainCommonElements(e,t){for(let i=0,s=e.length;i<s;i++)for(let o=0,l=t.length;o<l;o++)if(t[o]===e[i])return!0;return!1}static setPivotProperties(e,t){e.allowServerDataBinding=!1,e.pivotGridModule&&(e.pivotGridModule.allowServerDataBinding=!1),e.setProperties(t,!0),e.allowServerDataBinding=!0,e.pivotGridModule&&(e.pivotGridModule.allowServerDataBinding=!0)}static getClonedDataSourceSettings(e){return this.getDefinedObj({type:e.type,catalog:e.catalog,cube:e.cube,providerType:e.providerType,url:e.url,localeIdentifier:e.localeIdentifier,excludeFields:(0,a.le)(e.excludeFields)?[]:[...e.excludeFields],expandAll:e.expandAll,allowLabelFilter:e.allowLabelFilter,allowValueFilter:e.allowValueFilter,allowMemberFilter:e.allowMemberFilter,enableSorting:!!e.enableSorting,rows:this.cloneFieldSettings(e.rows),columns:this.cloneFieldSettings(e.columns),filters:this.cloneFieldSettings(e.filters),values:this.cloneFieldSettings(e.values),filterSettings:this.cloneFilterSettings(e.filterSettings),sortSettings:this.cloneSortSettings(e.sortSettings),drilledMembers:this.cloneDrillMemberSettings(e.drilledMembers),valueSortSettings:this.CloneValueSortObject(e.valueSortSettings),valueAxis:e.valueAxis,formatSettings:this.cloneFormatSettings(e.formatSettings),calculatedFieldSettings:this.cloneCalculatedFieldSettings(e.calculatedFieldSettings),fieldMapping:this.cloneFieldSettings(e.fieldMapping),showSubTotals:e.showSubTotals,showRowSubTotals:e.showRowSubTotals,showColumnSubTotals:e.showColumnSubTotals,showGrandTotals:e.showGrandTotals,showRowGrandTotals:e.showRowGrandTotals,showColumnGrandTotals:e.showColumnGrandTotals,showHeaderWhenEmpty:e.showHeaderWhenEmpty,alwaysShowValueHeader:e.alwaysShowValueHeader,conditionalFormatSettings:this.cloneConditionalFormattingSettings(e.conditionalFormatSettings),emptyCellsTextContent:e.emptyCellsTextContent,groupSettings:this.cloneGroupSettings(e.groupSettings),showAggregationOnValueField:e.showAggregationOnValueField,authentication:this.CloneAuthenticationObject(e.authentication)})}static updateDataSourceSettings(e,t){e&&this.setPivotProperties(e,{dataSourceSettings:this.getDefinedObj({type:t.type,catalog:t.catalog,cube:t.cube,providerType:t.providerType,url:t.url,localeIdentifier:t.localeIdentifier,excludeFields:(0,a.le)(t.excludeFields)?[]:t.excludeFields,expandAll:t.expandAll,allowLabelFilter:t.allowLabelFilter,allowValueFilter:t.allowValueFilter,allowMemberFilter:t.allowMemberFilter,enableSorting:!!t.enableSorting,rows:t.rows,columns:t.columns,filters:t.filters,values:t.values,filterSettings:t.filterSettings,sortSettings:t.sortSettings,drilledMembers:t.drilledMembers,valueSortSettings:t.valueSortSettings,valueAxis:t.valueAxis,formatSettings:t.formatSettings,calculatedFieldSettings:t.calculatedFieldSettings,fieldMapping:t.fieldMapping,showSubTotals:t.showSubTotals,showRowSubTotals:t.showRowSubTotals,showColumnSubTotals:t.showColumnSubTotals,showGrandTotals:t.showGrandTotals,showRowGrandTotals:t.showRowGrandTotals,showColumnGrandTotals:t.showColumnGrandTotals,showHeaderWhenEmpty:t.showHeaderWhenEmpty,alwaysShowValueHeader:t.alwaysShowValueHeader,conditionalFormatSettings:t.conditionalFormatSettings,emptyCellsTextContent:t.emptyCellsTextContent,groupSettings:t.groupSettings,showAggregationOnValueField:t.showAggregationOnValueField,authentication:this.CloneAuthenticationObject(t.authentication)})})}static cloneFieldSettings(e){if(e){let t=[];for(let i of e)t.push(this.getDefinedObj({name:i.name,caption:i.caption,axis:i.axis,baseField:i.baseField,baseItem:i.baseItem,isCalculatedField:i.isCalculatedField,isNamedSet:i.isNamedSet,showNoDataItems:i.showNoDataItems,showSubTotals:i.showSubTotals,type:i.type,dataType:i.dataType,showFilterIcon:i.showFilterIcon,showSortIcon:i.showSortIcon,showRemoveIcon:i.showRemoveIcon,showValueTypeIcon:i.showValueTypeIcon,showEditIcon:i.showEditIcon,allowDragAndDrop:i.allowDragAndDrop}));return t}return e}static cloneFilterSettings(e){if(e){let t=[];for(let i of e)t.push(this.getDefinedObj({name:i.name,type:i.type,condition:i.condition,items:i.items?[...i.items]:i.items,levelCount:i.levelCount,measure:i.measure,selectedField:i.selectedField,showDateFilter:i.showDateFilter,showLabelFilter:i.showLabelFilter,showNumberFilter:i.showNumberFilter,value1:i.value1,value2:i.value2}));return t}return e}static cloneSortSettings(e){if(e){let t=[];for(let i of e)t.push(this.getDefinedObj({name:i.name,order:i.order}));return t}return e}static cloneDrillMemberSettings(e){if(e){let t=[];for(let i of e)t.push(this.getDefinedObj({name:i.name,delimiter:i.delimiter,items:i.items?[...i.items]:i.items}));return t}return e}static cloneFormatSettings(e){if(e){let t=[];for(let i of e)t.push(this.getDefinedObj({name:i.name,calendar:i.calendar,currency:i.currency,format:i.format,maximumFractionDigits:i.maximumFractionDigits,maximumSignificantDigits:i.maximumSignificantDigits,minimumFractionDigits:i.minimumFractionDigits,minimumIntegerDigits:i.minimumIntegerDigits,minimumSignificantDigits:i.minimumSignificantDigits,skeleton:i.skeleton,type:i.type,useGrouping:i.useGrouping}));return t}return e}static CloneValueSortObject(e){return e?{columnIndex:e.columnIndex,headerDelimiter:e.headerDelimiter,headerText:e.headerText,measure:e.measure,sortOrder:e.sortOrder}:e}static CloneAuthenticationObject(e){return e?{userName:e.userName,password:e.password}:e}static cloneCalculatedFieldSettings(e){if(e){let t=[];for(let i of e)t.push(this.getDefinedObj({name:i.name,formatString:i.formatString,formula:i.formula,hierarchyUniqueName:i.hierarchyUniqueName}));return t}return e}static cloneConditionalFormattingSettings(e){if(e){let t=[];for(let i of e)t.push(this.getDefinedObj({applyGrandTotals:i.applyGrandTotals,conditions:i.conditions,label:i.label,measure:i.measure,style:i.style?{backgroundColor:i.style.backgroundColor,color:i.style.color,fontFamily:i.style.fontFamily,fontSize:i.style.fontSize}:i.style,value1:i.value1,value2:i.value2}));return t}return e}static cloneGroupSettings(e){if(e){let t=[];for(let i of e)t.push(this.getDefinedObj({name:i.name,caption:i.caption,customGroups:this.cloneCustomGroups(i.customGroups),endingAt:i.endingAt,startingAt:i.startingAt,groupInterval:i.groupInterval,rangeInterval:i.rangeInterval,type:i.type}));return t}return e}static cloneCustomGroups(e){if(e){let t=[];for(let i of e)t.push(this.getDefinedObj({groupName:i.groupName,items:i.items?[...i.items]:i.items}));return t}return e}static getFilterItemByName(e,t){let i=new r.hm({json:t}).executeLocal((new r.AE).where("name","equal",e));if(i&&i.length>0)return i[i.length-1]}static getFieldByName(e,t){return new r.hm({json:t}).executeLocal((new r.AE).where("name","equal",e))[0]}static getFieldInfo(e,t,i){if(!i){let i=[this.cloneFieldSettings(t.dataSourceSettings.rows),this.cloneFieldSettings(t.dataSourceSettings.columns),this.cloneFieldSettings(t.dataSourceSettings.values),this.cloneFieldSettings(t.dataSourceSettings.filters)];for(let t=0,s=i.length;t<s;t++)for(let o=0,l=i[t]?i[t].length:0;o<l;o++)if(i[t][o]&&i[t][o].name===e)return{fieldName:e,fieldItem:i[t][o],axis:0===t?"rows":1===t?"columns":2===t?"values":"filters",position:o}}let s="olap"===t.dataType?t.olapEngineModule.fieldList[e]:t.engineModule.fieldList[e];return{fieldName:e,fieldItem:s?{name:e,caption:s.caption,baseField:s.baseField,baseItem:s.baseItem,isCalculatedField:s.isCalculatedField,isNamedSet:s.isNamedSets,showNoDataItems:s.showNoDataItems,showSubTotals:s.showSubTotals,type:s.aggregateType,showFilterIcon:s.showFilterIcon,showSortIcon:s.showSortIcon,showRemoveIcon:s.showRemoveIcon,showValueTypeIcon:s.showValueTypeIcon,showEditIcon:s.showEditIcon,allowDragAndDrop:s.allowDragAndDrop}:void 0,axis:"fieldlist",position:-1}}static isButtonIconRefesh(e,t,i){let s=!1;try{if("dataSourceSettings"===e&&t.dataSourceSettings&&i.dataSourceSettings){let e=["notAvail","notAvail","notAvail","notAvail"],o=Object.keys(t.dataSourceSettings),l=Object.keys(i.dataSourceSettings);if(o&&l&&l.length>0&&o.length===l.length){let s=["rows","columns","values","filters"];for(let r=0;r<l.length;r++){let n=l[r]in t.dataSourceSettings&&!(0,a.le)(t.dataSourceSettings[l[r]])?Object.keys(t.dataSourceSettings[l[r]]):[],h=l[r]in i.dataSourceSettings&&!(0,a.le)(i.dataSourceSettings[l[r]])?Object.keys(i.dataSourceSettings[l[r]]):[];if(-1!==s.indexOf(l[r])&&-1!==s.indexOf(o[r])&&n&&h&&h.length>0&&n.length===h.length){let s=["showFilterIcon","showSortIcon","showRemoveIcon","showValueTypeIcon","showEditIcon","allowDragAndDrop"];for(let o=0;o<h.length;o++){let a=Object.keys(t.dataSourceSettings[l[r]][h[o]]),n=Object.keys(i.dataSourceSettings[l[r]][h[o]]);for(let t=0;t<n.length;t++){if(-1===s.indexOf(n[t])||-1===s.indexOf(a[t])){e[r]="break";break}e[r]="update"}if("break"===e[r])break}}else e[r]="break";if("break"===e[r])break}}let r=0,n=0,h=0;for(let t of e)"break"===t&&r++,"notAvail"===t&&n++,"update"===t&&h++;s=!(r>0||4===n)&&0===r&&n<4&&h>0}}catch(o){s=!1}return s}static formatPivotValues(e){let t=[];for(let i=0;i<e.length;i++)if(e[i]){t[i]=[];for(let s=0;s<e[i].length;s++)e[i][s]&&(t[i][s]={axis:e[i][s].Axis,actualText:e[i][s].ActualText,indexObject:e[i][s].IndexObject,index:e[i][s].Index,rowHeaders:e[i][s].RowHeaders,columnHeaders:e[i][s].ColumnHeaders,formattedText:e[i][s].FormattedText,actualValue:e[i][s].ActualValue,rowIndex:e[i][s].RowIndex,colIndex:e[i][s].ColIndex,colSpan:e[i][s].ColSpan,level:e[i][s].Level,rowSpan:e[i][s].RowSpan,isSum:e[i][s].IsSum,isGrandSum:e[i][s].IsGrandSum,valueSort:e[i][s].ValueSort,ordinal:e[i][s].Ordinal,hasChild:e[i][s].HasChild,isDrilled:e[i][s].IsDrilled,value:e[i][s].Value,type:e[i][s].Type,members:e[i][s].Members})}return t}static formatPdfHeaderFooter(e){let t=[];if(!(0,a.le)(e))for(let i=0;i<e.length;i++){let s=e[i];t.push({type:s.Type,pageNumberType:s.PageNumberType,style:s.Style?{penColor:s.Style.PenColor,penSize:s.Style.PenSize,dashStyle:s.Style.DashStyle,textBrushColor:s.Style.TextBrushColor,textPenColor:s.Style.TextPenColor,fontSize:s.Style.FontSize,hAlign:s.Style.HAlign,vAlign:s.Style.VAlign}:s.Style,points:null!==s.Points?{x1:s.Points.X1,y1:s.Points.Y1,x2:s.Points.X2,y2:s.Points.Y2}:null,format:s.Format,position:null!==s.Position?{x:s.Position.X,y:s.Position.Y}:null,size:null!==s.Size?{height:s.Size.Height,width:s.Size.Width}:null,src:s.Src,value:s.Value,font:s.Font})}return t}static formatPdfExportProperties(e){let t;return t=this.getDefinedObj({pageOrientation:"string"==typeof e.PageOrientation?e.PageOrientation:null,pageSize:"string"==typeof e.PageSize?e.PageSize:null,header:(0,a.le)(e.Header)?null:{fromTop:e.Header.FromTop,height:e.Header.Height,contents:this.formatPdfHeaderFooter(e.Header.Contents)},columns:e.Columns,footer:(0,a.le)(e.Footer)?null:{fromTop:e.Footer.FromBottom,height:e.Footer.Height,contents:this.formatPdfHeaderFooter(e.Footer.Contents)},includeHiddenColumn:e.IncludeHiddenColumn,dataSource:e.DataSource,exportType:"string"==typeof e.ExportType?e.ExportType:null,theme:(0,a.le)(e.Theme)?null:{header:e.Theme.Header,record:e.Theme.Record,caption:e.Theme.Caption},fileName:e.FileName,hierarchyExportMode:"string"==typeof e.HierarchyExportMode?e.HierarchyExportMode:null,allowHorizontalOverflow:e.AllowHorizontalOverflow}),t}static formatExcelStyle(e){let t;return(0,a.le)(e)||(t=this.getDefinedObj({fontColor:e.FontColor,fontName:e.FontName,fontSize:e.FontSize,hAlign:e.HAlign===String?e.HAlign:null,vAlign:e.VAlign===String?e.VAlign:null,bold:e.Bold,indent:e.Indent,italic:e.Italic,underline:e.Underline,backColor:e.BackColor,wrapText:e.WrapText,borders:e.Borders,numberFormat:e.NumberFormat,type:e.Type})),t}static formatExcelCell(e){if(!(0,a.le)(e))for(let t=0;t<e.length;t++)this.getDefinedObj({index:(0,a.le)(e[t].Index)?null:e[t].Index,colSpan:(0,a.le)(e[t].ColSpan)?null:e[t].ColSpan,value:(0,a.le)(e[t].Value)?null:e[t].Value,hyperlink:{target:(0,a.le)(e[t].Hyperlink)?null:e[t].Hyperlink.Target,displayText:(0,a.le)(e[t].Hyperlink)?null:e[t].Hyperlink.DisplayText},styles:this.formatExcelStyle(e[t].Style),rowSpan:(0,a.le)(e[t].RowSpan)?null:e[t].RowSpan});return[]}static formatExcelHeaderFooter(e){let t=[];if(!(0,a.le)(e))for(let i=0;i<e.Rows.length;i++){let s=e.Rows[i],o=this.getDefinedObj({index:(0,a.le)(s.Index)?null:s.Index,cells:this.formatExcelCell(s.Cells),grouping:(0,a.le)(s.Grouping)?null:s.Grouping});t.push(o)}return t}static formatExcelExportProperties(e){let t;return t=this.getDefinedObj({dataSource:e.DataSource,query:e.Query,multipleExport:this.getDefinedObj({type:(0,a.le)(e.MultipleExport)?null:e.MultipleExport.Type,blankRows:(0,a.le)(e.MultipleExport)?null:e.MultipleExport.BlankRows}),header:this.getDefinedObj({headerRows:(0,a.le)(e.Header)?null:e.Header.HeaderRows,rows:this.formatExcelHeaderFooter(e.Header)}),footer:this.getDefinedObj({footerRows:(0,a.le)(e.Footer)?null:e.Footer.FooterRows,rows:this.formatExcelHeaderFooter(e.Footer)}),columns:e.Columns,exportType:"string"==typeof e.ExportType?e.ExportType:void 0,includeHiddenColumn:e.IncludeHiddenColumn,theme:(0,a.le)(e.Theme)?void 0:{header:this.formatExcelStyle(e.Theme.Header),record:this.formatExcelStyle(e.Theme.Record),caption:this.formatExcelStyle(e.Theme.Caption)},fileName:e.FileName,hierarchyExportMode:"string"==typeof e.HierarchyExportMode?e.HierarchyExportMode:void 0}),t}static formatFieldList(e){let t=Object.keys(e),i={};for(let s=0;s<t.length;s++)e[t[s]]&&(i[t[s]]={id:e[t[s]].Id,caption:e[t[s]].Caption,type:e[t[s]].Type,formatString:e[t[s]].FormatString,index:e[t[s]].Index,members:e[t[s]].Members,formattedMembers:e[t[s]].FormattedMembers,dateMember:e[t[s]].DateMember,filter:e[t[s]].Filter,sort:e[t[s]].Sort,aggregateType:e[t[s]].AggregateType,baseField:e[t[s]].BaseField,baseItem:e[t[s]].BaseItem,filterType:e[t[s]].FilterType,format:e[t[s]].Format,formula:e[t[s]].Formula,isSelected:e[t[s]].IsSelected,isExcelFilter:e[t[s]].IsExcelFilter,showNoDataItems:e[t[s]].ShowNoDataItems,isCustomField:e[t[s]].IsCustomField,showFilterIcon:e[t[s]].ShowFilterIcon,showSortIcon:e[t[s]].ShowSortIcon,showRemoveIcon:e[t[s]].ShowRemoveIcon,showEditIcon:e[t[s]].ShowEditIcon,showValueTypeIcon:e[t[s]].ShowValueTypeIcon,allowDragAndDrop:e[t[s]].AllowDragAndDrop,isCalculatedField:e[t[s]].IsCalculatedField,showSubTotals:e[t[s]].ShowSubTotals});return i}static frameContent(e,t,i,s){let o=[];if(s.dataSourceSettings.values.length>0&&!s.engineModule.isEmptyData&&(s.enableValueSorting||!s.engineModule.isEngineUpdated)){let s=0,r="value"===t?e.length:i;for(var l="value"===t?i:0;l<r;l++)if(e[l]){s="header"===t?l:s,o[s]={};for(var a=0;a<e[l].length;a++)e[l][a]&&(o[s][a]=e[l][a]);s++}}return o}static getLocalizedObject(e){let t=new Object;return t.Null=e.localeObj.getConstant("null"),t.Years=e.localeObj.getConstant("Years"),t.Quarters=e.localeObj.getConstant("Quarters"),t.Months=e.localeObj.getConstant("Months"),t.Days=e.localeObj.getConstant("Days"),t.Hours=e.localeObj.getConstant("Hours"),t.Minutes=e.localeObj.getConstant("Minutes"),t.Seconds=e.localeObj.getConstant("Seconds"),t.QuarterYear=e.localeObj.getConstant("QuarterYear"),t.Of=e.localeObj.getConstant("of"),t.Qtr=e.localeObj.getConstant("qtr"),t.Undefined=e.localeObj.getConstant("undefined"),t.GroupOutOfRange=e.localeObj.getConstant("groupOutOfRange"),t.Group=e.localeObj.getConstant("group"),t}static updateReport(e,t){e.setProperties({dataSourceSettings:{rows:[]}},!0),e.setProperties({dataSourceSettings:{columns:[]}},!0),e.setProperties({dataSourceSettings:{formatSettings:[]}},!0);for(let i=0;i<t.Rows.length;i++)e.dataSourceSettings.rows.push({name:t.Rows[i].Name,caption:t.Rows[i].Caption,showNoDataItems:t.Rows[i].ShowNoDataItems,baseField:t.Rows[i].BaseField,baseItem:t.Rows[i].BaseItem,showFilterIcon:t.Rows[i].ShowFilterIcon,showSortIcon:t.Rows[i].ShowSortIcon,showEditIcon:t.Rows[i].ShowEditIcon,showRemoveIcon:t.Rows[i].ShowRemoveIcon,showSubTotals:t.Rows[i].ShowValueTypeIcon,allowDragAndDrop:t.Rows[i].AllowDragAndDrop,axis:t.Rows[i].Axis,dataType:t.Rows[i].DataType,isCalculatedField:t.Rows[i].IsCalculatedField,showValueTypeIcon:t.Rows[i].ShowValueTypeIcon,type:t.Rows[i].Type});for(let i=0;i<t.Columns.length;i++)e.dataSourceSettings.columns.push({name:t.Columns[i].Name,caption:t.Columns[i].Caption,showNoDataItems:t.Columns[i].ShowNoDataItems,baseField:t.Columns[i].BaseField,baseItem:t.Columns[i].BaseItem,showFilterIcon:t.Columns[i].ShowFilterIcon,showSortIcon:t.Columns[i].ShowSortIcon,showEditIcon:t.Columns[i].ShowEditIcon,showRemoveIcon:t.Columns[i].ShowRemoveIcon,showSubTotals:t.Columns[i].ShowValueTypeIcon,allowDragAndDrop:t.Columns[i].AllowDragAndDrop,axis:t.Columns[i].Axis,dataType:t.Columns[i].DataType,isCalculatedField:t.Columns[i].IsCalculatedField,showValueTypeIcon:t.Columns[i].ShowValueTypeIcon,type:t.Columns[i].Type});for(let i=0;i<t.FormatSettings.length;i++)e.dataSourceSettings.formatSettings.push({name:t.FormatSettings[i].Name,format:t.FormatSettings[i].Format,type:t.FormatSettings[i].Type,currency:t.FormatSettings[i].Currency,maximumFractionDigits:t.FormatSettings[i].MaximumFractionDigits,maximumSignificantDigits:t.FormatSettings[i].MaximumSignificantDigits,minimumFractionDigits:t.FormatSettings[i].MinimumFractionDigits,minimumIntegerDigits:t.FormatSettings[i].MinimumIntegerDigits,minimumSignificantDigits:t.FormatSettings[i].MinimumSignificantDigits,skeleton:t.FormatSettings[i].Skeleton,useGrouping:t.FormatSettings[i].UseGrouping})}static generateUUID(){let e=(new Date).getTime(),t=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,i=>{let s=16*Math.random();return e>0?(s=(e+s)%16|0,e=Math.floor(e/16)):(s=(t+s)%16|0,t=Math.floor(t/16)),("x"===i?s:3&s|8).toString(16)})}}class fr{constructor(){this.aggregatedValueMatrix=[],this.valueContent=[],this.formatFields={},this.dateFormatFunction={},this.calculatedFields={},this.calculatedFormulas={},this.valueAxis=0,this.saveDataHeaders={},this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.rowStartPos=0,this.colStartPos=0,this.enableValueSorting=!1,this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0},this.rMembers=[],this.cMembers=[],this.groupingFields={},this.valueMatrix=[],this.indexMatrix=[],this.memberCnt=-1,this.pageInLimit=!1,this.endPos=0,this.removeCount=0,this.colHdrBufferCalculated=!1,this.colValuesLength=1,this.rowValuesLength=1,this.slicedHeaders=[],this.fieldFilterMem={},this.filterPosObj={},this.selectedHeaders={selectedHeader:[],values:[]},this.rowGrandTotal=null,this.columnGrandTotal=null,this.removeRowGrandTotal=!1,this.removeColumnGrandTotal=!1,this.isValueHasAdvancedAggregate=!1,this.rawIndexObject={},this.isEditing=!1,this.data=[],this.actualData=[],this.groupRawIndex={},this.fieldKeys={},this.allowDataCompression=!1,this.dataSourceSettings={},this.frameHeaderObjectsCollection=!1,this.headerObjectsCollection={},this.columnKeys={},this.fieldDrillCollection={},this.fieldMapping=[],this.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,this.formatRegex=/(^[ncpae]{1})([0-1]?[0-9]|20)?$/i}renderEngine(e,t,i){let s;if(this.getValueCellInfo=i,this.formatFields={},this.dateFormatFunction={},this.calculatedFields={},this.calculatedFormulas={},this.valueAxis=0,this.saveDataHeaders={},this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.rowStartPos=0,this.colStartPos=0,this.excludeFields=(0,a.le)(e.excludeFields)?[]:e.excludeFields,this.enableValueSorting=!1,this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0},this.valueMatrix=[],this.indexMatrix=[],this.aggregatedValueMatrix=[],this.rMembers=[],this.cMembers=[],this.memberCnt=-1,this.pageInLimit=!1,this.endPos=0,this.removeCount=0,this.colHdrBufferCalculated=!1,this.colValuesLength=1,this.rowValuesLength=1,this.slicedHeaders=[],this.fieldFilterMem={},this.filterPosObj={},this.selectedHeaders={selectedHeader:[],values:[]},this.rowGrandTotal=null,this.columnGrandTotal=null,this.removeRowGrandTotal=!1,this.removeColumnGrandTotal=!1,this.isValueHasAdvancedAggregate=!1,this.rawIndexObject={},this.isEditing=!1,this.globalize=new a.eC,this.localeObj=t?t.localeObj:void 0,this.fieldsType=t?t.fieldsType:{},this.clonedReport=t?t.clonedReport:{},this.enableSort=e.enableSorting,this.alwaysShowValueHeader=e.alwaysShowValueHeader,this.showHeaderWhenEmpty=!!(0,a.le)(e.showHeaderWhenEmpty)||e.showHeaderWhenEmpty,this.showSubTotals=!!(0,a.le)(e.showSubTotals)||e.showSubTotals,this.showRowSubTotals=!!(0,a.le)(e.showRowSubTotals)||e.showRowSubTotals,this.showColumnSubTotals=!!(0,a.le)(e.showColumnSubTotals)||e.showColumnSubTotals,this.showGrandTotals=!!(0,a.le)(e.showGrandTotals)||e.showGrandTotals,this.showRowGrandTotals=!!(0,a.le)(e.showRowGrandTotals)||e.showRowGrandTotals,this.showColumnGrandTotals=!!(0,a.le)(e.showColumnGrandTotals)||e.showColumnGrandTotals,this.allowValueFilter=e.allowValueFilter,this.isValueFilterEnabled=!1,this.enableValueSorting=!!t&&t.enableValueSorting,this.isDrillThrough=!!t&&!!t.isDrillThrough&&t.isDrillThrough,this.valueContent=[],this.dataSourceSettings=e,e.dataSource instanceof r.hm||(this.data=(0,a.xr)()&&!e.dataSource&&this.data&&this.data.length>0?this.data:e.dataSource),this.data&&this.data[0]){if(!this.fieldList){this.fields="CSV"===e.type?this.data.shift():Object.keys(this.data[0]);for(let t=0;t<this.fields.length;t++)this.fieldKeys[this.fields[t]]="CSV"===e.type?t:this.fields[t]}t&&t.pageSettings&&t.pageSettings.allowDataCompression&&(this.actualData=this.data,this.data=this.getGroupedRawData(e)),this.rows=e.rows?e.rows:[],this.columns=e.columns?e.columns:[],this.filters=e.filters?e.filters:[],this.values=e.values?e.values:[],this.formats=e.formatSettings?e.formatSettings:[],this.groups=e.groupSettings?e.groupSettings:[],this.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.enableSort=void 0===e.enableSorting||e.enableSorting,this.fieldMapping=e.fieldMapping?e.fieldMapping:[],s=this.getGroupData(this.data);for(let t=0;t<this.fields.length;t++)this.fieldKeys[this.fields[t]]="CSV"===e.type?t:this.fields[t];this.validateFilters(e),this.isExpandAll=!(!this.isValueFiltersAvail||!e.allowValueFilter)||e.expandAll,this.drilledMembers=e.drilledMembers?this.isValueFiltersAvail&&e.allowValueFilter?[]:e.drilledMembers:[],this.isMutiMeasures=this.values.length>1,this.valueAxis="row"===e.valueAxis?1:0,this.emptyCellTextContent=e.emptyCellsTextContent?e.emptyCellsTextContent:"",this.rowValuesLength=1===this.valueAxis?this.values.length:1,this.colValuesLength=0===this.valueAxis?this.values.length:1,this.valueSortSettings=e.valueSortSettings||{sortOrder:"None",headerDelimiter:".",headerText:"",columnIndex:void 0},this.valueSortData=[],this.pageSettings=t?t.pageSettings?t.pageSettings:this.pageSettings:void 0,this.allowDataCompression=this.pageSettings&&this.pageSettings.allowDataCompression,this.savedFieldList=t?t.savedFieldList:void 0,this.getFieldList(s,this.enableSort,e.allowValueFilter),this.removeIrrelevantFields(e,Object.keys(this.fieldList)),this.fillFieldMembers(this.data,this.indexMatrix),this.updateSortSettings(e.sortSettings,this.enableSort),this.valueMatrix=this.generateValueMatrix(this.data),this.filterMembers=[];let i=this.columns.length-1;for(this.columnKeys={};i>-1;)this.columnKeys[this.columns[i].name]=this.columns[i],i--;this.updateFilterMembers(e),this.generateGridData(e)}}removeIrrelevantFields(e,t){let i={};i[0]=e.rows,i[1]=e.columns,i[2]=e.values,i[3]=e.filters;let s=0;for(;s<4;){if(i[s])for(let e=0;e<i[s].length;e++)(this.excludeFields.indexOf(i[s][e].name)>-1||!(0,a.le)(t)&&-1===t.indexOf(i[s][e].name))&&(i[s].splice(e,1),e--);s++}}getGroupedRawData(e){this.data=[];for(let a of this.actualData)this.data[this.data.length]=this.frameHeaderWithKeys(a);let t=e.values.filter(e=>"Count"===e.type||"DistinctCount"===e.type).map(e=>e.name),i=t.length>0,s=this.data,o=e.rows.concat(e.columns.concat(e.filters)).map(e=>e.name),l={},r=[];this.groupRawIndex={};let n={},h=0;for(let d=0;d<s.length;d++){let c=s[d],p=[];if(i)for(let e=0;e<t.length;e++)c[this.fieldKeys[t[e]]]=(0,a.le)(c[this.fieldKeys[t[e]]])?c[this.fieldKeys[t[e]]]:1;for(let e=0;e<o.length;e++)p.push(c[this.fieldKeys[o[e]]]);let u=p.join("-");if(l[u]){for(let t=0;t<e.values.length;t++){let i=e.values[t].name,s=c[this.fieldKeys[i]],o=l[u],r=e.values[t].type;(0,a.le)(s)||("number"==typeof s&&"DistinctCount"!==r||(r="Count"),(0,a.le)(o[i])?o[i]="Product"===r?1:"Min"===r||"Max"===r?void 0:0:"number"!=typeof o[i]&&(o[i]=1),"Count"===r?o[i]+=1:"Min"===r?(0,a.le)(o[i])||(o[i]=o[i]>s?s:o[i]):"Max"===r?(0,a.le)(o[i])||(o[i]=o[i]<s?s:o[i]):"Product"===r?o[i]*=s:o[i]+=s)}this.isDrillThrough&&this.groupRawIndex[n[u]].push(d)}else l[u]=c,r.push(c),this.isDrillThrough&&(this.groupRawIndex[h]=[d],n[u]=h,h++)}return r}getGroupData(e){let t=e[0];for(let i of this.groups){let s=i.name,o=i.caption;if(!(this.fields.indexOf(s)>-1))return t;{let l,r={};if("Date"===i.type&&this.groupingFields[s])return t;if("Number"===i.type){if("number"!==br.getType(t[s])&&this.groupingFields[s])return t;i.rangeInterval&&e.sort((e,t)=>Number(e[this.fieldKeys[s]])>Number(t[this.fieldKeys[s]])?1:Number(t[this.fieldKeys[s]])>Number(e[this.fieldKeys[s]])?-1:0)}else if("Custom"===i.type&&this.fields.indexOf(s+"_custom_group")>-1)return t;let n=e.length;for(;n--;){let o=e[n];if(o[this.fieldKeys[s]]&&"Date"===i.type){let e=new Date(o[this.fieldKeys[s]].toString());if(!(0,a.le)(e)&&i.groupInterval.length>0)for(let t=0,l=i.groupInterval.length;t<l;t++){let l=i.groupInterval[t],a=this.getRange(i,e.getTime()),n=br.resetTime(new Date);switch(l){case"Years":{let h=t===i.groupInterval.length-1?s:s+"_date_group_years";r[h]=l,this.fieldKeys[h]="CSV"===this.dataSourceSettings.type?this.fieldKeys[h]?this.fieldKeys[h]:this.fields.length:h,-1===this.fields.indexOf(h)&&this.fields.push(h),o[this.fieldKeys[h]]=a?void 0:new Date(n.setFullYear(e.getFullYear())).toString()}break;case"Quarters":{let n=t===i.groupInterval.length-1?s:s+"_date_group_quarters";r[n]=l;let h=Math.ceil((e.getMonth()+1)/3);this.fieldKeys[n]="CSV"===this.dataSourceSettings.type?this.fieldKeys[n]?this.fieldKeys[n]:this.fields.length:n,-1===this.fields.indexOf(n)&&this.fields.push(n),o[this.fieldKeys[n]]=a?void 0:(this.localeObj?this.localeObj.getConstant("qtr"):"Qtr")+h.toString()}break;case"QuarterYear":{let n=t===i.groupInterval.length-1?s:s+"_date_group_quarterYear";r[n]=l;let h=Math.ceil((e.getMonth()+1)/3);this.fieldKeys[n]="CSV"===this.dataSourceSettings.type?this.fieldKeys[n]?this.fieldKeys[n]:this.fields.length:n,-1===this.fields.indexOf(n)&&this.fields.push(n),o[this.fieldKeys[n]]=a?void 0:(this.localeObj?this.localeObj.getConstant("qtr"):"Qtr")+h.toString()+" "+(this.localeObj?this.localeObj.getConstant("of"):"of")+" "+e.getFullYear().toString()}break;case"Months":{let h=t===i.groupInterval.length-1?s:s+"_date_group_months";r[h]=l,this.fieldKeys[h]="CSV"===this.dataSourceSettings.type?this.fieldKeys[h]?this.fieldKeys[h]:this.fields.length:h,-1===this.fields.indexOf(h)&&this.fields.push(h),o[this.fieldKeys[h]]=a?void 0:new Date(n.setMonth(e.getMonth(),n.getDate())).toString()}break;case"Days":{let h=t===i.groupInterval.length-1?s:s+"_date_group_days";r[h]=l,this.fieldKeys[h]="CSV"===this.dataSourceSettings.type?this.fieldKeys[h]?this.fieldKeys[h]:this.fields.length:h,-1===this.fields.indexOf(h)&&this.fields.push(h),o[this.fieldKeys[h]]=a?void 0:new Date(n.setMonth(e.getMonth(),e.getDate())).toString()}break;case"Hours":{let h=t===i.groupInterval.length-1?s:s+"_date_group_hours";r[h]=l,this.fieldKeys[h]="CSV"===this.dataSourceSettings.type?this.fieldKeys[h]?this.fieldKeys[h]:this.fields.length:h,-1===this.fields.indexOf(h)&&this.fields.push(h),o[this.fieldKeys[h]]=a?void 0:new Date(n.setHours(e.getHours())).toString()}break;case"Minutes":{let h=t===i.groupInterval.length-1?s:s+"_date_group_minutes";r[h]=l,this.fieldKeys[h]="CSV"===this.dataSourceSettings.type?this.fieldKeys[h]?this.fieldKeys[h]:this.fields.length:h,-1===this.fields.indexOf(h)&&this.fields.push(h),o[this.fieldKeys[h]]=a?void 0:new Date(n.setMinutes(e.getMinutes())).toString()}break;case"Seconds":{let h=t===i.groupInterval.length-1?s:s+"_date_group_seconds";r[h]=l,this.fieldKeys[h]="CSV"===this.dataSourceSettings.type?this.fieldKeys[h]?this.fieldKeys[h]:this.fields.length:h,-1===this.fields.indexOf(h)&&this.fields.push(h),o[this.fieldKeys[h]]=a?void 0:new Date(n.setSeconds(e.getSeconds())).toString()}}}}else if(o[this.fieldKeys[s]]&&"Number"===i.type){let e=this.getRange(i,Number(o[this.fieldKeys[s]]));o[this.fieldKeys[s]]=e?void 0:o[this.fieldKeys[s]]}else if(o[this.fieldKeys[s]]&&"Custom"===i.type&&i.customGroups&&i.customGroups.length>0){let e,t=s+"_custom_group",a=i.customGroups;for(let i=0,r=a.length;i<r;i++){let r=a[i];if(r.items&&r.items.length>1){l=t,this.fieldKeys[t]="CSV"===this.dataSourceSettings.type?this.fieldKeys[t]?this.fieldKeys[t]:this.fields.length:t,-1===this.fields.indexOf(t)&&this.fields.push(t);let a=-1!==br.inArray(o[this.fieldKeys[s]].toString(),r.items);o[this.fieldKeys[t]]=a?r.groupName&&""!==r.groupName?r.groupName:this.localeObj.getConstant("group")+" "+i:e&&e!==o[this.fieldKeys[s]].toString()?e:o[this.fieldKeys[s]].toString(),e=o[this.fieldKeys[t]]}}}let h=Object.keys(o),d=[];for(let e of h)d.push(!!o[e]);t=-1===d.indexOf(!1)&&h.length===Object.keys(e[0]).length?o:t}if("Date"===i.type){let e,t=!1,i=[this.rows,this.columns,this.values,this.filters],o=Object.keys(r),l=Object.keys(o).length;for(let a of i)if(!t&&a){let i=a.length,n=0;for(;n<i;){if(a[n].name===s){t=!0;let i=a[n];a.splice(n,1);let s=this.rows;for(s=s.concat(this.columns,this.values,this.filters);l--;){let t=i.caption?i.caption:i.name;if(this.clonedReport){let e=this.clonedReport.rows;e=e.concat(this.clonedReport.columns,this.clonedReport.values,this.clonedReport.filters);let i=br.getFieldByName(o[l],e);i&&(t=i.caption?i.caption:i.name)}if(!br.getFieldByName(o[l],s)){e=r[o[l]];let s={name:o[l],caption:(this.localeObj?this.localeObj.getConstant(e):e)+" ("+t+")",type:"Count",showNoDataItems:i.showNoDataItems,baseField:i.baseField,baseItem:i.baseItem,showFilterIcon:i.showFilterIcon,showSortIcon:i.showSortIcon,showEditIcon:i.showEditIcon,showRemoveIcon:i.showRemoveIcon,showSubTotals:i.showValueTypeIcon,allowDragAndDrop:i.allowDragAndDrop};a.splice(n,0,s)}}break}n++}if(t)break}for(l=Object.keys(o).length;l--;){e=r[o[l]];for(let e=0,t=this.formats.length;e<t;e++)if(this.formats[e].name===o[l]){this.formats.splice(e,1);break}if("Quarters"!==e&&"QuarterYear"!==e){let t={name:o[l],type:["Years","Months","Days"].indexOf(e)>-1?"date":"time",format:"Years"===e?"yyyy":"Months"===e?"MMM":"Days"===e?"d-MMM":"Hours"===e?"hh a":"Minutes"===e?":mm":"Seconds"===e?":ss":void 0};this.formats.push(t)}}}else if("Number"===i.type&&i.rangeInterval){let o,l,a,r,n=[],h=[],d=e.length,c=0;for(this.groupingFields[s]=s;c<d;)h.push(Number(e[c][this.fieldKeys[s]])),e[c][this.fieldKeys[s]]&&-1===n.indexOf(Number(e[c][this.fieldKeys[s]]))&&n.push(Number(e[c][this.fieldKeys[s]])),c++;let p=Math.max.apply(Math,n);for(let t=n[0],i=p;t<i;t++)if(h.indexOf(t)<0){let i=this.frameData(e[0]);i[this.fieldKeys[s]]=t;let o=h.lastIndexOf(t-1);h.splice(o+1,0,t),e.splice(o+1,0,i)}for(d=e.length,c=0;c<d;){if(e[c]&&e[c][this.fieldKeys[s]]){a=Number(e[c][this.fieldKeys[s]]),r=a+(i.rangeInterval-1),o=o||a,l=l?l>p?p:l:r>p?p:r,a>=o&&a<=l?e[c][this.fieldKeys[s]]=o===l?o.toString():o.toString()+"-"+l.toString():a>l&&a===l+1&&(o=l+1,l=o+(i.rangeInterval-1)>p?p:o+(i.rangeInterval-1),e[c][this.fieldKeys[s]]=o===l?o.toString():o.toString()+"-"+l.toString());let n=Object.keys(e[c]),h=[];for(let t of n)h.push(!!e[c][t]);t=-1===h.indexOf(!1)&&n.length===Object.keys(e[0]).length?e[c]:t}c++}let u=[this.rows,this.columns,this.values,this.filters];for(let e of u){let t=br.getFieldByName(s,e);t&&(t=t.properties?t.properties:t,t.type="Count")}for(let e=0,t=this.formats.length;e<t;e++)if(this.formats[e].name===s){this.formats.splice(e,1);break}}else if("Custom"===i.type&&l){let e=l,t=!1,a=[this.rows,this.columns,this.values,this.filters],r=this.rows;r=r.concat(this.columns,this.values,this.filters);let n=[];o&&""!==o||(n=e.match(/_custom_group/g));let h=br.getFieldByName(s.replace(/_custom_group/g,""),r),d=br.getFieldByName(e,r);for(let s of a)if(!t&&s){let l=s.length,a=0;for(;a<l;){if(s[a].name===i.name&&!d){t=!0;let i=s[a];s.splice(a,0,{name:e,caption:o&&""!==o?o:(h.caption?h.caption:h.name)+(n.length+1),type:"Count",showNoDataItems:i.showNoDataItems,baseField:i.baseField,baseItem:i.baseItem,showSubTotals:i.showValueTypeIcon,allowDragAndDrop:i.allowDragAndDrop,showFilterIcon:i.showFilterIcon,showSortIcon:i.showSortIcon,showRemoveIcon:i.showRemoveIcon,showEditIcon:i.showEditIcon});break}if(s[a].name===e&&d){s.splice(a,1,{name:d.name,caption:o&&""!==o?o:d.caption,type:d.type,showNoDataItems:d.showNoDataItems,baseField:d.baseField,baseItem:d.baseItem,showRemoveIcon:d.showRemoveIcon,showSubTotals:d.showValueTypeIcon,allowDragAndDrop:d.allowDragAndDrop,showFilterIcon:d.showFilterIcon,showSortIcon:d.showSortIcon,showEditIcon:d.showEditIcon});break}a++}if(t)break}let c=br.getFieldByName(s,br.cloneFormatSettings(this.formats));c&&(c.name=e,this.formats.push(c))}this.groupingFields=(0,a.l7)(this.groupingFields,r)}}return t}frameData(e){let t=Object.keys(e),i=0,s={};for(;i<t.length;)s[t[i]]=void 0,i++;return s}getRange(e,t){let i;if("Date"===e.type){let s=new Date(t),o="string"==typeof e.startingAt?new Date(e.startingAt):e.startingAt,l="string"==typeof e.endingAt?new Date(e.endingAt):e.endingAt;i=!!(o&&s.getTime()<o.getTime()||l&&s.getTime()>l.getTime())}else{let s="string"==typeof e.startingAt?parseInt(e.startingAt,10):e.startingAt,o="string"==typeof e.endingAt?parseInt(e.endingAt,10):e.endingAt;i=!!(s&&t<s||o&&t>o)}return i}getPercentFormat(e,t){let i=(0,a.le)(e[t])||(0,a.le)(this.formatFields[t].format)?void 0:this.formatFields[t].format.toLowerCase().match(/p[0-9]/);return(0,a.le)(i)?2:Number(this.formatFields[t].format.replace(/[^0-9]/g,""))}getFormattedFields(e){let t=this.formats.length;for(;t--;)this.formatFields[this.formats[t].name]=this.formats[t],this.formats[t].type&&(this.dateFormatFunction[this.formats[t].name]={exactFormat:this.globalize.getDateFormat(this.formats[t]),fullFormat:this.globalize.getDateFormat({format:"yyyy/MM/dd/HH/mm/ss",type:this.formats[t].type})})}getFieldList(e,t,i){let s,o=this.fields,l=(0,a.l7)([],this.rows,null,!0);l=l.concat(this.columns,this.values,this.filters),this.getFormattedFields(l),this.getCalculatedField(o),o=this.fields;let r=this.excludeFields.length;for(r-=1;r>-1;){let e=this.fields.indexOf(this.excludeFields[r]);-1!==e&&this.fields.splice(e,1),this.fieldList&&delete this.fieldList[this.excludeFields[r]],r--}let n=o.length,h=["string","number","datetime","date","boolean"];if(this.savedFieldList)for(this.fieldList=this.savedFieldList;n--;){let e=o[n],l=this.getMappingField(e);this.fieldList[e]?(this.fieldList[e].isSelected=!1,this.fieldList[e].index=n,this.fieldList[e].filter=[],this.fieldList[e].sort=t?"Ascending":"None",this.fieldList[e].isExcelFilter=!1,this.fieldList[e].filterType="",this.fieldList[e].showFilterIcon=!l||!("showFilterIcon"in l)||l.showFilterIcon,this.fieldList[e].showRemoveIcon=!l||!("showRemoveIcon"in l)||l.showRemoveIcon,this.fieldList[e].showSortIcon=!l||!("showSortIcon"in l)||l.showSortIcon,this.fieldList[e].showEditIcon=!l||!("showEditIcon"in l)||l.showEditIcon,this.fieldList[e].showValueTypeIcon=!l||!("showValueTypeIcon"in l)||l.showValueTypeIcon,this.fieldList[e].allowDragAndDrop=!l||!("allowDragAndDrop"in l)||l.allowDragAndDrop,this.fieldList[e].isCalculatedField=!(!l||!("isCalculatedField"in l))&&l.isCalculatedField,this.fieldList[e].showNoDataItems=!(!l||!("showNoDataItems"in l))&&l.showNoDataItems,this.fieldList[e].showSubTotals=!l||!("showSubTotals"in l)||l.showSubTotals,this.isValueFiltersAvail&&i&&(this.fieldList[e].dateMember=[],this.fieldList[e].formattedMembers={},this.fieldList[e].members={})):(s=l&&"dataType"in l&&l.dataType&&h.indexOf(l.dataType.toLowerCase())>-1?l.dataType.toLowerCase():s,this.fieldList[e]={caption:l&&"caption"in l&&l.caption?l.caption:e,id:e,type:-1!==e.indexOf("_custom_group")||-1!==e.indexOf("_date_group")?"string":void 0===s||"undefined"===s?"number":s,isSelected:!1,sort:t?"Ascending":"None",filterType:"",index:n,filter:[],isCustomField:-1!==e.indexOf("_custom_group")||-1!==e.indexOf("_date_group"),showRemoveIcon:!l||!("showRemoveIcon"in l)||l.showRemoveIcon,showFilterIcon:!l||!("showFilterIcon"in l)||l.showFilterIcon,showSortIcon:!l||!("showSortIcon"in l)||l.showSortIcon,showNoDataItems:!(!l||!("showNoDataItems"in l))&&l.showNoDataItems,isCalculatedField:!(!l||!("isCalculatedField"in l))&&l.isCalculatedField,showEditIcon:!l||!("showEditIcon"in l)||l.showEditIcon,showValueTypeIcon:!l||!("showValueTypeIcon"in l)||l.showValueTypeIcon,allowDragAndDrop:!l||!("allowDragAndDrop"in l)||l.allowDragAndDrop,showSubTotals:!l||!("showSubTotals"in l)||l.showSubTotals,aggregateType:l&&"type"in l?l.type:"number"===(-1!==e.indexOf("_custom_group")||-1!==e.indexOf("_date_group")?"string":void 0===s||"undefined"===s?"number":s)?"Sum":"Count",baseField:l&&"baseField"in l?l.baseField:void 0,baseItem:l&&"baseItem"in l?l.baseItem:void 0})}else for(this.fieldList={};n--;){let i=o[n],l=this.getMappingField(i);s=l&&"dataType"in l&&l.dataType&&h.indexOf(l.dataType.toLowerCase())>-1?l.dataType.toLowerCase():br.getType(e[this.fieldKeys[i]]),this.fieldList[i]={id:i,caption:l&&"caption"in l&&l.caption?l.caption:i,type:-1!==i.indexOf("_custom_group")||-1!==i.indexOf("_date_group")?"string":void 0===s||"undefined"===s?"number":s,filterType:"",index:n,filter:[],sort:t?"Ascending":"None",isSelected:!1,isCustomField:-1!==i.indexOf("_custom_group")||-1!==i.indexOf("_date_group"),showFilterIcon:!l||!("showFilterIcon"in l)||l.showFilterIcon,showRemoveIcon:!l||!("showRemoveIcon"in l)||l.showRemoveIcon,showSortIcon:!l||!("showSortIcon"in l)||l.showSortIcon,showEditIcon:!l||!("showEditIcon"in l)||l.showEditIcon,showValueTypeIcon:!l||!("showValueTypeIcon"in l)||l.showValueTypeIcon,allowDragAndDrop:!l||!("allowDragAndDrop"in l)||l.allowDragAndDrop,showSubTotals:!l||!("showSubTotals"in l)||l.showSubTotals,showNoDataItems:!(!l||!("showNoDataItems"in l))&&l.showNoDataItems,isCalculatedField:!(!l||!("isCalculatedField"in l))&&l.isCalculatedField,aggregateType:l&&"type"in l?l.type:"number"===(-1!==i.indexOf("_custom_group")||-1!==i.indexOf("_date_group")?"string":void 0===s||"undefined"===s?"number":s)?"Sum":"Count",baseField:l&&"baseField"in l?l.baseField:void 0,baseItem:l&&"baseItem"in l?l.baseItem:void 0}}this.updateTreeViewData(l)}getMappingField(e){let t={};if(this.fieldMapping.length>0)for(let i=0,s=this.fieldMapping.length;i<s;i++)if(this.fieldMapping[i].name===e){t=this.fieldMapping[i];break}return t}updateFieldList(e){let t=this.fields,i=t.length;for(;i--;)this.fieldList[t[i]].isExcelFilter=e[t[i]].isExcelFilter}updateTreeViewData(e){let t=e.length,i=this.calculatedFieldSettings.length;for(;t--;)if(this.fieldList[e[t].name]){let i=this.fieldList[e[t].name];i.type=e[t].dataType?e[t].dataType.toLowerCase():i.type,i.caption=e[t].caption?e[t].caption:e[t].name,i.isSelected=!0,i.showNoDataItems=e[t].showNoDataItems,i.aggregateType=e[t].type,i.baseField=e[t].baseField,i.baseItem=e[t].baseItem,i.allowDragAndDrop=e[t].allowDragAndDrop,i.showFilterIcon=e[t].showFilterIcon,i.showSortIcon=e[t].showSortIcon,i.showRemoveIcon=e[t].showRemoveIcon,i.showValueTypeIcon=e[t].showValueTypeIcon,i.showEditIcon=e[t].showEditIcon,i.showSubTotals=e[t].showSubTotals}for(;i--;)this.fieldList[this.calculatedFieldSettings[i].name]&&(this.fieldList[this.calculatedFieldSettings[i].name].aggregateType="CalculatedField",this.fieldList[this.calculatedFieldSettings[i].name].isCalculatedField=!0,this.fieldList[this.calculatedFieldSettings[i].name].formula=this.calculatedFieldSettings[i].formula)}getCalculatedField(e){for(let i of this.calculatedFieldSettings)this.calculatedFields[i.name]=(0,a.l7)({},i,null,!0),this.calculatedFields[i.name].actualFormula=i.formula;let t=Object.keys(this.calculatedFields);for(let i=0,s=t.length;i<s;i++){let s=this.calculatedFields[t[i]],o=s.properties,l=(o?o.formula:s.formula).trim(),a=l.replace(/"/g,"");s.formula=a.indexOf("^")>-1?this.powerFunction(a):a,-1===s.formula.indexOf("Math.min(")&&s.formula.indexOf("min(")>-1&&(s.formula=s.formula.replace(/min\(/g,"Math.min(")),-1===s.formula.indexOf("Math.max(")&&s.formula.indexOf("max(")>-1&&(s.formula=s.formula.replace(/max\(/g,"Math.max(")),-1===s.formula.indexOf("Math.abs(")&&s.formula.indexOf("abs(")>-1&&(s.formula=s.formula.replace(/abs\(/g,"Math.abs(")),s.name=o?o.name:s.name,(e=e.filter(e=>e!==s.name)).push(s.name);let r=l.split('"');for(let t=0,i=r.length;t<i;t++){let i=r[t].trim(),o=i.split(/[ .:;?!~,`"&|()<>{}\[\]\r\n/\\]+/),l=i.match(/^([^()]+)\((.*)\)$/),a="DistinctCount"===o[0]?"DistinctCount":"PopulationStDev"===o[0]?"PopulationStDev":"SampleStDev"===o[0]?"SampleStDev":"PopulationVar"===o[0]?"PopulationVar":"SampleVar"===o[0]?"SampleVar":o[0];if(-1!==["Sum","Count","Min","Max","Avg","Product","DistinctCount","PopulationStDev","SampleStDev","PopulationVar","SampleVar","Median"].indexOf(a)){let t=-1===e.indexOf(o[1])&&l[2]?e.indexOf(l[2]):e.indexOf(o[1]);this.calculatedFormulas[s.name]?this.calculatedFormulas[s.name].push({index:t,type:a,formula:i}):this.calculatedFormulas[s.name]=[{index:t,type:a,formula:i}]}}}this.fields=e}validateFilters(e){this.isValueFiltersAvail=!1;let t=e.filterSettings?e.filterSettings:[],i=(0,a.l7)([],this.rows,null,!0);i=i.concat(this.columns);for(let s of t){for(let e of i)if(s.name===e.name&&"Value"===s.type){this.isValueFiltersAvail=!0;break}if(this.isValueFiltersAvail)break}}validateValueFields(){this.isValueHasAdvancedAggregate=!1;for(let e of this.values)if(-1!==["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal","RunningTotals"].indexOf(e.type)){this.isValueHasAdvancedAggregate=!0;break}}fillFieldMembers(e,t){let i=this.fields,s=e.length,o=this.fieldList,l=i.length;for(let a=0;a<l;a++){let l=i[a];o[l].members&&!this.allowDataCompression||(o[l].members={}),o[l].formattedMembers&&!this.allowDataCompression||(o[l].formattedMembers={}),o[l].dateMember&&!this.allowDataCompression||(o[l].dateMember=[]);let r=o[l].members,n=Object.keys(r).length>0,h=o[l].formattedMembers,d=o[l].dateMember,c=0,p=0;for(let i=0;i<s;i++){let s=e[i][this.fieldKeys[l]];if(!n){let e=s,t=!this.pageSettings||this.formatFields[l]&&["date","dateTime","time"].indexOf(this.formatFields[l].type)>-1?this.getFormattedValue(s,l):{formattedText:null===s?this.localeObj?this.localeObj.getConstant("null"):String(s):void 0===s?this.localeObj?this.localeObj.getConstant(l in this.groupingFields?"groupOutOfRange":"undefined"):String(s):s.toString(),actualText:null===s?this.localeObj?this.localeObj.getConstant("null"):String(s):void 0===s?this.localeObj?this.localeObj.getConstant(l in this.groupingFields?"groupOutOfRange":"undefined"):String(s):s};t.formattedText&&(e=t.formattedText),r.hasOwnProperty(s)?r[s].index.push(i):(c++,r[s]={index:[i],ordinal:c,isDrilled:!!this.isExpandAll},d.push({formattedText:t.formattedText,actualText:t.dateText?t.dateText:t.actualText})),h.hasOwnProperty(e)?h[e].index.push(i):(p++,h[e]={index:[i],ordinal:p,isDrilled:!!this.isExpandAll})}t[i]||(t[i]=[]),t[i][a]=r[s].ordinal}}}generateValueMatrix(e){let t=this.fields,i=e.length,s=[],o=t.length,l=this.fieldList;for(;i--;){let r=o;for(s[i]=[];r--;){let o=t[r];s[i][r]="number"===l[o].type||(0,a.le)(e[i][this.fieldKeys[o]])?(0,a.le)(e[i][this.fieldKeys[o]])?e[i][this.fieldKeys[o]]:isNaN(Number(e[i][this.fieldKeys[o]]))?void 0:Number(e[i][this.fieldKeys[o]]):1}}return s}updateSortSettings(e,t){for(let i=0,s=e?e.length:0;i<s&&t;i++)this.fieldList[e[i].name]&&(this.fieldList[e[i].name].sort=e[i].order)}updateFilterMembers(e){let t=this.filterMembers,i={},s=this.getFilters(e,i),o=this.indexMatrix.length;if(s){let e=i.include.index;for(let s=0;s<e.length;s++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[e[s]]||t.push(e[s])}else for(let l=0;l<o;l++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[l]||t.push(l)}getFilters(e,t){let i=e.filterSettings?e.filterSettings:[],s=!1,o=[];for(let l=0,a=i.length;l<a;l++){let a=i[l].properties?i[l].properties:i[l];this.fieldList[a.name]&&this.fieldList[a.name].isSelected&&this.isValidFilterField(a,e.allowMemberFilter,e.allowLabelFilter)&&(this.applyLabelFilter(a),a&&(o=a.items),a.type&&"Include"===a.type?(this.frameFilterList(o,a.name,t,"include",a.showLabelFilter,s),s=!0):this.frameFilterList(o,a.name,t,"exclude",a.showLabelFilter),a.showLabelFilter&&(a.items=[],a.type=a.showDateFilter?"Date":a.showNumberFilter?"Number":"Label"))}return s}isValidFilterField(e,t,i){let s=e.name,o=!1,l=(0,a.l7)([],this.rows,null,!0);if(l=l.concat(this.columns),this.fieldList[s].isSelected&&t&&["Include","Exclude"].indexOf(e.type)>=0){o=!0;for(let e of this.values)if(s===e.name){o=!1;break}}else if(i)for(let a of l)if(s===a.name&&["Label","Date","Number"].indexOf(e.type)>=0){o=!0;break}return o}applyLabelFilter(e){if(["Label","Date","Number"].indexOf(e.type)>=0){let t=Object.keys(this.fieldList[e.name].members);if(e.showLabelFilter=!0,"Label"===e.type)e.items=this.getLabelFilterMembers(t,e.condition,e.value1,e.value2);else if("Date"===e.type){e.showDateFilter=!0;let i="string"==typeof e.value1?new Date(e.value1):e.value1,s="string"==typeof e.value2?new Date(e.value2):e.value2;e.items=this.getDateFilterMembers(t,e.name,e.condition,i,s)}else{e.showNumberFilter=!0,e.items=[];for(let i of t){let t=this.getParsedValue(e.name,e.value1),s=this.getParsedValue(e.name,e.value2),o=this.getParsedValue(e.name,i);this.validateFilterValue(o,e.condition,t,s)&&e.items.push(i)}}let i=["DoesNotBeginWith","DoesNotContains","DoesNotEndsWith","DoesNotEquals","NotBetween"];e.type=e.condition?i.indexOf(e.condition)>-1&&!e.showNumberFilter?"Exclude":"Include":"Exclude"}else e.showLabelFilter=!1}getLabelFilterMembers(e,t,i,s){let o=[];for(let l of e){let e=l.toLowerCase();if(i.toString())switch(t){case"Equals":case"DoesNotEquals":e===i.toLowerCase()&&o.push(l);break;case"BeginWith":case"DoesNotBeginWith":0===e.indexOf(i.toLowerCase())&&o.push(l);break;case"EndsWith":case"DoesNotEndsWith":null!==e.match(i.toLowerCase()+"$")&&o.push(l);break;case"Contains":case"DoesNotContains":e.indexOf(i.toLowerCase())>-1&&o.push(l);break;case"GreaterThan":e>i.toLowerCase()&&o.push(l);break;case"GreaterThanOrEqualTo":e>=i.toLowerCase()&&o.push(l);break;case"LessThan":e<i.toLowerCase()&&o.push(l);break;case"LessThanOrEqualTo":e<=i.toLowerCase()&&o.push(l);break;case"Between":case"NotBetween":e>=i.toLowerCase()&&e<=s.toLowerCase()&&o.push(l);break;default:e===i.toLowerCase()&&o.push(l)}}return o}getDateFilterMembers(e,t,i,s,o){let l=[];for(let a of e){let e=new Date(a);if(s)switch(i){case"Equals":case"DoesNotEquals":this.getFormattedValue(e.toString(),t).formattedText===this.getFormattedValue(s.toString(),t).formattedText&&l.push(this.getFormattedValue(a,t).formattedText);break;case"After":e.getTime()>s.getTime()&&l.push(this.getFormattedValue(a,t).formattedText);break;case"AfterOrEqualTo":e.getTime()>=s.getTime()&&l.push(this.getFormattedValue(a,t).formattedText);break;case"Before":e.getTime()<s.getTime()&&l.push(this.getFormattedValue(a,t).formattedText);break;case"BeforeOrEqualTo":e.getTime()<=s.getTime()&&l.push(this.getFormattedValue(a,t).formattedText);break;case"Between":case"NotBetween":e.getTime()>=s.getTime()&&e.getTime()<=o.getTime()&&l.push(this.getFormattedValue(a,t).formattedText);break;default:this.getFormattedValue(e.toString(),t).formattedText===this.getFormattedValue(s.toString(),t).formattedText&&l.push(this.getFormattedValue(a,t).formattedText)}}return l}validateFilterValue(e,t,i,s){let o=!1;if("number"==typeof i)switch(t){case"Equals":e===i&&(o=!0);break;case"DoesNotEquals":e!==i&&(o=!0);break;case"GreaterThan":e>i&&(o=!0);break;case"GreaterThanOrEqualTo":e>=i&&(o=!0);break;case"LessThan":e<i&&(o=!0);break;case"LessThanOrEqualTo":e<=i&&(o=!0);break;case"Between":e>=i&&e<=s&&(o=!0);break;case"NotBetween":e>=i&&e<=s||(o=!0);break;default:e!==i&&(o=!0)}return o}frameFilterList(e,t,i,s,o,l){i[s]||(i[s]={indexObject:{},index:[]}),this.updateFilter(e,t,i,s,o,l)}updateFilter(e,t,i,s,o,l){let a=0,r=this.fieldList[t];r.filter=e,r.filterType=s,r.isExcelFilter=o;let n=this.formatFields[t]&&["date","dateTime","time"].indexOf(this.formatFields[t].type)>-1?r.formattedMembers:r.members,h=l,d={},c={};for(d[s]={indexObject:{},index:[]},this.fieldFilterMem[t]={memberObj:{}};e[a];){if(n[e[a]]){let o=n[e[a]].index;if("include"===s)for(let e=0,t=o.length;e<t;e++)h&&void 0===i[s].indexObject[o[e]]||(d[s].indexObject[o[e]]=o[e],d[s].index.push(o[e]));else{for(let e=0,t=o.length;e<t;e++)void 0===i[s].indexObject[o[e]]&&(i[s].indexObject[o[e]]=o[e],i[s].index.push(o[e]));this.fieldFilterMem[t].memberObj[e[a]]=e[a]}}a++}if("include"===s){i[s]=d[s];for(let t=0;t<e.length;t++)n[e[t]]&&(c[e[t]]=e[t]);let o=Object.keys(n);for(let e=0,i=o.length;e<i;e++)void 0===c[o[e]]&&(this.fieldFilterMem[t].memberObj[o[e]]=o[e])}}applyValueFiltering(e,t,i,s,o,l,r){this.isValueFiltered=!1;let n=(0,a.l7)({},"row"===r&&this.rowGrandTotal?this.rowGrandTotal:"column"===r&&this.columnGrandTotal?this.columnGrandTotal:i[i.length-1],null,!0);return this.getFilteredData(i,s,o,l,t,e.name,n,r),this.isValueFiltered&&(("row"===r&&null===this.rowGrandTotal||"column"===r&&null===this.columnGrandTotal)&&l.push(n),i=l),i}getFilteredData(e,t,i,s,o,l,r,n){let h=e.length;for(let d=0;d<h;d++)if(i[l])if(e[d].level===o){this.isValueFiltered=!0,this.fieldList[l].isExcelFilter=!0;let h=0,c=i[l].measure,p=this.fieldList[c].index,u=this.fieldList[c].aggregateType;this.rawIndexObject={},h="row"===n?this.getAggregateValue(e[d].index,t.indexObject,p,u):this.getAggregateValue(t.index,e[d].indexObject,p,u);let g={fieldName:c,row:e[d],column:t,value:h,cellSets:this.getCellSet(this.rawIndexObject),rowCellType:e[d].hasChild&&e[d].isDrilled?"subTotal":"grand sum"===e[d].type?"grandTotal":"value",columnCellType:t.hasChild&&t.isDrilled?"subTotal":"grand sum"===t.type?"grandTotal":"value",aggregateType:u,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(g),h=g.value,this.rawIndexObject={};let m=this.getParsedValue(c,i[l].value1),b=this.getParsedValue(c,i[l].value2);if(this.validateFilterValue(h,i[l].condition,m,b)||"grand sum"===e[d].type)"grand sum"!==e[d].type&&(s.push((0,a.l7)({},e[d],null,!0)),s[s.length-1].isLevelFiltered=!0);else{let t=this.removefilteredData(e[d],this.valueFilteredData);this.validateFilteredParentData(t||e[d],this.valueFilteredData,r,0,o,n)}}else e[d].hasChild&&e[d].members.length>0&&"grand sum"!==e[d].type&&(s.push((0,a.l7)({},e[d],null,!0)),s[s.length-1].members=[],s[s.length-1].isLevelFiltered=!0,this.getFilteredData(e[d].members,t,i,s[s.length-1].members,o,l,r,n))}getParsedValue(e,t){let i=t?t.toString():"";if(this.formatFields[e]&&t){let t=(0,a.l7)({},this.formatFields[e],null,!0);return delete t.name,this.globalize.parseNumber(i,t)}return this.globalize.parseNumber(i,{format:"N"})}removefilteredData(e,t){let i,s=(0,a.l7)([],t,null,!0);for(let o=0;o<s.length;o++){if(e.isLevelFiltered&&e.axis===s[o].axis&&e.valueSort.levelName===s[o].valueSort.levelName&&e.actualText===s[o].actualText&&e.axis===s[o].axis&&e.level===s[o].level&&e.ordinal===s[o].ordinal){i=s[o],t.splice(o,1);break}t[o].hasChild&&t[o].members.length>0&&this.removefilteredData(e,t[o].members)}return i}validateFilteredParentData(e,t,i,s,o,l){if(t.length>0){for(let a of t)if(a.level===s){if("row"===l){let t=e.index;for(let s of t)i.index.indexOf(s)>=0&&i.index.splice(i.index.indexOf(s),1),e.valueSort.levelName.toString().indexOf(a.valueSort.levelName.toString())>=0&&a.level!==o&&a.index.indexOf(s)>=0&&a.index.splice(a.index.indexOf(s),1)}else{let t=e.indexObject;for(let s of Object.keys(t))t.hasOwnProperty(s)&&(delete i.indexObject[s],e.valueSort.levelName.toString().indexOf(a.valueSort.levelName.toString())>=0&&a.level!==o&&delete a.indexObject[s])}a&&a.members.length>0&&a.members[0].level===s+1&&a.members[0].level!==o&&this.validateFilteredParentData(e,a.members,i,s+1,o,l)}}else if("row"===l){let t=e.index;for(let e of t)i.index.indexOf(e)>=0&&i.index.splice(i.index.indexOf(e),1)}else{let t=e.indexObject;for(let e of Object.keys(t))t.hasOwnProperty(e)&&delete i.indexObject[e]}}updateFramedHeaders(e,t,i,s,o){for(let l of e)this.isHeaderAvail=!1,(this.validateFilteredHeaders(l,i,o)||"grand sum"===l.type)&&("row"===o?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength,s.push((0,a.l7)({},l,null,!0)),s[s.length-1].members=[],l.hasChild&&l.isDrilled&&l.members.length>0&&this.updateFramedHeaders(l.members,t,i,s[s.length-1].members,o));return this.filterFramedHeaders}validateFilteredHeaders(e,t,i){for(let s of t)if(!this.isHeaderAvail){if(e.actualText===s.actualText&&e.level===s.level&&e.valueSort.levelName===s.valueSort.levelName)return"row"===i?s.index.length>0?(this.isHeaderAvail=!0,e.index=s.index,!0):(this.isHeaderAvail=!1,e.index=s.index,!1):Object.keys(s.indexObject).length>0?(this.isHeaderAvail=!0,e.indexObject=s.indexObject,!0):(this.isHeaderAvail=!1,e.indexObject=s.indexObject,!1);s.hasChild&&s.members.length>0&&"grand sum"!==s.type&&this.validateFilteredHeaders(e,s.members,i)}return this.isHeaderAvail}isEmptyDataAvail(e,t){this.isEmptyData=!1,e.length>0&&"grand sum"===e[e.length-1].type&&0===e[e.length-1].index.length&&(this.isEmptyData=!0),t.length>0&&"grand sum"===t[t.length-1].type&&0===Object.keys(t[t.length-1].indexObject).length&&(this.isEmptyData=!0),0!==e.length&&0!==t.length||(this.isEmptyData=!0)}updateGridData(e){this.data=e.dataSource,this.pageSettings&&this.pageSettings.allowDataCompression&&(this.actualData=this.data,this.data=this.getGroupedRawData(e)),this.indexMatrix=[];for(let t of this.fields)this.fieldList[t].members={},this.fieldList[t].formattedMembers={},this.fieldList[t].dateMember=[];this.fillFieldMembers(this.data,this.indexMatrix),this.valueMatrix=this.generateValueMatrix(this.data),this.filterMembers=[],this.cMembers=[],this.rMembers=[],this.updateFilterMembers(e),this.isEditing=!0,this.isDrillThrough=!0,this.generateGridData(e),this.isEditing=!1}generateGridData(e,t){let i=e.columns?e.columns:[],s=this.data,o=e.rows?e.rows:[],l=e.filterSettings,r=e.values?e.values:[];this.removeCount=0,this.isExpandAll=e.expandAll,this.drilledMembers=e.drilledMembers?e.drilledMembers:[],this.isEmptyData=!1;let n=[],h=o[0]&&o[0].showNoDataItems||i[0]&&i[0].showNoDataItems,d=(0,a.l7)([],this.rows,null,!0);if(d=d.concat(this.columns,this.values,this.filters),h)for(let a=0;a<this.indexMatrix.length;a++)n.push(a);for(let a=0;a<this.filterMembers.length;a++)this.filterPosObj[this.filterMembers[a]]=this.filterMembers[a];this.valueSortSettings.columnIndex=void 0,this.validateValueFields(),this.frameDrillObject(),this.isValueFilterEnabled&&!this.isEditing||t||(this.columnCount=0,this.rowCount=0,this.cMembers=[],this.rMembers=[],0!==o.length&&(this.rMembers=this.getIndexedHeaders(o,s,0,o[0].showNoDataItems?n:this.filterMembers,"row","",this.allowValueFilter)),0!==i.length&&(this.cMembers=this.getIndexedHeaders(i,s,0,i[0].showNoDataItems?n:this.filterMembers,"column","",this.allowValueFilter)),this.insertAllMembersCommon(),this.saveDataHeaders=this.isValueFiltersAvail&&e.allowValueFilter?{rowHeaders:(0,a.l7)([],this.rMembers,null,!0),columnHeaders:(0,a.l7)([],this.cMembers,null,!0)}:{}),this.pivotValues=[],this.headerContent=[],this.valueContent=[],this.valueFilteredData=[],this.filterFramedHeaders=[];let c=[],p=[],u=[],g=[],m=this.values.length;if(this.isValueFiltersAvail&&e.allowValueFilter&&!t){this.valueFilteredData=[];let t=this.saveDataHeaders.rowHeaders,h=this.saveDataHeaders.columnHeaders;if(l.length>0){let e={},s={};for(let t of r)s[t.name]=t;for(let a of l){t=u.length>0?u:t,h=g.length>0?g:h,this.valueFilteredData=[];let l=a.properties?a.properties:a;if("Value"===l.type&&this.fieldList[a.name]&&this.fieldList[a.name].isSelected){e[a.name]=a,l.items=[];let r=!1,n=o.length,d=i.length;for(let i=0;i<n;i++)if(l.name===o[i].name&&s[l.measure]&&!r){r=!0,u=this.applyValueFiltering(o[i],i,t,this.columnGrandTotal?this.columnGrandTotal:h[h.length-1],e,this.valueFilteredData,"row");break}for(let o=0;o<d;o++)if(l.name===i[o].name&&s[l.measure]&&!r){r=!0,g=this.applyValueFiltering(i[o],o,h,this.rowGrandTotal?this.rowGrandTotal:t[t.length-1],e,this.valueFilteredData,"column");break}}}}u=u.length>0?u:t,g=g.length>0?g:h,this.isEmptyDataAvail(u,g);let d=(0,a.l7)({},this.fieldList,null,!0);this.indexMatrix=[],this.getFieldList(this.data[0],this.enableSort,e.allowValueFilter),this.fillFieldMembers(this.data,this.indexMatrix),this.updateSortSettings(e.sortSettings,this.enableSort),this.valueMatrix=this.generateValueMatrix(this.data),this.filterMembers=[],this.updateFilterMembers(e),this.rMembers=0!==o.length?this.getIndexedHeaders(o,s,0,o[0].showNoDataItems?n:this.filterMembers,"row",""):[],this.cMembers=0!==i.length?this.getIndexedHeaders(i,s,0,i[0].showNoDataItems?n:this.filterMembers,"column",""):[],this.insertAllMembersCommon(),this.updateFieldList(d),this.rowCount=0,this.columnCount=0,this.rMembers=this.updateFramedHeaders(this.rMembers,this.rMembers,u,this.filterFramedHeaders,"row"),this.filterFramedHeaders=[],this.cMembers=this.updateFramedHeaders(this.cMembers,this.cMembers,g,this.filterFramedHeaders,"column"),this.isValueFilterEnabled=!0}t||this.applyValueSorting(),this.pageSettings&&(t?(this.rMembers=t.rowHeaders,this.cMembers=t.columnHeaders,this.rowCount=t.rowHeadersCount,this.columnCount=t.columnHeadersCount):(this.headerCollection.rowHeaders=this.rMembers,this.headerCollection.columnHeaders=this.cMembers,this.headerCollection.rowHeadersCount=this.rowCount,this.headerCollection.columnHeadersCount=this.columnCount),this.calculatePagingValues()),this.getAggregatedHeaders(o,i,this.rMembers,this.cMembers,r),this.getHeaderData(this.cMembers,p,this.pivotValues,0,this.valueAxis?1:m),this.insertSubTotals(),this.getTableData(this.rMembers,c,p,0,this.pivotValues,m,this.rowGrandTotal?this.rowGrandTotal:this.rMembers[this.rMembers.length-1],this.columnGrandTotal?this.columnGrandTotal:this.cMembers[this.cMembers.length-1]),this.applyAdvancedAggregate(c,p,this.pivotValues),this.isEngineUpdated=!0,this.isEmptyDataAvail(this.rMembers,this.cMembers)}updateHeaders(e,t){e=(0,a.le)(e)?!((!this.showGrandTotals||!this.showRowGrandTotals)&&this.rows.length>0):e,(this.pageSettings&&this.removeRowGrandTotal||!e&&!this.rowGrandTotal)&&"grand sum"===this.rMembers[this.rMembers.length-1].type&&(this.rMembers=this.rMembers.slice(0,this.rMembers.length-1)),t=(0,a.le)(t)?!((!this.showGrandTotals||!this.showColumnGrandTotals)&&this.columns.length>0):t,(this.pageSettings&&this.removeColumnGrandTotal||!t&&!this.columnGrandTotal)&&"grand sum"===this.cMembers[this.cMembers.length-1].type&&(this.cMembers=this.cMembers.slice(0,this.cMembers.length-1))}updatePivotValues(e){let t=!((!this.showGrandTotals||!this.showRowGrandTotals)&&this.rows.length>0),i=!((!this.showGrandTotals||!this.showColumnGrandTotals)&&this.columns.length>0);if(e&&this.updateHeaders(t,i),(this.pageSettings&&this.removeRowGrandTotal||!t&&!this.rowGrandTotal)&&this.valueContent.length>0){let e=1;this.valueAxis&&this.values.length>0&&(e=1+this.values.length),this.pivotValues[this.pivotValues.length-e]&&"grand sum"===this.pivotValues[this.pivotValues.length-e][0].type&&(this.pivotValues=this.pivotValues.slice(0,this.pivotValues.length-e),this.valueContent=this.valueContent.slice(0,this.valueContent.length-e))}if((this.pageSettings&&this.removeColumnGrandTotal||!i&&!this.columnGrandTotal)&&this.headerContent.length>0){let e=this.values.length;if(this.valueAxis&&this.values.length>0&&(e=1),this.pivotValues[0][this.pivotValues[0].length-e]&&"grand sum"===this.pivotValues[0][this.pivotValues[0].length-e].type)for(let t=0;t<this.pivotValues.length;t++)if(this.pivotValues[t]&&(this.pivotValues[t]=this.pivotValues[t].slice(0,this.pivotValues[t].length-e)),this.headerContent[t])for(let i=this.pivotValues[t].length;i<this.pivotValues[t].length+e;i++)delete this.headerContent[t][i]}this.removeRowGrandTotal=this.removeColumnGrandTotal=!1}onDrill(e){this.frameDrillObject();let t=this.getHeadersInfo(e.fieldName,e.axis);this.performDrillOperation(t.headers,e,t.fields,t.position,0),this.headerCollection.rowHeadersCount=this.rowCount,this.headerCollection.columnHeadersCount=this.columnCount,"row"===t.axis?this.headerCollection.rowHeaders=t.headers:this.headerCollection.columnHeaders=t.headers,this.updateEngine()}onSort(e){let t=this.getHeadersInfo(e.name,"");this.fieldList[e.name].sort=e.order,this.performSortOperation(t.headers,e,t,0),this.updateEngine()}onFilter(e,t){let i=this.getHeadersInfo(e.name,"");"Include"===e.type&&e.items.length===this.fieldList[e.name].dateMember.length?(this.fieldList[e.name].filter=[],this.fieldList[e.name].filterType=""):(this.fieldList[e.name].filter=e.items,this.fieldList[e.name].filterType=e.type);let s={};for(let l of this.filterMembers)s[l]=l;this.filterMembers=[],this.fieldFilterMem={},this.updateFilterMembers(t);let o=this.filterMembers.filter(e=>void 0===s[e]);for(let l of e.items);if(this.rows[0]&&this.rows[0].showNoDataItems||this.columns[0]&&this.columns[0].showNoDataItems){let e=[];this.filterPosObj={};for(let t=0;t<o.length;t++)this.filterPosObj[o[t]]=o[t];for(let t=0;t<this.indexMatrix.length;t++)e.push(t);o=e}this.performFilterCommonUpdate(e,i,o),this.frameHeaderObjectsCollection=!1,this.headerObjectsCollection={},this.updateEngine()}onAggregation(e){this.fieldList[e.name].aggregateType=e.type,this.rMembers=this.headerCollection.rowHeaders,this.cMembers=this.headerCollection.columnHeaders,this.allowDataCompression&&(this.data=this.getGroupedRawData(this.dataSourceSettings),this.valueMatrix=this.generateValueMatrix(this.data)),this.updateEngine()}onCalcOperation(e){this.rMembers=this.headerCollection.rowHeaders,this.cMembers=this.headerCollection.columnHeaders,this.getCalculatedField(this.fields),this.fieldList[e.name]?this.fieldList[e.name].formula=e.formula:(this.fieldList[e.name]={id:e.name,caption:e.name,type:"number",aggregateType:"CalculatedField",filterType:"",index:this.fields.length-1,filter:[],sort:this.enableSort?"Ascending":"None",isSelected:!0,isExcelFilter:!1,formula:e.formula},1===this.valueAxis?this.headerCollection.rowHeadersCount=this.rowCount=this.rowCount/(this.values.length-1)*this.values.length:this.headerCollection.columnHeadersCount=this.columnCount=this.columnCount/(this.values.length-1)*this.values.length),this.updateEngine()}performDrillOperation(e,t,i,s,o){let l=0;for(;l<e.length;){if(s===o){if(t.memberName===e[l].valueSort.levelName.split(this.valueSortSettings.headerDelimiter).join(t.delimiter?t.delimiter:"**")){if("down"===t.action){let o;e[l].isDrilled=!0,e[l].members=this.getIndexedHeaders(i,this.data,s+1,e[l].index,t.axis,t.memberName.split(t.delimiter?t.delimiter:"**").join(this.valueSortSettings.headerDelimiter)),"row"===t.axis?(o=this.applyValueSorting(e[l].members,this.cMembers),e[l].members=o.rMembers):(this.columnCount-=this.showSubTotals&&this.showColumnSubTotals&&i[s].showSubTotals?0:this.colValuesLength,o=this.applyValueSorting(this.rMembers,e[l].members),e[l].members=o.cMembers)}else e[l].isDrilled=!1,this.updateHeadersCount(e[l].members,t.axis,s,i,"minus",!0),e[l].members=[];break}}else e[l].members.length>0&&(e[l].members=this.performDrillOperation(e[l].members,t,i,s,o+1));l++}return e}performSortOperation(e,t,i,s){let o=0;for(;o<e.length;){if(i.position===s){e=this.getSortedHeaders(e,t.order.toString());break}e[o].members.length>0&&(e[o].members=this.performSortOperation(e[o].members,t,i,s+1)),o++}return e}performFilterDeletion(e,t,i,s,o){let l=0,a=!0;for(;l<e.length&&a;){if(i.position===o){let i=this;e=e.filter(e=>!i.fieldFilterMem[t.name].memberObj[e.formattedText]||"grand sum"===e.type),a=!1}else e[l].members.length>0&&(e[l].members=this.performFilterDeletion(e[l].members,t,i,s,o+1));l++}let r=this;return e.filter(e=>e.members.length>0?e.members.length>0:r.matchIndexes(e.indexObject,s))}matchIndexes(e,t){let i=Object.keys(e),s=i.length;if(0===s)return!0;for(;s>-1;){if(void 0!==t[e[i[s]]])return!0;s--}return!1}performFilterAddition(e,t,i){let s=0;for(;s<e.length;){let o=e[s].valueSort.levelName;if(this.headerObjectsCollection[o]){let t={};for(let i of e[s].members)t[i.valueSort.levelName.toString()]=i.valueSort.levelName.toString();let l=this.headerObjectsCollection[o].filter(e=>!t[e.valueSort.levelName.toString()]);e[s].members=e[s].members.concat(l),e[s].members=this.getSortedHeaders(e[s].members,this.fieldList[i.fields[e[s].members[0].level].name].sort),delete this.headerObjectsCollection[o]}e[s].members.length>0&&(e[s].members=this.performFilterAddition(e[s].members,t,i)),s++}return e}performFilterCommonUpdate(e,t,i){let s="row"===t.axis?this.rMembers:this.cMembers,o={};for(let l of this.filterMembers)o[l]=l;if(this.fieldFilterMem[e.name]&&(s=this.performFilterDeletion(t.headers,e,t,o,0)),i.length>0&&t.fields.length>0){if(this.frameHeaderObjectsCollection=!0,t.fields.filter(e=>e.showNoDataItems).length>0)for(let t=0;t<this.data.length;t++)i.push(t);this.headerObjectsCollection.parent=this.getIndexedHeaders(t.fields,this.data,0,i,t.axis,""),s=this.performFilterAddition(s,t.fields,t);let e={};for(let t of s)e[t.valueSort.levelName.toString()]=t.valueSort.levelName.toString();let o=this.headerObjectsCollection.parent.filter(t=>!e[t.valueSort.levelName.toString()]),l=s.filter(e=>"grand sum"===e.type);l.length>0&&s.pop(),s=this.getSortedHeaders(s.concat(o),this.fieldList[t.fields[0].name].sort).concat(l)}"row"===t.axis?this.rowCount=0:this.columnCount=0,this.updateHeadersCount(s,t.axis,0,t.fields,"plus",!1),"row"===t.axis?(t.position>0&&this.insertPosition(this.rows,this.data,0,this.filterMembers,"row","",s),this.insertTotalPosition(s),this.rMembers=this.headerCollection.rowHeaders=s,this.headerCollection.rowHeadersCount=this.rowCount):(t.position>0&&this.insertPosition(this.columns,this.data,0,this.filterMembers,"column","",s),this.insertTotalPosition(s),this.cMembers=this.headerCollection.columnHeaders=s,this.headerCollection.columnHeadersCount=this.columnCount),this.applyValueSorting()}getHeadersInfo(e,t){this.rMembers=this.headerCollection.rowHeaders,this.cMembers=this.headerCollection.columnHeaders;let i="row"===(t=""===t?this.getAxisByFieldName(e):t)?this.rMembers:this.cMembers,s="row"===t?this.rows:this.columns,o=0;for(let l of s){if(l.name===e)break;o++}return{axis:t,fields:s,headers:i,position:o}}updateEngine(){this.removeCount=0,this.validateValueFields(),this.calculatePagingValues(),this.pivotValues=[],this.headerContent=[],this.valueContent=[];let e=[],t=[],i=this.values.length;this.getAggregatedHeaders(this.rows,this.columns,this.rMembers,this.cMembers,this.values),this.getHeaderData(this.cMembers,t,this.pivotValues,0,this.valueAxis?1:i),this.insertSubTotals(),this.getTableData(this.rMembers,e,t,0,this.pivotValues,i,this.rowGrandTotal?this.rowGrandTotal:this.rMembers[this.rMembers.length-1],this.columnGrandTotal?this.columnGrandTotal:this.cMembers[this.cMembers.length-1]),this.applyAdvancedAggregate(e,t,this.pivotValues),this.isEngineUpdated=!0,this.isEmptyDataAvail(this.rMembers,this.cMembers)}getAxisByFieldName(e){let t=0,i="";for(;t<4&&""===i;){switch(t){case 0:i=this.getFieldByName(e,this.rows)?"row":"";break;case 1:i=this.getFieldByName(e,this.columns)?"column":""}t++}return i}getFieldByName(e,t){return new r.hm({json:t}).executeLocal((new r.AE).where("name","equal",e))[0]}updateHeadersCount(e,t,i,s,o,l){let a=0,r=s[i],n=!0;for(n="column"===t?this.showSubTotals&&this.showColumnSubTotals&&r.showSubTotals:!(this.showSubTotals&&this.showRowSubTotals&&r)||r.showSubTotals;a<e.length;)"row"===t?this.rowCount=this.rowCount-("plus"===o?-(1===this.valueAxis?this.values.length:1):1===this.valueAxis?this.values.length:1):this.columnCount=this.columnCount-("plus"===o?-(1===this.valueAxis?1:this.values.length):1===this.valueAxis?1:this.values.length),e[a].members.length>0&&this.updateHeadersCount(e[a].members,t,i+1,s,o,!0),a++;"column"===t&&!n&&l&&(this.columnCount+="plus"===o?-this.colValuesLength:this.colValuesLength)}frameHeaderWithKeys(e){let t=Object.keys(e),i=0,s={};for(;i<t.length;)s[t[i]]=e[t[i]],i++;return s}getSortedHeaders(e,t){let i=this.fieldList[e[0].valueSort.axis];if(!(this.formatFields&&this.formatFields[e[0].valueSort.axis]&&this.formatFields[e[0].valueSort.axis].type)){if(i&&"number"==i.type&&e.length>0&&"string"==typeof e[0].actualText){let t=[],s=[],o=[];for(let i=0;i<e.length;i++)isNaN(e[i].actualText.toString().charAt(0))?t.push(e[i]):""===e[i].actualText?o.push(e[i]):s.push(e[i]);return t.length>0&&(t="Ascending"===i.sort?t.sort((e,t)=>e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0):"Descending"===i.sort?t.sort((e,t)=>e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0):t),s.length>0&&(s="Ascending"===i.sort?s.sort((e,t)=>Number(e.actualText.toString().match(/\d+/)[0])>Number(t.actualText.toString().match(/\d+/)[0])?1:Number(t.actualText.toString().match(/\d+/)[0])>Number(e.actualText.toString().match(/\d+/)[0])?-1:0):"Descending"===i.sort?s.sort((e,t)=>Number(e.actualText.toString().match(/\d+/)[0])<Number(t.actualText.toString().match(/\d+/)[0])?1:Number(t.actualText.toString().match(/\d+/)[0])<Number(e.actualText.toString().match(/\d+/)[0])?-1:0):s),o.concat(s,t)}return"Ascending"===t?e.sort(function(e,t){return e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0}):"Descending"===t?e.sort(function(e,t){return e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0}):e}return"Ascending"===t?e.sort((e,t)=>e.dateText>t.dateText?1:t.dateText>e.dateText?-1:0):"Descending"===t?e.sort((e,t)=>e.dateText<t.dateText?1:t.dateText<e.dateText?-1:0):e}applyValueSorting(e,t){let i=!1;if(void 0!==e&&void 0!==t||(e=this.rMembers,t=this.cMembers,i=!0),this.enableValueSorting&&this.valueSortSettings.headerText&&""!==this.valueSortSettings.headerText&&this.values.length>0){let s,o,l,a,r=this.valueSortSettings.headerText.split(this.valueSortSettings.headerDelimiter),n="";for(let e=0;e<this.values.length;e++){if(this.values[e].caption===r[r.length-1]){l=this.values[e].name;break}l=r[r.length-1]}if((1===this.values.length&&0===this.columns.length||this.values.length>1)&&l&&this.fieldList[l]){for(let e=0;e<r.length-1;e++)n=""===n?r[e]:n+this.valueSortSettings.headerDelimiter+r[e];s=this.fieldList[l].index,o=this.fieldList[l].aggregateType}else{if(this.alwaysShowValueHeader&&1!==r.length)for(let e=0;e<r.length-1;e++)n=""===n?r[e]:n+this.valueSortSettings.headerDelimiter+r[e];else n=this.valueSortSettings.headerText;s=this.fieldList[this.values[0].name].index,o=this.fieldList[this.values[0].name].aggregateType}0===this.valueAxis?(a=this.getMember(t,n),a&&(e=this.sortByValueRow(e,a,this.valueSortSettings.sortOrder,s,o))):(a=this.getMember(e,n),a&&(t=this.sortByValueRow(t,a,this.valueSortSettings.sortOrder,s,o))),i&&(this.rMembers=e,this.cMembers=t,this.pageSettings&&(this.headerCollection.rowHeaders=this.rMembers,this.headerCollection.columnHeaders=this.cMembers))}return{rMembers:e,cMembers:t}}getMember(e,t){let i,s=e.length;for(let o=0;o<s;o++){if(e[o].valueSort.levelName===t){i=e[o];break}if(e[o].members.length>0&&(i=this.getMember(e[o].members,t)),i)return i}return i}sortByValueRow(e,t,i,s,o){let l=[];for(let a of e)if("grand sum"===a.type)l.push({header:a});else{this.rawIndexObject={};let e=this.getAggregateValue(a.index,t.indexObject,s,o),i={fieldName:this.fields[s],row:a,column:t,value:e,cellSets:this.getCellSet(this.rawIndexObject),rowCellType:a.hasChild&&a.isDrilled?"subTotal":"grand sum"===a.type?"grandTotal":"value",columnCellType:t.hasChild&&t.isDrilled?"subTotal":"grand sum"===t.type?"grandTotal":"value",aggregateType:o,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(i),e=i.value,this.rawIndexObject={},l.push({header:a,value:e})}l.sort((e,t)=>"Descending"===i?(t.value||"grand sum"===t.header.type?t.value:0)-(e.value||"grand sum"===e.header.type?e.value:0):(e.value||"grand sum"===e.header.type?e.value:0)-(t.value||"grand sum"===t.header.type?t.value:0)),e=l.map(e=>e.header);for(let a of e)a.members.length>0&&(a.members=this.sortByValueRow(a.members,t,i,s,o));return e}insertAllMembersCommon(){this.rowGrandTotal=this.columnGrandTotal=null;let e=!((!this.showGrandTotals||!this.showRowGrandTotals)&&this.rows.length>0),t=!((!this.showGrandTotals||!this.showColumnGrandTotals)&&this.columns.length>0);this.isValueHasAdvancedAggregate?(this.insertAllMember(this.rMembers,this.filterMembers,"","row"),e&&(this.rowCount+=this.rowValuesLength),this.insertAllMember(this.cMembers,this.filterMembers,"","column"),t&&(this.columnCount+=this.colValuesLength)):(e?(this.insertAllMember(this.rMembers,this.filterMembers,"","row"),this.rowCount+=this.rowValuesLength):this.rowGrandTotal=this.insertAllMember([],this.filterMembers,"","row")[0],t?(this.insertAllMember(this.cMembers,this.filterMembers,"","column"),this.columnCount+=this.colValuesLength):this.columnGrandTotal=this.insertAllMember([],this.filterMembers,"","column")[0])}insertSubTotals(){let e=this.pivotValues.length;for(let t=0;t<e;t++){let e=this.pivotValues[t];if(e){let i,s,o=1;for(let l=e.length-1;l>0;l--){let r=e[l];if(r){i&&(i.colSpan=o,i.colIndex=i.colIndex-(o-1)),s={index:r.index,indexObject:r.indexObject},r.index=[],r.indexObject={},i=(0,a.l7)({},r,null,!0),r.index=s.index,r.indexObject=s.indexObject;let e=t+1;for(;this.pivotValues[e]&&!this.pivotValues[e][l];){this.pivotValues[t][l].isDrilled||(this.pivotValues[t][l].rowSpan=e-t+1,i.rowSpan=e-t+1);let s="sum"===r.type||"grand sum"===r.type?r.type:"sum";this.pivotValues[e][l]=this.headerContent[e][l]={type:s,formattedText:"sum"===r.type||"grand sum"===r.type?r.formattedText:r.formattedText+" Total",axis:"column",level:-1,colIndex:l,rowIndex:e,valueSort:r.valueSort},r.valueSort&&r.valueSort[this.valueSortSettings.headerText]&&(this.valueSortSettings.columnIndex=l);let o=!1;"grand sum"===s?(this.pivotValues[t][l].rowSpan=e-t+1,i.rowSpan=e-t+1):"sum"!==this.pivotValues[t][l].type&&this.pivotValues[t][l].isDrilled?(this.pivotValues[t+1][l].rowSpan=e-t,o=!0):this.pivotValues[e][l].rowSpan=-1,e>t+1&&("sum"===this.pivotValues[t][l].type||o)&&(this.pivotValues[e][l].rowSpan=-1),e++}o=1}else e[l]=this.headerContent[t][l]=(0,a.l7)({},i,null,!0),e[l].index=this.headerContent[t][l].index=s.index,e[l].indexObject=this.headerContent[t][l].indexObject=s.indexObject,o++,e[l].colSpan=o,e[l].colIndex=e[l].colIndex-(o-1);1===l&&i&&(i.colSpan=o,i.colIndex=i.colIndex-(o-1))}}}}frameDrillObject(){this.fieldDrillCollection={};for(let e=0;e<this.drilledMembers.length;e++){let t=this.drilledMembers[e];for(let e=0;e<t.items.length;e++){let i=t.name+this.valueSortSettings.headerDelimiter+t.items[e].split(t.delimiter).join(this.valueSortSettings.headerDelimiter);this.fieldDrillCollection[i]=i}}}getIndexedHeaders(e,t,i,s,o,l,r){let n=[];if(e){let h=e.length,d={},c=e[i].name,p=e[i],u=this.fieldList[c];if((0,a.le)(this.reportDataType)){this.reportDataType={};for(let e=0;e<this.dataSourceSettings.rows.length;e++)this.reportDataType[this.dataSourceSettings.rows[e].name]=this.dataSourceSettings.rows[e].dataType;for(let e=0;e<this.dataSourceSettings.columns.length;e++)this.reportDataType[this.dataSourceSettings.columns[e].name]=this.dataSourceSettings.columns[e].dataType;for(let e=0;e<this.dataSourceSettings.values.length;e++)this.reportDataType[this.dataSourceSettings.values[e].name]=this.dataSourceSettings.values[e].dataType}u.type=(0,a.le)(this.reportDataType[u.id])?u.type:this.reportDataType[u.id];let g=!1,m=this.formatFields[c]&&["date","dateTime","time"].indexOf(this.formatFields[c].type)>-1,b=s.length<1&&i>0||p.showNoDataItems,f={};if(b){let e=Object.keys(u.members);for(let t=0,i=e.length;t<i;t++)(this.showHeaderWhenEmpty||this.localeObj&&e[t]!==this.localeObj.getConstant("undefined"))&&(f[e[t]]=e[t]);s.length<1&&(g=!0,s.length=e.length)}for(let y=0,v=s.length;y<v;y++){let p={};(0,a.le)(e[i].showSubTotals)||e[i].showSubTotals||(p.showSubTotals=!1),p.hasChild=i<h-1,p.level=i,p.axis=o,p.colSpan=1;let S=g?u.members[Object.keys(f)[0]].ordinal:this.indexMatrix[s[y]][u.index],x=g?Object.keys(f)[0]:t[s[y]][this.fieldKeys[c]];if(((0,a.le)(x)||this.localeObj&&x===this.localeObj.getConstant("undefined"))&&!this.showHeaderWhenEmpty){b&&!g&&i>0&&y+1===s.length&&Object.keys(f).length>0&&(v=Object.keys(f).length,g=!0,y=-1);continue}if(delete f[x],b&&this.fieldFilterMem[c]&&this.fieldFilterMem[c].memberObj[x]===x)continue;let w=m?{actualText:x,formattedText:u.dateMember[S-1].formattedText,dateText:u.dateMember[S-1].actualText}:{formattedText:null===x?this.localeObj?this.localeObj.getConstant("null"):String(x):void 0===x&&this.localeObj?this.localeObj.getConstant(c in this.groupingFields?"groupOutOfRange":"undefined"):String(x),actualText:null===x?this.localeObj?this.localeObj.getConstant("null"):String(x):void 0===x?this.localeObj?this.localeObj.getConstant(c in this.groupingFields?"groupOutOfRange":"undefined"):String(x):x};p.actualText=w.actualText,p.formattedText=w.formattedText,m&&(p.dateText=w.dateText);let C=!b||void 0!==this.filterPosObj[s[y]]&&!g;if(d&&d[S])C&&(d[S].index.push(s[y]),d[S].indexObject[s[y]]=s[y]);else{d[S]={index:[],indexObject:{}},p.index=d[S].index,p.indexObject=d[S].indexObject,C&&(p.index=d[S].index=[s[y]],d[S].indexObject[s[y]]=s[y],p.indexObject=d[S].indexObject),p.ordinal=S,p.valueSort={},p.valueSort.axis=c,0!==i?(p.valueSort.levelName=l+this.valueSortSettings.headerDelimiter+p.formattedText,p.valueSort[l+this.valueSortSettings.headerDelimiter+p.formattedText]=1):(p.valueSort[p.formattedText]=1,p.valueSort.levelName=p.formattedText);let e=p.valueSort.axis+this.valueSortSettings.headerDelimiter+p.valueSort.levelName;p.isDrilled=!(!r||!this.isValueFiltersAvail)||(p.hasChild&&this.fieldDrillCollection[e]?!this.isExpandAll:u.members[x].isDrilled),p.members=[],n.push(p)}b&&!g&&i>0&&y+1===s.length&&Object.keys(f).length>0&&(g=!0,v=Object.keys(f).length,y=-1)}for(let s=0,r=n.length;s<r;s++){this.frameHeaderObjectsCollection||("row"===o?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength);let r=null;if(n[s].valueSort&&n[s].valueSort.levelName&&(r=n[s].valueSort.levelName),l=r||n[s].formattedText,!this.showHeaderWhenEmpty&&h-1>i&&n[s].index&&n[s].index.length>0)if(b&&e[i+1]&&e[i+1].name&&Object.keys(this.fieldList[e[i+1].name].members).length>0)n[s].hasChild=!0;else{let o=n[s].index.length,l=0;for(let r=0;r<o;r++){let o=t[n[s].index[r]][this.fieldKeys[e[i+1].name]];((0,a.le)(o)||this.localeObj&&o===this.localeObj.getConstant("undefined"))&&l++}n[s].hasChild=l!==o}if(h-1>i&&n[s].isDrilled){this.columnCount-=this.showSubTotals&&this.showColumnSubTotals&&p.showSubTotals||"column"!==o?0:this.colValuesLength;let a=n[s].index;n[s].members=this.getIndexedHeaders(e,t,i+1,void 0===a?[]:a,o,l),this.frameHeaderObjectsCollection&&(this.headerObjectsCollection[l]=n[s].members)}}if(this.enableSort){if(m)return"Ascending"===u.sort?n.sort((e,t)=>e.dateText>t.dateText?1:t.dateText>e.dateText?-1:0):"Descending"===u.sort?n.sort((e,t)=>e.dateText<t.dateText?1:t.dateText<e.dateText?-1:0):n;if("number"===u.type&&n.length>0&&"string"==typeof n[0].actualText){let e=[],t=[],i=[];for(let s=0;s<n.length;s++)isNaN(n[s].actualText.toString().charAt(0))?e.push(n[s]):""===n[s].actualText?i.push(n[s]):t.push(n[s]);return e.length>0&&(e="Ascending"===u.sort?e.sort((e,t)=>e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0):"Descending"===u.sort?e.sort((e,t)=>e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0):e),t.length>0&&(t="Ascending"===u.sort?t.sort((e,t)=>Number(e.actualText.toString().match(/\d+/)[0])>Number(t.actualText.toString().match(/\d+/)[0])?1:Number(t.actualText.toString().match(/\d+/)[0])>Number(e.actualText.toString().match(/\d+/)[0])?-1:0):"Descending"===u.sort?t.sort((e,t)=>Number(e.actualText.toString().match(/\d+/)[0])<Number(t.actualText.toString().match(/\d+/)[0])?1:Number(t.actualText.toString().match(/\d+/)[0])<Number(e.actualText.toString().match(/\d+/)[0])?-1:0):t),i.concat(t,e)}return"Ascending"===u.sort?n.sort((e,t)=>e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0):"Descending"===u.sort?n.sort((e,t)=>e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0):n}return n}return n}getOrderedIndex(e){let t={};for(let i=0;i<e.length;i++)"grand sum"!==e[i].type&&(t[e[i].ordinal]=i);return t}insertPosition(e,t,i,s,o,l,a){let r=[],n=this.getOrderedIndex(a);if(e){let h={},d=e[i].name,c=this.fieldList[d];for(let e=0,o=s.length;e<o;e++){let o={},p=this.indexMatrix[s[e]][c.index],u=a[n[p]],g=t[s[e]][this.fieldKeys[d]];g=null===g?this.localeObj?this.localeObj.getConstant("null"):String(g):g;let m=this.formatFields[d]&&["date","dateTime","time"].indexOf(this.formatFields[d].type)>-1?this.getFormattedValue(g,d):{formattedText:g.toString(),actualText:g.toString()};u&&u.formattedText===m.formattedText&&(h&&h[p]?(h[p].index.push(s[e]),h[p].indexObject[s[e]]=s[e]):(h[p]={index:[],indexObject:{}},u.index=h[p].index=[s[e]],h[p].indexObject[s[e]]=s[e],u.indexObject=h[p].indexObject,u.valueSort={},u.valueSort.axis=d,0!==i?(u.valueSort.levelName=l+this.valueSortSettings.headerDelimiter+u.formattedText,u.valueSort[l+this.valueSortSettings.headerDelimiter+u.formattedText]=1):(u.valueSort[u.formattedText]=1,u.valueSort.levelName=u.formattedText),o.members=[],r.push(o)))}let p=a.length-r.length;for(;p>0;)r.push({members:[]}),p--;for(let s=0,n=r.length;s<n;s++)if(a[s].members.length>0){let n=null;a[s].valueSort&&a[s].valueSort.levelName&&(n=a[s].valueSort.levelName),r[s].members=this.insertPosition(e,t,i+1,a[s].index,o,l=n||a[s].formattedText,a[s].members)}return r}return r}insertTotalPosition(e){let t=e[e.length-1];if(t&&"grand sum"===t.type){t.index=this.filterMembers;for(let e=0,i=this.filterMembers.length;e<i;e++)t.indexObject[this.filterMembers[e]]=this.filterMembers[e]}return e}calculatePagingValues(){if(this.pageSettings){1===this.valueAxis?this.rowValuesLength=this.values.length:this.colValuesLength=this.values.length,this.memberCnt=-this.rowValuesLength,this.rowStartPos=(this.pageSettings.rowCurrentPage*this.pageSettings.rowSize-this.pageSettings.rowSize)*this.rowValuesLength;let e=this.rowStartPos+3*this.pageSettings.rowSize*this.rowValuesLength>this.rowCount?this.rowCount-3*this.pageSettings.rowSize*this.rowValuesLength:this.rowStartPos;e<0&&(e=this.rowStartPos=0,this.pageSettings.rowCurrentPage=1),this.rowFirstLvl=(this.rowStartPos-e)%this.pageSettings.rowSize,this.rowStartPos=e,this.endPos=this.rowStartPos+3*this.pageSettings.rowSize*this.rowValuesLength,this.endPos=this.endPos>this.rowCount?this.rowCount:this.endPos,this.rMembers=this.performSlicing(this.rMembers,[],this.rowStartPos,"row"),this.memberCnt=-this.colValuesLength,this.pageInLimit=!1,this.colHdrBufferCalculated=!1,this.colStartPos=(this.pageSettings.columnCurrentPage*this.pageSettings.columnSize-this.pageSettings.columnSize)*this.colValuesLength,e=this.colStartPos+3*this.pageSettings.columnSize*this.colValuesLength>this.columnCount?this.columnCount-3*this.pageSettings.columnSize*this.colValuesLength:this.colStartPos,e<0&&(e=this.colStartPos=0,this.pageSettings.columnCurrentPage=1),this.colFirstLvl=(this.colStartPos-e)%this.pageSettings.columnSize,this.colStartPos=e,this.endPos=this.colStartPos+3*this.pageSettings.columnSize*this.colValuesLength,this.endPos=this.endPos>this.columnCount?this.columnCount:this.endPos,this.cMembers=this.performSlicing(this.cMembers,[],this.colStartPos,"column"),this.memberCnt=-1,this.pageInLimit=!1,this.isValueHasAdvancedAggregate?("grand sum"!==this.rMembers[this.rMembers.length-1].type&&"grand sum"===this.headerCollection.rowHeaders[this.headerCollection.rowHeaders.length-1].type&&(this.rMembers.push(this.headerCollection.rowHeaders[this.headerCollection.rowHeaders.length-1]),this.removeRowGrandTotal=!0),"grand sum"!==this.cMembers[this.cMembers.length-1].type&&"grand sum"===this.headerCollection.columnHeaders[this.headerCollection.columnHeaders.length-1].type&&(this.cMembers.push(this.headerCollection.columnHeaders[this.headerCollection.columnHeaders.length-1]),this.removeColumnGrandTotal=!0)):(this.rowGrandTotal=this.rowGrandTotal?this.rowGrandTotal:this.headerCollection.rowHeaders[this.headerCollection.rowHeaders.length-1],this.columnGrandTotal=this.columnGrandTotal?this.columnGrandTotal:this.headerCollection.columnHeaders[this.headerCollection.columnHeaders.length-1])}}performSlicing(e,t,i,s){let o=0;for(;e[o];){if(this.memberCnt+="column"===s?this.colValuesLength:this.rowValuesLength,i<=this.memberCnt&&this.endPos>=this.memberCnt&&!this.pageInLimit&&("column"===s?this.colFirstLvl=this.colFirstLvl+e[o].level:this.rowFirstLvl=this.rowFirstLvl+e[o].level,this.pageInLimit=!0),this.pageInLimit&&this.endPos<=this.memberCnt){if("column"!==s)break;if(0===e[o].members.length){if(this.colHdrBufferCalculated)break;this.colHdrBufferCalculated=!0,this.endPos+=e[o].level*this.colValuesLength}else if(this.colHdrBufferCalculated)break}if(t.push(e[o].members.length>0?this.removeChildMembers(e[o]):e[o]),e[o].members.length>0&&("column"===s&&(this.memberCnt-=this.showSubTotals&&this.showColumnSubTotals&&this.columnKeys[e[o].valueSort.axis].showSubTotals?0:this.colValuesLength),t[t.length-1].members=this.performSlicing(e[o].members,[],i,s)),this.pageInLimit||t.pop(),0===e[o].level&&this.pageInLimit&&this.endPos<=this.memberCnt)break;o++}return t}removeChildMembers(e){let t=Object.keys(e),i=0,s={};for(;i<t.length;)s[t[i]]=e[t[i]],"members"===t[i]&&(s.members=[]),i++;return s}insertAllMember(e,t,i,s){let o=e.length;e[o]={hasChild:!1,index:t,level:0,axis:s,isDrilled:!1,indexObject:{},members:[],formattedText:"Grand Total",ordinal:o,type:"grand sum",valueSort:{}},e[o].valueSort[e[o].formattedText]=1,e[o].valueSort.levelName=e[o].formattedText;for(let l=0,a=t.length;l<a;l++)e[o].indexObject[t[l]]=t[l];return e}getTableData(e,t,i,s,o,l,r,n){for(let h=e.length,d=0;d<h;d++){t[s=o.length]=e[d];let h=s-Number(Object.keys(t)[0]),c=!t[s].members.length;if(e[d].colIndex=0,e[d].rowIndex=s,o[s]||(o[s]=[],this.valueContent[h]={}),o[s][0]=this.valueContent[h][0]=this.frameHeaderWithKeys(e[d]),this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)){let p=s,u=h,g=s;if(!e[d].hasChild||!e[d].isDrilled||((0,a.le)(e[d].showSubTotals)||e[d].showSubTotals)&&this.showSubTotals&&this.showRowSubTotals){for(let t=0;t<l;t++){s++,h++;let l=this.values[t].caption?this.values[t].caption:this.values[t].name,a={axis:"row",actualText:this.values[t].name,formattedText:l,level:0,valueSort:{},colIndex:0,rowIndex:s,type:"value"};o[s]||(o[s]=[],this.valueContent[h]={},o[s][0]=this.valueContent[h][0]=a);let c=o[s][0].valueSort;c[o[s-t-1][0].valueSort.levelName+this.valueSortSettings.headerDelimiter+l]=1,c.levelName=o[s-t-1][0].valueSort.levelName+this.valueSortSettings.headerDelimiter+l;for(let g=0,m=1,b=i.length;g<b;++g)this.updateRowData(e,i,s,o,t,d,g,m,h,r,n),m=o[s].length,o[p][m-1]=this.valueContent[u][m-1]={axis:"value",actualText:"",colSpan:1,colIndex:m,formattedText:"",hasChild:!1}}g=s}else{for(let e=0,t=1,l=i.length;e<l;++e)t=o[s].length,o[p][t]=this.valueContent[u][t]={axis:"value",actualText:"",colSpan:1,colIndex:t,formattedText:"",hasChild:!1};g=s+l}this.recursiveRowData(e,t,i,g,o,l,c,d,l,r,n)}else{for(let t=0,a=1,c=i.length;t<c;++t)for(let p=0;p<l;p++)this.updateRowData(e,i,s,o,p,d,t,a,h,r,n),a=o[s].length;this.recursiveRowData(e,t,i,s,o,l,c,d,0,r,n)}}}getAggregatedHeaders(e,t,i,s,o){this.selectedHeaders={selectedHeader:[],values:[]};for(let l=o.length,a=0;a<l;a++)switch(o[a].type){case"DifferenceFrom":case"PercentageOfDifferenceFrom":{let l,r;this.selectedHeaders.values.push(o[a].name),o[a].baseField&&o[a].baseItem?(l=o[a].baseField,r=o[a].baseItem):this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)&&t.length>0?(l=t[0].name,r=Object.keys(this.fieldList[t[0].name].members)[0]):e.length>0&&(l=e[0].name,r=Object.keys(this.fieldList[e[0].name].members)[0]);let n=!1;for(let t of e)if(t.name===l){this.getAggregatedHeaderData(i,o[a].name,r,!1,"row",o[a].type,this.selectedHeaders.selectedHeader,a),n=!0;break}if(!n)for(let e of t)if(e.name===l){this.getAggregatedHeaderData(s,o[a].name,r,!1,"column",o[a].type,this.selectedHeaders.selectedHeader,a);break}}break;case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":this.selectedHeaders.values.push(o[a].name),this.getAggregatedHeaderData("PercentageOfParentRowTotal"===o[a].type?i:s,o[a].name,void 0,!1,"PercentageOfParentRowTotal"===o[a].type?"row":"column",o[a].type,this.selectedHeaders.selectedHeader,a);break;case"RunningTotals":this.selectedHeaders.values.push(o[a].name),this.getAggregatedHeaderData(this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)?s:i,o[a].name,void 0,!1,this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)?"column":"row",o[a].type,this.selectedHeaders.selectedHeader,a);break;case"PercentageOfParentTotal":{let l;this.selectedHeaders.values.push(o[a].name),o[a].baseField?l=o[a].baseField:this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)&&t.length>0?l=t[0].name:e.length>0&&(l=e[0].name);let r=!1;for(let t=e.length,s=0;s<t;s++)if(e[s].name===l){this.getAggregatedHeaderData(i,o[a].name,void 0,!1,"row",o[a].type,this.selectedHeaders.selectedHeader,a,s),r=!0;break}if(!r)for(let e=t.length,i=0;i<e;i++)if(t[i].name===l){this.getAggregatedHeaderData(s,o[a].name,void 0,!1,"column",o[a].type,this.selectedHeaders.selectedHeader,a,i);break}}}}getAggregatedHeaderData(e,t,i,s,o,l,r,n,h){for(let d of e)switch(l){case"DifferenceFrom":case"PercentageOfDifferenceFrom":-1!==d.valueSort.levelName.toString().split(this.valueSortSettings.headerDelimiter).indexOf(i)?(r.push(this.updateSelectedHeaders(i,d.level,o,s,t,l,d.valueSort.levelName,s?[d]:e,n+1)),d.members.length>0&&this.getAggregatedHeaderData(d.members,t,i,!0,o,l,r[r.length-1].childMembers,n)):d.members.length>0&&this.getAggregatedHeaderData(d.members,t,i,!1,o,l,r,n);break;case"RunningTotals":case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":"grand sum"===d.type?r.push(this.updateSelectedHeaders(void 0,d.level,o,!1,t,l,d.valueSort.levelName,e,n+1)):d.members.length>0&&(r.push(this.updateSelectedHeaders(void 0,d.level,o,!1,t,l,d.valueSort.levelName,d.members,n+1)),this.getAggregatedHeaderData(d.members,t,void 0,!1,o,l,r,n));break;case"PercentageOfParentTotal":if("grand sum"!==d.type)if(d.level===h)if(d.members.length>0){if(s){let e=r[r.length-1].aggregateHeaders;for(let t of d.members)e.push(t)}else{let e=(0,a.l7)([],d.members,null,!0);r.push(this.updateSelectedHeaders(void 0,d.level,o,!1,t,l,d.valueSort.levelName,e,n+1)),r[r.length-1].aggregateHeaders.push(d)}this.getAggregatedHeaderData(d.members,t,void 0,!0,o,l,r,n,h+1)}else s||r.push(this.updateSelectedHeaders(void 0,d.level,o,!1,t,l,d.valueSort.levelName,[d],n+1));else d.members.length>0&&this.getAggregatedHeaderData(d.members,t,void 0,!1,o,l,r,n,h)}}updateSelectedHeaders(e,t,i,s,o,l,a,r,n){return{name:e,level:t,axis:i,isChild:s,value:o,type:l,uniqueName:a,aggregateHeaders:r,childMembers:[],valueCount:n}}applyAdvancedAggregate(e,t,i){if(this.aggregatedValueMatrix=[],this.selectedHeaders.values.length>0){let s={},o=[],l=!1;for(let e=i.length,t=0;t<e;t++)if(void 0!==i[t]&&void 0!==i[t][0]){if(!l)for(let e=i[t].length,s=0;s<e;s++)"value"===i[t][s].axis&&-1!==this.selectedHeaders.values.indexOf(i[t][s].actualText)&&(o.push(s),l=!0);if(o.length>0&&"value"===i[t][o[0]].axis&&-1!==this.selectedHeaders.values.indexOf(i[t][o[0]].actualText))for(let e of o)s[t+","+e]=[t,e]}this.updateAggregates(e,t,i,this.selectedHeaders.selectedHeader,o,s);let a=Object.keys(s);for(let e of a)i[s[e][0]][s[e][1]].formattedText=this.selectedHeaders.selectedHeader.length>0?this.emptyCellTextContent:"#N/A",this.aggregatedValueMatrix[s[e][0]]||(this.aggregatedValueMatrix[s[e][0]]=[]),this.aggregatedValueMatrix[s[e][0]][s[e][1]]=0;this.updatePivotValues(!0)}}updateAggregates(e,t,i,s,o,l){for(let r of s){let s,n=r.aggregateHeaders,h=r.value,d=this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)?r.valueCount:0,c=r.type,p=r.uniqueName,u="row"===r.axis,g=[],m=[],b=[],f=[],y=[],v=[];if(-1!==["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal","RunningTotals"].indexOf(r.type))if(u){if("RunningTotals"!==r.type)for(let t=e.length,o=0;o<t;o++)if(void 0!==e[o]&&e[o].valueSort[p]){s=e[o],y=0===this.valueAxis||this.valueAxis&&i[o+d]&&i[o+d][0].actualText===h?i[o+d]:[];break}}else{for(let t=i.length,s=0;s<t&&void 0!==i[s]&&void 0===i[s][0];s++)b.push(i[s]);let e=b.length;for(;e--;)-1===this.selectedHeaders.values.indexOf(b[e][o[0]].actualText)&&(m=b[e],e=0);if("RunningTotals"!==r.type){for(let e=m.length,t=0;t<e;t++){let e=!1;if(void 0!==m[t]&&m[t].valueSort[p]){s=m[t];for(let s=i.length,o=0;o<s;o++){let s=i[o];void 0!==s&&void 0!==s[0]&&"value"===s[t].axis&&-1!==this.selectedHeaders.values.indexOf(s[t].actualText)&&(e=!0,v[o]=s[t],f.push(o))}if(e)break}}if(0===v.length&&0===f.length)for(let e=m.length,t=0;t<e;t++){let e=!1;if(void 0!==m[t]&&0===m[t].valueSort.levelName.indexOf(p)){s=m[t];for(let s=i.length,o=0;o<s;o++){let s=i[o];void 0!==s&&void 0!==s[0]&&"value"===s[t].axis&&-1!==this.selectedHeaders.values.indexOf(s[t].actualText)&&(e=!0,f.push(o))}if(e)break}}}}switch(r.type){case"DifferenceFrom":case"PercentageOfDifferenceFrom":{let a=r.isChild;if(u){if(a){let t=p.split(this.valueSortSettings.headerDelimiter);for(let a=e.length,r=0;r<a;r++)if(void 0!==e[r]&&-1!==e[r].valueSort.levelName.split(this.valueSortSettings.headerDelimiter).indexOf(t[t.length-1])&&e[r].level===s.level)for(let e of o){let t=i[r+d][e];"value"===t.axis&&t.actualText===h&&(g.push([r+d,e]),l[r+d+","+e]&&delete l[r+d+","+e])}}else for(let t of n)for(let a=e.length,r=0;r<a;r++)if(void 0!==e[r]&&e[r].valueSort[t.valueSort.levelName]&&e[r].level===s.level&&"grand sum"!==e[r].type)for(let e of o){let t=i[r+d][e];"value"===t.axis&&t.actualText===h&&(g.push([r+d,e]),l[r+d+","+e]&&delete l[r+d+","+e])}for(let e of g){let t=i[e[0]][e[1]],s=t.actualValue-y[e[1]].actualValue;s=isNaN(s)||0===t.value&&0===y[e[1]].value?0:s,this.aggregatedValueMatrix[e[0]]||(this.aggregatedValueMatrix[e[0]]=[]),"DifferenceFrom"===c?(this.aggregatedValueMatrix[e[0]][e[1]]=s,t.formattedText=0===s?this.emptyCellTextContent:this.getFormattedValue(s,h).formattedText):(s=0===y[e[1]].actualValue?0:s/y[e[1]].actualValue,this.aggregatedValueMatrix[e[0]][e[1]]=s,t.formattedText=t.showSubTotals?0!==s?this.globalize.formatNumber(s,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,t.actualText)}):this.emptyCellTextContent:t.formattedText)}}else{if(a){let e=p.split(this.valueSortSettings.headerDelimiter);for(let t=m.length,o=0;o<t;o++){let t=!1;if(void 0!==m[o]&&-1!==m[o].valueSort.levelName.split(this.valueSortSettings.headerDelimiter).indexOf(e[e.length-1])&&m[o].level===s.level){for(let e of f){let s=i[e][o];"value"===s.axis&&s.actualText===h&&(t=!0,g.push([e,o]),l[e+","+o]&&delete l[e+","+o])}if(t)break}}}else for(let e of n)for(let t=m.length,o=0;o<t;o++){let t=!1;if(void 0!==m[o]&&m[o].valueSort[e.valueSort.levelName]&&m[o].level===s.level&&"grand sum"!==m[o].type){for(let e of f){let s=i[e][o];"value"===s.axis&&s.actualText===h&&(t=!0,g.push([e,o]),l[e+","+o]&&delete l[e+","+o])}if(t)break}}let o;0===v.length&&(o=this.getSelectedColumn(r.uniqueName,t));for(let t of g){let s=i[t[0]][t[1]],l=0;if(0===v.length){let t=this.getSelectedRow(s.rowHeaders,e);l=this.getAggregateValue(t.index,o.indexObject,this.fieldList[h].index,r.type)}else l=v[t[0]].value;let a=s.value-l;a=isNaN(a)?0:a,this.aggregatedValueMatrix[t[0]]||(this.aggregatedValueMatrix[t[0]]=[]),"DifferenceFrom"===c?(s.formattedText=0===a?this.emptyCellTextContent:this.getFormattedValue(a,h).formattedText,this.aggregatedValueMatrix[t[0]][t[1]]=a):(a=0===v[t[0]].value?0:a/v[t[0]].value,s.formattedText=0!==a?this.globalize.formatNumber(a,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,s.actualText)}):this.emptyCellTextContent,this.aggregatedValueMatrix[t[0]][t[1]]=a)}}r.childMembers.length>0&&this.updateAggregates(e,t,i,r.childMembers,o,l)}break;case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":case"PercentageOfParentTotal":if(u){for(let t of n)for(let s=e.length,a=0;a<s;a++)if(void 0!==e[a]&&e[a].valueSort[t.valueSort.levelName]&&e[a].level===t.level)for(let e of o){let t=i[a+d][e];"value"===t.axis&&t.actualText===h&&(g.push([a+d,e]),l[a+d+","+e]&&delete l[a+d+","+e])}for(let e of g){let o=i[e[0]][e[1]],l=0;l=0===y.length&&s?this.getAggregateValue(s.index,t[e[1]-1].indexObject,this.fieldList[h].index,r.type):y[e[1]].actualValue;let a=o.value/l;a=isNaN(a)?0:a,o.formattedText=o.showSubTotals?0!==a?this.globalize.formatNumber(a,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,o.actualText)}):this.emptyCellTextContent:o.formattedText,this.aggregatedValueMatrix[e[0]]||(this.aggregatedValueMatrix[e[0]]=[]),this.aggregatedValueMatrix[e[0]][e[1]]=a}}else{for(let e of n)for(let t=m.length,s=0;s<t;s++){let t=!1;if(void 0!==m[s]&&m[s].valueSort[e.valueSort.levelName]){for(let e of f){let o=i[e][s];"value"===o.axis&&o.actualText===h&&(t=!0,g.push([e,s]),l[e+","+s]&&delete l[e+","+s])}if(t)break}}let s;0===v.length&&(s=this.getSelectedColumn(r.uniqueName,t));for(let t of g){let o=i[t[0]][t[1]],l=0;if(0===v.length){let t=this.getSelectedRow(o.rowHeaders,e);l=this.getAggregateValue(t.index,s.indexObject,this.fieldList[h].index,r.type)}else l=v[t[0]].value;let a=o.value/l;a=isNaN(a)?0:a,o.formattedText=0!==a?this.globalize.formatNumber(a,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,o.actualText)}):this.emptyCellTextContent,this.aggregatedValueMatrix[t[0]]||(this.aggregatedValueMatrix[t[0]]=[]),this.aggregatedValueMatrix[t[0]][t[1]]=a}}break;case"RunningTotals":if(u)for(let t of o){let s=0;for(let o of n)for(let r=e.length,n=0;n<r;n++)if(void 0!==e[n]){let r=i[n+d][t];if(void 0!==e[n]&&e[n].valueSort[o.valueSort.levelName]&&e[n].level===o.level&&"value"===r.axis&&r.actualText===h){"grand sum"!==e[n].type&&(s+=r.showSubTotals||!(0,a.le)(r.actualValue)&&isNaN(r.actualValue)?r.value:r.actualValue,r.formattedText=r.showSubTotals?0===s&&r.actualValue&&0!==r.actualValue?"":this.getFormattedValue(s,h).formattedText:r.formattedText,this.aggregatedValueMatrix[n+d]||(this.aggregatedValueMatrix[n+d]=[]),this.aggregatedValueMatrix[n+d][t]=s),l[n+d+","+t]&&delete l[n+d+","+t];break}}}else for(let t=e.length,s=0;s<t;s++)if(void 0!==e[s]){let e=0;for(let t of n)for(let o=m.length,a=0;a<o;a++){let o=i[s+d][a];if(void 0!==m[a]&&m[a].valueSort[t.valueSort.levelName]&&"value"===o.axis&&o.actualText===h){"grand sum"!==m[a].type&&(e+=o.value,o.formattedText=this.getFormattedValue(e,h).formattedText,this.aggregatedValueMatrix[s+d]||(this.aggregatedValueMatrix[s+d]=[]),this.aggregatedValueMatrix[s+d][a]=e),l[s+d+","+a]&&delete l[s+d+","+a];break}}}}}}getSelectedColumn(e,t){let i={axis:"column",index:[],indexObject:{}};for(let s of t)s&&s.valueSort&&0===s.valueSort.levelName.indexOf(e)&&(i.index=[...i.index,...s.index].sort(function(e,t){return e-t}),i.indexObject=Object.assign({},i.indexObject,s.indexObject));return i}getSelectedRow(e,t){for(let i of t)if(i){if(i.valueSort&&i.valueSort.levelName===e)return i;if(""===e&&"grand sum"===i.type)return i}return null}recursiveRowData(e,t,i,s,o,l,a,r,n,h,d){a||this.getTableData(t[s-n].members,t,i,s,o,l,h,d),this.pageSettings||(t[s-n].members=[])}updateRowData(e,t,i,s,o,l,r,n,h,d,c){let p=this.fieldList[this.values[o].name].index,u=this.fieldList[this.values[o].name].aggregateType,g=this.values[o].name,m=[],b={},f=0,y=0;switch(u){case"Index":{m=[[e[l],t[r]],[e[l],c],[d,t[r]],[d,c]];let i=["cVal","rTotalVal","cTotalVal","gTotalVal"],s=0;for(let e of m)b[i[s]]=this.getAggregateValue(e[0].index,e[1].indexObject,p,u),s++;let o=b.cVal*b.gTotalVal/(b.rTotalVal*b.cTotalVal);f=!(e[l].members.length>0)||((0,a.le)(e[l].showSubTotals)||e[l].showSubTotals)&&this.showRowSubTotals&&this.showSubTotals?(0,a.le)(b.cVal)?b.cVal:isNaN(o)?0:o:void 0,y=(0,a.le)(b.cVal)?b.cVal:isNaN(o)?0:o}break;case"PercentageOfGrandTotal":case"PercentageOfColumnTotal":case"PercentageOfRowTotal":{m=[[e[l],t[r]]],m.push("PercentageOfGrandTotal"===u?[d,c]:"PercentageOfColumnTotal"===u?[d,t[r]]:[e[l],c]);let i=["cVal","gTotalVal"],s=0;for(let e of m)b[i[s]]=this.getAggregateValue(e[0].index,e[1].indexObject,p,u),s++;let o=b.cVal/b.gTotalVal;f=!(e[l].members.length>0)||((0,a.le)(e[l].showSubTotals)||e[l].showSubTotals)&&this.showSubTotals&&this.showRowSubTotals?(0,a.le)(b.cVal)?b.cVal:isNaN(o)?0:o:void 0,y=(0,a.le)(b.cVal)?b.cVal:isNaN(o)?0:o}break;default:let i=this.getAggregateValue(e[l].index,t[r].indexObject,p,u);f=!(e[l].members.length>0)||((0,a.le)(e[l].showSubTotals)||e[l].showSubTotals)&&this.showSubTotals&&this.showRowSubTotals?i:void 0,y=i}let v={fieldName:this.values[o].name,row:e[l],column:t[r],value:f,cellSets:this.getCellSet(this.rawIndexObject),rowCellType:e[l].hasChild&&e[l].isDrilled?"subTotal":"grand sum"===e[l].type?"grandTotal":"value",columnCellType:t[r].hasChild&&t[r].isDrilled?"subTotal":"grand sum"===t[r].type?"grandTotal":"value",aggregateType:u,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(v),f=v.value;let S=e[l].hasChild||t[r].hasChild||"grand sum"===e[l].type||"grand sum"===t[r].type,x="grand sum"===e[l].type||"grand sum"===t[r].type,w=e[l].members.length>0&&(!(0,a.le)(e[l].showSubTotals)&&!e[l].showSubTotals||!this.showSubTotals||!this.showRowSubTotals),C=w?"":void 0===f?this.emptyCellTextContent:"Count"===u||"DistinctCount"===u?f.toLocaleString():this.getFormattedValue(f,g).formattedText;!isNaN(f)&&!(0,a.le)(f)&&["PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal"].indexOf(u)>=0?C=this.globalize.formatNumber(f,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,v.fieldName)}):w||!isNaN(f)||(0,a.le)(f)||-1===["PopulationStDev","SampleStDev","PopulationVar","SampleVar"].indexOf(u)||(C="#DIV/0!"),C=v.skipFormatting?(0,a.le)(f)?this.emptyCellTextContent:f.toString():C,s[i][n]=this.valueContent[h][n]={axis:"value",actualText:g,indexObject:this.isDrillThrough?this.rawIndexObject:{},rowHeaders:"grand sum"===e[l].type?"":e[l].valueSort.levelName,columnHeaders:"grand sum"===t[r].type?"":t[r].valueSort.levelName,formattedText:C,value:(0,a.le)(f)?0:f,actualValue:(0,a.le)(y)?0:y,rowIndex:i,colIndex:n,isSum:S,isGrandSum:x,showSubTotals:!w},this.rawIndexObject={}}getCellSet(e){let t=[],i=Object.keys(e);for(let s of i)this.data[parseInt(s,10)]&&t.push(this.data[parseInt(s,10)]);return t}getHeaderData(e,t,i,s,o){let l=e.length,r=this.columns.length,n=this.valueSortSettings.headerText;for(let h=0;h<l;h++){e[h].members.length&&this.getHeaderData(e[h].members,t,i,s,o);let l=!0;((0,a.le)(e[h].showSubTotals)||e[h].showSubTotals)&&this.showSubTotals&&this.showColumnSubTotals?t[s=t.length]=this.frameHeaderWithKeys(e[h]):(e[h].members.length>0?(this.removeCount++,l=!1):t[t.length]=this.frameHeaderWithKeys(e[h]),s=t.length-1);let d=e[h].level;e[h].rowIndex=d,e[h].colIndex=s*o+o,i[d]||(i[d]=[],this.headerContent[d]={}),i[d][s*o+o]=this.headerContent[d][s*o+o]=this.frameHeaderWithKeys(e[h]);let c=0===this.columns.length&&1===this.values.length;if((this.isMutiMeasures||this.alwaysShowValueHeader||c)&&!this.valueAxis&&l)for(let t=0;t<o;t++){let l=this.values[t].caption?this.values[t].caption:this.values[t].name,a={axis:"column",actualText:this.values[t].name,formattedText:l,level:0,valueSort:{},colIndex:s*o+1+t,rowIndex:r};i[r]||(i[r]=[],this.headerContent[r]={}),i[r][s*o+1+t]=this.headerContent[r][s*o+1+t]=a;let d=i[r][s*o+1+t].valueSort;d[e[h].valueSort.levelName+this.valueSortSettings.headerDelimiter+l]=1,d.levelName=e[h].valueSort.levelName+this.valueSortSettings.headerDelimiter+l,d&&d[n]&&(this.valueSortSettings.columnIndex=s*o+1+t)}else e[h].valueSort&&e[h].valueSort[n]&&(this.valueSortSettings.columnIndex=s*o+1);this.pageSettings||(t[s].members=[])}}getAggregateValue(e,t,i,s){let o=0,l=0,r=0,n=!0,h=!1;switch(s.toLowerCase()){case"median":let d=[],c=0;for(;void 0!==e[o];)void 0!==t[e[o]]&&(h=!0,this.rawIndexObject[e[o]]=e[o],(0,a.le)(this.valueMatrix[e[o]][i])||d.push(this.valueMatrix[e[o]][i])),o++;let p=d.length;p>0&&(d.sort((e,t)=>e-t),p%2==0?(c=p/2<=1?0:p/2-1,l=(d[c]+d[c+1])/2):(c=(p+1)/2<=1?0:(p+1)/2-1,l=d[c]));break;case"count":for(;void 0!==e[o];)void 0!==t[e[o]]&&(h=!0,this.rawIndexObject[e[o]]=e[o],l+=(0,a.le)(this.valueMatrix[e[o]][i])?0:this.allowDataCompression?this.valueMatrix[e[o]][i]:1),o++;break;case"distinctcount":let u=[];for(;void 0!==e[o];){if(void 0!==t[e[o]]){this.rawIndexObject[e[o]]=e[o],h=!0;let t,s=this.data[e[o]][this.fieldKeys[this.fields[i]]];(0,a.le)(s)||(t=s.toString(),(0===u.length||u.length>0&&-1===u.indexOf(t))&&(l+=this.allowDataCompression&&"number"==typeof s?s:1,u.push(t)))}o++}break;case"product":for(;void 0!==e[o];){if(void 0!==t[e[o]]){this.rawIndexObject[e[o]]=e[o],h=!0;let t=this.valueMatrix[e[o]][i];(0,a.le)(t)?n&&(l=t):(l=n||(0,a.le)(l)?1:l,l*=t),n=!1}o++}break;case"populationstdev":case"samplestdev":case"populationvar":case"samplevar":let g=0,m=0,b=[],f=0,y=0,v=0;for(;void 0!==e[o];){if(void 0!==t[e[o]]){h=!0,this.rawIndexObject[e[o]]=e[o];let t=this.valueMatrix[e[o]][i];(0,a.le)(t)||(m+=t,b.push(t),g++)}o++}if(g>0){f=m/g;for(let e of b)v+=Math.pow(e-f,2);y=-1!==["populationstdev","samplestdev"].indexOf(s.toLowerCase())?Math.sqrt(v/("populationstdev"===s.toLowerCase()?g:g-1)):v/("populationvar"===s.toLowerCase()?g:g-1),l=0===y?NaN:y}else l=m;break;case"min":let S=!0;for(l=void 0;void 0!==e[o];)void 0!==t[e[o]]&&void 0!==this.valueMatrix[e[o]][i]&&(h=!0,this.rawIndexObject[e[o]]=e[o],(0,a.le)(l)&&(0,a.le)(this.valueMatrix[e[o]][i])?l=this.valueMatrix[e[o]][i]:S?(l=this.valueMatrix[e[o]][i],S=!1):l=this.valueMatrix[e[o]][i]<l?this.valueMatrix[e[o]][i]:l),o++;break;case"max":let x=!0;for(;void 0!==e[o];)void 0!==t[e[o]]&&void 0!==this.valueMatrix[e[o]][i]&&(h=!0,this.rawIndexObject[e[o]]=e[o],x?(l=this.valueMatrix[e[o]][i],x=!1):l=this.valueMatrix[e[o]][i]>l?this.valueMatrix[e[o]][i]:l),o++;break;case"calculatedfield":h=!0;let w=this.calculatedFields[this.fields[i]],C=w.formula,M={};if(this.calculatedFormulas[w.name]){let i=this.calculatedFormulas[w.name];for(let s=0,o=i.length;s<o;s++){let o=i[s],l=M[o.formula];void 0===l&&(l=this.getAggregateValue(e,t,o.index,o.type),M[o.formula]=l),C=C.replace(o.formula,String(l))}}l=this.evaluate(C),l=l===1/0||l===-1/0?1/0:void 0===l||isNaN(l)?void 0:JSON.parse(String(l));break;default:for(l=void 0;void 0!==e[o];){if(void 0!==t[e[o]]){h=!0,this.rawIndexObject[e[o]]=e[o];let t=this.valueMatrix[e[o]][i];(0,a.le)(l)&&(0,a.le)(t)?l=t:((0,a.le)(l)&&(l=0),l+=(0,a.le)(t)?0:t),(0,a.le)(t)||r++}o++}}return s&&"avg"===s.toLowerCase()&&0!==l&&!(0,a.le)(l)?l/r:h?l:void 0}evaluate(e){return Function('"use strict";return ('+e+")")()}getFormattedValue(e,t){let i=null===e?this.localeObj?this.localeObj.getConstant("null"):String(e):void 0===e?this.localeObj?this.localeObj.getConstant(t in this.groupingFields?"groupOutOfRange":"undefined"):String(e):e,s={formattedText:i.toString(),actualText:i,dateText:i};if(this.formatFields[t]&&!(0,a.le)(e))try{let o=(0,a.l7)({},this.formatFields[t].properties?this.formatFields[t].properties:this.formatFields[t],null,!0);if(delete o.name,!o.minimumSignificantDigits&&o.minimumSignificantDigits<1&&delete o.minimumSignificantDigits,!o.maximumSignificantDigits&&o.maximumSignificantDigits<1&&delete o.maximumSignificantDigits,o.type)s.formattedText=this.dateFormatFunction[t].exactFormat(new Date(e)),s.actualText=e;else{if(delete o.type,o.format&&!this.formatRegex.test(o.format)){let e=o.format.match(this.customRegex),t=!0;(0,a.le)(o.minimumFractionDigits)&&delete o.minimumFractionDigits,(0,a.le)(o.maximumFractionDigits)&&delete o.maximumFractionDigits,(0,a.le)(o.minimumIntegerDigits)&&delete o.minimumIntegerDigits,(0,a.le)(e)&&(e=o.format.match(/^(('[^']+'|''|[^*@0])*)(\*.)?((([0#,]*[0,]*[0#]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@,.E])*)$/),delete o.useGrouping,t=!1);let i=e[6];t&&(o.useGrouping=-1!==i.indexOf(","));let s=e[5];(0,a.xr)()&&s&&-1!==s.indexOf(".")&&o.maximumFractionDigits&&delete o.maximumFractionDigits}s.formattedText=this.globalize.formatNumber(isNaN(Number(e))?e:Number(e),o),s.actualText=isNaN(Number(e))?e:Number(e),s.dateText=isNaN(Number(e))?e:Number(e)}"None"!==this.fieldList[t].sort&&o.type&&["date","dateTime","time"].indexOf(this.formatFields[t].type)>-1&&(s.dateText=this.dateFormatFunction[t].fullFormat(new Date(e))),this.fieldList[t].isCustomField&&(s.formattedText="NaN"===s.formattedText?i.toString():s.formattedText,s.dateText="NaN"===s.dateText?i.toString():s.dateText)}catch(o){if(!this.fieldList[t].isCustomField)throw o}finally{this.fieldList[t].isCustomField&&(s.formattedText=(0,a.le)(s.formattedText)||"NaN"===s.formattedText?i.toString():s.formattedText,s.dateText=(0,a.le)(s.dateText)||"NaN"===s.dateText?i.toString():s.dateText)}return s}powerFunction(e){if(e.indexOf("^")>-1){let t=[];for(;e.indexOf("(")>-1;)e=e.replace(/(\([^\(\)]*\))/g,(e,i)=>(t.push(i),"~"+(t.length-1)));for(t.push(e),e="~"+(t.length-1);e.indexOf("~")>-1;)e=e.replace(new RegExp("~(\\d+)","g"),(e,i)=>t[i].replace(/(\w*)\^(\w*)/g,"Math.pow($1,$2)"))}return e}}const yr="load",vr="enginePopulating",Sr="enginePopulated",xr="fieldDrop",wr="beforeExport",Cr="onPdfCellRender",Mr="dataBound",Tr="cellSelecting",Lr="drill",Ar="editCompleted",Dr="aggregateCellInfo",Rr="memberFiltering",Ir="fieldRemove",Pr="aggregateMenuOpen",kr="fieldDragStart",Er="beforeServiceInvoke",Fr="initial-load",Or="ui-update",Nr="content-ready",zr="data-ready",_r="init-groupingbar",Br="tree-view-update",Zr="pivot-button-update",Vr="init-calculatedfield",jr="e-pivotfieldlist",Hr="e-rtl",qr="e-device",Gr="e-icons",Yr="e-disable",Wr="e-hide",Ur="e-pivotfieldlist-wrapper",Xr="e-static",Qr="e-field-list-footer",Jr="e-draggable-prompt",Kr="e-member-sort",$r="e-descend",en="e-btn-filter",tn="e-pv-filter",sn="e-pv-filtered",on="e-remove",ln="e-drag",an="e-disable-drag",rn="e-drop-hover",nn="e-member-editor-wrapper",hn="e-check",dn="e-stop",cn="e-ok-btn",pn="e-cancel-btn",un="e-pivot-error-dialog",gn="e-rows",mn="e-columns",bn="e-filters",fn="e-drag-restrict",yn="e-list-selected",vn="e-flat",Sn="e-selected-node",xn="e-selected-option-icon",wn="e-value-options",Cn="e-filter-operator",Mn="e-active",Tn="e-collapse",Ln="e-expand",An="e-table",Dn="e-columnsheader",Rn="e-rowsheader",In="e-cellvalue",Pn="e-nextspan",kn="e-lastspan",En="e-editor-search-wrapper",Fn="e-editor-search",On="e-pivot-calc-check",Nn="e-pivot-calc-input",zn="e-custom-format-input",_n="e-olap-calc-hierarchy-list-div",Bn="e-olap-calc-format-type-div",Zn="e-olap-calc-member-type-div",Vn="e-member-options",jn="e-flat",Hn="e-format",qn="e-pivot-formula",Gn="e-pivot-treeview",Yn="e-pivot-treeview-outer",Wn="e-pivot-ok-button",Un="e-pivot-button-div",Xn="e-olap-format-title",Qn="e-disabled",Jn="e-menu-hide",Kn="e-edit",$n="e-edited",eh="e-empty-field",th="e-virtualtrack",ih="e-cellselectionbackground",sh="e-selectionbackground",oh="e-field-list-back-icon",lh="e-rowcell",ah="e-active",rh="e-spanclicked",nh="e-remove-report",hh="e-pivot-toolbar",dh="e-pivotchart",ch="e-group-chart-columns",ph="e-group-chart-values",uh="e-group-chart-values-drodown-div",gh="e-group-chart-columns-dropdown-div",mh="e-pivotchart-inner",bh="e-group-pivot-rows";class fh{constructor(e){this.menuInfo=[],this.parent=e}render(e,t){this.parentElement=t,this.openContextMenu(e)}openContextMenu(e){let t=e.target.parentElement.id;this.buttonElement=e.target.parentElement;let i="number"!==this.parent.engineModule.fieldList[t].type?1:0;this.summaryTypes=[...this.getMenuItem(i)];let s={cancel:!1,fieldName:t,aggregateTypes:this.summaryTypes,displayMenuCount:7};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(Pr,s,t=>{if(!t.cancel){this.summaryTypes=t.aggregateTypes,this.createContextMenu(i,t.displayMenuCount),this.currentMenu=e.target;let s=this.currentMenu.getBoundingClientRect();this.menuInfo[i].open(s.top+(window.scrollY||document.documentElement.scrollTop),this.parent.enableRtl?s.left-105:s.left)}})}createContextMenu(e,t){let i=[];i[e]=[],this.menuInfo[e]&&!this.menuInfo[e].isDestroyed&&this.menuInfo[e].destroy();let s,o=[];for(let a=0;a<this.summaryTypes.length;a++){let t=this.summaryTypes[a];e?["Count","DistinctCount"].indexOf(t)>-1&&o.indexOf(t)<0&&(i[e].push({text:this.parent.localeObj.getConstant(t),id:this.parent.element.id+"StringMenu_"+t}),o.push(t)):this.parent.getAllSummaryType().indexOf(t)>-1&&o.indexOf(t)<0&&(i[e].push({text:this.parent.localeObj.getConstant(t),id:this.parent.element.id+"_"+t}),o.push(t))}i[e].length>t&&(i[e].splice(t),i[e].push({text:this.parent.localeObj.getConstant("MoreOption"),id:this.parent.element.id+"_MoreOption"})),s={items:i[e],enableRtl:this.parent.enableRtl,locale:this.parent.locale,beforeOpen:this.beforeMenuOpen.bind(this,e),onClose:e=>{(0,a.Ys)("#"+this.buttonElement.id,this.parentElement).focus()},select:this.selectOptionInContextMenu.bind(this)};let l=document.getElementById(this.parent.element.id+(e?"valueFieldStringContextMenu":"valueFieldContextMenu"));null!==l?l.innerHTML="":l=(0,a.az)("ul",{id:this.parent.element.id+(e?"valueFieldStringContextMenu":"valueFieldContextMenu")}),this.parent.element.appendChild(l),this.menuInfo[e]=new d.xV(s),this.menuInfo[e].isStringTemplate=!0,this.menuInfo[e].appendTo(l)}getMenuItem(e){let t=[];for(let i=0;i<this.parent.aggregateTypes.length;i++){let s=this.parent.aggregateTypes[i];e?["Count","DistinctCount"].indexOf(s)>-1&&-1===t.indexOf(s)&&t.push(s):this.parent.getAllSummaryType().indexOf(s)>-1&&-1===t.indexOf(s)&&t.push(s)}return t}beforeMenuOpen(e,t){t.element.style.zIndex=(this.menuInfo[e].element.style.zIndex+3).toString(),t.element.style.display="inline"}createValueSettingsDialog(e,t,i){this.parentElement=t;let s=(0,a.az)("div",{id:this.parentElement.id+"_ValueDialog",className:"e-value-field-settings",attrs:{"data-field":e.id}});this.parentElement.appendChild(s),this.valueDialog=new n.Vq({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("valueFieldSettings"),content:this.createFieldOptions(e,i),isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.updateValueSettings.bind(this),buttonModel:{cssClass:cn,content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:()=>{this.valueDialog.hide()},buttonModel:{cssClass:pn,content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:"pivotfieldlist"!==this.parent.getModuleName()||"Popup"!==this.parent.renderMode,target:this.parentElement,overlayClick:()=>{this.removeDialog()},close:this.removeDialog.bind(this)}),this.valueDialog.isStringTemplate=!0,this.valueDialog.appendTo(s)}createFieldOptions(e,t){let i=e.getAttribute("data-caption"),s=t&&"MoreOption"!==t?t:e.getAttribute("data-type"),o=e.getAttribute("data-basefield"),l=e.getAttribute("data-baseitem");s="undefined"!==s.toString()?s:"Sum";let r=[],n=this.summaryTypes,h=[];for(let a=0;a<n.length;a++)this.parent.getAllSummaryType().indexOf(n[a])>-1&&h.indexOf(n[a])<0&&(r.push({value:n[a],text:this.parent.localeObj.getConstant(n[a])}),h.push(n[a]));let d=["DifferenceFrom","PercentageOfDifferenceFrom"],u=["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"],g=(0,a.l7)([],this.parent.dataSourceSettings.rows,null,!0);g=g.concat(this.parent.dataSourceSettings.columns);let m=[],b=[];for(let a of g)m.push({value:a.name,text:a.caption?a.caption:a.name});0===Object.keys(m).length?(m.push({value:"",text:""}),o="",b=[]):(o=o&&"undefined"!==o.toString()&&"null"!==o.toString()?o:m[0].value,b=Object.keys(this.parent.engineModule.fieldList["undefined"!==o.toString()?o:m[0].value].formattedMembers)),l="undefined"!==l.toString()?l:b[0];let f=(0,a.az)("div",{className:"e-value-field-div-content",id:this.parentElement.id+"_field_div_content",attrs:{"data-type":s,"data-caption":i,"data-basefield":o,"data-baseitem":l}}),y=(0,a.az)("div",{className:"e-field-name-text-wrapper"}),v=(0,a.az)("div",{className:"e-field-option-wrapper"}),S=(0,a.az)("div",{className:"e-type-option-wrapper"}),x=(0,a.az)("div",{className:"e-base-field-option-wrapper"}),w=(0,a.az)("div",{className:"e-base-item-option-wrapper"}),C=(0,a.az)("div",{className:"e-field-name-title",innerHTML:this.parent.localeObj.getConstant("sourceName")+"&nbsp;"}),M=(0,a.az)("div",{className:"e-field-name-content",innerHTML:e.id.toString()}),T=(0,a.az)("div",{className:"e-type-option-text",innerHTML:this.parent.localeObj.getConstant("sourceCaption")}),L=(0,a.az)("div",{className:"e-base-field-option-text",innerHTML:this.parent.localeObj.getConstant("summarizeValuesBy")}),A=(0,a.az)("div",{className:"e-base-item-option-text",innerHTML:this.parent.localeObj.getConstant("baseField")}),D=(0,a.az)("div",{className:"e-type-option-text",innerHTML:this.parent.localeObj.getConstant("baseItem")}),R=(0,a.az)("div",{className:"e-caption-input-wrapper"}),I=(0,a.az)("div",{id:this.parentElement.id+"_type_option"}),P=(0,a.az)("div",{id:this.parentElement.id+"_base_field_option"}),k=(0,a.az)("div",{id:this.parentElement.id+"_base_item_option"}),E=(0,a.az)("input",{id:this.parentElement.id+"type_input_option",className:"e-caption-input-text",attrs:{type:"text"}});y.appendChild(C),y.appendChild(M),R.appendChild(T),R.appendChild(E),S.appendChild(L),x.appendChild(A),w.appendChild(D),S.appendChild(I),x.appendChild(P),w.appendChild(k),v.appendChild(y),v.appendChild(R),v.appendChild(S),v.appendChild(x),v.appendChild(w),f.appendChild(v);let F=this,O=new p.NB({dataSource:r,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:s,cssClass:wn,width:"100%",change:e=>{N.enabled=-1!==u.indexOf(e.value),z.enabled=-1!==d.indexOf(e.value),z.enabled&&1===z.dataSource.length&&(z.dataSource=b,z.dataBind())}});O.isStringTemplate=!0,O.appendTo(I);let N=new p.NB({dataSource:m,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:o,enabled:-1!==u.indexOf(s),cssClass:wn,width:"100%",change:e=>{b=Object.keys(F.parent.engineModule.fieldList[e.value].formattedMembers),z.dataSource=b,z.value=b[0],z.filterBarPlaceholder=F.parent.localeObj.getConstant("example")+" "+b[0],z.dataBind()}});N.isStringTemplate=!0,N.appendTo(P);let z=new p.NB({dataSource:[b[0]],enableRtl:this.parent.enableRtl,locale:this.parent.locale,value:l,allowFiltering:!0,filterBarPlaceholder:this.parent.localeObj.getConstant("example")+" "+b[0],enabled:-1!==d.indexOf(s),cssClass:Cn,width:"100%"});z.isStringTemplate=!0,z.appendTo(k);let _=new c.g3({placeholder:"Enter field caption",enableRtl:this.parent.enableRtl,locale:this.parent.locale,value:i,width:"100%"});return _.isStringTemplate=!0,_.appendTo(E),f}selectOptionInContextMenu(e){if(null!==e.item.text){let t=this.currentMenu.parentElement,i=e.item.id.split("_").pop();if("MoreOption"===i||"PercentageOfDifferenceFrom"===i||"PercentageOfParentTotal"===i||"DifferenceFrom"===i)this.createValueSettingsDialog(t,this.parentElement,i);else{let s=t.getAttribute("data-uid"),o=this.parent.dataSourceSettings.values,l=t.querySelector(".e-content"),r=e.item.text+" "+this.parent.localeObj.getConstant("of")+" "+this.parent.engineModule.fieldList[s].caption;l.innerHTML=r,l.setAttribute("title",r),t.setAttribute("data-type",i);for(let e=0;e<this.parent.dataSourceSettings.values.length;e++)if(this.parent.dataSourceSettings.values[e].name===s){let t=(0,a.l7)({},o[e].properties?o[e].properties:o[e],null,!0);t.type=i,this.parent.engineModule.fieldList[s].aggregateType=i,o.splice(e,1,t),this.parent.lastAggregationInfo=t}this.updateDataSource()}}}updateDataSource(e){this.parent.allowDeferLayoutUpdate&&"pivotview"!==this.parent.getModuleName()?"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?(this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0),this.parent.pivotGridModule.notify(Or,this),this.parent.pivotGridModule.engineModule=this.parent.engineModule):this.parent.triggerPopulateEvent():this.parent.updateDataSource(e)}updateValueSettings(){let e,t=this.valueDialog.element,i=(0,a.s8)("#"+this.parentElement.id+"type_input_option",c.g3),s=(0,a.s8)("#"+this.parentElement.id+"_type_option",p.NB),o=(0,a.s8)("#"+this.parentElement.id+"_base_field_option",p.NB),l=(0,a.s8)("#"+this.parentElement.id+"_base_item_option",p.NB),r=t.getAttribute("data-field");if(this.parentElement.querySelector(".e-pivot-button")&&(e=this.parentElement.querySelector(".e-pivot-button."+r.replace(/[^A-Z0-9]/gi,""))),e){let t=e.querySelector(".e-content"),a=this.parent.localeObj.getConstant(s.value)+" "+this.parent.localeObj.getConstant("of")+" "+i.value;t.innerHTML=a,t.setAttribute("title",a),e.setAttribute("data-type",s.value),e.setAttribute("data-caption",i.value),e.setAttribute("data-basefield",o.value),e.setAttribute("data-baseitem",l.value)}let n=br.getFieldByName(r,this.parent.dataSourceSettings.values);n=n.properties?n.properties:n,n.caption=i.value,n.type=s.value,n.baseField=o.value,n.baseItem=l.value,this.valueDialog.close(),this.parent.lastAggregationInfo=n,this.updateDataSource(!0)}removeDialog(){(0,a.Ys)("#"+this.buttonElement.id,this.parentElement)&&(0,a.Ys)("#"+this.buttonElement.id,this.parentElement).focus(),this.valueDialog&&!this.valueDialog.isDestroyed&&this.valueDialog.destroy(),document.getElementById(this.parentElement.id+"_ValueDialog")&&(0,a.Od)(document.getElementById(this.parentElement.id+"_ValueDialog"))}destroy(){this.parent.isDestroyed||this.menuInfo&&(void 0===this.menuInfo[1]||this.menuInfo[1].isDestroyed||this.menuInfo[1].destroy(),void 0===this.menuInfo[0]||this.menuInfo[0].isDestroyed||this.menuInfo[0].destroy())}}class yh{constructor(e){this.indentCollection={},this.colPos=0,this.lastSpan=0,this.lvlCollection={},this.hierarchyCollection={},this.lvlPosCollection={},this.hierarchyPosCollection={},this.position=0,this.measurePos=0,this.maxMeasurePos=0,this.hierarchyCount=0,this.actualText="",this.parent=e,this.resColWidth=this.parent.showGroupingBar&&this.parent.groupingBarModule?this.parent.isAdaptive?180:250:this.parent.isAdaptive?140:200,this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.gridSettings=e.gridSettings,this.formatList=this.getFormatList(),this.aggMenu=new fh(this.parent)}render(){let e=this.parent,t="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;if(this.parent.gridHeaderCellInfo=[],this.parent.gridCellCollection={},this.injectGridModules(e),this.rowStartPos=this.getRowStartPos(),this.parent.grid&&this.parent.grid.element&&this.parent.element.querySelector(".e-grid")){if(this.parent.notEmpty=!0,t.isEngineUpdated?(this.parent.enableValueSorting&&(t.valueContent=this.frameDataSource("value")),t.isEngineUpdated=!1):(t.headerContent=this.frameDataSource("header"),t.valueContent=this.frameDataSource("value")),this.parent.grid.setProperties({columns:this.frameStackedHeaders(),dataSource:("olap"===this.parent.dataType||e.dataSourceSettings.values.length>0)&&!this.engine.isEmptyData?t.valueContent:this.frameDataSource("value")},!0),"auto"===this.parent.grid.height){let e=this.parent.element.querySelector(".e-movablecontent").offsetHeight,t=this.parent.grid.dataSource.length*this.parent.gridSettings.rowHeight;e>50&&e<t&&this.parent.grid.contentModule.setHeightToContent(t)}this.parent.grid.notify("datasource-modified",{}),this.parent.isScrolling&&(this.parent.resizeInfo={}),this.parent.grid.refreshColumns(),this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-grouping-bar")&&this.parent.groupingBarModule.setGridRowWidth(),this.parent.element.querySelector(".e-movablecontent").querySelector("colGroup").innerHTML=this.parent.grid.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").innerHTML,this.parent.grid.width=this.calculateGridWidth(),!this.gridSettings.allowAutoResizing&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-grouping-bar")&&this.parent.groupingBarModule.refreshUI(),this.parent.isScrolling||this.calculateGridHeight(!0)}else this.parent.element.innerHTML="",this.bindGrid(this.parent,!!this.engine.isEmptyData),this.parent.element.appendChild((0,a.az)("div",{id:this.parent.element.id+"_grid"})),this.parent.grid.isStringTemplate=!0,this.parent.grid.appendTo("#"+this.parent.element.id+"_grid");this.parent.grid.on(h.lxn,this.refreshHeader,this)}refreshHeader(){if(this.parent.enableVirtualization){let e=this.parent.element.querySelector(".e-movableheader"),t=this.parent.element.querySelector(".e-movablecontent"),i=t.querySelector(".e-virtualtrack");this.parent.virtualHeaderDiv=e.querySelector(".e-virtualtrack"),e.querySelector(".e-virtualtrack")?(0,a.Od)(e.querySelector(".e-virtualtrack")):this.parent.virtualHeaderDiv=(0,a.az)("div",{className:th}),e.appendChild(this.parent.virtualHeaderDiv),i&&(0,a.V7)(this.parent.virtualHeaderDiv,{height:0,width:i.style.width}),(0,a.V7)(e.querySelector(".e-table"),{transform:t.querySelector(".e-table").style.transform.split(",")[0]+",0px)"});let s=this.parent.isAdaptive?t:t.parentElement.parentElement.querySelector(".e-movablescrollbar");e.scrollLeft=s.scrollLeft}}bindGrid(e,t){this.injectGridModules(e),this.parent.grid=new h.rjZ({frozenColumns:1,frozenRows:0,enableHover:!1,dataSource:t?this.frameEmptyData():this.frameDataSource("value"),columns:t?this.frameEmptyColumns():this.frameStackedHeaders(),height:t?"auto":this.calculateGridHeight(),width:t?this.gridSettings.allowAutoResizing?this.parent.width:400:this.calculateGridWidth(),locale:e.locale,enableRtl:e.enableRtl,allowExcelExport:e.allowExcelExport,allowPdfExport:e.allowPdfExport,allowResizing:this.gridSettings.allowResizing,allowTextWrap:this.gridSettings.allowTextWrap,allowReordering:!this.parent.showGroupingBar&&this.gridSettings.allowReordering,allowSelection:this.gridSettings.allowSelection,contextMenuItems:this.gridSettings.contextMenuItems,selectedRowIndex:this.gridSettings.selectedRowIndex,selectionSettings:this.gridSettings.selectionSettings,textWrapSettings:this.gridSettings.textWrapSettings,printMode:this.gridSettings.printMode,rowHeight:this.gridSettings.rowHeight,gridLines:this.gridSettings.gridLines,contextMenuClick:this.contextMenuClick.bind(this),contextMenuOpen:this.contextMenuOpen.bind(this),beforeCopy:this.gridSettings.beforeCopy?this.gridSettings.beforeCopy.bind(this.parent):void 0,beforePrint:this.gridSettings.beforePrint?this.gridSettings.beforePrint.bind(this.parent):void 0,printComplete:this.gridSettings.printComplete?this.gridSettings.printComplete.bind(this.parent):void 0,rowSelecting:this.gridSettings.rowSelecting?this.gridSettings.rowSelecting.bind(this.parent):void 0,rowSelected:this.rowSelected.bind(this),rowDeselecting:this.gridSettings.rowDeselecting?this.gridSettings.rowDeselecting.bind(this.parent):void 0,rowDeselected:this.rowDeselected.bind(this),cellSelecting:this.gridSettings.cellSelecting?this.gridSettings.cellSelecting.bind(this.parent):void 0,cellSelected:this.cellSelected.bind(this),cellDeselecting:this.gridSettings.cellDeselecting?this.gridSettings.cellDeselecting.bind(this.parent):void 0,cellDeselected:this.cellDeselected.bind(this),resizeStart:this.gridSettings.resizeStart?this.gridSettings.resizeStart.bind(this.parent):void 0,columnDragStart:this.gridSettings.columnDragStart?this.gridSettings.columnDragStart.bind(this):void 0,columnDrag:this.gridSettings.columnDrag?this.gridSettings.columnDrag.bind(this):void 0,columnDrop:this.gridSettings.columnDrop?this.gridSettings.columnDrop.bind(this):void 0,beforeExcelExport:this.beforeExcelExport.bind(this),resizing:this.setGroupWidth.bind(this),resizeStop:this.onResizeStop.bind(this),queryCellInfo:this.queryCellInfo.bind(this),dataBound:this.dataBound.bind(this),headerCellInfo:this.headerCellInfo.bind(this),excelHeaderQueryCellInfo:this.excelHeaderQueryCellInfo.bind(this),pdfHeaderQueryCellInfo:this.pdfHeaderQueryCellInfo.bind(this),excelQueryCellInfo:this.excelQueryCellInfo.bind(this),pdfQueryCellInfo:this.pdfQueryCellInfo.bind(this),beforePdfExport:this.gridSettings.beforePdfExport?this.gridSettings.beforePdfExport.bind(this):void 0,pdfExportComplete:this.pdfExportComplete.bind(this),excelExportComplete:this.excelExportComplete.bind(this)}),(0,a.xr)()&&(this.parent.grid.isJsComponent=!0),this.parent.grid.on("header-refreshed",this.headerRefreshed.bind(this)),this.parent.grid.on("export-DataBound",this.excelDataBound.bind(this))}headerRefreshed(e){this.parent.lastGridSettings&&Object.keys(this.parent.lastGridSettings).indexOf("allowResizing")>-1&&(this.parent.lastGridSettings=void 0,this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-grouping-bar")&&this.parent.groupingBarModule.setGridRowWidth())}beforeExcelExport(e){(0,a.le)(e.gridObject.columns)||(0,a.le)(this.parent.pivotColumns)||(e.gridObject.columns[e.gridObject.columns.length-1].width=this.parent.pivotColumns[this.parent.pivotColumns.length-1].width),this.parent.trigger("beforeExcelExport",e)}rowSelected(e){this.parent.renderModule.selected(),this.parent.trigger("rowSelected",e)}rowDeselected(e){this.parent.renderModule.selected(),this.parent.trigger("rowDeselected",e)}cellSelected(e){this.parent.rowRangeSelection.enable?(this.parent.grid.selectionModule.selectRowsByRange(this.parent.rowRangeSelection.startIndex,this.parent.rowRangeSelection.endIndex),this.parent.rowRangeSelection.enable=!1):(this.parent.renderModule.selected(),this.parent.trigger("selected",e))}cellSelecting(e){this.parent.trigger(Tr,e)}cellDeselected(e){this.parent.renderModule.selected(),this.parent.trigger("cellDeselected",e)}queryCellInfo(e){this.parent.renderModule.rowCellBoundEvent(e)}headerCellInfo(e){this.parent.renderModule.columnCellBoundEvent(e)}excelHeaderQueryCellInfo(e){this.parent.renderModule.excelColumnEvent(e)}pdfQueryCellInfo(e){this.parent.renderModule.pdfRowEvent(e)}excelQueryCellInfo(e){this.parent.renderModule.excelRowEvent(e)}pdfHeaderQueryCellInfo(e){this.parent.renderModule.pdfColumnEvent(e)}pdfExportComplete(e){void 0!==this.parent.lastColumn&&"auto"!==this.parent.lastColumn.width&&(this.parent.lastColumn.width="auto",this.parent.lastColumn=void 0)}excelExportComplete(e){void 0!==this.parent.lastColumn&&"auto"!==this.parent.lastColumn.width&&(this.parent.lastColumn.width="auto",this.parent.lastColumn=void 0)}dataBound(e){if(this.parent.cellTemplate&&!(0,a.xr)()){for(let e of this.parent.gridHeaderCellInfo)if(this.parent.cellTemplate){let t=this.parent.getCellTemplate()(e,this.parent,"cellTemplate",this.parent.element.id+"_cellTemplate",null,null,e.targetCell);t&&""!==t&&t.length>0&&this.parent.appendHtml(e.targetCell,this.parent.enableHtmlSanitizer?a.pJ.sanitize(t[0].outerHTML):t[0].outerHTML)}this.parent.gridHeaderCellInfo=[]}!this.parent.element.querySelector(".e-firstcell")||1===this.parent.dataSourceSettings.values.length&&this.parent.dataSourceSettings.columns.length>0||(this.parent.enableRtl?this.parent.element.querySelector(".e-firstcell").style.borderRight="none":this.parent.element.querySelector(".e-firstcell").style.borderLeft="none"),this.parent.grid&&this.parent.grid.widthService&&this.parent.grid.widthService.setWidthToTable(),this.parent.notEmpty&&this.calculateGridHeight(!0),this.parent.isScrolling=!1,this.setFocusOnLastCell(),(0,a.le)(this.parent.renderReactTemplates)||this.parent.renderReactTemplates(),this.parent.isInitial&&this.parent.refreshData(),this.parent.isInitial=!1,this.parent.notify(Nr,{})}setFocusOnLastCell(){if(this.parent.keyboardModule&&this.parent.keyboardModule.event&&"TD"===this.parent.keyboardModule.event.target.nodeName){let e=this.parent.grid.serviceLocator.getService("focus");e.setFocusedElement(this.parent.keyboardModule.event.target),e.focus(this.parent.keyboardModule.event),(0,a.cn)([this.parent.keyboardModule.event.target],["e-focused","e-focus"]),this.parent.keyboardModule.event.target.setAttribute("tabindex","0"),this.parent.keyboardModule.event=void 0}}contextMenuOpen(e){for(let t of e.items){let i,s,o=this.parent.lastCellClicked,l=null;if(o.classList.contains("e-stackedheadercelldiv")||o.classList.contains("e-cellvalue")||o.classList.contains("e-headercelldiv")||o.classList.contains("e-icons")||o.classList.contains("e-rhandler")?l=o.parentElement:o.classList.contains("e-headercell")||o.classList.contains("e-rowcell")||o.classList.contains("e-columnsheader")||o.classList.contains("e-rowsheader")||o.classList.contains("e-valuescontent")||o.classList.contains("e-valuesheader")?l=o:o.classList.contains("e-headertext")&&(l=o.parentElement.parentElement),!l)return void(e.cancel=!0);(l.classList.contains("e-valuesheader")||l.classList.contains("e-stot"))&&(i=!0),this.parent.allowGrouping&&this.parent.groupingModule&&!this.validateField(l)&&(s=!0);let r=Number(l.getAttribute("index")),n=Number(l.getAttribute("aria-colindex")),h=this.parent.pivotValues[r][n];switch(t.id){case this.parent.element.id+"_expand":l.querySelectorAll("."+Ln).length>0?((0,a.td)("#"+this.parent.element.id+"_expand",e.element)&&(0,a.Ys)("#"+this.parent.element.id+"_expand",e.element).classList.add(Qn),(0,a.Ys)("#"+this.parent.element.id+"_expand",e.element).classList.contains(Qn)&&(0,a.Ys)("#"+this.parent.element.id+"_expand",e.element).classList.remove(Qn),(0,a.Ys)("#"+this.parent.element.id+"_expand",e.element).classList.contains(Jn)&&((0,a.Ys)("#"+this.parent.element.id+"_expand",e.element).classList.remove(Jn),(0,a.Ys)("#"+this.parent.element.id+"_collapse",e.element).classList.remove(Jn))):i?(0,a.Ys)("#"+this.parent.element.id+"_expand",e.element).classList.add(Jn):(0,a.Ys)("#"+this.parent.element.id+"_expand",e.element).classList.add(Qn);break;case this.parent.element.id+"_collapse":l.querySelectorAll("."+Tn).length>0?((0,a.Ys)("#"+this.parent.element.id+"_expand",e.element)&&(0,a.Ys)("#"+this.parent.element.id+"_expand",e.element).classList.add(Qn),(0,a.Ys)("#"+this.parent.element.id+"_collapse",e.element).classList.contains(Qn)&&(0,a.Ys)("#"+this.parent.element.id+"_collapse",e.element).classList.remove(Qn),(0,a.Ys)("#"+this.parent.element.id+"_collapse",e.element).classList.contains(Jn)&&((0,a.Ys)("#"+this.parent.element.id+"_collapse",e.element).classList.remove(Jn),(0,a.Ys)("#"+this.parent.element.id+"_expand",e.element).classList.remove(Jn))):i?(0,a.Ys)("#"+this.parent.element.id+"_collapse",e.element).classList.add(Jn):(0,a.Ys)("#"+this.parent.element.id+"_collapse",e.element).classList.add(Qn);break;case this.parent.element.id+"_custom_group":s||2!==e.items.length||(e.cancel=!0),(0,a.td)("#"+this.parent.element.id+"_custom_group",e.element)&&(0,a.cn)([(0,a.Ys)("#"+this.parent.element.id+"_custom_group",e.element)],Jn),s&&(0,a.td)("#"+this.parent.element.id+"_custom_group",e.element)&&(0,a.IV)([(0,a.Ys)("#"+this.parent.element.id+"_custom_group",e.element)],Jn);break;case this.parent.element.id+"_custom_ungroup":if((0,a.td)("#"+this.parent.element.id+"_custom_ungroup",e.element)&&(0,a.cn)([(0,a.Ys)("#"+this.parent.element.id+"_custom_ungroup",e.element)],Jn),s){let t=!1,i=l.getAttribute("fieldname"),s=br.getFieldByName(i,this.parent.dataSourceSettings.groupSettings);if(s&&"Custom"===s.type||this.parent.engineModule.fieldList[i].isCustomField&&i.indexOf("_custom_group")>-1){if(s=br.getFieldByName(i.replace("_custom_group",""),this.parent.dataSourceSettings.groupSettings),s){let e=this.parent.engineModule.pivotValues[Number(l.getAttribute("index"))][Number(l.getAttribute("aria-colindex"))],o=this.parent.groupingModule.getSelectedCells(e.axis,i,e.actualText.toString());o.push({axis:e.axis,fieldName:i,name:e.actualText.toString(),cellInfo:e});let a=this.parent.groupingModule.getSelectedOptions(o);for(let i of s.customGroups)if(a.indexOf(i.groupName)>-1){t=!0;break}}}else(s&&("Date"===s.type||"Number"===s.type)||this.parent.engineModule.fieldList[i].isCustomField&&i.indexOf("_date_group")>-1)&&(t=!0);(0,a.td)("#"+this.parent.element.id+"_custom_ungroup",e.element)&&t&&(0,a.IV)([(0,a.Ys)("#"+this.parent.element.id+"_custom_ungroup",e.element)],Jn)}break;case this.parent.element.id+"_drillthrough":this.parent.allowDrillThrough?l.classList.contains("e-summary")?(0,a.Ys)("#"+this.parent.element.id+"_drillthrough",e.element).classList.contains(Qn)&&(0,a.Ys)("#"+this.parent.element.id+"_drillthrough",e.element).classList.remove(Qn):""===l.innerText&&(0,a.Ys)("#"+this.parent.element.id+"_drillthrough",e.element)&&(0,a.Ys)("#"+this.parent.element.id+"_drillthrough",e.element).classList.add(Qn):(0,a.Ys)("#"+this.parent.element.id+"_drillthrough",e.element)&&(0,a.Ys)("#"+this.parent.element.id+"_drillthrough",e.element).classList.add(Qn);break;case this.parent.element.id+"_sortasc":this.parent.enableValueSorting?l.querySelectorAll(".e-icon-descending").length>0?((0,a.Ys)("#"+this.parent.element.id+"_sortdesc",e.element)?(0,a.Ys)("#"+this.parent.element.id+"_sortdesc",e.element).classList.add(Qn):(0,a.Ys)("#"+this.parent.element.id+"_sortdesc",e.element).classList.remove(Qn),(0,a.Ys)("#"+this.parent.element.id+"_sortasc",e.element).classList.contains(Qn)&&(0,a.Ys)("#"+this.parent.element.id+"_sortasc",e.element).classList.remove(Qn)):(0,a.Ys)("#"+this.parent.element.id+"_sortdesc",e.element).classList.contains(Qn)&&(0,a.Ys)("#"+this.parent.element.id+"_sortdesc",e.element).classList.remove(Qn):(0,a.Ys)("#"+this.parent.element.id+"_sortasc",e.element)&&(0,a.Ys)("#"+this.parent.element.id+"_sortasc",e.element).classList.add(Qn);break;case this.parent.element.id+"_sortdesc":this.parent.enableValueSorting?l.querySelectorAll(".e-icon-ascending").length>0?((0,a.Ys)("#"+this.parent.element.id+"_sortasc",e.element)?(0,a.Ys)("#"+this.parent.element.id+"_sortasc",e.element).classList.add(Qn):(0,a.Ys)("#"+this.parent.element.id+"_sortasc",e.element).classList.remove(Qn),(0,a.Ys)("#"+this.parent.element.id+"_sortdesc",e.element).classList.contains(Qn)&&(0,a.Ys)("#"+this.parent.element.id+"_sortdesc",e.element).classList.remove(Qn)):(0,a.Ys)("#"+this.parent.element.id+"_sortasc",e.element).classList.contains(Qn)&&(0,a.Ys)("#"+this.parent.element.id+"_sortasc",e.element).classList.remove(Qn):(0,a.Ys)("#"+this.parent.element.id+"_sortdesc",e.element)&&(0,a.Ys)("#"+this.parent.element.id+"_sortdesc",e.element).classList.add(Qn);break;case this.parent.element.id+"_CalculatedField":this.parent.allowCalculatedField||(0,a.Ys)("#"+this.parent.element.id+"_CalculatedField",e.element).classList.add(Qn);break;case this.parent.element.id+"_pdf":this.parent.allowPdfExport||(0,a.Ys)("#"+this.parent.element.id+"_pdf",e.element).classList.add(Qn);break;case this.parent.element.id+"_excel":this.parent.allowExcelExport||(0,a.Ys)("#"+this.parent.element.id+"_excel",e.element).classList.add(Qn);break;case this.parent.element.id+"_csv":this.parent.allowExcelExport||(0,a.Ys)("#"+this.parent.element.id+"_csv",e.element).classList.add(Qn);break;case this.parent.element.id+"_exporting":this.parent.allowExcelExport||this.parent.allowPdfExport||(0,a.Ys)("#"+this.parent.element.id+"_exporting",e.element).classList.add(Qn);break;case this.parent.element.id+"_aggregate":if((0,a.Ys)("#"+this.parent.element.id+"_aggregate",e.element)&&!(0,a.Ys)("#"+this.parent.element.id+"_aggregate",e.element).classList.contains(Qn)&&(0,a.Ys)("#"+this.parent.element.id+"_aggregate",e.element).classList.add(Qn),(l.classList.contains("e-valuesheader")||l.classList.contains("e-valuescontent")||l.classList.contains("e-stot")&&l.classList.contains("e-rowsheader"))&&"olap"!==this.parent.dataType){let i;""!==l.innerText&&(i=this.parent.engineModule.fieldList[h.actualText.toString()].type);let s={cancel:!1,fieldName:h.actualText.toString(),aggregateTypes:[...this.getMenuItem(i)],displayMenuCount:7};this.parent.trigger(Pr,s,s=>{if(!s.cancel&&""!==l.innerText){let o=[],l=[];for(let e=0;e<s.aggregateTypes.length;e++){let t=s.aggregateTypes[e];"number"!==i?["Count","DistinctCount"].indexOf(t)>-1&&l.indexOf(t)<0&&(o.push({text:this.parent.localeObj.getConstant(t),id:this.parent.element.id+"_Agg"+t}),l.push(t)):this.parent.getAllSummaryType().indexOf(t)>-1&&l.indexOf(t)<0&&(o.push({text:this.parent.localeObj.getConstant(t),id:this.parent.element.id+"_Agg"+t}),l.push(t))}o.length>s.displayMenuCount&&(o.splice(s.displayMenuCount),o.push({text:this.parent.localeObj.getConstant("MoreOption"),id:this.parent.element.id+"_AggMoreOption"})),o&&o.length>=1&&(t.items=o,(0,a.Ys)("#"+this.parent.element.id+"_aggregate",e.element).classList.remove(Qn))}})}}}this.parent.trigger("contextMenuOpen",e)}getMenuItem(e){let t=[];for(let i=0;i<this.parent.aggregateTypes.length;i++){let s=this.parent.aggregateTypes[i];"string"!==e?this.parent.getAllSummaryType().indexOf(s)>-1&&-1===t.indexOf(s)&&t.push(s):["Count","DistinctCount"].indexOf(s)>-1&&-1===t.indexOf(s)&&t.push(s)}return t}contextMenuClick(e){let t=this.parent.lastCellClicked,i=e.item.id,s=new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0}),o={},l=null;t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-cellvalue")||t.classList.contains("e-headercelldiv")||t.classList.contains("e-icons")||t.classList.contains("e-rhandler")?l=t.parentElement:t.classList.contains("e-headercell")||t.classList.contains("e-rowcell")?l=t:t.classList.contains("e-headertext")&&(l=t.parentElement.parentElement);let r,n=Number(l.getAttribute("index")),h=Number(l.getAttribute("aria-colindex")),d=this.parent.pivotValues[n][h];switch(e.item.id.indexOf(this.parent.element.id+"_Agg")>-1&&(this.field=this.parent.engineModule.fieldList[d.actualText.toString()].id,this.fieldCaption=this.parent.engineModule.fieldList[d.actualText.toString()].caption,r=e.item.id.split("_Agg")[1]),i){case this.parent.element.id+"_pdf":o={pdfDoc:void 0,isBlob:!1,isMultipleExport:!1,pdfExportProperties:{fileName:"Export.pdf"}},this.parent.trigger(wr,o,e=>{if((0,a.xr)()){let t=br.formatPdfExportProperties(e.pdfExportProperties);this.parent.pdfExport(t,e.isMultipleExport,e.pdfDoc,e.isBlob)}else this.parent.pdfExport(e.pdfExportProperties,e.isMultipleExport,e.pdfDoc,e.isBlob)});break;case this.parent.element.id+"_excel":o={isBlob:!1,isMultipleExport:!1,workbook:void 0,excelExportProperties:{fileName:"Export.xlsx"}},this.parent.trigger(wr,o,e=>{if((0,a.xr)()){let t=br.formatExcelExportProperties(e.excelExportProperties);this.parent.excelExport(t,e.isMultipleExport,e.workbook,e.isBlob)}else this.parent.excelExport(e.excelExportProperties,e.isMultipleExport,e.workbook,e.isBlob)});break;case this.parent.element.id+"_csv":o={isBlob:!1,workbook:void 0,isMultipleExport:!1,excelExportProperties:{fileName:"Export.csv"}},this.parent.trigger(wr,o,e=>{if((0,a.xr)()){let t=br.formatExcelExportProperties(e.excelExportProperties);this.parent.csvExport(t,e.isMultipleExport,e.workbook,e.isBlob)}else this.parent.csvExport(e.excelExportProperties,e.isMultipleExport,e.workbook,e.isBlob)});break;case this.parent.element.id+"_drillthrough_menu":l.dispatchEvent(s);break;case this.parent.element.id+"_sortasc":this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:d.valueSort.levelName,headerDelimiter:this.parent.dataSourceSettings.valueSortSettings.headerDelimiter}}}),this.parent.dataSourceSettings.valueSortSettings.sortOrder="Ascending";break;case this.parent.element.id+"_sortdesc":this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:d.valueSort.levelName,headerDelimiter:this.parent.dataSourceSettings.valueSortSettings.headerDelimiter}}}),this.parent.dataSourceSettings.valueSortSettings.sortOrder="Descending";break;case this.parent.element.id+"_expand":if(l.querySelectorAll("."+Ln)){let e=l.querySelectorAll("."+Ln)[0];this.parent.onDrill(e)}break;case this.parent.element.id+"_collapse":if(l.querySelectorAll("."+Tn)){let e=l.querySelectorAll("."+Tn)[0];this.parent.onDrill(e)}break;case this.parent.element.id+"_CalculatedField":this.parent.calculatedFieldModule.createCalculatedFieldDialog();break;case this.parent.element.id+"_AggMoreOption":case this.parent.element.id+"_AggDifferenceFrom":case this.parent.element.id+"_AggPercentageOfDifferenceFrom":case this.parent.element.id+"_AggPercentageOfParentTotal":l.setAttribute("id",this.field),l.setAttribute("data-caption",this.fieldCaption),l.setAttribute("data-field",this.field),l.setAttribute("data-type",this.engine.fieldList[d.actualText.toString()].aggregateType),l.setAttribute("data-basefield",this.engine.fieldList[d.actualText.toString()].baseField),l.setAttribute("data-baseItem",this.engine.fieldList[d.actualText.toString()].baseItem),this.aggMenu.createValueSettingsDialog(l,this.parent.element,r);break;case this.parent.element.id+"_Agg"+r:this.updateAggregate(r);break;case this.parent.element.id+"_custom_group":case this.parent.element.id+"_custom_ungroup":this.parent.groupingModule&&(this.parent.notify("init-grouping",{target:l,option:i,parentElement:this.parent.element}),this.parent.grid.contextMenuModule.contextMenu.close())}this.parent.trigger("contextMenuClick",e)}validateColumnTotalcell(e){let t=Object.keys(this.engine.headerContent),i=!1,s="";for(let o=t.length-1;o>=0;o--){let l=this.engine.headerContent[t[o]][e];if(!l)return!1;if(i=!(!i||""===s)&&s===l.valueSort.axis,s=l.valueSort.axis?l.valueSort.axis.toString():"","sum"===l.type&&(i=!0),i&&l.members&&l.members.length>0)return!0}return!1}validateField(e){let t=!1;if(e.classList.contains("e-stot")||e.classList.contains("e-gtot")||e.classList.contains("e-valuescontent")||e.classList.contains("e-valuesheader"))t=!0;else{let i=e.getAttribute("fieldName");if(!i||""==i){let t=Number(e.getAttribute("index")),s=Number(e.getAttribute("aria-colindex"));i=this.engine.pivotValues[t][s].actualText}let s=this.parent.dataSourceSettings.values;for(let e=0;e<s.length;e++)if(this.parent.dataSourceSettings.values[e].name===i){t=!0;break}}return t}updateAggregate(e){if(this.parent.getAllSummaryType().indexOf(e)>-1){let t=this.parent.dataSourceSettings.values;for(let i=0;i<this.parent.dataSourceSettings.values.length;i++)this.parent.dataSourceSettings.values[i].name===this.field&&(t[i].type=e)}}injectGridModules(e){h.rjZ.Inject(h.fMg),e.allowExcelExport&&h.rjZ.Inject(h.jY6),e.allowPdfExport&&h.rjZ.Inject(h.Nhn),h.rjZ.Inject(h.Y19,h.tmU,h.t$0),this.gridSettings.contextMenuItems&&h.rjZ.Inject(h.xVl)}updateGridSettings(){if(this.injectGridModules(this.parent),this.parent.grid.allowResizing=this.gridSettings.allowResizing,this.parent.grid.allowTextWrap=this.gridSettings.allowTextWrap,this.parent.grid.allowReordering=!this.parent.showGroupingBar&&this.gridSettings.allowReordering,this.parent.grid.allowSelection=this.gridSettings.allowSelection,this.parent.grid.contextMenuItems=this.gridSettings.contextMenuItems,this.parent.grid.selectedRowIndex=this.gridSettings.selectedRowIndex,this.parent.grid.selectionSettings=this.gridSettings.selectionSettings,this.parent.grid.textWrapSettings=this.gridSettings.textWrapSettings,this.parent.grid.printMode=this.gridSettings.printMode,this.parent.grid.rowHeight=this.gridSettings.rowHeight,this.parent.grid.gridLines=this.gridSettings.gridLines,this.parent.lastGridSettings){let e=Object.keys(this.parent.lastGridSettings);e.indexOf("height")>-1&&(this.parent.grid.height=this.gridSettings.height),e.indexOf("width")>-1&&(this.parent.grid.width=this.gridSettings.width),this.updatePivotColumns(),e.indexOf("allowTextWrap")>-1&&this.parent.layoutRefresh()}this.clearColumnSelection()}updatePivotColumns(){let e=Object.keys(this.parent.lastGridSettings);for(let t=0;t<this.parent.pivotColumns.length;t++){let i=this.parent.pivotColumns[t];for(let s=0;s<e.length;s++){let o=e[s];(0,a.le)(this.parent.pivotColumns[t][o])||(i[o]=this.parent.lastGridSettings[o])}}this.parent.fillGridColumns(this.parent.grid.columns)}clearColumnSelection(){(0,a.IV)(this.parent.element.querySelectorAll(".e-active"),[ah,sh])}appendValueSortIcon(e,t,i,s){if(this.parent.enableValueSorting&&"pivot"===this.parent.dataType){let o=this.parent.dataSourceSettings.valueSortSettings,l="grand sum"!==e.type||1!==this.parent.dataSourceSettings.values.length||this.parent.dataSourceSettings.alwaysShowValueHeader?this.parent.dataSourceSettings.values.length>1||this.parent.dataSourceSettings.alwaysShowValueHeader?this.parent.engineModule.headerContent.length-1:0===this.parent.dataSourceSettings.columns.length?0:this.parent.engineModule.headerContent.length-1:0,r=o&&o.headerText?e.valueSort.levelName===o.headerText:s===o.columnIndex;if(void 0!==o&&r&&i===l&&"column"===this.parent.dataSourceSettings.valueAxis&&(t.querySelector(".e-sortfilterdiv")?(t.querySelector(".e-sortfilterdiv").classList.add("Descending"===o.sortOrder?"e-descending":"e-ascending"),t.querySelector(".e-sortfilterdiv").classList.add("Descending"===o.sortOrder?"e-icon-descending":"e-icon-ascending")):t.appendChild((0,a.az)("div",{className:"Descending"===o.sortOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv":"e-icon-ascending e-icons e-ascending e-sortfilterdiv"})),!(0,a.le)(e.hasChild)&&"grand sum"!==e.type&&t.querySelector(".e-expand")&&(t.querySelector(".e-icon-descending")||t.querySelector(".e-icon-ascending")))){let e=t.querySelector(".e-icon-descending")||t.querySelector(".e-icon-ascending");(0,a.V7)(e,{"padding-top":"12px"})}}return t}onResizeStop(e){this.parent.resizeInfo["0.formattedText"===e.column.field?"0.formattedText":e.column.customAttributes.cell.valueSort.levelName]=Number(e.column.width.toString().split("px")[0]),this.parent.grid.columns[this.parent.grid.columns.length-1].minWidth=this.parent.gridSettings.columnWidth,this.parent.layoutRefresh(),this.setGroupWidth(e),this.calculateGridHeight(!0),this.parent.grid.hideScroll()}setGroupWidth(e){if(this.parent.enableVirtualization&&("0.formattedText"===e.column.field?this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-grouping-bar")&&Number(e.column.width.toString().split("px")[0])<250?e.cancel=!0:this.parent.element.querySelector(".e-frozenscrollbar").style.width=e.column.width.toString().split("px")[0]+"px":e.cancel=!0),this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-grouping-bar")){if(this.parent.groupingBarModule.refreshUI(),this.parent.element.querySelector(".e-group-row").offsetWidth<245&&!this.parent.firstColWidth){e.cancel=!0;let t=this.parent.grid.columns;t&&t.length>0&&(t[0].width=this.resColWidth),this.parent.element.querySelector(".e-frozenheader").querySelector("col").style.width=this.resColWidth+"px",this.parent.element.querySelector(".e-frozencontent").querySelector("col").style.width=this.resColWidth+"px"}this.parent.element.querySelector(".e-group-rows").style.height="auto",this.parent.element.querySelector(".e-group-values").style.width=this.parent.element.querySelector(".e-group-row").offsetWidth+"px";let t=this.parent.element.querySelector(".e-headercontent").offsetHeight;this.parent.element.querySelector(".e-group-rows").style.height=t+"px"}this.parent.resizedValue=e.cancel?this.parent.resizedValue:Number(e.column.width.toString().split("px")[0]),this.parent.trigger("touchend"===e.e.type||"mouseup"===e.e.type?"resizeStop":"resizing",e)}selected(){clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.onSelect.bind(this),300)}onSelect(){let e={selectedCellsInfo:[],pivotValues:this.parent.pivotValues,currentCell:null},t=this.parent.element.querySelectorAll(".e-cellselectionbackground,."+sh);for(let i of t){let t=Number(i.getAttribute("aria-colindex")),s=Number(i.getAttribute("index")),o=this.engine.pivotValues[s][t];o&&e.selectedCellsInfo.push("value"===o.axis?{currentCell:o,value:o.value,columnHeaders:o.columnHeaders,rowHeaders:o.rowHeaders,measure:o.actualText.toString()}:"column"===o.axis?{currentCell:o,value:o.formattedText,columnHeaders:o.valueSort.levelName,rowHeaders:"",measure:""}:{currentCell:o,value:o.formattedText,columnHeaders:"",rowHeaders:o.valueSort.levelName,measure:""})}this.parent.trigger("cellSelected",e)}rowCellBoundEvent(e){let t=e.cell;if(t&&this.parent.notEmpty&&this.engine.headerContent){let i=this.parent.hyperlinkSettings.cssClass;t.setAttribute("index",(Number(t.getAttribute("index"))+this.engine.headerContent.length).toString());let s=e.data[0];if("0"===t.getAttribute("aria-colindex")){if("pivot"===this.parent.dataType){let e=s.type&&"value"===s.type;t.innerText="";let i,o=s.level?s.level:e?this.lastSpan+1:0;do{o>0&&t.appendChild((0,a.az)("span",{className:0===o?"":Pn})),o--}while(o>-1);o=s.level?s.level:0,this.lastSpan=e?this.lastSpan:o,!s.hasChild&&o>0&&t.appendChild((0,a.az)("span",{className:kn})),this.parent.dataSourceSettings.rows.length>0&&(!s.valueSort||Object.keys(s.valueSort).length>0)&&(i=o>-1?this.parent.dataSourceSettings.rows[o].name:"",t.setAttribute("fieldname",i))}else t=this.onOlapRowCellBoundEvent(t,s);let e=s.formattedText;s.type&&("grand sum"===s.type?(this.rowGrandPos=s.rowIndex,t.classList.add("e-gtot"),e=this.parent.localeObj.getConstant("grandTotal")):s.valueSort.levelName===this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+s.formattedText?t.classList.add("e-gtot"):t.classList.add("e-stot")),t.classList.add(Rn),!0!==s.hasChild||s.isNamedSet||t.appendChild((0,a.az)("div",{className:(!0===s.isDrilled?Tn:Ln)+" "+Gr,attrs:{title:this.parent.localeObj.getConstant(!0===s.isDrilled?"collapse":"expand")}})),t.appendChild((0,a.az)("span",{className:In,innerHTML:this.parent.isRowCellHyperlink||s.enableHyperlink?'<a  data-url="'+e+'" class="e-hyperlinkcell '+i+'">'+e+"</a>":e}));let o=this.parent.pivotView.dataSourceSettings.valueSortSettings;if(this.parent.enableValueSorting&&o&&o.headerText&&"row"===this.parent.dataSourceSettings.valueAxis&&this.parent.pivotValues[Number(t.getAttribute("index"))][0].valueSort.levelName&&this.parent.pivotValues[Number(t.getAttribute("index"))][0].valueSort.levelName===o.headerText){let e=t.querySelector(".e-expand")||t.querySelector(".e-collapse")?"padding-top: 18px":"padding-top: 12px";t.appendChild((0,a.az)("div",{className:"Descending"===o.sortOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv":"e-icon-ascending e-icons e-ascending e-sortfilterdiv",styles:e}))}}else{let o=t.innerText;t.innerText="",t.classList.add("e-valuescontent"),s=e.data[Number(t.getAttribute("aria-colindex"))],s.isSum&&t.classList.add("e-summary"),s.isGrandSum||this.colGrandPos===Number(t.getAttribute("aria-colindex"))||this.rowGrandPos===Number(t.getAttribute("index"))?t.classList.add("e-gtot"):("olap"===this.parent.dataType?s.isSum:this.validateColumnTotalcell((0,a.le)(s.value)?s.colIndex-1:s.colIndex))&&t.classList.add("e-colstot"),s.cssClass&&t.classList.add(s.cssClass),t.appendChild((0,a.az)("span",{className:In,innerHTML:-1!==t.className.indexOf("e-summary")&&this.parent.isSummaryCellHyperlink||-1===t.className.indexOf("e-summary")&&this.parent.isValueCellHyperlink||s.enableHyperlink?'<a data-url="'+o+'" class="e-hyperlinkcell '+i+'">'+o+"</a>":o})),this.parent.gridSettings.allowReordering&&!this.parent.showGroupingBar&&t.setAttribute("aria-colindex",e.column.customAttributes.cell.colIndex.toString())}if(this.parent.cellTemplate){let e=t.getAttribute("index"),i=t.getAttribute("aria-colindex"),o=e+"_"+i;if(window&&(0,a.xr)())e&&i&&(this.parent.gridCellCollection[o]=t);else{let e=this.parent.getCellTemplate()({targetCell:t,cellInfo:s},this.parent,"cellTemplate",this.parent.element.id+"_cellTemplate",null,null,t);e&&""!==e&&e.length>0&&this.parent.appendHtml(t,this.parent.enableHtmlSanitizer?a.pJ.sanitize(e[0].outerHTML):e[0].outerHTML)}}this.unWireEvents(t),this.wireEvents(t)}e.pivotview=this.parent,this.parent.trigger("queryCellInfo",e)}onOlapRowCellBoundEvent(e,t){e.innerText="";let i=this.engine.rowMeasurePos;if(this.parent.enableVirtualization){if(t.ordinal>-1&&this.parent.olapEngineModule.tupRowInfo.length>0){let s=this.parent.olapEngineModule.tupRowInfo[t.ordinal],o=s.uNameCollection.indexOf(t.actualText.toString()),l=(s.uNameCollection.substring(0,o)+(3===t.memberType?"":t.actualText.toString())).split("::[").map(e=>"["===e[0]?e:"["+e);3===t.memberType&&i&&l.push(t.actualText.toString());let r=-1,n=0,h=!1;for(let e=0;e<l.length;e++){r+=l[e].split("~~").length;let t="2"!==s.typeCollection[e]&&(!!(this.engine.fieldList[s.members[e].getAttribute("Hierarchy")]&&this.engine.fieldList[s.members[e].getAttribute("Hierarchy")].isHierarchy&&e<this.parent.dataSourceSettings.rows.length-1&&!this.parent.dataSourceSettings.rows[e+1].isNamedSet&&this.parent.dataSourceSettings.rows[e+1].name.indexOf("[Measures]")<0&&this.engine.fieldList[this.parent.dataSourceSettings.rows[e+1].name]&&this.engine.fieldList[this.parent.dataSourceSettings.rows[e+1].name].hasAllMember)||Number(s.members[e].querySelector("CHILDREN_CARDINALITY").textContent)>0);n+=e>0&&h&&!t?1:0,h=t}let d=0;for(let t=0;t<r;t++)e.appendChild((0,a.az)("span",{className:Pn})),d++;for(let t=0;t<n&&r>0;t++)e.appendChild((0,a.az)("span",{className:kn}));this.indentCollection[t.rowIndex]=d,this.maxIndent=this.maxIndent>d?this.maxIndent:d}}else{let s=t.hierarchy,o=3===t.memberType?this.measurePos+"."+t.levelUniqueName:t.levelUniqueName,l=t.hasChild;if(!this.lvlCollection[o]&&o)this.lvlPosCollection[this.position]=o,this.lvlCollection[o]={position:this.position,hasChild:l},this.position++;else if(o){let e=this.lvlCollection[o].position;for(let t=e+1;t<this.position;t++)delete this.lvlCollection[this.lvlPosCollection[t]],delete this.lvlPosCollection[t];this.position=this.position>e+1?e+1:this.position}if(!this.hierarchyCollection[s]&&s)this.hierarchyPosCollection[this.hierarchyCount]=s,this.hierarchyCollection[s]={lvlPosition:this.position-1,hierarchyPOs:this.hierarchyCount},this.hierarchyCount++;else if(s){let e=this.hierarchyCollection[s].hierarchyPOs;for(let t=e+1;t<this.hierarchyCount;t++)delete this.hierarchyCollection[this.hierarchyPosCollection[t]],delete this.hierarchyPosCollection[t];this.hierarchyCount=this.hierarchyCount>e+1?e+1:this.hierarchyCount}3!==t.memberType&&o&&this.lvlCollection[o]&&(this.measurePos=i<=(this.hierarchyCollection[s]?this.hierarchyCollection[s].hierarchyPOs:-1)&&this.hierarchyPosCollection[i+1]?this.measurePos:this.lvlCollection[o].position);let r=this.lvlCollection[o]?this.lvlCollection[o].position:-1,n=0,h=0;for(;n<=r&&r>0&&t.level>-1;){let t=this.lvlCollection[this.lvlPosCollection[n]].hasChild;n>0&&this.lvlCollection[this.lvlPosCollection[n-1]].hasChild&&!t&&e.appendChild((0,a.az)("span",{className:kn})),n!==r&&(e.appendChild((0,a.az)("span",{className:Pn})),h++),n++}3===t.memberType&&-1===t.level&&Object.keys(this.lvlCollection).length>1&&(e.appendChild((0,a.az)("span",{className:Pn})),h++),this.indentCollection[t.rowIndex]=h,this.maxIndent=this.maxIndent>h?this.maxIndent:h}return e.setAttribute("fieldname",t.hierarchy),!!this.parent.olapEngineModule.tupRowInfo[t.ordinal]&&(0===this.parent.olapEngineModule.tupRowInfo[t.ordinal].measurePosition?1===this.parent.olapEngineModule.tupRowInfo[t.ordinal].allStartPos:0===this.parent.olapEngineModule.tupRowInfo[t.ordinal].allStartPos)&&e.classList.add("e-gtot"),e}columnCellBoundEvent(e){if(e.cell.column&&e.cell.column.customAttributes){let t=e.cell.column.customAttributes.cell,i=e.node;if(t){let s,o=this.parent.hyperlinkSettings.cssClass,l=t.level?t.level:0;if(-1===t.level&&!t.rowSpan||-1===t.rowSpan?e.node.style.display="none":t.rowSpan>1&&(e.node.setAttribute("rowspan",t.rowSpan.toString()),e.node.setAttribute("aria-rowspan",t.rowSpan.toString()),t.rowIndex+t.rowSpan===this.engine.headerContent.length&&(e.node.style.borderBottomWidth="0px")),e.node.setAttribute("aria-colindex",t.colIndex.toString()),e.node.setAttribute("index",t.rowIndex.toString()),"pivot"===this.parent.dataType?(!(this.parent.dataSourceSettings.values&&"column"===this.parent.dataSourceSettings.valueAxis&&this.parent.dataSourceSettings.values.length>1&&t.rowIndex===this.engine.headerContent.length-1)&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&(s=l>-1&&this.parent.dataSourceSettings.columns[l]?this.parent.dataSourceSettings.columns[l].name:"",i.setAttribute("fieldname",s)),this.validateColumnTotalcell(t.colIndex)&&i.classList.add("e-colstot")):i=this.onOlapColumnCellBoundEvent(i,t),t.type){i.classList.add("grand sum"===t.type?"e-gtot":"e-stot"),"grand sum"===t.type?this.colGrandPos=t.colIndex:i.classList.add("e-colstot");let e="grand sum"===t.type?this.parent.localeObj.getConstant("grandTotal"):t.formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total");null!==i.querySelector(".e-headertext")?i.querySelector(".e-headertext").innerText=e:i.querySelector(".e-stackedheadercelldiv").innerText=e}if(i.classList.add(Dn),this.parent.isColumnCellHyperlink||t.enableHyperlink)if(i.querySelector(".e-stackedheadercelldiv")){let e=i.querySelector(".e-stackedheadercelldiv").innerText;i.querySelector(".e-stackedheadercelldiv").innerHTML='<a data-url="'+e+'" class="e-hyperlinkcell '+o+'">'+e+"</a>"}else if(i.querySelector(".e-headertext")){let e=i.querySelector(".e-headertext").innerText;i.querySelector(".e-headertext").innerHTML='<a data-url="'+e+'" class="e-hyperlinkcell '+o+'">'+e+"</a>"}if(!0===t.hasChild&&!t.isNamedSet){let e=i.querySelector(".e-headercelldiv");e&&(e.style.height="auto",e.style.lineHeight="normal");let s=(0,a.az)("div",{className:(!0===t.isDrilled?Tn:Ln)+" "+Gr,attrs:{title:this.parent.localeObj.getConstant(!0===t.isDrilled?"collapse":"expand")}});i.children[0].classList.add(In),i.children[0].style.display=window.navigator.userAgent.indexOf("Edge")>-1||window.navigator.userAgent.indexOf("Trident")>-1?"table":"block",i.insertBefore(s,i.children[0])}if(i=this.appendValueSortIcon(t,i,t.rowIndex,t.colIndex),this.parent.cellTemplate){let e=i.getAttribute("index"),t=i.getAttribute("aria-colindex"),s=e+"_"+t;window&&(0,a.xr)()?e&&t&&(this.parent.gridCellCollection[s]=i):this.parent.gridHeaderCellInfo.push({targetCell:i})}let r=this.parent.dataSourceSettings.values.length;for(let e=0;e<r;e++)this.parent.dataSourceSettings.values[e].name===t.actualText&&("olap"===this.parent.dataType&&this.parent.olapEngineModule.tupColumnInfo[t.ordinal]&&(0===this.parent.olapEngineModule.tupColumnInfo[t.ordinal].measurePosition?1===this.parent.olapEngineModule.tupColumnInfo[t.ordinal].allStartPos:0===this.parent.olapEngineModule.tupColumnInfo[t.ordinal].allStartPos)&&i.classList.add("e-gtot"),t.valueSort.levelName===this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+t.formattedText||t.valueSort.levelName==="Grand Total"+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+t.formattedText?i.classList.add("e-gtot"):i.classList.add("e-valuesheader"));this.unWireEvents(i),this.wireEvents(i)}}this.parent.trigger("headerCellInfo",e)}onOlapColumnCellBoundEvent(e,t){e.setAttribute("fieldname",3===t.memberType?t.actualText.toString():t.hierarchy);let i=this.engine.headerContent[t.rowIndex]?this.engine.headerContent[t.rowIndex][t.colIndex-1]:void 0;return i&&i.actualText===t.actualText&&i.type===t.type&&i.colSpan>1?e.style.display="none":(e.setAttribute("colspan",t.colSpan.toString()),e.setAttribute("aria-colspan",t.colSpan.toString())),t.rowIndex===this.engine.headerContent.length-1&&2===t.memberType&&(e.style.display=this.isSpannedCell(this.engine.headerContent.length,t)?"none":e.style.display),e}isSpannedCell(e,t){let i,s,o=this.engine.headerContent[t.rowIndex-1]?this.engine.headerContent[t.rowIndex-1][t.colIndex]:void 0;for(;o&&(o.memberType===t.memberType||o.type&&t.type);)o.rowSpan>0&&(i=o.rowSpan,s=o.rowIndex),o=this.engine.headerContent[o.rowIndex-1]?this.engine.headerContent[o.rowIndex-1][t.colIndex]:void 0;return s+i>=e}onHyperCellClick(e){let t=e.target.parentElement.parentElement;t=t.className.indexOf("e-headercelldiv")>-1?t.parentElement:t;let i={currentCell:t,data:this.engine.pivotValues[Number(t.getAttribute("index"))][Number(t.getAttribute("aria-colindex"))],cancel:!0,nativeEvent:e};this.parent.trigger("hyperlinkCellClick",i,e=>{if(!e.cancel){i.currentCell=(0,a.sb)(i.currentCell);let e=i.currentCell.getAttribute("data-url")?i.currentCell.getAttribute("data-url"):i.currentCell.querySelector("a").getAttribute("data-url");window.open(e)}})}getRowStartPos(){let e,t=this.parent.pivotValues;for(let i=0;i<(t?t.length:0);i++)if(t[i]&&t[i][0]&&"row"===t[i][0].axis){e=i;break}return e}frameDataSource(e){let t=[];if(this.parent.dataSourceSettings.values.length>0&&!this.engine.isEmptyData)if(this.parent.enableValueSorting||!this.engine.isEngineUpdated){let i=0,s=this.parent.pivotValues,o="value"===e?s?s.length:0:this.rowStartPos;for(let l="value"===e?this.rowStartPos:0;l<o;l++)if(s[l]){i="header"===e?l:i,t[i]={};for(let e=0;e<s[l].length;e++)s[l][e]&&(t[i][e]=s[l][e]);i++}}else t="value"===e?this.engine.valueContent:this.engine.headerContent;else t=this.frameEmptyData();return t}frameEmptyData(){return[{0:{formattedText:this.parent.localeObj.getConstant("grandTotal")},1:{formattedText:this.parent.localeObj.getConstant("emptyData")}}]}calculateColWidth(e){this.resColWidth=(0,a.le)(this.parent.resizedValue)?this.resColWidth:this.parent.resizedValue;let t=this.parent.element.offsetWidth?this.parent.element.offsetWidth:this.parent.element.getBoundingClientRect().width,i=isNaN(this.parent.width)?this.parent.width.toString().indexOf("%")>-1?parseFloat(this.parent.width.toString())/100*t:t:Number(this.parent.width);return i=i-(this.gridSettings.columnWidth>this.resColWidth?this.gridSettings.columnWidth:this.resColWidth)-2,this.isOverflows=!((e-=1)*this.gridSettings.columnWidth<i),this.isOverflows||this.gridSettings.allowAutoResizing?Math.floor(e*this.gridSettings.columnWidth<i?i/e:this.gridSettings.columnWidth):this.gridSettings.columnWidth}resizeColWidth(e){this.resColWidth=(0,a.le)(this.parent.resizedValue)?this.resColWidth:this.parent.resizedValue;let t=isNaN(this.parent.width)?this.parent.width.toString().indexOf("%")>-1?parseFloat(this.parent.width.toString())/100*this.parent.element.offsetWidth:this.parent.element.offsetWidth:Number(this.parent.width);return t=t-(this.gridSettings.columnWidth>this.resColWidth?this.gridSettings.columnWidth:this.resColWidth)-2,this.isOverflows=!((e-=1)*this.gridSettings.columnWidth<t),this.isOverflows||this.gridSettings.allowAutoResizing?Math.floor(e*this.gridSettings.columnWidth<t?t/e:this.gridSettings.columnWidth):this.gridSettings.columnWidth}calculateGridWidth(){let e=this.parent.width,t=this.parent.element.getBoundingClientRect().width?this.parent.element.getBoundingClientRect().width:this.parent.element.offsetWidth;return"auto"===this.gridSettings.width?"auto"===this.parent.width?e=t:this.parent.width.toString().indexOf("%")>-1&&(e=parseFloat(this.parent.width.toString())/100*t):e=this.gridSettings.width,!this.gridSettings.allowAutoResizing&&e>this.parent.totColWidth?this.parent.totColWidth:e}calculateGridHeight(e){let t=this.parent.height,i=this.parent.getHeightAsNumber();if(isNaN(i)&&(i=i>this.parent.minHeight?i:this.parent.minHeight),"Chart"!==this.parent.currentView)if("auto"===this.gridSettings.height&&i&&this.parent.element.querySelector(".e-gridheader"))if(t=i-(this.parent.element.querySelector(".e-gridheader").offsetHeight+(this.parent.element.querySelector(".e-grouping-bar")?this.parent.element.querySelector(".e-grouping-bar").offsetHeight:0)+(this.parent.element.querySelector("."+hh)?42:0))-1,t=t<40?40:t,e){let e=this.parent.element.querySelector(".e-frozencontent ."+An).offsetHeight,i=this.parent.element.querySelector(".e-movablecontent").offsetHeight,s=this.parent.element.querySelector(".e-movablecontent ."+An).offsetWidth,o=this.parent.element.querySelector(".e-movablecontent").offsetWidth<s,l=!!(o&&t-e<18);t>=e&&(!o||t>=i)&&!l?this.parent.grid.height="auto":(this.parent.grid.height=t,this.parent.grid.dataBind()),this.parent.grid.widthService.refreshFrozenScrollbar()}else t>this.engine.valueContent.length*this.gridSettings.rowHeight&&(t="auto");else t=this.gridSettings.height;return t<this.parent.gridSettings.rowHeight?this.parent.gridSettings.rowHeight:t}frameStackedHeaders(){let e=1!==this.parent.dataSourceSettings.values.length||this.parent.dataSourceSettings.alwaysShowValueHeader?void 0:this.formatList[this.parent.dataSourceSettings.values[0].name],t=[];if(("olap"===this.parent.dataType||this.parent.dataSourceSettings.values.length>0)&&!this.engine.isEmptyData){let i=this.engine.headerContent.length,s=[],o=[],l=this.calculateColWidth(this.engine.pivotValues?this.engine.pivotValues[0].length:0);do{let r=[],n=0;i--;let h=this.engine.headerContent[i];if(h)for(let d=0;d<Object.keys(h).length+(h[0]?0:1);d++){let c=h[d]&&h[d].colSpan?3!==h[d].memberType||0===i?h[d].colSpan:s[d]:1;c="olap"===this.parent.dataType?1:c;let p=h[d]?"grand sum"===h[d].type?this.parent.localeObj.getConstant("grandTotal"):"sum"===h[d].type?h[d].formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total"):h[d].formattedText:"";if(i===this.engine.headerContent.length-1)c=1,r[n]={field:d+".formattedText",headerText:p,customAttributes:{cell:h[d]},width:h[d]?this.setSavedWidth(h[d].valueSort.levelName,l):this.resColWidth,minWidth:30,format:0===d?"":(0,a.le)(e)?this.formatList[h[d].actualText]:e,allowReordering:!this.parent.showGroupingBar&&this.parent.gridSettings.allowReordering,allowResizing:this.parent.gridSettings.allowResizing,visible:!0};else if(s[d]){c=h[d]&&"grand sum"===h[d].type&&2===h[d].memberType?1:c;let e=c,i=[],a=d;for(;e>0;){if(r[n]){if(!t[o[a]])break;i.push(t[o[a]])}else r[n]={headerText:p,field:h[d]?h[d].valueSort.levelName:"",customAttributes:{cell:h[d]},width:h[d]?this.setSavedWidth(h[d].valueSort.levelName,l):this.resColWidth,minWidth:30,allowReordering:!this.parent.showGroupingBar&&this.parent.gridSettings.allowReordering,allowResizing:this.parent.gridSettings.allowResizing,visible:!0},i=[t[o[a]]];e-=s[a],a+=s[a]}r[n].columns=i}r[n]&&(r[n].clipMode=this.gridSettings.clipMode),s[d]=c,o[d]=n,n++,d=d+c-1}t=r.length>0?r:t}while(i>0);t[0]={field:"0.formattedText",width:this.resColWidth,minWidth:30,headerText:"",allowReordering:!1,allowResizing:this.parent.gridSettings.allowResizing,visible:!0}}else t=this.frameEmptyColumns();if(t.length>1){let e=t[t.length-1];e.minWidth=e.width,e.width="auto",e.columns&&e.columns.length>0&&this.configLastColumnWidth(e.columns[e.columns.length-1])}return this.parent.triggerColumnRenderEvent(t),t}configLastColumnWidth(e){e.minWidth=e.width,e.width="auto",e.columns&&e.columns.length>0&&this.configLastColumnWidth(e.columns[e.columns.length-1])}setSavedWidth(e,t){return"0.formattedText"!==e||(0,a.le)(this.parent.resizedValue)?this.parent.resizeInfo[e]?this.parent.resizeInfo[e]:t:this.parent.resizedValue}frameEmptyColumns(){let e=[],t=this.calculateColWidth(2);return e.push({field:"0.formattedText",headerText:"",minWidth:30,width:this.resColWidth}),e.push({field:"1.formattedText",headerText:this.parent.localeObj.getConstant("grandTotal"),minWidth:30,width:t}),e}getFormatList(){let e={};for(let t=0;t<this.parent.dataSourceSettings.values.length;t++){let i=this.parent.dataSourceSettings.values[t],s="N";if("olap"===this.parent.dataType){if(this.parent.olapEngineModule.fieldList[i.name]){let e=this.parent.olapEngineModule.fieldList[i.name].formatString;s=e.indexOf("#")>-1?e:e[0]+"2"}}else if(this.parent.dataSourceSettings.formatSettings.length>0)for(let e=0;e<this.parent.dataSourceSettings.formatSettings.length;e++){let t=this.parent.dataSourceSettings.formatSettings[e];if(i.name===t.name){s=t.format;break}}e[i.name]=s}return e}excelColumnEvent(e){void 0!==e.gridCell&&"auto"===e.gridCell.column.width&&(this.parent.lastColumn=e.gridCell.column,e.gridCell.column.width=e.gridCell.column.minWidth),e=this.exportHeaderEvent(e),this.parent.trigger("excelHeaderQueryCellInfo",e)}pdfColumnEvent(e){void 0!==e.gridCell&&"auto"===e.gridCell.column.width&&(this.parent.lastColumn=e.gridCell.column,e.gridCell.column.width=e.gridCell.column.minWidth),this.parent.trigger("pdfHeaderQueryCellInfo",e)}excelRowEvent(e){if("0.formattedText"===e.column.field){let t="value"===e.data[0].type,i=0;i="olap"===this.parent.dataType?this.indentCollection[e.data[0].rowIndex]:t?this.lastSpan+1:e.data[0].level,this.colPos=0,e.style={hAlign:"Left",indent:2*i},this.lastSpan=t?this.lastSpan:i}else this.colPos++,e.value=(0,a.le)(e.data[this.colPos].value)||(0,a.le)(e.data[this.colPos].formattedText)||""===e.data[this.colPos].formattedText?"Excel"===this.parent.exportType?null:"":(0,a.le)(e.data[this.colPos].value)?e.data[this.colPos].formattedText:e.data[this.colPos].value;e=this.exportContentEvent(e),this.parent.trigger("excelQueryCellInfo",e)}pdfRowEvent(e){if("0.formattedText"===(e=this.exportContentEvent(e)).column.field){let t=0,i="value"===e.data[0].type;t="olap"===this.parent.dataType?this.indentCollection[e.data[0].rowIndex]:i?this.lastSpan+1:-1!==e.data[0].level?e.data[0].level:0,e.style={paragraphIndent:10*t},this.lastSpan=i?this.lastSpan:t}this.parent.trigger("pdfQueryCellInfo",e)}excelDataBound(e){let t=e.excelRows,i=Object.keys(this.engine.headerContent).length;for(let s=0;s<i;s++){let e=t[s].cells,i=[];for(let t=0;t<e.length;t++)-1!==e[t].rowSpan&&i.push(e[t]);t[s].cells=i}}exportHeaderEvent(e){let t=1;if(e.gridCell.column.customAttributes){let i=e.gridCell.column.customAttributes.cell;this.actualText!==i.actualText&&i.colSpan>1&&i.level>-1&&(e.gridCell.colSpan=e.cell.colSpan=i.colSpan>-1?i.colSpan:1),t=i.rowSpan>-1?i.rowSpan:1,"excelHeaderQueryCellInfo"===e.name&&(i.rowSpan>-1?t=i.rowSpan:(0,a.le)(i.type)||0===i.level||(t=-1,e.cell.rowSpan=-1)),this.actualText=i.actualText}else t=Object.keys(this.engine.headerContent).length;return e.cell.rowSpan!==t&&t>-1&&(e.cell.rowSpan=t),e}exportContentEvent(e){return e.value="grand sum"===e.data[Number(e.column.field.split(".formattedText")[0])].type?this.parent.localeObj.getConstant("grandTotal"):e.value,e}unWireEvents(e){e.querySelector(".e-hyperlinkcell")&&a.bi.remove(e.querySelector(".e-hyperlinkcell"),this.parent.isAdaptive?"touchend":"click",this.onHyperCellClick)}wireEvents(e){e.querySelector(".e-hyperlinkcell")&&a.bi.add(e.querySelector(".e-hyperlinkcell"),this.parent.isAdaptive?"touchend":"click",this.onHyperCellClick,this)}}class vh{constructor(e){this.keyConfigs={shiftF:"shift+F",shiftS:"shift+S",shiftE:"shift+E",delete:"delete",enter:"enter",escape:"escape",upArrow:"upArrow",downArrow:"downArrow"},this.parent=e,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.keyboardModule=new a.nv(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}keyActionHandler(e){switch(e.action){case"shiftF":this.processFilter(e);break;case"shiftS":this.processSort(e);break;case"shiftE":this.processEdit(e);break;case"delete":this.processDelete(e);break;case"enter":this.processEnter(e);break;case"escape":this.processClose(e);break;case"upArrow":case"downArrow":this.processFilterNodeSelection(e)}}getButtonElement(e){let t=[].slice.call(this.parent.element.querySelectorAll(".e-pivot-button"));for(let i=0,s=t.length;i<s;i++)if(t[i].getAttribute("data-uid")===e.getAttribute("data-uid"))return t[i];return e}processEnter(e){let t=e.target;if(t&&(0,a.oq)(t,".e-pivot-button"))return t.querySelector(".e-dropdown-icon")&&(0,a.oq)(t,".e-values")?t.querySelector(".e-dropdown-icon").click():t.querySelector(".e-edit")?t.querySelector(".e-edit").click():!t.querySelector(".e-sort")||(0,a.oq)(t,".e-values")||(0,a.oq)(t,".e-axis-filter")?t.querySelector(".e-btn-filter")&&!(0,a.oq)(t,".e-values")&&t.querySelector(".e-btn-filter").click():(t.querySelector(".e-sort").click(),this.getButtonElement(t).focus()),void e.preventDefault()}processSort(e){let t=e.target;if(t&&(0,a.oq)(t,".e-pivot-button")&&t.querySelector(".e-sort")&&!(0,a.oq)(t,".e-values")&&!(0,a.oq)(t,".e-axis-filter"))return t.querySelector(".e-sort").click(),this.getButtonElement(t).focus(),void e.preventDefault()}processEdit(e){let t=e.target;if(t&&(0,a.oq)(t,".e-pivot-button")&&t.querySelector(".e-edit"))return t.querySelector(".e-edit").click(),void e.preventDefault()}processFilter(e){let t=e.target;if(t&&(0,a.oq)(t,".e-pivot-button")&&t.querySelector(".e-btn-filter")&&!(0,a.oq)(t,".e-values")){if(t.querySelector(".e-btn-filter").click(),this.parent&&this.parent.control&&"pivotview"===this.parent.moduleName&&this.parent.control.grid&&this.parent.control.showGroupingBar&&this.parent.control.groupingBarModule&&(0,a.oq)(t,".e-group-rows")&&this.parent.filterDialog&&this.parent.filterDialog.dialogPopUp&&!this.parent.filterDialog.dialogPopUp.isDestroyed&&this.parent.filterDialog.dialogPopUp.element){let e=this.parent.filterDialog.dialogPopUp.element,t=this.parent.filterDialog.allowExcelLikeFilter;clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(()=>{e&&e.classList.contains("e-popup-open")&&(t&&e.querySelector(".e-dlg-closeicon-btn")?e.querySelector(".e-dlg-closeicon-btn").focus():e.querySelector("input")&&e.querySelector("input").focus())})}e.preventDefault()}}processFilterNodeSelection(e){let t=e.target;if(t&&(0,a.oq)(t,".e-select-all")&&40===e.keyCode){let i=(0,a.oq)(t,".e-member-editor-wrapper").querySelector(".e-member-editor-container");if(i&&i.querySelector("li")){let t=i.querySelector("li");return i.querySelector("li#_active")&&((0,a.IV)([i.querySelector("li#_active")],["e-hover","e-node-focus"]),i.querySelector("li#_active").removeAttribute("id")),t.setAttribute("id","_active"),(0,a.cn)([t],["e-hover","e-node-focus"]),i.focus(),void e.preventDefault()}}else if(t&&(0,a.oq)(t,".e-member-editor-container")&&38===e.keyCode){let i=(0,a.oq)(t,".e-member-editor-container");if(i.querySelector("li#_active.e-hover.e-node-focus")&&i.querySelector("li")&&i.querySelector("li").classList.contains("e-prev-active-node")&&i.querySelector("li")===i.querySelector("li#_active.e-hover.e-node-focus")){(0,a.IV)(i.querySelectorAll("li.e-prev-active-node"),"e-prev-active-node");let s=(0,a.oq)(t,".e-member-editor-wrapper").querySelector(".e-select-all");if(s&&s.querySelector("li")){let t=s.querySelector("li");return t.setAttribute("id","_active"),(0,a.cn)([t],["e-hover","e-node-focus"]),s.focus(),void e.preventDefault()}}}else t&&t.id===this.parent.parentID+"_inputbox"&&("upArrow"===e.action?t.parentElement.querySelector(".e-spin-up").click():"downArrow"===e.action&&t.parentElement.querySelector(".e-spin-down").click())}processDelete(e){let t=e.target;if(t&&(0,a.oq)(t,".e-pivot-button")&&t.querySelector(".e-remove"))return t.querySelector(".e-remove").click(),void e.preventDefault()}processClose(e){let t=e.target;if(t&&(0,a.oq)(t,".e-popup.e-popup-open")){let i=(0,a.oq)(t,".e-popup.e-popup-open").ej2_instances[0];if(i&&!i.closeOnEscape){let t=i.element.getAttribute("data-fieldName");if(i.hide(),this.parent.element){let e=[].slice.call(this.parent.element.querySelectorAll(".e-pivot-button"));for(let i of e)if(i.getAttribute("data-uid")===t){i.focus();break}}return void e.preventDefault()}}}destroy(){this.keyboardModule&&this.keyboardModule.destroy()}}class Sh{constructor(e){this.parent=e}updateSorting(e){if(!e.target.classList.contains(en)&&!e.target.classList.contains(on)){this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();let t,i,s,o=e.target;o.id?(t=o.id,i=[].slice.call(o.querySelectorAll(".e-descend"))):(t=o.parentElement.id,i=[].slice.call(o.parentElement.querySelectorAll(".e-descend"))),s=0!==i.length;let l=br.getFieldByName(t,this.parent.dataSourceSettings.sortSettings);if((0,a.le)(l))this.parent.dataSourceSettings.sortSettings.push({name:t,order:s?"Ascending":"Descending"});else{for(let e=0;e<this.parent.dataSourceSettings.sortSettings.length;e++)if(this.parent.dataSourceSettings.sortSettings[e].name===t){this.parent.dataSourceSettings.sortSettings.splice(e,1);break}this.parent.dataSourceSettings.sortSettings.push({name:t,order:s?"Ascending":"Descending"})}this.parent.control.lastSortInfo=this.parent.dataSourceSettings.sortSettings[this.parent.dataSourceSettings.sortSettings.length-1],s?(0,a.IV)([o],$r):(0,a.cn)([o],$r)}}updateFiltering(e){let t=e.target,i=t.parentElement.id,s=t.parentElement.textContent,o=!1,l=[],r=[];if(this.parent.dataSourceSettings.allowMemberFilter)if("olap"===this.parent.dataType)r=this.getOlapData(i,o);else{let e=br.getClonedData(this.parent.engineModule.fieldList[i].dateMember);e="Ascending"===this.parent.engineModule.fieldList[i].sort?e.sort((e,t)=>e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0):"Descending"===this.parent.engineModule.fieldList[i].sort?e.sort((e,t)=>e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0):e;let t=br.getFilterItemByName(i,this.parent.dataSourceSettings.filterSettings);(0,a.le)(t)||(o=!(!this.isValidFilterItemsAvail(i,t)||"Include"!==t.type),l=t.items?t.items:[]),r=this.getTreeData(o,e,l,i)}this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();let n=this.parent.control.filterTargetID;(0,a.le)(n)&&(n="pivotfieldlist"!==this.parent.moduleName?this.parent.element:document.getElementById(this.parent.parentID+"_Wrapper")),this.parent.filterDialog.createFilterDialog(r,i,s,n)}isValidFilterItemsAvail(e,t){let i=!1;if(t&&["Include","Exclude"].indexOf(t.type)>=0){let s=this.parent.engineModule,o=s.fieldList[e],l=s.formatFields[e]&&["date","dateTime","time"].indexOf(s.formatFields[e].type)>-1?o.formattedMembers:o.members;for(let e of t.items)if(l[e]){i=!0;break}}return i}getOlapData(e,t){let i=[],s=[];this.parent.filterDialog.isSearchEnabled=!1;let o=this.parent.engineModule,l=br.getFilterItemByName(e,this.parent.dataSourceSettings.filterSettings);0===o.fieldList[e].filterMembers.length?this.parent.control.loadOnDemandInMemberEditor?l&&l.levelCount>1&&o.fieldList[e].levels.length>1?o.getFilterMembers(this.parent.dataSourceSettings,e,l.levelCount):(o.fieldList[e].levelCount=1,o.getMembers(this.parent.dataSourceSettings,e)):o.getMembers(this.parent.dataSourceSettings,e,!0):(o.fieldList[e].currrentMembers={},o.fieldList[e].searchMembers=[]);let r=o.fieldList[e].isHierarchy;i=o.fieldList[e].filterMembers,(0,a.le)(l)||(t=!l.type||"Include"===l.type,s=l.items?l.items:[]);let n={},h={},d=o.fieldList[e].members;for(let a of s)n[a]=a,h[a]=a,d[a]&&(h=this.getParentNode(e,a,h));return i=this.getFilteredTreeNodes(e,i,h,[],r),i=this.getOlapTreeData(t,br.getClonedData(i),n,e,r),i=this.sortOlapFilterData(i,o.fieldList[e].sort),i}sortOlapFilterData(e,t){return e.length>0&&(e="Ascending"===t?e.sort((e,t)=>e.caption>t.caption?1:t.caption>e.caption?-1:0):"Descending"===t?e.sort((e,t)=>e.caption<t.caption?1:t.caption<e.caption?-1:0):e),e}getParentIDs(e,t,i){let s,o=e.fields.dataSource;for(let l of o)if(l.id===t){s=l.pid;break}return s&&(i.push(s),this.getParentIDs(e,s,i)),i}getChildIDs(e,t,i){let s,o=e.fields.dataSource;for(let l of o)if(l.pid===t){s=l.id;break}return s&&(i.push(s),this.getParentIDs(e,s,i)),i}searchTreeNodes(e,t,i,s){if(i){let i=[],s=[],o=[].slice.call(t.element.querySelectorAll("li"));for(let t of o)t.querySelector(".e-list-text").textContent.toLowerCase().indexOf(e.value.toLowerCase())>-1?i.push(t):s.push(t);if(t.enableNodes(i),(0,a.IV)(i,Yr),t.disableNodes(s),(0,a.cn)(s,Yr),i.length>0&&s.length>0)for(let e of i){let i=e.getAttribute("data-uid"),o=this.getParentIDs(t,i,[]),l=this.getChildIDs(t,i,[]),r=[];if(o.length>0)for(let e of s)-1!==br.inArray(e.getAttribute("data-uid"),o)&&r.push(e);if(l.length>0)for(let e of s)-1!==br.inArray(e.getAttribute("data-uid"),l)&&r.push(e);t.enableNodes(r),(0,a.IV)(r,Yr)}0===[].slice.call(t.element.querySelectorAll("li.e-disable")).length?t.collapseAll():t.expandAll(void 0,void 0,!0)}else if(this.parent.searchTreeItems=[],"olap"!==this.parent.dataType||s){let i=[],s=0;s=1;for(let t of this.parent.currentTreeItems)t.name.toLowerCase().indexOf(e.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(t),s<=this.parent.control.maxNodeLimitInMemberEditor&&i.push(t),s++);s--,s>this.parent.control.maxNodeLimitInMemberEditor?(this.parent.editorLabelElement.innerText=s-this.parent.control.maxNodeLimitInMemberEditor+this.parent.control.localeObj.getConstant("editorDataLimitMsg"),this.parent.filterDialog.dialogPopUp.height=this.parent.filterDialog.allowExcelLikeFilter?"440px":"400px",this.parent.isDataOverflow=!0):(this.parent.editorLabelElement.innerText="",this.parent.filterDialog.dialogPopUp.height=this.parent.filterDialog.allowExcelLikeFilter?"400px":"350px",this.parent.isDataOverflow=!1),this.parent.isDataOverflow=s>this.parent.control.maxNodeLimitInMemberEditor,this.parent.editorLabelElement.parentElement.style.display=this.parent.isDataOverflow?"block":"none",t.fields={dataSource:i,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},t.dataBind()}else this.updateOlapSearchTree(e,t,s)}updateOlapSearchTree(e,t,i){let s=[],o=this.parent.filterDialog.dialogPopUp.element.getAttribute("data-fieldname");if(""===e.value.toLowerCase()){this.parent.filterDialog.isSearchEnabled=!1,this.parent.engineModule.fieldList[o].searchMembers=[];let e=[],t={},l={},a=this.parent.engineModule.fieldList[o].members,r=Object.keys(a),n=[];for(let i of r)a[i].isSelected&&(a[i].parent&&a[a[i].parent].isSelected||n.push(i));for(let i of n)t[i]=i,l[i]=i,a[i]&&(l=this.getParentNode(o,i,l));s=this.getFilteredTreeNodes(o,this.parent.engineModule.fieldList[o].filterMembers,l,e,i),s=this.getOlapTreeData(!0,br.getClonedData(s),t,o,i,!0)}else this.parent.filterDialog.isSearchEnabled=!0,s=br.getClonedData(this.parent.engineModule.fieldList[o].searchMembers),s=this.getOlapSearchTreeData(!0,s,o);t.fields={dataSource:s,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},t.dataBind()}getTreeData(e,t,i,s){this.parent.currentTreeItems=[],this.parent.searchTreeItems=[],this.parent.currentTreeItemsPos={},this.parent.savedTreeFilterPos={};let o=this.parent.engineModule;this.parent.isDateField=o.formatFields[s]&&["date","dateTime","time"].indexOf(o.formatFields[s].type)>-1;let l=[],a=1,r={};for(let h of i)r[h]=h;let n=s.replace(/[^a-zA-Z0-9 ]/g,"_");for(let h of t){let t=this.parent.isDateField?h.formattedText:h.actualText.toString(),i={id:n+"_"+a,htmlAttributes:{"data-fieldName":s,"data-memberId":h.actualText.toString()},actualText:h.actualText,name:t,isSelected:!e};void 0!==r[t]&&(i.isSelected=!!e),a<=this.parent.control.maxNodeLimitInMemberEditor&&l.push(i),i.isSelected||(this.parent.savedTreeFilterPos[a-1]=t),this.parent.currentTreeItems.push(i),this.parent.searchTreeItems.push(i),this.parent.currentTreeItemsPos[h.actualText]={index:a-1,isSelected:i.isSelected},a++}return this.parent.isDataOverflow=a-1>this.parent.control.maxNodeLimitInMemberEditor,l}getOlapTreeData(e,t,i,s,o,l){let a=this.parent.engineModule.fieldList[s];this.parent.currentTreeItems=[],this.parent.searchTreeItems=[],this.parent.currentTreeItemsPos={};let r=[],n=1;for(let h of t){let t=h,d=h.id.toString();l||(t.isSelected=!e),void 0!==i[d]&&(t.isSelected=!!e),!l&&h.hasChildren&&this.updateChildNodeStates(a.filterMembers,s,h.id,t.isSelected),a.members[d].isSelected=t.isSelected,a.currrentMembers&&a.currrentMembers[d]&&(a.currrentMembers[d].isSelected=t.isSelected),n<=this.parent.control.maxNodeLimitInMemberEditor&&o&&r.push(t),this.parent.currentTreeItems.push(t),this.parent.searchTreeItems.push(t),this.parent.currentTreeItemsPos[d]={index:n-1,isSelected:t.isSelected},n++}return this.parent.isDataOverflow=!!o&&n-1>this.parent.control.maxNodeLimitInMemberEditor,o?r:t}getOlapSearchTreeData(e,t,i){let s=this.parent.engineModule.fieldList[i].members;for(let o of t){let e=o.id.toString();s[e]&&(o.isSelected=s[e].isSelected),this.parent.searchTreeItems.push(o)}return t}updateChildNodeStates(e,t,i,s){let o=this.parent.engineModule.fieldList[t].members,l=this.parent.engineModule.fieldList[t].currrentMembers;for(let a of e)a.pid&&a.pid.toString()===i&&(o[a.id].isSelected=s,l&&l[a.id]&&(l[a.id].isSelected=s),a.hasChildren&&this.updateChildNodeStates(e,t,a.id,s))}getParentNode(e,t,i){let s=this.parent.engineModule.fieldList[e].members;if(s[t].parent&&t!==s[t].parent){let o=s[t].parent;i[o]=o,this.getParentNode(e,o,i)}return i}getFilteredTreeNodes(e,t,i,s,o){let l=[],r=this.parent.engineModule.fieldList[e].members,n=i?Object.keys(i):[];for(let a of n){let e=r[a].parent;void 0!==e&&-1===br.inArray(e,l)&&l.push(e)}for(let h of t)(0,a.le)(h.pid)||-1!==br.inArray(h.pid,l)?(s.push(h),(0,a.le)(h.pid)&&-1!==br.inArray(h.id,l)?r[h.id].isNodeExpand=!0:(0,a.le)(h.pid)||-1===br.inArray(h.pid,l)?r[h.id].isNodeExpand=!1:(r[h.id].isNodeExpand=!1,r[h.pid].isNodeExpand=!0)):r[h.id].isNodeExpand=!1;return s}}class xh{constructor(e){this.parent=e}onStateModified(e,t){let i="",s=!0,o=(0,a.oq)(e.target,".e-droppable"),l=-1;if(this.parent.dataSourceUpdate.btnElement=e.element?e.element.parentElement:void 0,o&&(i=o.classList[1]===gn?"rows":o.classList[1]===mn?"columns":"e-values"===o.classList[1]?"values":o.classList[1]===bn?"filters":""),"olap"===this.parent.dataType){let o=this.parent.engineModule.fieldList[t]&&this.parent.engineModule.fieldList[t].isCalculatedField?this.parent.engineModule.fieldList[t].tag:t;if(e.cancel&&""===i)return s=!1,s;if(this.parent.dataSourceUpdate.btnElement&&"true"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&("filters"===i||"values"===i)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&o.toLowerCase().indexOf("[measures].")>-1&&("filters"===i||"rows"===i||"columns"===i)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&-1===o.toLowerCase().indexOf("[measures].")&&this.parent.engineModule.fieldList[t]&&this.parent.engineModule.fieldList[t].isNamedSets&&("filters"===i||"values"===i)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&-1===o.toLowerCase().indexOf("[measures].")&&"values"===i){let e=this.parent.localeObj.getConstant("warning"),t=this.parent.localeObj.getConstant("fieldDropErrorAction");return this.parent.errorDialog.createErrorDialog(e,t),s=!1,s}}else if(e.cancel&&""===i||this.parent.dataSourceUpdate.btnElement&&"true"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&("filters"===i||"values"===i||i.indexOf(this.parent.dataSourceSettings.valueAxis)>-1))return s=!1,s;if(""!==i){if("olap"===this.parent.dataType){let e=this.parent.engineModule.fieldList[t]&&this.parent.engineModule.fieldList[t].isCalculatedField?this.parent.engineModule.fieldList[t].tag:t;if(e.toLowerCase().indexOf("[measures].")>-1&&("filters"===i||"rows"===i||"columns"===i)||this.parent.engineModule.fieldList[t]&&this.parent.engineModule.fieldList[t].isNamedSets&&"filters"===i||-1===e.toLowerCase().indexOf("[measures].")&&"values"===i){let e=this.parent.localeObj.getConstant("warning"),t=this.parent.localeObj.getConstant("fieldDropErrorAction");return this.parent.errorDialog.createErrorDialog(e,t),s=!1,s}}if("pivot"===this.parent.dataType&&this.parent.engineModule.fieldList[t]&&"CalculatedField"===this.parent.engineModule.fieldList[t].aggregateType&&"values"!==i){let e=this.parent.localeObj.getConstant("warning"),t=this.parent.localeObj.getConstant("dropAction");return this.parent.errorDialog.createErrorDialog(e,t),s=!1,s}l=this.getButtonPosition(e.target,i)}else this.parent.engineModule.fieldList[t]&&(this.parent.engineModule.fieldList[t].isSelected=!1,"olap"===this.parent.dataType&&this.parent.engineModule.updateFieldlistData(t));return this.parent.dataSourceUpdate.updateDataSource(t,i,l),!(0,a.xr)()&&s}getButtonPosition(e,t){let i=-1,s=(0,a.oq)(e,".e-pvt-btn-div");if(!(0,a.le)(s)){s=s.querySelector(".e-pivot-button");let e=this.parent.element.querySelector(".e-"+t),o=[].slice.call(e.querySelectorAll(".e-pivot-button"));for(let t=0,l=o.length;t<l;t++)if(o[t].id===s.id){i=t;break}}return i}}class wh{constructor(e){this.parent=e}updateDataSource(e,t,i){let s,o,l=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters];for(let a=0,h=l.length;a<h;a++)if(l[a])for(let t=0,i=l[a].length;t<i;t++)(l[a][t].name===e||"olap"===this.parent.dataType&&"[measures]"===l[a][t].name.toLowerCase()&&l[a][t].name.toLowerCase()===e)&&(o=0===a?"rows":1===a?"columns":2===a?"values":"filters"),o||(o="fieldList");let r={fieldName:e,dropField:br.getFieldInfo(e,this.control).fieldItem,dataSourceSettings:br.getClonedDataSourceSettings(this.parent.dataSourceSettings),dropAxis:t,dropPosition:i,draggedAxis:o,cancel:!1},n="pivotfieldlist"===this.control.getModuleName()&&this.control.isPopupView?this.control.pivotGridModule:this.control;n.trigger(xr,r,o=>{if(!o.cancel){if(t=o.dropAxis,i=o.dropPosition,e=o.dropField?o.dropField.name:o.fieldName,s=o.dropField,this.control&&this.btnElement&&"true"===this.btnElement.getAttribute("isvalue"))switch(t){case"":this.control.setProperties({dataSourceSettings:{values:[]}},!0);break;case"rows":this.control.setProperties({dataSourceSettings:{valueAxis:"row"}},!0);break;case"columns":this.control.setProperties({dataSourceSettings:{valueAxis:"column"}},!0)}else this.removeFieldFromReport(e.toString()),s=this.getNewField(e.toString(),o.dropField),"CalculatedField"===s.type&&""!==t&&(t="values");if("olap"===this.parent.dataType&&(this.removeFieldFromReport(e.toString()),s=this.getNewField(e.toString(),o.dropField),0===this.parent.dataSourceSettings.values.length&&this.removeFieldFromReport("[measures]"),"CalculatedField"===s.type&&""!==t&&(t="values")),this.control){let o={fieldName:e,droppedField:s,dataSourceSettings:br.getClonedDataSourceSettings(this.parent.dataSourceSettings),droppedAxis:t,droppedPosition:i},l=this;n.trigger("onFieldDropped",o,e=>{if(s=e.droppedField,s){switch(i=e.droppedPosition,t=e.droppedAxis){case"filters":-1!==i?(0,a.xr)()?l.parent.dataSourceSettings.filters.splice(i,0,s):this.parent.dataSourceSettings.filters.splice(i,0,s):(0,a.xr)()?l.parent.dataSourceSettings.filters.push(s):this.parent.dataSourceSettings.filters.push(s);break;case"rows":-1!==i?(0,a.xr)()?l.parent.dataSourceSettings.rows.splice(i,0,s):this.parent.dataSourceSettings.rows.splice(i,0,s):(0,a.xr)()?l.parent.dataSourceSettings.rows.push(s):this.parent.dataSourceSettings.rows.push(s);break;case"columns":-1!==i?(0,a.xr)()?l.parent.dataSourceSettings.columns.splice(i,0,s):this.parent.dataSourceSettings.columns.splice(i,0,s):(0,a.xr)()?l.parent.dataSourceSettings.columns.push(s):this.parent.dataSourceSettings.columns.push(s);break;case"values":-1!==i?(0,a.xr)()?l.parent.dataSourceSettings.values.splice(i,0,s):this.parent.dataSourceSettings.values.splice(i,0,s):(0,a.xr)()?l.parent.dataSourceSettings.values.push(s):this.parent.dataSourceSettings.values.push(s),(0,a.xr)()?"olap"!==l.parent.dataType||l.parent.engineModule.isMeasureAvail||("row"===l.parent.dataSourceSettings.valueAxis?l.parent.dataSourceSettings.rows:l.parent.dataSourceSettings.columns).push({name:"[Measures]",caption:"Measures",showRemoveIcon:!0,allowDragAndDrop:!0}):"olap"!==this.parent.dataType||this.parent.engineModule.isMeasureAvail||("row"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.rows:this.parent.dataSourceSettings.columns).push({name:"[Measures]",caption:"Measures",showRemoveIcon:!0,allowDragAndDrop:!0})}(0,a.xr)()&&(l.parent.control.pivotButtonModule.updateDataSource(),l.parent.control.axisFieldModule.render())}})}}})}removeFieldFromReport(e){let t,i=!1,s=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],o=this.parent.engineModule.fieldList[e];for(let l=0,a=s.length;l<a;l++)if(!i&&s[l])for(let r=0,n=s[l].length;r<n;r++)if(s[l][r].name===e||"olap"===this.parent.dataType&&"[measures]"===s[l][r].name.toLowerCase()&&s[l][r].name.toLowerCase()===e){if(t=s[l][r].properties?s[l][r].properties:s[l][r],t.type=o&&"number"===o.type?t.type:"Count",s[l].splice(r,1),"olap"===this.parent.dataType){let t=this.parent.engineModule;t&&t.fieldList[e]&&(t.fieldList[e].currrentMembers={},t.fieldList[e].searchMembers=[])}i=!0;break}return t}getNewField(e,t){let i;if("olap"===this.parent.dataType){let s=this.parent.engineModule.fieldList[e];i={name:t?t.name:e,caption:t?t.caption:s.caption,isNamedSet:t?t.isNamedSet:s.isNamedSets,isCalculatedField:t?t.isCalculatedField:s.isCalculatedField,type:t?void 0===t.type?"number"===s.type?"Sum":"Count":t.type:void 0===s.aggregateType?"number"===s.type?"Sum":"Count":s.aggregateType,showFilterIcon:t?t.showFilterIcon:s.showFilterIcon,showSortIcon:t?t.showSortIcon:s.showSortIcon,showEditIcon:t?t.showEditIcon:s.showEditIcon,showRemoveIcon:t?t.showRemoveIcon:s.showRemoveIcon,showValueTypeIcon:t?t.showValueTypeIcon:s.showValueTypeIcon,allowDragAndDrop:t?t.allowDragAndDrop:s.allowDragAndDrop,showSubTotals:t?t.showSubTotals:s.showSubTotals}}else{let s=this.parent.engineModule.fieldList[e];i={name:t?t.name:e,caption:t?t.caption:s.caption,type:t?null==t.type?"number"===s.type?"Sum":"Count":t.type:null==s.aggregateType?"number"===s.type?"Sum":"Count":s.aggregateType,showNoDataItems:t?t.showNoDataItems:s.showNoDataItems,baseField:t?t.baseField:s.baseField,baseItem:t?t.baseItem:s.baseItem,allowDragAndDrop:t?t.allowDragAndDrop:s.allowDragAndDrop,showSubTotals:t?t.showSubTotals:s.showSubTotals,showFilterIcon:t?t.showFilterIcon:s.showFilterIcon,showSortIcon:t?t.showSortIcon:s.showSortIcon,showEditIcon:t?t.showEditIcon:s.showEditIcon,showRemoveIcon:t?t.showRemoveIcon:s.showRemoveIcon,showValueTypeIcon:t?t.showValueTypeIcon:s.showValueTypeIcon}}return i}}class Ch{constructor(e){this.parent=e}createErrorDialog(e,t,i){let s=(0,a.az)("div",{id:this.parent.parentID+"_ErrorDialog",className:un});this.parent.element.appendChild(s);let o=i?Number(i.style.zIndex)+1:"pivotfieldlist"===this.parent.moduleName&&"Popup"===this.parent.renderMode&&this.parent.control?this.parent.control.dialogRenderer.fieldListDialog.zIndex+1:"pivotfieldlist"===this.parent.moduleName&&"Fixed"===this.parent.renderMode&&this.parent.control||"pivotview"===this.parent.moduleName&&this.parent.control?1000002:1000001;this.errorPopUp=new n.Vq({animationSettings:{effect:"Fade"},allowDragging:!1,header:e,content:t,isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",zIndex:o,position:{X:"center",Y:"center"},buttons:[{click:this.closeErrorDialog.bind(this),buttonModel:{cssClass:cn,content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}}],closeOnEscape:!0,target:document.body,close:this.removeErrorDialog.bind(this)}),this.errorPopUp.isStringTemplate=!0,this.errorPopUp.appendTo(s)}closeErrorDialog(){this.errorPopUp.close()}removeErrorDialog(){this.errorPopUp&&!this.errorPopUp.isDestroyed&&this.errorPopUp.destroy(),document.getElementById(this.parent.parentID+"_ErrorDialog")&&(0,a.Od)(document.getElementById(this.parent.parentID+"_ErrorDialog"))}}class Mh{constructor(e){this.parent=e}createFilterDialog(e,t,i,s){let o=(0,a.az)("div",{id:this.parent.parentID+"_EditorTreeView",className:"e-member-editor-dialog "+("olap"===this.parent.dataType?"e-olap-editor-dialog":""),attrs:{"data-fieldName":t,"aria-label":i}}),l=this.parent.engineModule.fieldList[t].caption,r=this.parent.localeObj.getConstant("filter")+' "'+i+'" '+this.parent.localeObj.getConstant("by");this.filterObject=this.getFilterObject(t),this.isSearchEnabled=!1,this.allowExcelLikeFilter=this.isExcelFilter(t),this.parent.element.appendChild(o),this.dialogPopUp=new n.Vq({animationSettings:{effect:this.allowExcelLikeFilter?"None":"Fade"},allowDragging:!1,header:this.allowExcelLikeFilter?r:l,content:"",isModal:!0,visible:!0,showCloseIcon:!!this.allowExcelLikeFilter,enableRtl:this.parent.enableRtl,width:"auto",height:this.parent.isDataOverflow?this.allowExcelLikeFilter?"440px":"400px":this.allowExcelLikeFilter?"400px":"350px",position:{X:"center",Y:"center"},buttons:[{buttonModel:{cssClass:"e-clear-filter-button"+(this.allowExcelLikeFilter?"":" e-disable"),iconCss:"e-icons e-clear-filter-icon",enableRtl:this.parent.enableRtl,content:this.parent.localeObj.getConstant("clearFilter"),disabled:!this.filterObject}},{buttonModel:{cssClass:cn,content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.closeFilterDialog.bind(this),buttonModel:{cssClass:pn,content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:"Popup"!==this.parent.renderMode,target:s,close:this.removeFilterDialog.bind(this)}),this.dialogPopUp.isStringTemplate=!0,this.dialogPopUp.appendTo(o),("pivotfieldlist"===this.parent.moduleName&&this.parent.control.isPopupView?this.parent.control.pivotGridModule:this.parent.control).trigger("memberEditorOpen",{cancel:!1,fieldName:t,fieldMembers:this.parent.dataSourceSettings.allowMemberFilter?e:[],filterSetting:this.filterObject},s=>{s.cancel?(this.dialogPopUp.close(),this.dialogPopUp=void 0):(e=s.fieldMembers,this.allowExcelLikeFilter?(this.createTabMenu(e,i,t),(0,a.cn)([this.dialogPopUp.element],"e-excel-filter"),this.updateCheckedState(i)):(this.dialogPopUp.content=this.createTreeView(e,i,t),this.updateCheckedState(i)),(0,a.V7)(this.dialogPopUp.element,{visibility:"visible"}),this.allowExcelLikeFilter&&this.dialogPopUp.element.querySelector(".e-dlg-closeicon-btn").focus(),this.parent.control.pivotButtonModule.memberTreeView=this.parent.filterDialog.memberTreeView,this.memberTreeView.nodeChecked=this.parent.control.pivotButtonModule.nodeStateModified.bind(this.parent.control.pivotButtonModule),this.allMemberSelect.nodeChecked=this.parent.control.pivotButtonModule.nodeStateModified.bind(this.parent.control.pivotButtonModule))})}createTreeView(e,t,i){let s=(0,a.az)("div",{id:this.parent.parentID+"EditorDiv",className:nn+(this.allowExcelLikeFilter?" e-excelfilter":"")}),o=(0,a.az)("button",{id:this.parent.parentID+"_LevelDiv",className:"e-level-wrapper-class",attrs:{type:"button"}}),l=(0,a.az)("div",{id:this.parent.parentID+"_SearchDiv",attrs:{tabindex:"-1"},className:En}),r=this.parent.engineModule.fieldList[i].caption,n=(0,a.az)("input",{attrs:{type:"text",className:"e-editor-search-input"}}),h=this.parent.isDataOverflow?this.parent.currentTreeItems.length-this.parent.control.maxNodeLimitInMemberEditor+this.parent.control.localeObj.getConstant("editorDataLimitMsg"):"",p=(0,a.az)("div",{id:this.parent.parentID+"_LabelDiv",attrs:{tabindex:"-1",title:h},className:"e-editor-label-wrapper"});this.parent.editorLabelElement=(0,a.az)("label",{className:"e-editor-label"}),this.parent.editorLabelElement.innerText=h,p.style.display=this.parent.isDataOverflow?"block":"none",p.appendChild(this.parent.editorLabelElement),l.appendChild(n),this.createSortOptions(i,l,e);let u=(0,a.az)("div",{id:this.parent.parentID+"_AllDiv",attrs:{tabindex:"-1"},className:"e-select-all-wrapper"}),g=(0,a.az)("div",{className:"e-select-all"}),m=(0,a.az)("div",{className:"e-member-editor-container-outer-div"}),b=(0,a.az)("div",{className:"e-member-editor-container"}),f=(0,a.az)("div",{className:"e-member-prompt e-disable",innerHTML:this.parent.localeObj.getConstant("noMatches")});"olap"!==this.parent.dataType||!this.parent.control.loadOnDemandInMemberEditor||this.parent.engineModule.fieldList[i].isHierarchy||this.parent.engineModule.fieldList[i].isNamedSets||(l.appendChild(o),this.createLevelWrapper(o,i)),u.appendChild(g),s.appendChild(l),s.appendChild(u),s.appendChild(f),this.editorSearch=new c.g3({placeholder:this.parent.localeObj.getConstant("search")+" &#8220"+r+"&#8220",enableRtl:this.parent.enableRtl,cssClass:Fn,showClearButton:!0,change:e=>{if("olap"===this.parent.dataType)this.searchOlapTreeView(e,f,t);else{this.parent.eventBase.searchTreeNodes(e,this.memberTreeView,!1);let i=this.dialogPopUp.element;0===[].slice.call(this.memberTreeView.element.querySelectorAll("li")).length?(this.allMemberSelect.disableNodes([this.allMemberSelect.element.querySelector("li")]),i.querySelector(".e-ok-btn").setAttribute("disabled","disabled"),(0,a.IV)([f],Yr)):(this.allMemberSelect.enableNodes([this.allMemberSelect.element.querySelector("li")]),i.querySelector(".e-ok-btn").removeAttribute("disabled"),(0,a.cn)([f],Yr)),this.updateCheckedState(t)}}}),this.editorSearch.isStringTemplate=!0,this.editorSearch.appendTo(n);let y={"data-fieldName":i,"data-memberId":"all"},v=[{id:"all",name:this.parent.localeObj.getConstant("all"),isSelected:!0,htmlAttributes:y}];if(this.allMemberSelect=new d.LQ({fields:{dataSource:v,id:"id",text:"name",isChecked:"isSelected"},showCheckBox:!0,expandOn:"None",enableRtl:this.parent.enableRtl,nodeClicked:this.nodeCheck.bind(this,!0),keyPress:this.nodeCheck.bind(this,!0),nodeSelected:e=>{(0,a.IV)([e.node],"e-active"),e.cancel=!0}}),this.allMemberSelect.isStringTemplate=!0,!(0,a.le)(this.parent.currentTreeItems))for(let a=0;a<this.parent.currentTreeItems.length;a++)(this.parent.currentTreeItems[a].id.indexOf("\n")||this.parent.currentTreeItems[a].id.startsWith("\n"))&&(this.parent.currentTreeItems[a].id=this.parent.currentTreeItems[a].id.replace("\n"," "));return this.allMemberSelect.appendTo(g),m.appendChild(b),s.appendChild(m),this.memberTreeView=new d.LQ({fields:{dataSource:e,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},showCheckBox:!0,enableRtl:this.parent.enableRtl,nodeChecking:this.validateTreeNode.bind(this),nodeClicked:this.nodeCheck.bind(this,!1),keyPress:this.nodeCheck.bind(this,!1),nodeExpanding:this.updateChildNodes.bind(this),nodeSelected:e=>{(0,a.IV)([e.node],"e-active"),e.cancel=!0},expandOn:"None"}),this.memberTreeView.isStringTemplate=!0,this.memberTreeView.appendTo(b),s.appendChild(p),s}createSortOptions(e,t,i){if("pivot"===this.parent.dataType&&i&&i.length>0){let i=this.parent.engineModule.fieldList[e].sort,s=(0,a.az)("div",{className:"e-filter-sort e-btn-group"+(this.parent.enableRtl?" "+Hr:""),id:this.parent.element.id+"_Member_Sort"});this.parent.element.appendChild(s);let o=(0,a.az)("button",{className:("Ascending"===i?"e-active ":"")+Kr,id:this.parent.element.id+"_Sort_Ascend",attrs:{type:"button"}}),l=(0,a.az)("button",{className:("Descending"===i?"e-active ":"")+Kr,id:this.parent.element.id+"_Sort_Descend",attrs:{type:"button"}}),r=new m.zx({iconCss:"e-icons e-sort-ascend-icon",enableRtl:this.parent.enableRtl});r.appendTo(o),r=new m.zx({iconCss:"e-icons e-sort-descend-icon",enableRtl:this.parent.enableRtl}),r.appendTo(l),s.appendChild(o),s.appendChild(l),t.appendChild(s),this.unWireEvent(o,e),this.unWireEvent(l,e),this.wireEvent(o,e),this.wireEvent(l,e)}}createLevelWrapper(e,t){let i=this.parent.engineModule,s=i.fieldList[t].levels,o=i.fieldList[t].levelCount,l=[];for(let a=0,r=s.length;a<r;a++)l.push({id:s[a].id,text:s[a].name});this.dropMenu=new g.uw({cssClass:"e-level-drop e-caret-hide",items:l,iconCss:"e-icons e-dropdown-icon",disabled:o===s.length,enableRtl:this.parent.enableRtl,beforeOpen:e=>{let i=[].slice.call(e.element.querySelectorAll("li")),s=this.parent.engineModule.fieldList[t].levelCount;(0,a.IV)(i,Qn);for(let t=0,o=i.length;t<o;t++)t<s&&(0,a.cn)([i[t]],Qn)},select:e=>{let t,i=this.dialogPopUp.element.getAttribute("data-fieldname"),s=this.parent.engineModule;for(let o=0,a=l.length;o<a;o++)l[o].id===e.item.id&&(t=o);s.getFilterMembers(this.parent.dataSourceSettings,i,t+1,!1,!0)},close:()=>{let e=this.parent.engineModule;e.fieldList[t].levelCount===e.fieldList[t].levels.length?(this.dropMenu.disabled=!0,this.dropMenu.dataBind()):this.dropMenu.disabled=!1}}),this.dropMenu.appendTo(e)}searchOlapTreeView(e,t,i){let s=this;clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(function(){let o=s.parent.engineModule,l=s.dialogPopUp.element,r=l.getAttribute("data-fieldname"),n=s.parent.control.maxNodeLimitInMemberEditor?s.parent.control.maxNodeLimitInMemberEditor:5e3;if(o.fieldList[r].isHierarchy)s.parent.eventBase.searchTreeNodes(e,s.memberTreeView,!1,!0);else{if(s.dropMenu.disabled=!(!s.dropMenu||""===e.value),s.parent.control.loadOnDemandInMemberEditor){let t=o.fieldList[r].levelCount?o.fieldList[r].levelCount:1;o.getSearchMembers(s.parent.dataSourceSettings,r,e.value.toLowerCase(),n,!1,t)}else o.getSearchMembers(s.parent.dataSourceSettings,r,e.value.toLowerCase(),n,!0);s.parent.eventBase.searchTreeNodes(e,s.memberTreeView,!1,!1)}0===[].slice.call(s.memberTreeView.element.querySelectorAll("li")).length?(s.allMemberSelect.disableNodes([s.allMemberSelect.element.querySelector("li")]),l.querySelector(".e-ok-btn").setAttribute("disabled","disabled"),(0,a.IV)([t],Yr)):(s.allMemberSelect.enableNodes([s.allMemberSelect.element.querySelector("li")]),l.querySelector(".e-ok-btn").removeAttribute("disabled"),(0,a.cn)([t],Yr)),s.updateCheckedState(i)},500)}nodeCheck(e,t){let i=[t.node];if(t.event.target.classList.contains("e-fullrow")||"Enter"===t.event.key){let s=e?this.allMemberSelect:this.memberTreeView;"true"===s.getNode(t.node).isChecked?s.uncheckAll(i):s.checkAll(i)}else 38!==t.event.keyCode||e||((0,a.IV)(this.memberTreeView.element.querySelectorAll("li.e-prev-active-node"),"e-prev-active-node"),(0,a.cn)(i,"e-prev-active-node"))}applySorting(e,t){let i=(0,a.oq)(t.target,".e-member-sort");if(i){let t=[].slice.call((0,a.oq)(i,".e-filter-sort").querySelectorAll(".e-member-sort"));i.querySelector(".e-sort-ascend-icon")&&!i.classList.contains(Mn)?(this.updateFilterMembers("Ascending",e),(0,a.cn)([i],Mn),(0,a.IV)([t[1]],Mn)):i.querySelector(".e-sort-descend-icon")&&!i.classList.contains(Mn)?(this.updateFilterMembers("Descending",e),(0,a.cn)([i],Mn),(0,a.IV)([t[0]],Mn)):(this.updateFilterMembers("None",e),(0,a.IV)(t,Mn))}}updateFilterMembers(e,t){let i="None"===e?br.getClonedData(this.parent.engineModule.fieldList[t].dateMember):[...this.parent.currentTreeItems];this.parent.currentTreeItems=[],this.parent.searchTreeItems=[];let s=[];i="Ascending"===e?i.sort((e,t)=>e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0):"Descending"===e?i.sort((e,t)=>e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0):i;let o=t.replace(/[^a-zA-Z0-9 ]/g,"_");for(let l=0,a=i.length;l<a;l++){if("None"===e){let e=(this.parent.isDateField?i[l].formattedText:i[l].actualText).toString(),a={id:o+"_"+(l+1),htmlAttributes:{"data-fieldName":t,"data-memberId":i[l].actualText.toString()},actualText:i[l].actualText,name:e,isSelected:this.parent.currentTreeItemsPos[i[l].actualText].isSelected};this.parent.currentTreeItems.push(a),""!==this.editorSearch.value?a.name.toLowerCase().indexOf(this.editorSearch.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(a),s.push(a)):(this.parent.searchTreeItems.push(a),s.push(a))}else this.parent.currentTreeItems.push(i[l]),""!==this.editorSearch.value?i[l].name.toLowerCase().indexOf(this.editorSearch.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(i[l]),s.push(i[l])):(this.parent.searchTreeItems.push(i[l]),s.push(i[l]));this.parent.currentTreeItemsPos[i[l].actualText].index=l}this.memberTreeView.fields={dataSource:s.slice(0,this.memberTreeView.fields.dataSource.length),id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},this.memberTreeView.dataBind()}updateChildNodes(e){if("olap"===this.parent.dataType){let t=this.parent.engineModule,i=e.node.getAttribute("data-fieldname"),s=t.fieldList[i],o=[];if(s&&s.filterMembers.length>0&&!this.isSearchEnabled&&!s.members[e.nodeData.id].isNodeExpand){let l=[];for(let t of s.filterMembers)t.pid===e.nodeData.id.toString()&&l.push(t);0===l.length&&(s.childMembers=[],t.getChildMembers(this.parent.dataSourceSettings,e.nodeData.id.toString(),i),l=s.childMembers,s.childMembers=[]);let r=br.getClonedData(l),n=this.memberTreeView.fields.dataSource,h=!1;(0,a.le)(this.filterObject)||(h="Include"===this.filterObject.type,o=this.filterObject.items?this.filterObject.items:[]),r=this.updateChildData(h,r,o,i,e.nodeData),r=this.parent.eventBase.sortOlapFilterData(r,t.fieldList[i].sort);for(let e of r)n.push(e);s.members[e.nodeData.id].isNodeExpand=!0,this.memberTreeView.addNodes(r,e.node)}}}updateChildData(e,t,i,s,o){let l=Object.keys(this.parent.currentTreeItemsPos).length,a=this.parent.engineModule.fieldList[s],r=[],n=1;for(let h of t){let e=h,t=h.id.toString();a.members[t].isNodeExpand=!1,h.isSelected="true"===o.isChecked,n<=this.parent.control.maxNodeLimitInMemberEditor&&r.push(e),this.parent.currentTreeItems.push(e),this.parent.searchTreeItems.push(e),this.parent.currentTreeItemsPos[t]={index:l,isSelected:e.isSelected},l++,n++}return this.parent.isDataOverflow=!1,r}createTabMenu(e,t,i){let s=(0,a.az)("div",{className:"e-filter-tab-wrapper"});this.dialogPopUp.content=s,this.dialogPopUp.dataBind();let o=["Label","Value","Include","Exclude"],l="((-|\\+)?[0-9]+(\\.[0-9]+)?)+",r=Object.keys(this.parent.engineModule.fieldList[i].members)[0],n=this.parent.engineModule.fieldList[i].type,h=br.getFieldByName(i,this.parent.dataSourceSettings.formatSettings),c=[{header:{text:this.parent.localeObj.getConstant("member"),iconCss:this.filterObject&&o.indexOf(this.filterObject.type)>1?xn:""},content:this.createTreeView(e,t,i)}];for(let a of o)if("Label"===a&&this.parent.dataSourceSettings.allowLabelFilter||"Value"===a&&this.parent.dataSourceSettings.allowValueFilter){let e="Label"===a&&r&&r.match(l)&&r.match(l)[0].length===r.length&&"number"===n?"Number":"Label"===a&&r&&"Invalid Date"!==new Date(r).toString()&&(h&&h.type||this.filterObject&&"Date"===this.filterObject.type)?"Date":a,t={header:{text:this.parent.localeObj.getConstant("Number"===e?"label":e.toLowerCase()),iconCss:this.filterObject&&this.filterObject.type===e?xn:""},content:this.createCustomFilter(i,this.filterObject&&this.filterObject.type===e?this.filterObject:void 0,e.toLowerCase())};c.push(t)}let p=this.filterObject?["Label","Date","Number"].indexOf(this.filterObject.type)>=0?1:"Value"===this.filterObject.type?this.parent.dataSourceSettings.allowLabelFilter&&this.parent.dataSourceSettings.allowValueFilter?2:1:0:0;p=this.parent.dataSourceSettings.allowMemberFilter||0!==p?p:1,this.tabObj=new d.OK({heightAdjustMode:"Auto",items:c,height:"100%",selectedItem:p,enableRtl:this.parent.enableRtl}),this.tabObj.isStringTemplate=!0,this.tabObj.appendTo(s),this.parent.dataSourceSettings.allowMemberFilter||this.tabObj.hideTab(0),p>0&&(0,a.cn)([this.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===p&&this.parent.dataSourceSettings.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab")}createCustomFilter(e,t,i){let s=[],o=[],l=[],r=this.parent.dataSourceSettings.values,n="DoesNotEquals",h=0,d=0,c={label:["Equals","DoesNotEquals","BeginWith","DoesNotBeginWith","EndsWith","DoesNotEndsWith","Contains","DoesNotContains","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"],date:["Equals","DoesNotEquals","Before","BeforeOrEqualTo","After","AfterOrEqualTo","Between","NotBetween"],value:["Equals","DoesNotEquals","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"]},p=["Between","NotBetween"],u="label"===i?c.label:"date"===i?c.date:c.value;for(let a of u)n=t&&a===t.condition?u.indexOf(t.condition)>=0?t.condition:u[0]:n,s.push({value:a,text:this.parent.localeObj.getConstant(a)});let g=r.length;for(;g--;)o.unshift({value:r[g].name,text:r[g].caption?r[g].caption:r[g].name}),h=t&&"Value"===t.type&&t.measure===r[g].name&&t.condition===n?g:h;if("olap"===this.parent.dataType){let s=this.parent.engineModule,o=s.fieldList[e].levels;if(this.parent.engineModule.fieldList[e].isHierarchy){let o,a=this.parent.engineModule.fieldListData;for(let t of a)if(t&&t.pid===e){o=t;break}l.push({value:o?o.id:e,text:o?o.caption:s.fieldList[e].name}),d=0,t&&t.name===e&&t.type.toLowerCase()===i&&(l[l.length-1].iconClass="e-icons e-selected-level-icon")}else for(let a=0,r=o.length;a<r;a++){d=t&&t.selectedField===o[a].id?a:d,l.push({value:o[a].id,text:o[a].name});for(let t of this.parent.dataSourceSettings.filterSettings)if(t.name===e&&t.selectedField===o[a].id&&t.type.toLowerCase()===i){l[l.length-1].iconClass="e-icons e-selected-level-icon";break}}}let m=(0,a.az)("div",{className:"e-filter-div-content e-"+(["date","number"].indexOf(i)>=0?"label":i)+"-filter",id:this.parent.parentID+"_"+i+"_filter_div_content",attrs:{"data-type":i,"data-fieldName":e,"data-operator":n,"data-selectedField":"olap"===this.parent.dataType&&l.length>0?l[d].value.toString():"","data-measure":this.parent.dataSourceSettings.values.length>0?this.parent.dataSourceSettings.values[h].name:"","data-value1":t&&n===t.condition&&t.value1?t.value1.toString():"","data-value2":t&&n===t.condition&&t.value2?t.value2.toString():""}}),b=(0,a.az)("div",{className:"e-filter-text-div",innerHTML:this.parent.localeObj.getConstant(i+"TextContent")}),f=(0,a.az)("div",{className:"e-between-text-div "+(-1===p.indexOf(n)?Yr:""),innerHTML:this.parent.localeObj.getConstant("And")}),y=(0,a.az)("div",{className:"e-separator-div"}),v=(0,a.az)("div",{className:"e-filter-option-wrapper-1"}),S=(0,a.az)("div",{className:"e-level-option-wrapper "+("olap"===this.parent.dataType?"":Yr)}),x=(0,a.az)("div",{className:"e-measure-option-wrapper "+(["label","date","number"].indexOf(i)>=0?Yr:"")}),w=(0,a.az)("div",{className:"e-condition-option-wrapper"}),C=(0,a.az)("div",{className:"e-filter-option-wrapper-2"}),M=(0,a.az)("div",{id:this.parent.parentID+"_"+i+"_level_option_wrapper"}),T=(0,a.az)("div",{id:this.parent.parentID+"_"+i+"_measure_option_wrapper"}),L=(0,a.az)("div",{id:this.parent.parentID+"_"+i+"_contition_option_wrapper"}),A=(0,a.az)("div",{className:"e-filter-input-div-1"}),D=(0,a.az)("div",{className:"e-filter-input-div-2 "+(-1===p.indexOf(n)?Yr:"")}),R=(0,a.az)("input",{id:this.parent.parentID+"_"+i+"_input_option_1",attrs:{type:"text"}}),I=(0,a.az)("input",{id:this.parent.parentID+"_"+i+"_input_option_2",attrs:{type:"text"}});return A.appendChild(R),D.appendChild(I),S.appendChild(M),S.appendChild(y.cloneNode(!0)),x.appendChild(T),x.appendChild(y),w.appendChild(L),v.appendChild(S),v.appendChild(x),v.appendChild(w),C.appendChild(A),C.appendChild(f),C.appendChild(D),this.createElements(t,p,T,L,R,I,o,s,h,n,i,M,l,d),m.appendChild(b),m.appendChild(v),m.appendChild(C),m}createElements(e,t,i,s,o,l,r,n,d,g,m,b,f,y){let v=this;if("olap"===this.parent.dataType){let e=new p.NB({dataSource:f,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text",iconCss:"iconClass"},index:y,cssClass:"e-level-options",width:"100%",change:e=>{let t=v.dialogPopUp.element.querySelector(".e-selected-tab"),i=t.getAttribute("data-fieldName"),s=t.getAttribute("data-type");if(!(0,a.le)(t)){let a;v.updateInputValues(t,s,o,l),(0,h.dbf)(t,{"data-selectedField":e.value});for(let t of v.parent.dataSourceSettings.filterSettings)if(t.name===i&&t.selectedField===e.value){a=t;break}if(a){let e,t;"value"===s&&a.measure&&""!==a.measure&&(S.value=a.measure?a.measure:r[0].value),x.value=a.condition&&a.condition?a.condition:"DoesNotEquals","value"===s?(e=o.ej2_instances[0],t=l.ej2_instances[0],e&&(e.value=a.value1?parseInt(a.value1,10):void 0),t&&(t.value=a.value2?parseInt(a.value2,10):void 0)):(e=o.ej2_instances[0],t=l.ej2_instances[0],e&&(e.value=a.value1?a.value1:""),t&&(t.value=a.value2?a.value2:""))}v.updateInputValues(t,s,o,l)}}});e.isStringTemplate=!0,e.appendTo(b)}let S=new p.NB({dataSource:r,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},index:d,cssClass:wn,width:"100%",change:e=>{let t=v.dialogPopUp.element.querySelector(".e-selected-tab");(0,a.le)(t)||(v.updateInputValues(t,m,o,l),(0,h.dbf)(t,{"data-measure":e.value}))}});S.isStringTemplate=!0,S.appendTo(i);let x=new p.NB({dataSource:n,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:g,cssClass:Cn,width:"100%",change:e=>{let i=v.dialogPopUp.element.querySelector(".e-selected-tab");if(!(0,a.le)(i)){v.updateInputValues(i,m,o,l);let s=["e-between-text-div","e-filter-input-div-2"];for(let o of s)t.indexOf(e.value)>=0?(0,a.IV)([i.querySelector("."+o)],Yr):(0,a.cn)([i.querySelector("."+o)],Yr);(0,h.dbf)(i,{"data-operator":e.value})}}});if(x.isStringTemplate=!0,x.appendTo(s),"date"===m){let t=new u.xZ({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy hh:mm:ss a",showClearButton:!0,value:e&&g===e.condition?"string"==typeof e.value1?new Date(e.value1):e.value1:null,change:e=>{let t=v.dialogPopUp.element.querySelector(".e-selected-tab");(0,a.le)(t)||(0,h.dbf)(t,{"data-value1":e.value,"data-value2":i.value})},width:"100%"}),i=new u.xZ({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy hh:mm:ss a",showClearButton:!0,value:e&&g===e.condition?"string"==typeof e.value2?new Date(e.value2):e.value2:null,change:e=>{let i=v.dialogPopUp.element.querySelector(".e-selected-tab");(0,a.le)(i)||(0,h.dbf)(i,{"data-value1":t.value,"data-value2":e.value})},width:"100%"});t.isStringTemplate=!0,t.appendTo(o),i.isStringTemplate=!0,i.appendTo(l)}else if("value"===m){let t=new c.No({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,format:"###.##",value:e&&g===e.condition?parseInt(e.value1,10):void 0,change:e=>{let t=v.dialogPopUp.element.querySelector(".e-selected-tab");(0,a.le)(t)||(0,h.dbf)(t,{"data-value1":e.value?e.value.toString():"0","data-value2":i.value?i.value.toString():"0"})},width:"100%"}),i=new c.No({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,format:"###.##",value:e&&g===e.condition?parseInt(e.value2,10):void 0,change:e=>{let i=v.dialogPopUp.element.querySelector(".e-selected-tab");(0,a.le)(i)||(0,h.dbf)(i,{"data-value1":t.value?t.value.toString():"0","data-value2":e.value?e.value.toString():"0"})},width:"100%"});t.isStringTemplate=!0,t.appendTo(o),i.isStringTemplate=!0,i.appendTo(l)}else{let t=new c.g3({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,value:e&&g===e.condition?e.value1:"",change:e=>{let t=v.dialogPopUp.element.querySelector(".e-selected-tab");(0,a.le)(t)||(0,h.dbf)(t,{"data-value1":e.value,"data-value2":i.value})},width:"100%"}),i=new c.g3({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,value:e&&g===e.condition?e.value2:"",change:e=>{let i=v.dialogPopUp.element.querySelector(".e-selected-tab");(0,a.le)(i)||(0,h.dbf)(i,{"data-value1":t.value,"data-value2":e.value})},width:"100%"});t.isStringTemplate=!0,t.appendTo(o),i.isStringTemplate=!0,i.appendTo(l)}}updateInputValues(e,t,i,s){let o,l;if("date"===t){let e=i.ej2_instances[0],t=s.ej2_instances[0];o=(0,a.le)(e.value)?"":e.value.toString(),l=(0,a.le)(t.value)?"":t.value.toString()}else o=i.ej2_instances[0].value,l=s.ej2_instances[0].value;(0,h.dbf)(e,{"data-value1":o,"data-value2":l})}validateTreeNode(e){e.node.classList.contains(Yr)&&(e.cancel=!0)}updateCheckedState(e){let t=this.dialogPopUp.element;(0,h.dbf)(t,{role:"menu","aria-haspopup":"true"});let i=[].slice.call(this.memberTreeView.element.querySelectorAll("li")),s=t.getAttribute("data-fieldname"),o=this.getUnCheckedNodes(s),l=this.getCheckedNodes(s),r=this.allMemberSelect.element.querySelector("li").querySelector("span.e-frame");i.length>0?l>0?(o>0?((0,a.IV)([r],hn),(0,a.cn)([r],dn)):0===o&&((0,a.IV)([r],dn),(0,a.cn)([r],hn)),this.dialogPopUp.buttons[0].buttonModel.disabled=!1,t.querySelector(".e-ok-btn").removeAttribute("disabled")):o>0&&0===l&&((0,a.IV)([r],[hn,dn]),this.getCheckedNodes(s)===l&&(this.dialogPopUp.buttons[0].buttonModel.disabled=!0,t.querySelector(".e-ok-btn").setAttribute("disabled","disabled"))):(this.dialogPopUp.buttons[0].buttonModel.disabled=!0,t.querySelector(".e-ok-btn").setAttribute("disabled","disabled"))}getCheckedNodes(e){let t=this.parent.engineModule,i=[],s=[];if("olap"===this.parent.dataType&&t&&!t.fieldList[e].isHierarchy)return i=this.memberTreeView.getAllCheckedNodes(),i.length;for(let o of this.parent.searchTreeItems)o.isSelected&&s.push(o);return s.length}getUnCheckedNodes(e){let t=[],i=[],s=this.parent.engineModule;if("olap"===this.parent.dataType&&s&&!s.fieldList[e].isHierarchy)return i=this.memberTreeView.getAllCheckedNodes(),this.memberTreeView.fields.dataSource.length-i.length;for(let o of this.parent.searchTreeItems)o.isSelected||t.push(o);return t.length}isExcelFilter(e){let t=!1;for(let i of this.parent.dataSourceSettings.filters)if(i.name===e){t=!0;break}return!(t||!this.parent.dataSourceSettings.allowLabelFilter&&!this.parent.dataSourceSettings.allowValueFilter)}getFilterObject(e){let t=br.getFilterItemByName(e,br.cloneFilterSettings(this.parent.dataSourceSettings.filterSettings));if(t&&(["Label","Date","Number"].indexOf(t.type)>=0&&this.parent.dataSourceSettings.allowLabelFilter||"Value"===t.type&&this.parent.dataSourceSettings.allowValueFilter||["Include","Exclude"].indexOf(t.type)>=0&&this.parent.eventBase.isValidFilterItemsAvail(e,t)))return t}wireEvent(e,t){a.bi.add(e,"click",this.applySorting.bind(this,t),this)}unWireEvent(e,t){a.bi.remove(e,"click",this.applySorting)}closeFilterDialog(){this.allowExcelLikeFilter&&this.tabObj&&!this.tabObj.isDestroyed&&this.tabObj.destroy(),this.dropMenu&&!this.dropMenu.isDestroyed&&this.dropMenu.destroy(),document.getElementById(this.parent.parentID+"_LevelDiv-popup")&&(0,a.Od)(document.getElementById(this.parent.parentID+"_LevelDiv-popup")),this.dialogPopUp.close()}removeFilterDialog(){this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&this.dialogPopUp.destroy(),document.getElementById(this.parent.parentID+"_EditorTreeView")&&(0,a.Od)(document.getElementById(this.parent.parentID+"_EditorTreeView"))}}class Th{constructor(e){return this.currentTreeItems=[],this.savedTreeFilterPos={},this.currentTreeItemsPos={},this.searchTreeItems=[],this.isDataOverflow=!1,this.isDateField=!1,this.element=e.element,this.moduleName=e.moduleName,this.dataSourceSettings=e.dataSourceSettings,this.engineModule=e.pivotEngine,this.enableRtl=e.enableRtl,this.isAdaptive=e.isAdaptive,this.renderMode=e.renderMode,this.parentID=e.id,this.localeObj=e.localeObj,this.dataType=e.dataType,this.nodeStateModified=new xh(this),this.dataSourceUpdate=new wh(this),this.eventBase=new Sh(this),this.filterDialog=new Mh(this),this.errorDialog=new Ch(this),this.keyboardModule=new vh(this),this}destroy(){this.keyboardModule&&(this.keyboardModule.destroy(),this.keyboardModule=null)}}class Lh{constructor(e){this.parent=e,this.parent.commonModule=this,this.addEventListener()}getModuleName(){return"common"}initiateCommonModule(){if(this.parent.pivotCommon)this.parent.pivotCommon.element=this.parent.element,this.parent.pivotCommon.engineModule="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.parent.pivotCommon.parentID=this.parent.element.id,this.parent.pivotCommon.dataSourceSettings=this.parent.dataSourceSettings.properties?this.parent.dataSourceSettings.properties:this.parent.dataSourceSettings,this.parent.pivotCommon.moduleName=this.parent.getModuleName(),this.parent.pivotCommon.enableRtl=this.parent.enableRtl,this.parent.pivotCommon.isAdaptive=a.AR.isDevice,this.parent.pivotCommon.renderMode="Popup",this.parent.pivotCommon.localeObj=this.parent.localeObj,this.parent.pivotCommon.dataType=this.parent.dataType;else{let e={pivotEngine:"olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,dataSourceSettings:this.parent.dataSourceSettings.properties?this.parent.dataSourceSettings.properties:this.parent.dataSourceSettings,id:this.parent.element.id,element:this.parent.element,moduleName:this.parent.getModuleName(),enableRtl:this.parent.enableRtl,isAdaptive:a.AR.isDevice,renderMode:"Popup",localeObj:this.parent.localeObj,dataType:this.parent.dataType};this.parent.pivotCommon=new Th(e)}this.parent.pivotCommon.control=this.parent}addEventListener(){this.handlers={load:this.initiateCommonModule},this.parent.isDestroyed||(this.parent.on(Fr,this.handlers.load,this),this.parent.on(Or,this.handlers.load,this))}removeEventListener(){this.parent.isDestroyed||(this.parent.off(Fr,this.handlers.load),this.parent.off(Or,this.handlers.load))}destroy(){this.removeEventListener(),this.parent.pivotCommon&&(this.parent.pivotCommon.destroy(),this.parent.pivotCommon=null)}}var Ah=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class Dh extends a.rt{}Ah([(0,a.Z9)()],Dh.prototype,"name",void 0),Ah([(0,a.Z9)()],Dh.prototype,"caption",void 0),Ah([(0,a.Z9)("Sum")],Dh.prototype,"type",void 0),Ah([(0,a.Z9)()],Dh.prototype,"axis",void 0),Ah([(0,a.Z9)(!1)],Dh.prototype,"showNoDataItems",void 0),Ah([(0,a.Z9)()],Dh.prototype,"baseField",void 0),Ah([(0,a.Z9)()],Dh.prototype,"baseItem",void 0),Ah([(0,a.Z9)(!0)],Dh.prototype,"showSubTotals",void 0),Ah([(0,a.Z9)(!1)],Dh.prototype,"isNamedSet",void 0),Ah([(0,a.Z9)(!1)],Dh.prototype,"isCalculatedField",void 0),Ah([(0,a.Z9)(!0)],Dh.prototype,"showFilterIcon",void 0),Ah([(0,a.Z9)(!0)],Dh.prototype,"showSortIcon",void 0),Ah([(0,a.Z9)(!0)],Dh.prototype,"showRemoveIcon",void 0),Ah([(0,a.Z9)(!0)],Dh.prototype,"showValueTypeIcon",void 0),Ah([(0,a.Z9)(!0)],Dh.prototype,"showEditIcon",void 0),Ah([(0,a.Z9)(!0)],Dh.prototype,"allowDragAndDrop",void 0),Ah([(0,a.Z9)()],Dh.prototype,"dataType",void 0);class Rh extends a.rt{}Ah([(0,a.Z9)()],Rh.prototype,"backgroundColor",void 0),Ah([(0,a.Z9)()],Rh.prototype,"color",void 0),Ah([(0,a.Z9)()],Rh.prototype,"fontFamily",void 0),Ah([(0,a.Z9)()],Rh.prototype,"fontSize",void 0);class Ih extends a.rt{}Ah([(0,a.Z9)()],Ih.prototype,"name",void 0),Ah([(0,a.Z9)("Include")],Ih.prototype,"type",void 0),Ah([(0,a.Z9)()],Ih.prototype,"items",void 0),Ah([(0,a.Z9)("DoesNotEquals")],Ih.prototype,"condition",void 0),Ah([(0,a.Z9)()],Ih.prototype,"value1",void 0),Ah([(0,a.Z9)()],Ih.prototype,"value2",void 0),Ah([(0,a.Z9)()],Ih.prototype,"measure",void 0),Ah([(0,a.Z9)(1)],Ih.prototype,"levelCount",void 0),Ah([(0,a.Z9)()],Ih.prototype,"selectedField",void 0);class Ph extends a.rt{}Ah([(0,a.Z9)()],Ph.prototype,"measure",void 0),Ah([(0,a.Z9)()],Ph.prototype,"label",void 0),Ah([(0,a.Z9)()],Ph.prototype,"conditions",void 0),Ah([(0,a.Z9)()],Ph.prototype,"value1",void 0),Ah([(0,a.Z9)()],Ph.prototype,"value2",void 0),Ah([(0,a.Z9)()],Ph.prototype,"style",void 0),Ah([(0,a.Z9)(!0)],Ph.prototype,"applyGrandTotals",void 0);class kh extends a.rt{}Ah([(0,a.Z9)()],kh.prototype,"name",void 0),Ah([(0,a.Z9)("Ascending")],kh.prototype,"order",void 0);class Eh extends a.rt{}Ah([(0,a.Z9)()],Eh.prototype,"name",void 0),Ah([(0,a.Z9)()],Eh.prototype,"minimumFractionDigits",void 0),Ah([(0,a.Z9)()],Eh.prototype,"maximumFractionDigits",void 0),Ah([(0,a.Z9)()],Eh.prototype,"minimumSignificantDigits",void 0),Ah([(0,a.Z9)()],Eh.prototype,"maximumSignificantDigits",void 0),Ah([(0,a.Z9)(!0)],Eh.prototype,"useGrouping",void 0),Ah([(0,a.Z9)()],Eh.prototype,"skeleton",void 0),Ah([(0,a.Z9)()],Eh.prototype,"type",void 0),Ah([(0,a.Z9)()],Eh.prototype,"currency",void 0),Ah([(0,a.Z9)()],Eh.prototype,"minimumIntegerDigits",void 0),Ah([(0,a.Z9)()],Eh.prototype,"format",void 0);class Fh extends a.rt{}Ah([(0,a.Z9)()],Fh.prototype,"name",void 0),Ah([(0,a.Z9)()],Fh.prototype,"groupInterval",void 0),Ah([(0,a.Z9)()],Fh.prototype,"startingAt",void 0),Ah([(0,a.Z9)()],Fh.prototype,"endingAt",void 0),Ah([(0,a.Z9)("Date")],Fh.prototype,"type",void 0),Ah([(0,a.Z9)()],Fh.prototype,"rangeInterval",void 0),Ah([(0,a.Z9)()],Fh.prototype,"caption",void 0),Ah([(0,a.Z9)()],Fh.prototype,"customGroups",void 0);class Oh extends a.rt{}Ah([(0,a.Z9)()],Oh.prototype,"groupName",void 0),Ah([(0,a.Z9)([])],Oh.prototype,"items",void 0);class Nh extends a.rt{}Ah([(0,a.Z9)()],Nh.prototype,"name",void 0),Ah([(0,a.Z9)()],Nh.prototype,"formula",void 0),Ah([(0,a.Z9)()],Nh.prototype,"hierarchyUniqueName",void 0),Ah([(0,a.Z9)()],Nh.prototype,"formatString",void 0);class zh extends a.rt{}Ah([(0,a.Z9)()],zh.prototype,"name",void 0),Ah([(0,a.Z9)()],zh.prototype,"items",void 0),Ah([(0,a.Z9)()],zh.prototype,"delimiter",void 0);class _h extends a.rt{}Ah([(0,a.Z9)()],_h.prototype,"headerText",void 0),Ah([(0,a.Z9)(".")],_h.prototype,"headerDelimiter",void 0),Ah([(0,a.Z9)("None")],_h.prototype,"sortOrder",void 0),Ah([(0,a.Z9)()],_h.prototype,"measure",void 0);class Bh extends a.rt{}Ah([(0,a.Z9)()],Bh.prototype,"userName",void 0),Ah([(0,a.Z9)()],Bh.prototype,"password",void 0);class Zh extends a.rt{}Ah([(0,a.Z9)("Local")],Zh.prototype,"mode",void 0),Ah([(0,a.Z9)()],Zh.prototype,"catalog",void 0),Ah([(0,a.Z9)()],Zh.prototype,"cube",void 0),Ah([(0,a.Z9)("Relational")],Zh.prototype,"providerType",void 0),Ah([(0,a.Z9)()],Zh.prototype,"url",void 0),Ah([(0,a.Z9)(1033)],Zh.prototype,"localeIdentifier",void 0),Ah([(0,a.Z9)()],Zh.prototype,"dataSource",void 0),Ah([(0,a.FE)([],Dh)],Zh.prototype,"rows",void 0),Ah([(0,a.FE)([],Dh)],Zh.prototype,"columns",void 0),Ah([(0,a.FE)([],Dh)],Zh.prototype,"values",void 0),Ah([(0,a.FE)([],Dh)],Zh.prototype,"filters",void 0),Ah([(0,a.FE)([],Dh)],Zh.prototype,"fieldMapping",void 0),Ah([(0,a.Z9)([])],Zh.prototype,"excludeFields",void 0),Ah([(0,a.Z9)(!1)],Zh.prototype,"expandAll",void 0),Ah([(0,a.Z9)("column")],Zh.prototype,"valueAxis",void 0),Ah([(0,a.FE)([],Ih)],Zh.prototype,"filterSettings",void 0),Ah([(0,a.FE)([],kh)],Zh.prototype,"sortSettings",void 0),Ah([(0,a.Z9)(!0)],Zh.prototype,"enableSorting",void 0),Ah([(0,a.Z9)("JSON")],Zh.prototype,"type",void 0),Ah([(0,a.Z9)(!0)],Zh.prototype,"allowMemberFilter",void 0),Ah([(0,a.Z9)(!1)],Zh.prototype,"allowLabelFilter",void 0),Ah([(0,a.Z9)(!1)],Zh.prototype,"allowValueFilter",void 0),Ah([(0,a.Z9)(!0)],Zh.prototype,"showSubTotals",void 0),Ah([(0,a.Z9)(!0)],Zh.prototype,"showRowSubTotals",void 0),Ah([(0,a.Z9)(!0)],Zh.prototype,"showColumnSubTotals",void 0),Ah([(0,a.Z9)(!0)],Zh.prototype,"showGrandTotals",void 0),Ah([(0,a.Z9)(!0)],Zh.prototype,"showRowGrandTotals",void 0),Ah([(0,a.Z9)(!0)],Zh.prototype,"showColumnGrandTotals",void 0),Ah([(0,a.Z9)(!1)],Zh.prototype,"alwaysShowValueHeader",void 0),Ah([(0,a.Z9)(!0)],Zh.prototype,"showHeaderWhenEmpty",void 0),Ah([(0,a.Z9)(!0)],Zh.prototype,"showAggregationOnValueField",void 0),Ah([(0,a.FE)([],Eh)],Zh.prototype,"formatSettings",void 0),Ah([(0,a.FE)([],zh)],Zh.prototype,"drilledMembers",void 0),Ah([(0,a.Zz)({},_h)],Zh.prototype,"valueSortSettings",void 0),Ah([(0,a.FE)([],Nh)],Zh.prototype,"calculatedFieldSettings",void 0),Ah([(0,a.FE)([],Ph)],Zh.prototype,"conditionalFormatSettings",void 0),Ah([(0,a.Z9)()],Zh.prototype,"emptyCellsTextContent",void 0),Ah([(0,a.FE)([],Fh)],Zh.prototype,"groupSettings",void 0),Ah([(0,a.Zz)({},Bh)],Zh.prototype,"authentication",void 0);var Vh=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class jh extends a.rt{}Vh([(0,a.Z9)("Row")],jh.prototype,"mode",void 0),Vh([(0,a.Z9)("Flow")],jh.prototype,"cellSelectionMode",void 0),Vh([(0,a.Z9)("Single")],jh.prototype,"type",void 0),Vh([(0,a.Z9)(!1)],jh.prototype,"checkboxOnly",void 0),Vh([(0,a.Z9)(!1)],jh.prototype,"persistSelection",void 0),Vh([(0,a.Z9)("Default")],jh.prototype,"checkboxMode",void 0),Vh([(0,a.Z9)(!1)],jh.prototype,"enableSimpleMultiRowSelection",void 0);class Hh extends a.rt{}Vh([(0,a.Z9)("auto")],Hh.prototype,"height",void 0),Vh([(0,a.Z9)("auto")],Hh.prototype,"width",void 0),Vh([(0,a.Z9)("Both")],Hh.prototype,"gridLines",void 0),Vh([(0,a.Z9)(!1)],Hh.prototype,"allowTextWrap",void 0),Vh([(0,a.Z9)(!1)],Hh.prototype,"allowReordering",void 0),Vh([(0,a.Z9)(!0)],Hh.prototype,"allowResizing",void 0),Vh([(0,a.Z9)(!0)],Hh.prototype,"allowAutoResizing",void 0),Vh([(0,a.Z9)(null)],Hh.prototype,"rowHeight",void 0),Vh([(0,a.Z9)(110)],Hh.prototype,"columnWidth",void 0),Vh([(0,a.Z9)("Ellipsis")],Hh.prototype,"clipMode",void 0),Vh([(0,a.Z9)(!1)],Hh.prototype,"allowSelection",void 0),Vh([(0,a.Z9)(-1)],Hh.prototype,"selectedRowIndex",void 0),Vh([(0,a.Z9)({mode:"Row",cellSelectionMode:"Flow",type:"Single"})],Hh.prototype,"selectionSettings",void 0),Vh([(0,a.Z9)({wrapMode:"Both"})],Hh.prototype,"textWrapSettings",void 0),Vh([(0,a.Z9)("AllPages")],Hh.prototype,"printMode",void 0),Vh([(0,a.Z9)()],Hh.prototype,"contextMenuItems",void 0),Vh([(0,a.ju)()],Hh.prototype,"beforeCopy",void 0),Vh([(0,a.ju)()],Hh.prototype,"printComplete",void 0),Vh([(0,a.ju)()],Hh.prototype,"beforePrint",void 0),Vh([(0,a.ju)()],Hh.prototype,"beforePdfExport",void 0),Vh([(0,a.ju)()],Hh.prototype,"beforeExcelExport",void 0),Vh([(0,a.ju)()],Hh.prototype,"contextMenuOpen",void 0),Vh([(0,a.ju)()],Hh.prototype,"contextMenuClick",void 0),Vh([(0,a.ju)()],Hh.prototype,"queryCellInfo",void 0),Vh([(0,a.ju)()],Hh.prototype,"headerCellInfo",void 0),Vh([(0,a.ju)()],Hh.prototype,"rowSelecting",void 0),Vh([(0,a.ju)()],Hh.prototype,"rowSelected",void 0),Vh([(0,a.ju)()],Hh.prototype,"rowDeselecting",void 0),Vh([(0,a.ju)()],Hh.prototype,"rowDeselected",void 0),Vh([(0,a.ju)()],Hh.prototype,"cellSelecting",void 0),Vh([(0,a.ju)()],Hh.prototype,"cellSelected",void 0),Vh([(0,a.ju)()],Hh.prototype,"cellDeselecting",void 0),Vh([(0,a.ju)()],Hh.prototype,"cellDeselected",void 0),Vh([(0,a.ju)()],Hh.prototype,"resizeStart",void 0),Vh([(0,a.ju)()],Hh.prototype,"resizing",void 0),Vh([(0,a.ju)()],Hh.prototype,"resizeStop",void 0),Vh([(0,a.ju)()],Hh.prototype,"pdfHeaderQueryCellInfo",void 0),Vh([(0,a.ju)()],Hh.prototype,"pdfQueryCellInfo",void 0),Vh([(0,a.ju)()],Hh.prototype,"excelHeaderQueryCellInfo",void 0),Vh([(0,a.ju)()],Hh.prototype,"excelQueryCellInfo",void 0),Vh([(0,a.ju)()],Hh.prototype,"columnDragStart",void 0),Vh([(0,a.ju)()],Hh.prototype,"columnDrag",void 0),Vh([(0,a.ju)()],Hh.prototype,"columnDrop",void 0),Vh([(0,a.ju)()],Hh.prototype,"columnRender",void 0);class qh{constructor(e){this.actualrCnt=0,this.parent=e}getModuleName(){return"excelExport"}addHeaderAndFooter(e,t,i,s){let o=[];if((0,a.le)(e.rows))""!==t&&("footer"===i&&this.actualrCnt++,o.push({index:1,value:t}),this.rows.push({index:this.actualrCnt+1,cells:o}),this.actualrCnt="header"===i?this.actualrCnt+2:this.actualrCnt);else{this.actualrCnt="footer"===i?this.actualrCnt+s-e.rows[0].cells.length:this.actualrCnt;let t=e.rows;for(let e=0;e<t.length;e++)for(let i=0;i<t[e].cells.length;i++)o=[],o.push({index:e+1,value:t[e].cells[i].value,colSpan:t[e].cells[i].colSpan,rowSpan:t[e].cells[i].rowSpan,style:t[e].cells[i].style}),this.actualrCnt++,this.rows.push({index:this.actualrCnt,cells:o});this.actualrCnt="header"===i?s:this.actualrCnt}}exportToExcel(e,t){this.rows=[],this.actualrCnt=0;let i,s=!(0,a.le)(t)&&!(0,a.le)(t.header),o=!(0,a.le)(t)&&!(0,a.le)(t.footer),l=!(0,a.le)(t)&&!(0,a.le)(t.fileName);this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;let r=br.getClonedPivotValues(this.engine.pivotValues),n=l?t.fileName:"default.xlsx";if(s&&this.addHeaderAndFooter(t.header,"","header",t.header.headerRows),this.parent.exportAllPages&&this.parent.enableVirtualization&&"olap"!==this.parent.dataType){let e=this.engine.pageSettings;this.engine.pageSettings=null,this.engine.generateGridData(this.parent.dataSourceSettings),this.parent.applyFormatting(this.engine.pivotValues),i=br.getClonedPivotValues(this.engine.pivotValues),this.engine.pivotValues=r,this.engine.pageSettings=e}else i=r;let h,d,c,p,u={fileName:n,header:"",footer:"",dataCollections:[i]};this.parent.trigger(wr,u,e=>{h=e.fileName,d=e.header,c=e.footer,p=e.dataCollections}),!s&&(0,a.le)(u.excelExportProperties)&&""!==d?this.addHeaderAndFooter({},d,"header",void 0):(0,a.le)(u.excelExportProperties)||(0,a.le)(u.excelExportProperties.header)||this.addHeaderAndFooter(u.excelExportProperties.header,"","header",u.excelExportProperties.header.headerRows);let g=[];for(let b=0;b<p.length;b++){let i=p[b],s=0,l=i.length,r=this.parent.renderModule.getFormatList(),n=0;for(let t=0;t<l;t++)if(i[t]){this.actualrCnt++,s=i[t].length;let o=[];for(let l=0;l<s;l++)if(i[t][l]){let s=i[t][l];if(-1!==s.level||s.rowSpan){let i="value"===s.axis?s.value:s.formattedText;if(i="grand sum"===s.type?this.parent.localeObj.getConstant("grandTotal"):"sum"===s.type?i.toString().replace("Total",this.parent.localeObj.getConstant("total")):i,-1!==s.level||s.rowSpan){if(o.push({index:l+1,value:i,colSpan:s.colSpan,rowSpan:-1===s.rowSpan?1:s.rowSpan}),"value"===s.axis){(isNaN(s.value)||""===s.formattedText||void 0===s.formattedText||(0,a.le)(s.value))&&(o[o.length-1].value="Excel"===e?null:"");let t="row"===this.parent.dataSourceSettings.valueAxis&&"olap"===this.parent.dataType&&s.rowOrdinal&&this.engine.tupRowInfo[s.rowOrdinal]?this.engine.tupRowInfo[s.rowOrdinal].measureName:s.actualText;o[o.length-1].style=(0,a.le)(o[o.length-1].value)?{bold:!1,wrapText:!0}:{numberFormat:r[t],bold:!1,wrapText:!0},s.style&&(o[o.length-1].style.backColor=s.style.backgroundColor,o[o.length-1].style.fontColor=s.style.color,o[o.length-1].style.fontName=s.style.fontFamily,o[o.length-1].style.fontSize=Number(s.style.fontSize.split("px")[0]))}else if(o[o.length-1].style={bold:!0,vAlign:"Center",wrapText:!0,indent:0===l?10*s.level:0},"row"===s.axis&&0===l)if(o[o.length-1].style.hAlign="Left","olap"===this.parent.dataType){let e=this.parent.renderModule.indentCollection[t];o[o.length-1].style.indent=2*e,n=n>e?n:e}else o[o.length-1].style.indent=2*s.level,n=s.level>n?s.level:n;o[o.length-1].style.borders={color:"#000000",lineStyle:"Thin"}}}l+=s.colSpan?s.colSpan-1:0}else o.push({index:l+1,value:"",colSpan:1,rowSpan:1});this.rows.push({index:this.actualrCnt,cells:o})}o?this.addHeaderAndFooter(t.footer,"","footer",t.footer.footerRows):!o&&""!==c&&(0,a.le)(u.excelExportProperties)?this.addHeaderAndFooter({},c,"footer",void 0):(0,a.le)(u.excelExportProperties)||(0,a.le)(u.excelExportProperties.footer)||this.addHeaderAndFooter(u.excelExportProperties.footer,"","footer",u.excelExportProperties.footer.footerRows);let h=[];for(let e=0;e<s;e++)h.push({index:e+1,width:100});n>0&&(h[0].width=100+20*n),g.push({columns:h,rows:this.rows})}let m=new b.IE({worksheets:g},"Excel"===e?"xlsx":"csv",void 0,this.parent.currencyCode);".xlsx"===h.substring(h.length-5,h.length)||".csv"===h.substring(h.length-4,h.length)?m.save(h):m.save(h+("Excel"===e?".xlsx":".csv"))}destroy(){}}class Gh{constructor(e){this.parent=e}getModuleName(){return"pdfExport"}addPage(e){let t=e.document.pages.add(),i=e.args.pdfExportProperties,s=(0,a.le)(i)||(0,a.le)(i.header)||(0,a.le)(i.header.contents)||(0,a.le)(i.header.contents[0].value)?e.args.header:i.header.contents[0].value,o=(0,a.le)(i)||(0,a.le)(i.footer)||(0,a.le)(i.footer.contents)||(0,a.le)(i.footer.contents[0].value)?e.args.footer:i.footer.contents[0].value,l=new f.ihD(f.RGI.TimesRoman,15,f.rNm.Regular),r=new f.RYn(new f.qve(0,0,0)),n=new f.YBF(new f.qve(0,0,0),.5),h=new f.iD(new f.Z_c(0,0,t.graphics.clientSize.width,20));h.graphics.drawString(s,l,n,r,0,0,new f.haZ(f.oG9.Center)),e.document.template.top=h;let d=new f.iD(new f.Z_c(0,0,t.graphics.clientSize.width,20));return d.graphics.drawString(o,l,n,r,0,0,new f.haZ(f.oG9.Center)),e.document.template.bottom=d,t}hexDecToRgb(e){if(null===e||""===e||7!==e.length)throw new Error("please set valid hex value for color..");e=e.substring(1);let t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}}getFontStyle(e){let t=f.rNm.Regular;return!(0,a.le)(e)&&e.bold&&(t|=f.rNm.Bold),!(0,a.le)(e)&&e.italic&&(t|=f.rNm.Italic),!(0,a.le)(e)&&e.underline&&(t|=f.rNm.Underline),!(0,a.le)(e)&&e.strikeout&&(t|=f.rNm.Strikeout),t}getBorderStyle(e){let t=new f.jyB;if((0,a.le)(e)){let e=new f.qve(234,234,234);t.all=new f.YBF(e)}else{let i=e.width,s=(0,a.le)(i)||"number"!=typeof i?void 0:.75*i,o=new f.qve(196,196,196);if(!(0,a.le)(e.color)){let t=this.hexDecToRgb(e.color);o=new f.qve(t.r,t.g,t.b)}let l=new f.YBF(o,s);(0,a.le)(e.dashStyle)||(l.dashStyle=this.getDashStyle(e.dashStyle)),t.all=l}return t}getDashStyle(e){switch(e){case"Dash":return 1;case"Dot":return 2;case"DashDot":return 3;case"DashDotDot":return 4;default:return 0}}getStyle(){let e=new f.jyB;if((0,a.le)(this.gridStyle))return{brush:new f.RYn(new f.qve),border:e,font:void 0};{let e=(0,a.le)(this.gridStyle.header.fontName)?f.RGI.Helvetica:this.getFontFamily(this.gridStyle.header.fontName),t=this.getFontStyle(this.gridStyle.header),i=(0,a.le)(this.gridStyle.header.fontSize)?10.5:this.gridStyle.header.fontSize,s=new f.qve;if(!(0,a.le)(this.gridStyle.header.fontColor)){let e=this.hexDecToRgb(this.gridStyle.header.fontColor);s=new f.qve(e.r,e.g,e.b)}let o=new f.ihD(e,i,t);return(0,a.le)(this.gridStyle.header.font)||(o=this.gridStyle.header.font),{border:this.getBorderStyle(this.gridStyle.header.border),font:o,brush:new f.RYn(s)}}}setRecordThemeStyle(e,t){if(!(0,a.le)(this.gridStyle)&&!(0,a.le)(this.gridStyle.record)){let t=(0,a.le)(this.gridStyle.record.fontName)?f.RGI.Helvetica:this.getFontFamily(this.gridStyle.record.fontName),i=(0,a.le)(this.gridStyle.record.fontSize)?9.75:this.gridStyle.record.fontSize,s=this.getFontStyle(this.gridStyle.record),o=new f.ihD(t,i,s);(0,a.le)(this.gridStyle.record.font)||(o=this.gridStyle.record.font),e.style.setFont(o);let l=new f.qve;if(!(0,a.le)(this.gridStyle.record.fontColor)){let e=this.hexDecToRgb(this.gridStyle.record.fontColor);l=new f.qve(e.r,e.g,e.b)}e.style.setTextBrush(new f.RYn(l))}let i=this.gridStyle&&this.gridStyle.record&&this.gridStyle.record.border?this.getBorderStyle(this.gridStyle.record.border):t;return e.style.setBorder(i),e}exportToPDF(e){this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;let t=this.applyEvent(),i=this.getStyle(),s=Math.floor((540-(100+20*(this.parent.renderModule.maxIndent?this.parent.renderModule.maxIndent:5)))/90)+1,o=0,l=t.args.dataCollections[o];for(let a=0;t.args.allowRepeatHeader&&s>1&&a<l.length;a++)for(let e=s;l[a]&&e<l[a].length;e+=s)l[a].splice(e,0,l[a][0]);let r=l&&l.length>0?l[0].length:0,n=0;do{(0,a.le)(e)||(t.args.header=(0,a.le)(e.header)||(0,a.le)(e.header.contents)||(0,a.le)(e.header.contents[0].value)?t.args.header:e.header.contents[0].value,t.args.footer=(0,a.le)(e.footer)||(0,a.le)(e.footer.contents)||(0,a.le)(e.footer.contents[0].value)?t.args.footer:e.footer.contents[0].value);let h=this.addPage(t),d=new f.EsS,c=s>1?s:5;if(l&&l.length>0){d.columns.add(l[0].length-n>=c?c:l[0].length-n);let e=l.length,t=0,s=0;for(let o=0;o<e;o++)if(l[o]){let e=!(l[o][0]&&"row"===l[o][0].axis),a=l[o].length>n+c?n+c:l[o].length;e&&d.headers.add(1);let r=e?d.headers.getHeader(t):d.rows.addRow();e?(r.style.setBorder(i.border),i.font&&r.style.setFont(i.font),r.style.setTextBrush(i.brush)):this.setRecordThemeStyle(r,i.border);let h=0,p=!0;for(let t=n;t<a;t++){let i=!1;if(l[o][t]){let a=l[o][t];if(-1!==a.level||a.rowSpan){let t=a.formattedText;t="grand sum"===a.type?this.parent.localeObj.getConstant("grandTotal"):"sum"===a.type?t.toString().replace("Total",this.parent.localeObj.getConstant("total")):t,(-1!==a.level||a.rowSpan)&&(r.cells.getCell(h).columnSpan=a.colSpan?c-h<a.colSpan?c-h:a.colSpan:1,e&&a.rowSpan&&a.rowSpan>1&&(r.cells.getCell(h).rowSpan=a.rowSpan?a.rowSpan:1),r.cells.getCell(h).value=t?t.toString():""),""!==t&&(p=!1)}s=a.level>s?a.level:s,i="value"===a.axis,t+=r.cells.getCell(h).columnSpan?r.cells.getCell(h).columnSpan-1:0,h+=r.cells.getCell(h).columnSpan?r.cells.getCell(h).columnSpan-1:0,a.style&&(r=this.applyStyle(r,a,h));let n={style:a&&a.isSum?{bold:!0}:void 0,pivotCell:a,cell:r.cells.getCell(h)};this.parent.trigger(Cr,n),n.style&&this.processCellStyle(r.cells.getCell(h),n)}else{let i={style:void 0,pivotCell:void 0,cell:r.cells.getCell(h)};this.parent.trigger(Cr,i),i.style&&this.processCellStyle(r.cells.getCell(h),i),r.cells.getCell(h).value="",(0===t&&e&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0||0!==t&&e&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&d.headers.getHeader(0).cells.getCell(0).rowSpan<Object.keys(this.engine.headerContent).length)&&d.headers.getHeader(0).cells.getCell(0).rowSpan++}let a=new f.haZ;if("olap"===this.parent.dataType){let i=!e&&0===h&&l[o][t]?this.parent.renderModule.indentCollection[l[o][t].rowIndex]:0;a.paragraphIndent=15*i,s=s>i?s:i}else a.paragraphIndent=!e&&0===h&&l[o][t]&&-1!==l[o][t].level?15*l[o][t].level:0;a.alignment=i?f.oG9.Right:f.oG9.Left,a.lineAlignment=f.SAZ.Middle,r.cells.getCell(h).style.stringFormat=a,h++}p&&(r.height=16),t++}d.columns.getColumn(0).width=100+20*s}0===n&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&d.headers.getHeader(0).cells.getCell(0).rowSpan--,d.draw(h,new f.fuO(10,20)),n+=c,n>=r&&t.args.dataCollections.length>o+1&&(o++,l=t.args.dataCollections[o],r=l&&l.length>0?l[0].length:0,n=0)}while(n<r);t.document.save(t.args.fileName+".pdf"),t.document.destroy()}applyStyle(e,t,i){let s=this.parent.conditionalFormattingModule.hexToRgb(t.style.backgroundColor),o=new f.RYn(new f.qve(s.r,s.g,s.b));e.cells.getCell(i).style.backgroundBrush=o;let l=Number(t.style.fontSize.split("px")[0]),a=new f.ihD(f.RGI.TimesRoman,l,f.rNm.Regular);return e.cells.getCell(i).style.font=a,s=this.parent.conditionalFormattingModule.hexToRgb(t.style.color),o=new f.RYn(new f.qve(s.r,s.g,s.b)),e.cells.getCell(i).style.textBrush=o,e}getFontFamily(e){switch(e){case"TimesRoman":return 2;case"Courier":return 1;case"Symbol":return 3;case"ZapfDingbats":return 4;default:return 0}}getFont(e){if(e.style.font)return e.style.font;let t=e.cell.cellStyle.font&&e.cell.cellStyle.font.fontSize?e.cell.cellStyle.font.fontSize:(0,a.le)(e.style.fontSize)?9.75:.75*e.style.fontSize,i=(0,a.le)(e.style.fontFamily)?f.RGI.TimesRoman:this.getFontFamily(e.style.fontFamily),s=f.rNm.Regular;return!(0,a.le)(e.style.bold)&&e.style.bold&&(s|=f.rNm.Bold),!(0,a.le)(e.style.italic)&&e.style.italic&&(s|=f.rNm.Italic),!(0,a.le)(e.style.underline)&&e.style.underline&&(s|=f.rNm.Underline),!(0,a.le)(e.style.strikeout)&&e.style.strikeout&&(s|=f.rNm.Strikeout),new f.ihD(i,t,s)}processCellStyle(e,t){if(!(0,a.le)(t.style.backgroundColor)){let i=this.hexDecToRgb(t.style.backgroundColor);e.style.backgroundBrush=new f.RYn(new f.qve(i.r,i.g,i.b))}if(!(0,a.le)(t.style.textBrushColor)){let i=this.hexDecToRgb(t.style.textBrushColor);e.style.textBrush=new f.RYn(new f.qve(i.r,i.g,i.b))}if(!(0,a.le)(t.style.textPenColor)){let i=this.hexDecToRgb(t.style.textPenColor);e.style.textPen=new f.YBF(new f.qve(i.r,i.g,i.b))}if((0,a.le)(t.style.fontFamily)&&(0,a.le)(t.style.fontSize)&&(0,a.le)(t.style.bold)&&(0,a.le)(t.style.italic)&&(0,a.le)(t.style.underline)&&(0,a.le)(t.style.strikeout)||(e.style.font=this.getFont(t)),!(0,a.le)(t.style.border)){let i=new f.jyB,s=t.style.border.width,o=(0,a.le)(s)||"number"!=typeof s?void 0:.75*s,l=new f.qve(196,196,196);if(!(0,a.le)(t.style.border.color)){let e=this.hexDecToRgb(t.style.border.color);l=new f.qve(e.r,e.g,e.b)}let r=new f.YBF(l,o);(0,a.le)(t.style.border.dashStyle)||(r.dashStyle=this.getDashStyle(t.style.border.dashStyle)),i.all=r,e.style.borders=i}}applyEvent(){let e,t,i=br.getClonedPivotValues(this.engine.pivotValues);if(this.parent.exportAllPages&&this.parent.enableVirtualization&&"olap"!==this.parent.dataType){let t=this.engine.pageSettings;this.engine.pageSettings=null,this.engine.generateGridData(this.parent.dataSourceSettings),this.parent.applyFormatting(this.engine.pivotValues),e=br.getClonedPivotValues(this.engine.pivotValues),this.engine.pivotValues=i,this.engine.pageSettings=t}else e=i;return this.parent.trigger(wr,{fileName:"default",header:"",footer:"",dataCollections:[e],allowRepeatHeader:!0,style:void 0},e=>{this.gridStyle=e.style,t=e}),{document:new f.ZlO,args:t}}destroy(){}}class Yh{constructor(e){this.keyConfigs={tab:"tab",shiftTab:"shift+tab",enter:"enter",shiftUp:"shift+upArrow",shiftDown:"shift+downArrow",shiftLeft:"shift+leftArrow",shiftRight:"shift+rightArrow",shiftEnter:"shift+enter",ctrlEnter:"ctrl+enter",upArrow:"upArrow",downArrow:"downArrow",leftArrow:"leftArrow",rightArrow:"rightArrow",escape:"escape",ctrlShiftF:"ctrl+shift+f"},this.parent=e,this.event=void 0,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.pivotViewKeyboardModule=new a.nv(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}keyActionHandler(e){switch(e.action){case"tab":this.processTab(e);break;case"shiftTab":this.processShiftTab(e);break;case"enter":case"shiftEnter":case"ctrlEnter":this.processEnter(e);break;case"shiftUp":case"shiftDown":case"shiftLeft":case"shiftRight":case"upArrow":case"downArrow":case"leftArrow":case"rightArrow":this.processSelection(e);break;case"escape":this.clearSelection();break;case"ctrlShiftF":this.toggleFieldList(e)}}getNextButton(e){let t=this.allpivotButtons(e);if((0,a.IV)(t,"e-btn-focused"),this.parent.grid.element.querySelector(".e-pivot-button")){let i=t.length;for(let s=0;s<i;s++)if(t[s].getAttribute("data-uid")===e.getAttribute("data-uid"))return t[s+1]?t[s+1]:e}return e}getPrevButton(e){let t=this.allpivotButtons(e);if((0,a.IV)(t,"e-btn-focused"),this.parent.grid.element.querySelector(".e-pivot-button")){let i=t.length;for(let s=0;s<i;s++)if(t[s].getAttribute("data-uid")===e.getAttribute("data-uid"))return t[s-1]?t[s-1]:e}return e}allpivotButtons(e){let t,i,s,o,l=(0,a.oq)(e,".e-pivot-grouping-bar"),r=(0,a.oq)(e,"."+bh),n=(0,a.oq)(e,".e-chart-grouping-bar"),h=e.classList.contains(Rn);if(null!==l?s=l.classList.contains("e-pivot-grouping-bar"):null!==r?o=r.classList.contains(bh):null!==n&&(i=n.classList.contains("e-chart-grouping-bar")),s||o||h){let e=[].slice.call(this.parent.element.querySelector(".e-pivot-grouping-bar").querySelectorAll(".e-pivot-button")),i=[].slice.call(this.parent.element.querySelector("."+bh).querySelectorAll(".e-pivot-button"));t=e.concat(i)}else i&&(t=[].slice.call(this.parent.element.querySelector(".e-chart-grouping-bar").querySelectorAll(".e-pivot-button")));return t}processTab(e){let t=e.target;if(t&&((0,a.oq)(t,".e-pivot-button")||t.classList.contains("e-group-row"))){if(this.parent.grid){let i=this.parent.grid.serviceLocator.getService("focus");if(t.classList.contains("e-group-row")&&t.querySelector(".e-btn-focused"))t=t.querySelector(".e-btn-focused");else if(t.classList.contains("e-group-row")){i.focus();let t=i.getFocusedElement();return(0,a.cn)([t],["e-focused","e-focus"]),t.setAttribute("tabindex","0"),void e.preventDefault()}let s=this.getNextButton(t);if(s.getAttribute("data-uid")!==t.getAttribute("data-uid"))this.parent.element.querySelector(".e-focused")?(this.parent.element.querySelector(".e-focused").setAttribute("tabindex","-1"),(0,a.IV)(this.parent.element.querySelectorAll(".e-focus"),"e-focus"),(0,a.IV)(this.parent.element.querySelectorAll(".e-focused"),"e-focused"),i.setFocusedElement(this.parent.element.querySelector(".e-headercell")),this.parent.element.querySelector(".e-headercell").setAttribute("tabindex","0")):i.currentInfo.skipAction=!0,(0,a.cn)([s],"e-btn-focused"),s.focus();else{i.focus();let e=i.getFocusedElement();(0,a.cn)([e],["e-focused","e-focus"]),e.setAttribute("tabindex","0")}return void e.preventDefault()}}else if(!this.parent.showGroupingBar&&this.parent.showFieldList&&t&&(0,a.oq)(t,".e-toggle-field-list")){if(this.parent.grid){let t=this.parent.grid.serviceLocator.getService("focus");t.focus();let i=t.getFocusedElement();return(0,a.cn)([i],["e-focused","e-focus"]),i.setAttribute("tabindex","0"),void e.preventDefault()}}else if(this.parent.showGroupingBar||this.parent.showFieldList||!t||!(0,a.oq)(t,".e-pivotview")||(0,a.oq)(t,".e-popup.e-popup-open")){if(t&&(0,a.oq)(t,"."+hh)&&this.parent.toolbar&&this.parent.toolbarModule)clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(()=>{(0,a.IV)((0,a.oq)(t,"."+hh).querySelectorAll(".e-menu-item.e-focused"),"e-focused"),document.activeElement&&document.activeElement.classList.contains("e-menu-item")&&(0,a.cn)([document.activeElement],"e-focused")});else if(t.classList.contains("e-numerictextbox")){let t=this.parent.grid.serviceLocator.getService("focus");t.focus();let i=t.getFocusedElement();(0,a.IV)([i],["e-focused","e-focus"]),i.setAttribute("tabindex","0"),e.preventDefault()}}else if(this.parent.grid){let i=(0,a.oq)(t,".e-pivotview"),s=this.parent.grid.serviceLocator.getService("focus"),o=[].slice.call(i.getElementsByTagName("tr"));if(t.innerHTML!==o[o.length-1].lastChild.innerHTML){s.focus();let t=s.getFocusedElement();return(0,a.cn)([t],["e-focused","e-focus"]),t.setAttribute("tabindex","0"),void e.preventDefault()}s.currentInfo.skipAction=!0}}processShiftTab(e){let t=e.target;if(t&&((0,a.oq)(t,".e-pivot-button")||t.classList.contains("e-group-row"))){if(this.parent.grid){let i=this.parent.grid.serviceLocator.getService("focus");if(t.classList.contains("e-group-row")&&t.querySelector(".e-btn-focused"))t=t.querySelector(".e-btn-focused");else if(t.classList.contains("e-group-row")){t=this.parent.element.querySelector(".e-btn-focused")?this.parent.element.querySelector(".e-btn-focused"):this.parent.element.querySelector(".e-pivot-grouping-bar");let s=this.allpivotButtons(t);if(s.length>0&&s[s.length-1])return i.currentInfo.skipAction=!0,s[s.length-1].focus(),(0,a.IV)(s,"e-btn-focused"),(0,a.cn)([s[s.length-1]],"e-btn-focused"),void e.preventDefault()}let s=this.getPrevButton(t);if(s.getAttribute("data-uid")!==t.getAttribute("data-uid"))return i.currentInfo.skipAction=!0,s.focus(),void e.preventDefault()}}else if(t&&this.parent.grid&&(t.classList.contains("e-movablefirst")||t.classList.contains("e-rowsheader")&&(0,a.oq)(t,"tr").getAttribute("data-uid")===this.parent.grid.element.querySelector(".e-frozencontent tr").getAttribute("data-uid"))){let i=this.parent.grid.serviceLocator.getService("focus");if(t.classList.contains("e-movablefirst")){t=this.parent.element.querySelector(".e-group-rows .e-btn-focused")?this.parent.element.querySelector(".e-group-rows .e-btn-focused"):this.parent.element.querySelector(".e-group-rows");let e=i.getFocusedElement();(0,a.IV)([e],["e-focused","e-focus"])}let s=this.allpivotButtons(t);if(s.length>0)return i.currentInfo.skipAction=!0,setTimeout(()=>{s[s.length-1].focus()}),(0,a.IV)(s,"e-btn-focused"),(0,a.cn)([s[s.length-1]],"e-btn-focused"),void e.preventDefault()}else if(t&&(0,a.oq)(t,"."+hh)&&this.parent.toolbar&&this.parent.toolbarModule)clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(()=>{(0,a.IV)((0,a.oq)(t,"."+hh).querySelectorAll(".e-menu-item.e-focused"),"e-focused"),document.activeElement&&document.activeElement.classList.contains("e-menu-item")&&(0,a.cn)([document.activeElement],"e-focused")});else if(t.classList.contains("e-numerictextbox")){let t=this.parent.grid.serviceLocator.getService("focus");t.focus();let i=t.getFocusedElement();(0,a.IV)([i],["e-focused","e-focus"]),i.setAttribute("tabindex","0"),e.preventDefault()}}processEnter(e){let t=e.target;if(t&&(0,a.oq)(t,".e-grid")){let i=this.parent.grid.serviceLocator.getService("focus");if(13!==e.keyCode||e.shiftKey||e.ctrlKey)if(13===e.keyCode&&e.shiftKey&&!e.ctrlKey){if(this.parent.enableValueSorting){this.event=e,t.click(),i.focus();let s=i.getFocusedElement();(0,a.cn)([s],["e-focused","e-focus"]),s.setAttribute("tabindex","0")}}else 13===e.keyCode&&!e.shiftKey&&e.ctrlKey&&this.parent.hyperlinkSettings&&t.querySelector("a")&&t.querySelector("a").click();else if(t.querySelector("."+Gr)){this.event=e,t.querySelector("."+Gr).click(),i.focus();let s=i.getFocusedElement();(0,a.cn)([s],["e-focused","e-focus"]),s.setAttribute("tabindex","0")}else if(t.classList.contains("e-valuescontent"))t.dispatchEvent(new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0})),t.querySelector(".e-numerictextbox")&&t.click();else if(t.classList.contains("e-numerictextbox")){i.focus();let e=i.getFocusedElement();(0,a.IV)([e],["e-focused","e-focus"])}e.preventDefault()}}clearSelection(){(0,a.IV)(this.parent.element.querySelectorAll(".e-cellselectionbackground,."+sh),[sh,ih,ah]),this.parent.renderModule.selected()}processSelection(e){let t=e.target;if(this.parent.grid&&this.parent.gridSettings.allowSelection&&"Row"!==this.parent.gridSettings.selectionSettings.mode&&!t.classList.contains("e-numerictextbox")){let i,s=this.parent,o=Number(e.target.getAttribute("aria-colIndex")),l=Number(e.target.getAttribute("index"));if("TH"!==t.nodeName&&"TD"!==t.nodeName||(i="shiftUp"===e.action||"upArrow"===e.action?0===l||0===o||"TH"!==t.nodeName&&s.renderModule.rowStartPos!==l?null:this.getParentElement(s,i,o,l-1):"shiftDown"===e.action||"downArrow"===e.action?s.element.querySelector('th[aria-colindex="'+o+'"][index="'+(l+1)+'"]'):"shiftLeft"===e.action||"leftArrow"===e.action?e.target.previousSibling:e.target.nextSibling),(0,a.le)(i))"upArrow"===e.action?(i=s.element.querySelector('[aria-colindex="'+o+'"][index="'+(l-1)+'"]'),l--):"downArrow"===e.action&&(i=s.element.querySelector('[aria-colindex="'+o+'"][index="'+(l+1)+'"]'),l++),(0,a.le)(i)||s.clearSelection(i,e,o,l);else if("Both"===s.gridSettings.selectionSettings.mode&&i.classList.contains(lh))s.clearSelection(i,e,o,l);else{o=Number(i.getAttribute("aria-colindex")),l=Number(i.getAttribute("index"));let t=Number(i.getAttribute("aria-colspan"));s.clearSelection(i,e,o,l),s.trigger(Tr,{cancel:!1,isCellClick:!0,currentCell:i,data:s.pivotValues[l][o]},a=>{a.cancel||s.applyColumnSelection(e,i,o,o+(t>0?t-1:0),l)})}}else if(t&&(37===e.keyCode||38===e.keyCode)&&this.parent&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&!t.classList.contains("e-numerictextbox")){if(this.parent.grid&&this.parent.element.querySelector(".e-frozenheader")&&this.parent.element.querySelector(".e-frozenheader").querySelectorAll(".e-focus").length>0)return(0,a.IV)(this.parent.element.querySelector(".e-frozenheader").querySelectorAll(".e-focus"),"e-focus"),(0,a.IV)(this.parent.element.querySelector(".e-frozenheader").querySelectorAll(".e-focused"),"e-focused"),this.parent.element.querySelector(".e-headercell").setAttribute("tabindex","-1"),this.parent.grid.serviceLocator.getService("focus").setFocusedElement(t),(0,a.cn)([t],["e-focused","e-focus"]),t.setAttribute("tabindex","0"),t.focus(),void e.preventDefault()}else(t.classList.contains("e-numerictextbox")&&"rightArrow"===e.action||"leftArrow"===e.action)&&t.click()}getParentElement(e,t,i,s){for(;!t;)t=e.element.querySelector('[aria-colindex="'+i+'"][index="'+s+'"]'),i--;return t}toggleFieldList(e){if(this.parent&&!this.parent.isDestroyed&&this.parent.showFieldList&&this.parent.pivotFieldListModule&&!this.parent.pivotFieldListModule.isDestroyed&&this.parent.element.querySelector(".e-toggle-field-list")){if(!this.parent.element.querySelector(".e-toggle-field-list").classList.contains(Wr))return this.parent.element.querySelector(".e-toggle-field-list").click(),void e.preventDefault();this.parent.element.querySelector(".e-toggle-field-list").classList.contains(Wr)&&this.parent.pivotFieldListModule.dialogRenderer&&this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog&&!this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog.isDestroyed&&this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog.hide()}}destroy(){this.pivotViewKeyboardModule&&this.pivotViewKeyboardModule.destroy()}}class Wh{constructor(e){this.parent=e,this.parent.contextMenuModule=this}render(){this.renderContextMenu()}renderContextMenu(){let e={cssClass:"e-pivot-context-menu",items:[{text:this.parent.localeObj.getConstant("addToFilter"),id:this.parent.element.id+"_Filters"},{text:this.parent.localeObj.getConstant("addToRow"),id:this.parent.element.id+"_Rows"},{text:this.parent.localeObj.getConstant("addToColumn"),id:this.parent.element.id+"_Columns"},{text:this.parent.localeObj.getConstant("addToValue"),id:this.parent.element.id+"_Values"}],enableRtl:this.parent.enableRtl,locale:this.parent.locale,beforeOpen:this.onBeforeMenuOpen.bind(this),select:this.onSelectContextMenu.bind(this)},t=(0,a.az)("ul",{id:this.parent.element.id+"_PivotContextMenu"});this.parent.element.appendChild(t),this.menuObj=new d.xV(e),this.menuObj.isStringTemplate=!0,this.menuObj.appendTo(t)}onBeforeMenuOpen(e){let t=[].slice.call(e.element.querySelectorAll("li")),i="olap"===this.parent.dataType?this.fieldElement.getAttribute("data-type"):this.fieldElement.querySelector(".e-content").getAttribute("data-type");if((0,a.IV)(t,Qn),"CalculatedField"===i||"isMeasureFieldsAvail"===i)for(let s of t)s.textContent!==this.parent.localeObj.getConstant("addToValue")&&(0,a.cn)([s],Qn);else if("isMeasureAvail"===i)for(let s of t)s.textContent!==this.parent.localeObj.getConstant("addToRow")&&s.textContent!==this.parent.localeObj.getConstant("addToColumn")&&(0,a.cn)([s],Qn);else if("olap"===this.parent.dataType)for(let s of t)if(s.textContent===this.parent.localeObj.getConstant("addToValue")){(0,a.cn)([s],Qn);break}}onSelectContextMenu(e){if(null!==e.element.textContent){let t=this.fieldElement.getAttribute("data-uid"),i=e.item.id.replace(this.parent.element.id+"_","").toLowerCase();this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.dataSourceUpdate.btnElement=this.fieldElement,this.parent.pivotCommon.dataSourceUpdate.updateDataSource(t,i,-1),this.parent.updateDataSource(!0),this.fieldElement=void 0}}destroy(){this.parent.isDestroyed&&this.menuObj&&!this.menuObj.isDestroyed&&(this.menuObj.destroy(),(0,a.Ys)("#"+this.parent.element.id+"_PivotContextMenu",document)&&(0,a.Od)((0,a.Ys)("#"+this.parent.element.id+"_PivotContextMenu",document)))}}class Uh{constructor(e){this.previousValues={top:0,left:0},this.frozenPreviousValues={top:0,left:0},this.eventType="",this.parent=e,this.engineModule="pivot"===this.parent.dataType?this.parent.engineModule:this.parent.olapEngineModule,this.addInternalEvents()}getModuleName(){return"virtualscroll"}addInternalEvents(){this.parent.on(Nr,this.wireEvents,this)}wireEvents(){if("Chart"!==this.parent.displayOption.view){let e=this.parent.element.querySelector(".e-movablecontent"),t=this.parent.element.querySelector(".e-frozencontent"),i=this.parent.element.querySelector(".e-movableheader"),s=e.parentElement.parentElement.querySelector(".e-movablescrollbar");if(a.bi.clearEvents(e),a.bi.clearEvents(t),this.engineModule){let o=this.parent.isAdaptive?e:e.parentElement.parentElement.querySelector(".e-movablescrollbar");a.bi.add(o,"scroll touchmove pointermove",this.onHorizondalScroll(i,e,t),this),a.bi.add(e.parentElement,"scroll wheel touchmove pointermove keyup keydown",this.onVerticalScroll(t,e),this),a.bi.add(e.parentElement.parentElement,"mouseup touchend",this.common(i,e,t),this),a.bi.add(s,"scroll",this.onCustomScrollbarScroll(e,i),this),a.bi.add(e,"scroll",this.onCustomScrollbarScroll(s,i),this),a.bi.add(i,"scroll",this.onCustomScrollbarScroll(s,e),this),a.bi.add(i,"touchstart pointerdown",this.setPageXY(),this),a.bi.add(i,"touchmove pointermove",this.onTouchScroll(i,e,t),this),a.bi.add(e,"touchstart pointerdown",this.setPageXY(),this),a.bi.add(e,"touchmove pointermove",this.onTouchScroll(i,e,t),this)}this.parent.grid.on("check-scroll-reset",e=>{e.cancel=!0}),this.parent.grid.on("prevent-frozen-scroll-refresh",function(e){e.cancel=!0}),this.parent.grid.isPreventScrollEvent=!0}}onWheelScroll(e,t){let i=e;return e=>{let t=i.parentElement.scrollTop+(1===e.deltaMode?30*e.deltaY:e.deltaY);this.frozenPreviousValues.top!==t&&(e.preventDefault(),this.frozenPreviousValues.top=t,this.eventType=e.type)}}getPointXY(e){let t={x:0,y:0};return e.touches&&e.touches.length?(t.x=e.touches[0].pageX,t.y=e.touches[0].pageY):(t.x=e.pageX,t.y=e.pageY),t}onCustomScrollbarScroll(e,t){let i=e,s=t;return e=>{if(null===this.parent.element.querySelector(".e-movablecontent").parentElement.querySelector("tbody"))return;let t=e.target.scrollLeft;this.previousValues.left!==t&&(i.scrollLeft=t,s.scrollLeft=t,this.previousValues.left=t)}}onTouchScroll(e,t,i){let s=t;return i=>{if("mouse"===i.pointerType)return;let o=this.getPointXY(i),l=s.parentElement.scrollTop+(this.pageXY.y-o.y),a=this.parent.isAdaptive?t:s.parentElement.parentElement.querySelector(".e-movablescrollbar"),r=a.scrollLeft+(this.pageXY.x-o.x);this.frozenPreviousValues.left===r||r<0||(e.scrollLeft=r,a.scrollLeft=r,this.pageXY.x=o.x,this.frozenPreviousValues.left=r,this.frozenPreviousValues.top===l||l<0||(this.pageXY.y=o.y,this.frozenPreviousValues.top=l,this.eventType=i.type))}}update(e,t,i,s,o){this.parent.isScrolling=!0;let l="pivot"===this.parent.dataType?this.parent.engineModule:this.parent.olapEngineModule;if(((0,a.xr)()||"Server"===this.parent.dataSourceSettings.mode)&&(l.pageSettings=this.parent.pageSettings),this.parent.pageSettings&&l.pageSettings)if("vertical"===this.direction){let e="pivot"===this.parent.dataType&&"row"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.values.length:1,t=this.parent.pageSettings.rowSize*e*this.parent.gridSettings.rowHeight,s=Math.ceil(i/t);if(this.parent.scrollPosObject.vertical===s||l.pageSettings.rowSize>=l.rowCount)return;this.parent.showWaitingPopup(),this.parent.scrollPosObject.vertical=s,l.pageSettings.rowCurrentPage=s>1?s:1;let o=0;if("pivot"===this.parent.dataType)if((0,a.xr)()){let i=this.parent,s="sfBlazor",a=window[s].copyWithoutCircularReferences([i.dataSourceSettings],i.dataSourceSettings),r=window[s].copyWithoutCircularReferences([l.pageSettings],l.pageSettings);i.interopAdaptor.invokeMethodAsync("PivotInteropMethod","generateGridData",{dataSourceSettings:a,pageSettings:r,isScrolling:!0}).then(s=>{i.updateBlazorData(s,i),i.pivotValues=l.pivotValues,o=this.parent.engineModule.rowStartPos;let a=Math.ceil(o/(i.pageSettings.rowSize*e));i.scrollPosObject.verticalSection=t*a-l.rowFirstLvl*e*i.gridSettings.rowHeight})}else"Server"===this.parent.dataSourceSettings.mode?this.parent.getEngine("onScroll",null,null,null,null,null,null):(this.parent.engineModule.generateGridData(this.parent.dataSourceSettings,this.parent.engineModule.headerCollection),o=this.parent.engineModule.rowStartPos);else this.parent.olapEngineModule.scrollPage("scroll"),o=this.parent.olapEngineModule.pageRowStartPos;if(!(0,a.xr)()||"pivot"!==this.parent.dataType){this.parent.pivotValues=l.pivotValues;let i=Math.ceil(o/(this.parent.pageSettings.rowSize*e));this.parent.scrollPosObject.verticalSection=t*i-l.rowFirstLvl*e*this.parent.gridSettings.rowHeight}}else{let e="pivot"===this.parent.dataType&&"column"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.values.length:1,t=this.parent.pageSettings.columnSize*e*this.parent.gridSettings.columnWidth,i=Math.ceil(s/t);if(this.parent.scrollPosObject.horizontal===i)return;this.parent.showWaitingPopup();let o=this.parent;o.scrollPosObject.horizontal=i,l.pageSettings.columnCurrentPage=i>1?i:1;let r=0;if("pivot"===o.dataType)if((0,a.xr)()){let i="sfBlazor",s=this.parent,o=window[i].copyWithoutCircularReferences([l.pageSettings],l.pageSettings),a=window[i].copyWithoutCircularReferences([s.dataSourceSettings],s.dataSourceSettings);s.interopAdaptor.invokeMethodAsync("PivotInteropMethod","generateGridData",{dataSourceSettings:a,pageSettings:o,isScrolling:!0}).then(i=>{s.updateBlazorData(i,s),r=s.engineModule.colStartPos,s.pivotValues=l.pivotValues;let o=Math.ceil(r/(s.pageSettings.columnSize*e));s.scrollPosObject.horizontalSection=t*o-l.colFirstLvl*e*s.gridSettings.columnWidth})}else"Server"===this.parent.dataSourceSettings.mode?this.parent.getEngine("onScroll",null,null,null,null,null,null):(o.engineModule.generateGridData(o.dataSourceSettings,o.engineModule.headerCollection),r=o.engineModule.colStartPos);else o.olapEngineModule.scrollPage("scroll"),r=o.olapEngineModule.pageColStartPos;if(!(0,a.xr)()||"pivot"!==o.dataType){o.pivotValues=l.pivotValues;let i=Math.ceil(r/(o.pageSettings.columnSize*e));o.scrollPosObject.horizontalSection=t*i-l.colFirstLvl*e*o.gridSettings.columnWidth}}}setPageXY(){return e=>{"mouse"!==e.pointerType&&(this.pageXY=this.getPointXY(e))}}common(e,t,i){return i=>{let s=this.parent.isAdaptive?t:t.parentElement.parentElement.querySelector(".e-movablescrollbar");this.parent.isHScrollEnd=s.scrollLeft+s.offsetWidth-s.scrollWidth==0,this.update(e,t,t.parentElement.scrollTop*this.parent.verticalScrollScale,s.scrollLeft*this.parent.horizontalScrollScale,i)}}onHorizondalScroll(e,t,i){let s;return i=>{let o=this.parent.isAdaptive?t:t.parentElement.parentElement.querySelector(".e-movablescrollbar"),l=o.scrollLeft*this.parent.horizontalScrollScale;if("wheel"!==i.type&&"touchmove"!==i.type&&"wheel"!==this.eventType&&"touchmove"!==this.eventType||(clearTimeout(s),s=setTimeout(()=>{l="touchmove"===i.type?o.scrollLeft:l,this.update(e,t,t.parentElement.scrollTop*this.parent.verticalScrollScale,l,i)},300)),this.previousValues.left===l)return;this.parent.scrollDirection=this.direction="horizondal";let r=-(l-this.parent.scrollPosObject.horizontalSection-o.scrollLeft),n=t.querySelector("."+An).style.transform.split(",").length>1?t.querySelector("."+An).style.transform.split(",")[1].trim():"0px)";o.scrollLeft<this.parent.scrollerBrowserLimit&&((0,a.V7)(t.querySelector(".e-table"),{transform:"translate("+r+"px,"+n}),(0,a.V7)(e.querySelector(".e-table"),{transform:"translate("+r+"px,0px)"}));let h=this.parent.scrollPosObject.horizontalSection>l?-(this.parent.scrollPosObject.horizontalSection-l):l+e.offsetWidth-(this.parent.scrollPosObject.horizontalSection+t.querySelector(".e-table").offsetWidth),d=Math.ceil(this.parent.scrollPosObject.horizontalSection/this.parent.horizontalScrollScale)<this.parent.scrollerBrowserLimit;if(this.parent.scrollPosObject.horizontalSection>l||h>1&&d){l>e.clientWidth?(this.parent.scrollPosObject.left<1&&(this.parent.scrollPosObject.left=e.clientWidth),this.parent.scrollPosObject.left=this.parent.scrollPosObject.left-50,h=this.parent.scrollPosObject.horizontalSection>l?h-this.parent.scrollPosObject.left:h+this.parent.scrollPosObject.left):h=-this.parent.scrollPosObject.horizontalSection,r=-(l-(this.parent.scrollPosObject.horizontalSection+h)-t.parentElement.parentElement.querySelector(".e-movablescrollbar").scrollLeft);let i=this.parent.gridSettings.columnWidth*this.engineModule.columnCount;i>this.parent.scrollerBrowserLimit&&(this.parent.horizontalScrollScale=i/this.parent.scrollerBrowserLimit,i=this.parent.scrollerBrowserLimit),r>i&&r>l&&(r=l,h=0),(0,a.V7)(t.querySelector(".e-table"),{transform:"translate("+r+"px,"+n}),(0,a.V7)(e.querySelector(".e-table"),{transform:"translate("+r+"px,0px)"}),this.parent.scrollPosObject.horizontalSection=this.parent.scrollPosObject.horizontalSection+h}this.previousValues.left=l,this.frozenPreviousValues.left=l,this.eventType="",e.scrollLeft=o.scrollLeft}}onVerticalScroll(e,t){let i;return s=>{let o=t.parentElement.scrollTop*this.parent.verticalScrollScale;if("wheel"===s.type||"touchmove"===s.type||"wheel"===this.eventType||"touchmove"===this.eventType||"keyup"===s.type||"keydown"===s.type){let e=this.parent.isAdaptive?t:t.parentElement.parentElement.querySelector(".e-movablescrollbar");clearTimeout(i),i=setTimeout(()=>{this.update(null,t,t.parentElement.scrollTop*this.parent.verticalScrollScale,e.scrollLeft*this.parent.horizontalScrollScale,s)},300)}if(this.previousValues.top===o)return;this.parent.scrollDirection=this.direction="vertical";let l=-(o-this.parent.scrollPosObject.verticalSection-t.parentElement.scrollTop),r=t.querySelector("."+An).style.transform.split(",")[0].trim();l>this.parent.virtualDiv.clientHeight&&(l=this.parent.virtualDiv.clientHeight),t.parentElement.scrollTop<this.parent.scrollerBrowserLimit&&((0,a.V7)(e.querySelector(".e-table"),{transform:"translate(0px,"+l+"px)"}),(0,a.V7)(t.querySelector(".e-table"),{transform:r+","+l+"px)"}));let n=this.parent.scrollPosObject.verticalSection>o?-(this.parent.scrollPosObject.verticalSection-o):o+e.parentElement.clientHeight-(this.parent.scrollPosObject.verticalSection+e.querySelector(".e-table").offsetHeight),h=Math.ceil(this.parent.scrollPosObject.verticalSection/this.parent.verticalScrollScale)<this.parent.scrollerBrowserLimit;if(this.parent.scrollPosObject.verticalSection>o||n>1&&h){o>e.parentElement.clientHeight?(this.parent.scrollPosObject.top<1&&(this.parent.scrollPosObject.top=e.parentElement.clientHeight),this.parent.scrollPosObject.top=this.parent.scrollPosObject.top-50,n=this.parent.scrollPosObject.verticalSection>o?n-this.parent.scrollPosObject.top:n+this.parent.scrollPosObject.top):n=-this.parent.scrollPosObject.verticalSection;let i=this.parent.element.querySelector(".e-movablecontent").querySelector(".e-table");l=-(o-(this.parent.scrollPosObject.verticalSection+n)-t.parentElement.scrollTop);let s=this.parent.gridSettings.rowHeight*this.engineModule.rowCount+.1-i.clientHeight;s>this.parent.scrollerBrowserLimit&&(this.parent.verticalScrollScale=s/this.parent.scrollerBrowserLimit,s=this.parent.scrollerBrowserLimit),l>s&&l>o&&(l=o,n=0),l>this.parent.virtualDiv.clientHeight&&(l=this.parent.virtualDiv.clientHeight),(0,a.V7)(e.querySelector(".e-table"),{transform:"translate(0px,"+l+"px)"}),(0,a.V7)(t.querySelector(".e-table"),{transform:r+","+l+"px)"}),this.parent.scrollPosObject.verticalSection=this.parent.scrollPosObject.verticalSection+n}this.previousValues.top=o,this.frozenPreviousValues.top=o,this.eventType=""}}removeInternalEvents(){this.parent.isDestroyed||this.parent.off(Nr,this.wireEvents)}destroy(){this.removeInternalEvents()}}class Xh{constructor(e){this.indexString=[],this.clonedData=[],this.isUpdated=!1,this.gridIndexObjects={},this.gridData=[],this.formatList={},this.parent=e,this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule}frameHeaderWithKeys(e){let t=Object.keys(e),i=0,s={};for(;i<t.length;)s[t[i]]=e[t[i]],i++;return s}showDrillThroughDialog(e){this.gridData=e.rawData;for(let i=0;i<e.rawData.length;i++)this.clonedData.push(this.frameHeaderWithKeys(e.rawData[i]));let t=e.currentCell.actualText.toString();if("Count"!==this.engine.fieldList[t].aggregateType&&this.parent.editSettings.allowInlineEditing&&this.parent.editSettings.allowEditing&&1===e.rawData.length&&"DistinctCount"!==this.engine.fieldList[t].aggregateType&&"string"!=typeof e.rawData[0][t])this.editCell(e);else{this.removeDrillThroughDialog();let t=(0,a.az)("div",{id:this.parent.element.id+"_drillthrough",className:"e-drillthrough-dialog"});this.parent.element.appendChild(t),this.dialogPopUp=new n.Vq({animationSettings:{effect:"Fade"},allowDragging:!1,header:this.parent.localeObj.getConstant("details"),content:this.createDrillThroughGrid(e),beforeOpen:()=>{this.drillThroughGrid.setProperties({dataSource:this.parent.editSettings.allowEditing?this.dataWithPrimarykey(e):this.gridData,height:this.parent.editSettings.allowEditing?220:300},!1)},beforeClose:()=>{if(this.parent.editSettings.allowEditing&&this.isUpdated){"CSV"===this.parent.dataSourceSettings.type&&this.updateData(this.drillThroughGrid.dataSource);let e=Object.keys(this.gridIndexObjects),t=[];for(let a of e)t.push(this.gridIndexObjects[a]);let i=Object.keys(this.gridIndexObjects).length,s=[],o=[],l=0;for(let r of this.drillThroughGrid.dataSource){if((0,a.le)(r.__index)||""===r.__index){for(let e of this.engine.fields)(0,a.le)(r[e])&&delete r[e];delete r.__index,s.push(r)}else i>0&&((0,a.xr)()&&this.parent.editSettings.allowCommandColumns&&(this.parent.engineModule.data[Number(r.__index)]=r),delete this.gridIndexObjects[r.__index.toString()],o.push(r),i--);"Server"===this.parent.dataSourceSettings.mode&&(r.__index&&delete r.__index,this.gridData[l].__index&&delete this.gridData[l].__index),l++}if(i=0,(0,a.xr)()&&this.parent.enableVirtualization){let e=this;e.parent.interopAdaptor.invokeMethodAsync("PivotInteropMethod","updateRawData",{AddItem:s,RemoveItem:e.gridIndexObjects,ModifiedItem:e.gridData}).then(t=>{e.parent.updateBlazorData(t,e.parent),e.parent.allowServerDataBinding=!1,e.parent.setProperties({pivotValues:e.parent.engineModule.pivotValues},!0),delete e.parent.bulkChanges.pivotValues,e.parent.allowServerDataBinding=!0,e.isUpdated=!1,e.gridIndexObjects={}})}else if("Server"===this.parent.dataSourceSettings.mode){let e=[],t=Object.keys(this.gridIndexObjects);for(let s=0;s<t.length;s++)delete this.parent.drillThroughValue.indexObject[this.gridIndexObjects[t[s]]],e.push({Key:t[s],Value:this.gridIndexObjects[t[s]]});let i=[];t=Object.keys(this.parent.drillThroughValue.indexObject);for(let s=0;s<t.length;s++)i.push({Key:t[s],Value:this.parent.drillThroughValue.indexObject[t[s]]});this.parent.getEngine("updateRawData",null,null,null,null,null,null,null,{addedData:s,removedData:e,updatedData:o,indexObject:i})}else{let e=[],o=this.parent.allowDataCompression&&this.parent.enableVirtualization?this.parent.engineModule.actualData:this.parent.engineModule.data;for(let t of o)delete t.__index,void 0===this.gridIndexObjects[i.toString()]&&e.push(t),i++;e=e.concat(s);let l={currentData:this.drillThroughGrid.dataSource,previousData:this.clonedData,previousPosition:t,cancel:!1};this.parent.trigger(Ar,l),l.cancel||(this.parent.setProperties({dataSourceSettings:{dataSource:e}},!0),this.engine.updateGridData(this.parent.dataSourceSettings),this.parent.pivotValues=this.engine.pivotValues)}}(0,a.xr)()&&this.parent.enableVirtualization||(this.isUpdated=!1,this.gridIndexObjects={})},isModal:!0,visible:!0,showCloseIcon:!0,locale:this.parent.locale,enableRtl:this.parent.enableRtl,width:this.parent.isAdaptive?"100%":"60%",position:{X:"center",Y:"center"},closeOnEscape:!0,target:document.body,close:this.removeDrillThroughDialog.bind(this)}),this.dialogPopUp.isStringTemplate=!0,this.dialogPopUp.appendTo(t),(0,a.V7)(this.dialogPopUp.element,{visibility:"visible"})}}editCell(e){let t=this.parent.gridSettings.allowResizing,i=e.currentCell.actualText.toString(),s=Number(Object.keys(e.currentCell.indexObject));e.currentTarget.firstElementChild.style.display="none";let o=Number(e.rawData[0][i]),l=this.frameHeaderWithKeys(e.rawData[e.rawData.length-1]),r=e.rawData[e.rawData.length-1];e.currentCell.actualText in l&&(r[e.currentCell.actualText]=e.currentCell.actualValue),this.numericTextBox=new c.No({value:o,enableRtl:this.parent.enableRtl,enabled:!0,format:"####.##",locale:this.parent.locale,change:()=>{let t=e.currentCell.indexObject[s];e.rawData[0][i]=this.numericTextBox.value,this.parent.engineModule.data[t]=e.rawData[0]},blur:()=>{let e={currentData:r,previousData:l,previousPosition:r.index,cancel:!1};this.parent.trigger(Ar,e),e.cancel||(this.parent.setProperties({dataSourceSettings:{dataSource:this.parent.engineModule.data}},!0),this.engine.updateGridData(this.parent.dataSourceSettings),this.parent.pivotValues=this.engine.pivotValues,this.parent.gridSettings.allowResizing=t)}});let n=(0,a.az)("input",{id:this.parent.element.id+"_inputbox"});e.currentTarget.appendChild(n),this.numericTextBox.appendTo(n),e.currentCell.value=this.numericTextBox.value,this.numericTextBox.focusIn(),this.parent.gridSettings.allowResizing=!1}updateData(e){let t=0,i=this.parent.allowDataCompression&&this.parent.enableVirtualization?this.parent.engineModule.actualData:this.parent.engineModule.data;for(;t<e.length;){let s=Object.keys(e[t]),o=0,l=[];for(;o<s.length;)(0,a.le)(this.parent.engineModule.fieldKeys[s[o]])||(l[this.parent.engineModule.fieldKeys[s[o]]]=e[t][s[o]]),o++;i[e[t].__index]=l,t++}this.parent.allowDataCompression&&this.parent.enableVirtualization?this.parent.engineModule.actualData=i:this.parent.engineModule.data=i}removeDrillThroughDialog(){this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&this.dialogPopUp.destroy();let e=document.getElementById(this.parent.element.id+"_drillthrough");e&&(0,a.Od)(e),document.getElementById(this.parent.element.id+"_drillthroughgrid_ccdlg")&&(0,a.Od)(document.getElementById(this.parent.element.id+"_drillthroughgrid_ccdlg"))}createDrillThroughGrid(e){let t=(0,a.az)("div",{id:this.parent.element.id+"_drillthroughbody",className:"e-drillthrough-body"}),i=(0,a.az)("div",{id:this.parent.element.id+"_drillthroughbodyheader",className:"e-drillthrough-body-header-container"});if(""!==e.rowHeaders&&(i.innerHTML="<span class=e-drillthrough-body-header-common><span class=e-drillthrough-body-header>"+this.parent.localeObj.getConstant("row")+"</span> :<span class=e-drillthrough-body-header-value>"+e.rowHeaders+"</span></span>"),""!==e.columnHeaders&&(i.innerHTML=i.innerHTML+"<span class=e-drillthrough-body-header-common><span class=e-drillthrough-body-header>"+this.parent.localeObj.getConstant("column")+"</span> :<span class=e-drillthrough-body-header-value>"+e.columnHeaders+"</span></span>"),""!==e.value){let t=e.value.split("(")[0],s=e.value.split("(")[1].split(")")[0];"0"!==s&&(i.innerHTML=i.innerHTML+"<span class=e-drillthrough-body-header-common><span class=e-drillthrough-body-header>"+t+"</span> :<span class=e-drillthrough-body-header-value>"+s+"</span></span>")}let s=["ColumnChooser"];this.parent.editSettings.allowEditing&&(s=this.parent.editSettings.allowCommandColumns?["ColumnChooser","Add"]:"Batch"===this.parent.editSettings.mode?["ColumnChooser","Add","Delete","Update","Cancel"]:"Dialog"===this.parent.editSettings.mode?["ColumnChooser","Add","Edit","Delete"]:["ColumnChooser","Add","Edit","Delete","Update","Cancel"]);let o=(0,a.az)("div",{id:this.parent.element.id+"_drillthroughgrid",className:"e-drillthrough-grid"});h.rjZ.Inject(h.Y19,h.tmU,h.t$0,h.o8z,h.kUs),this.drillThroughGrid=new h.rjZ({gridLines:"Default",allowResizing:!0,allowReordering:!0,showColumnChooser:!0,enableHover:!1,toolbar:s,columns:e.gridColumns,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableVirtualization:!this.parent.editSettings.allowEditing,allowPaging:this.parent.editSettings.allowEditing,pageSettings:{pageSize:20},rowHeight:this.parent.gridSettings.rowHeight}),(0,a.xr)()&&(this.drillThroughGrid.isJsComponent=!0),"olap"===this.parent.dataType&&this.formatData();let l=this;return this.parent.trigger("beginDrillThrough",{cellInfo:e,gridObj:(0,a.xr)()?void 0:this.drillThroughGrid,type:"editing"}),this.drillThroughGrid.allowExcelExport&&h.rjZ.Inject(h.jY6),this.drillThroughGrid.allowPdfExport&&h.rjZ.Inject(h.Nhn),this.parent.editSettings.allowEditing?(h.rjZ.Inject(h.I8b,h.T3C),this.drillThroughGrid.editSettings=this.parent.editSettings,this.parent.editSettings.allowCommandColumns?(this.drillThroughGrid.editSettings.mode="Normal",this.drillThroughGrid.editSettings.allowEditOnDblClick=!1,h.rjZ.Inject(h.mf9),this.drillThroughGrid.columns.push({headerText:this.parent.localeObj.getConstant("manageRecords"),width:160,showInColumnChooser:!1,commands:[{type:"Edit",buttonOption:{iconCss:" e-icons e-edit",cssClass:"e-flat"}},{type:"Delete",buttonOption:{iconCss:"e-icons e-delete",cssClass:"e-flat"}},{type:"Save",buttonOption:{iconCss:"e-icons e-update",cssClass:"e-flat"}},{type:"Cancel",buttonOption:{iconCss:"e-icons e-cancel-icon",cssClass:"e-flat"}}]})):this.drillThroughGrid.editSettings.allowEditOnDblClick=this.parent.editSettings.allowEditOnDblClick,this.drillThroughGrid.columns.push({field:"__index",visible:!1,isPrimaryKey:!0,type:"string",showInColumnChooser:!1}),this.drillThroughGrid.actionComplete=e=>{"batchsave"!==e.requestType&&"save"!==e.requestType&&"delete"!==e.requestType||(l.isUpdated=!0),("Normal"===l.drillThroughGrid.editSettings.mode&&"save"===e.requestType&&l.drillThroughGrid.element.querySelectorAll(".e-tbar-btn:hover").length>0&&!l.parent.editSettings.allowCommandColumns||"batchsave"===e.requestType)&&l.dialogPopUp.hide()},this.drillThroughGrid.beforeBatchSave=()=>{l.isUpdated=!0}):h.rjZ.Inject(h.Wvk),document.body.appendChild(o),this.drillThroughGrid.isStringTemplate=!0,this.drillThroughGrid.appendTo(o),t.appendChild(i),t.appendChild(o),t}frameGridColumns(e){let t="olap"===this.parent.dataType?e[0]?Object.keys(e[0]):[]:Object.keys(this.engine.fieldList),i=[];if(this.parent.dataSourceSettings.formatSettings.length>0)for(let s=0;s<this.parent.dataSourceSettings.formatSettings.length;s++)this.formatList[this.parent.dataSourceSettings.formatSettings[s].name]=this.parent.dataSourceSettings.formatSettings[s].format;if("olap"===this.parent.dataType)for(let s of t)i.push({field:s.replace(/_x005B_|_x0020_|_x005D_|_x0024_/g,"").replace("].[","").split(".").reverse().join(""),headerText:s.replace(/_x005B_|_x005D_|_x0024_/g,"").replace(/_x0020_/g," ").replace("].[","").split(".").reverse().join("."),width:120,visible:!0,validationRules:{required:!0},format:(0,a.le)(this.formatList[s])?null:this.formatList[s],type:(0,a.le)(this.formatList[s])?"string":null});else for(let s of t)if("CalculatedField"!==this.engine.fieldList[s].aggregateType){let t="",o=!("date"!==this.engine.fieldList[s].type&&"datetime"!==this.engine.fieldList[s].type||!(this.isDateFieldExist(s)||e[0]&&e[0][s]&&-1===e[0][s].toString().indexOf(" ")));t="number"===this.engine.fieldList[s].type?"numericedit":"date"===this.engine.fieldList[s].type&&o?"datepickeredit":"datetime"===this.engine.fieldList[s].type&&o?"datetimepickeredit":"defaultedit",i.push({field:s,headerText:this.engine.fieldList[s].caption,width:120,visible:this.engine.fieldList[s].isSelected,validationRules:{required:!0},editType:t,format:(0,a.le)(this.formatList[s])?void 0:this.formatList[s],type:(0,a.le)(this.formatList[s])?"string":null})}return i}isDateFieldExist(e){for(let t=0;t<this.parent.dataSourceSettings.formatSettings.length;t++)if(this.parent.dataSourceSettings.formatSettings[t].name===e&&this.parent.dataSourceSettings.formatSettings[t].type.indexOf("date")>-1)return!0;for(let t=0;t<this.parent.dataSourceSettings.fieldMapping.length;t++)if(this.parent.dataSourceSettings.fieldMapping[t].name===e&&this.parent.dataSourceSettings.fieldMapping[t].dataType.indexOf("date")>-1)return!0;return!1}formatData(){let e=0;for(;e<this.gridData.length;){let t=this.gridData[e],i=Object.keys(this.gridData[e]),s={},o=0;for(;o<i.length;)s[i[o].replace(/_x005B_|_x0020_|_x005D_|_x0024_/g,"").replace("].[","").split(".").reverse().join("")]=t[i[o]],o++;this.gridData[e]=s,e++}}dataWithPrimarykey(e){let t=this.indexString.length>0?this.indexString:Object.keys(e.currentCell.indexObject),i=this.gridData,s=0;for(let o of i)o.__index=t[s],this.gridIndexObjects[t[s].toString()]=Number(t[s]),s++;return i}}class Qh{constructor(e){this.parent=e,this.drillThroughDialog=new Xh(this.parent),this.addInternalEvents()}getModuleName(){return"drillthrough"}addInternalEvents(){this.parent.on(Nr,this.wireEvents,this)}wireEvents(){this.unWireEvents(),a.bi.add(this.parent.element,"dblclick",this.mouseClickHandler,this)}unWireEvents(){a.bi.remove(this.parent.element,"dblclick",this.mouseClickHandler)}mouseClickHandler(e){let t=e.target,i=null;if(t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-cellvalue")||t.classList.contains("e-headercelldiv")?i=t.parentElement:t.classList.contains("e-headercell")||t.classList.contains("e-rowcell")?i=t:t.classList.contains("e-headertext")&&(i=t.parentElement.parentElement),i&&(this.parent.allowDrillThrough&&i.classList.contains("e-valuescontent")||this.parent.editSettings.allowEditing)){let e=Number(i.getAttribute("aria-colindex")),t=Number(i.getAttribute("index"));this.executeDrillThrough(this.parent.pivotValues[t][e],t,e,i)}}executeDrillThrough(e,t,i,s){this.parent.drillThroughElement=s,this.parent.drillThroughValue=e;let o="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,l="",r="",n=[];if(void 0!==e.rowHeaders&&void 0!==e.columnHeaders&&!(0,a.le)(e.value)){if("olap"===this.parent.dataType){let t;t="row"===this.parent.dataSourceSettings.valueAxis?o.tupRowInfo[e.rowOrdinal]:o.tupColumnInfo[e.colOrdinal];let i=t?o.getUniqueName(t.measureName):e.actualText;if(o.fieldList[i]&&o.fieldList[i].isCalculatedField)return void this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("drillError"));l=o.fieldList[i||e.actualText].caption,r=o.fieldList[i||e.actualText].aggregateType,this.parent.olapEngineModule.getDrillThroughData(e,this.parent.maxRowsInDrillThrough);try{n=JSON.parse(o.gridJSON)}catch(h){return void this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),o.gridJSON)}}else{l=o.fieldList[e.actualText.toString()]?o.fieldList[e.actualText.toString()].caption:e.actualText.toString(),r=o.fieldList[e.actualText]?o.fieldList[e.actualText].aggregateType:"";let h=this;if((0,a.xr)()&&this.parent.enableVirtualization)h.parent.interopAdaptor.invokeMethodAsync("PivotInteropMethod","fetchRawData",{RowIndex:t,ColumnIndex:i}).then(t=>{n=JSON.parse(t.rawData);let i=JSON.parse(t.indexObject),o={};for(let e=0;e<i.length;e++)o[i[e].Key]=i[e].Value;e.indexObject=o,h.triggerDialog(l,r,n,e,s)});else if("Server"===this.parent.dataSourceSettings.mode)this.parent.getEngine("fetchRawData",null,null,null,null,null,null,{rowIndex:t,columnIndex:i});else if(this.parent.enableVirtualization&&this.parent.allowDataCompression){let t=Object.keys(e.indexObject);this.drillThroughDialog.indexString=[];for(let e of t)for(let t of this.parent.engineModule.groupRawIndex[Number(e)])n.push(this.parent.engineModule.actualData[t]),this.drillThroughDialog.indexString.push(t.toString())}else{let t=Object.keys(e.indexObject);for(let e of t)n.push(this.parent.engineModule.data[Number(e)])}}(0,a.xr)()&&this.parent.enableVirtualization||"Server"===this.parent.dataSourceSettings.mode||this.triggerDialog(l,r,n,e,s)}}getCalcualtedFieldValue(e,t){for(let i=0;i<e.length;i++){let s={};s[e[i]]=e[i];for(let o=0;o<this.parent.dataSourceSettings.calculatedFieldSettings.length;o++){let l;for(let e=this.parent.engineModule.fields.length-1;e>=0;e--)if(this.parent.engineModule.fields[e]===this.parent.dataSourceSettings.calculatedFieldSettings[o].name){l=e;break}if(!(0,a.le)(t[i])){let r=this.parent.engineModule.getAggregateValue([Number(e[i])],s,l,"calculatedfield");t[i][this.parent.dataSourceSettings.calculatedFieldSettings[o].name]=isNaN(r)&&(0,a.le)(r)?"#DIV/0!":r}}}return t}frameData(e){let t=0,i=0,s=[];for(;i<e.rawData.length;){let o={};for(;t<e.gridColumns.length;)o[e.gridColumns[t].field]="Server"===this.parent.dataSourceSettings.mode?e.rawData[i][-1!==this.parent.engineModule.fields.indexOf(e.gridColumns[t].field)?this.parent.engineModule.fields.indexOf(e.gridColumns[t].field):0]:e.rawData[i][this.parent.engineModule.fieldKeys[e.gridColumns[t].field]],t++;s.push(o),i++,t=0}return e.rawData=s,e}triggerDialog(e,t,i,s,o){let l="CalculatedField"===t?e.toString():""!==t?this.parent.localeObj.getConstant(t)+" "+this.parent.localeObj.getConstant("of")+" "+e:e,r={currentTarget:o,currentCell:s,rawData:i,rowHeaders:""===s.rowHeaders?"":s.rowHeaders.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - "),columnHeaders:""===s.columnHeaders?"":s.columnHeaders.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - "),value:l+"("+s.formattedText+")",gridColumns:this.drillThroughDialog.frameGridColumns(i),cancel:!1};"CSV"===this.parent.dataSourceSettings.type&&(r=this.frameData(r));let n=this,h=r.gridColumns;this.parent.trigger("drillThrough",r,e=>{if((0,a.xr)()){for(let t=0;t<e.gridColumns.length;t++)h[t].field===e.gridColumns[t].field&&(h[t].field=e.gridColumns[t].field,h[t].editType=e.gridColumns[t].editType,h[t].headerText=e.gridColumns[t].headerText,h[t].type=e.gridColumns[t].type,h[t].validationRules=e.gridColumns[t].validationRules,h[t].visible=e.gridColumns[t].visible,h[t].width=e.gridColumns[t].width);e.gridColumns=h}r.cancel||n.drillThroughDialog.showDrillThroughDialog(e)})}}class Jh{constructor(){this.headerColl={},this.maxLevel=0,this.columnGroupObject={},this.fieldPosition=[],this.measurePos=-1,this.measuresNames={},this.accumulationType=["Pie","Pyramid","Doughnut","Funnel"]}getModuleName(){return"pivotchart"}loadChart(e,t){if(this.parent=e,this.measuresNames={},this.engineModule="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.dataSourceSettings=this.parent.dataSourceSettings,this.chartSettings=t,!("olap"===e.dataType?e.olapEngineModule.tupColumnInfo.length>0&&e.olapEngineModule.tupRowInfo.length>0&&(!(0,a.le)(e.olapEngineModule.colMeasurePos)||!(0,a.le)(e.olapEngineModule.rowMeasurePos)):e.dataSourceSettings.values.length>0)){if(this.parent.chart)return this.parent.element.querySelector(".e-chart")?(this.parent.chart.series=[],this.parent.chart.rows=[],this.parent.chart.primaryXAxis.title="",this.parent.chart.primaryYAxis.title="",this.parent.chart.primaryXAxis.multiLevelLabels=[],this.parent.chart.primaryYAxis.multiLevelLabels=[],this.parent.chart.axes.length>0&&(this.parent.chart.axes[0].title=""),this.parent.chart.primaryXAxis.zoomFactor=(0,a.le)(this.parent.chartSettings.primaryXAxis.zoomFactor)?1:this.parent.chartSettings.primaryXAxis.zoomFactor):this.parent.element.querySelector(".e-accumulationchart")&&(this.parent.chart.series[0].dataSource=[{}],this.parent.chart.series[0].dataLabel={}),void this.parent.chart.refresh();if(!(0,a.Ys)("#"+this.parent.element.id+"_chart",this.parent.element)){"Both"===this.parent.displayOption.view&&"Chart"===this.parent.displayOption.primary?this.parent.element.insertBefore((0,a.az)("div",{className:dh,id:this.parent.element.id+"_chart"}),this.parent.element.querySelector(".e-grid")):this.parent.element.appendChild((0,a.az)("div",{className:dh,id:this.parent.element.id+"_chart"}));let e=this.parent.width.toString();this.parent.showToolbar&&this.parent.grid&&(e=this.parent.getGridWidthAsNumber().toString());let t,i=this.getChartHeight();t=this.chartSettings&&this.chartSettings.chartSeries&&this.accumulationType.indexOf(this.chartSettings.chartSeries.type)>-1?new ho({width:e,height:i}):new ds({width:e,height:i}),t.appendTo("#"+this.parent.element.id+"_chart"),this.parent.showToolbar&&("Both"===this.parent.displayOption.view&&"Chart"===this.parent.currentView&&(this.parent.grid.element.style.display="none"),"Chart"!==this.parent.currentView&&((0,a.Ys)("#"+this.parent.element.id+"_chart",this.parent.element).style.display="none"))}return void this.parent.notify(Nr,{})}this.parent.chart||!this.parent.element.querySelector(".e-chart")&&!this.parent.element.querySelector(".e-accumulationchart")||(0,a.Od)((0,a.Ys)("#"+this.parent.element.id+"_chart",this.parent.element)),this.measureList=this.chartSettings.enableMultipleAxis&&this.accumulationType.indexOf(t.chartSeries.type)<0?this.dataSourceSettings.values.map(e=>e.name):[""===t.value?this.dataSourceSettings.values[0].name:t.value];for(let a of this.dataSourceSettings.values){let e=a.name.replace(/[^A-Z0-9]+/gi,"_");this.measuresNames[a.name]=e,this.measuresNames[e]=a.name,"Polar"!==this.chartSettings.chartSeries.type&&"Radar"!==this.chartSettings.chartSeries.type||(this.measuresNames[a.caption?a.caption:a.name]=a.name)}this.columnGroupObject={},this.accEmptyPoint=!1;let i=this.engineModule.pivotValues;this.currentMeasure=t.enableMultipleAxis&&this.accumulationType.indexOf(t.chartSeries.type)<0?this.measureList[0]:(""===t.value||0===this.dataSourceSettings.values.filter(e=>e.name===t.value).length)&&this.dataSourceSettings.values.length>0?this.dataSourceSettings.values[0].name:t.value;let s,o,l,r=this.getColumnTotalIndex(i),n=Object.keys(i),h={},d=0,c=-.5;this.headerColl={},this.maxLevel=0;let p,u={},g="",m="",b="",f=!1;"olap"===this.parent.dataType&&(u=this.groupHierarchyWithLevels(i),g=this.fieldPosition[this.fieldPosition.length-1],m=this.measurePos===this.fieldPosition.length-1&&this.fieldPosition.length>1?this.fieldPosition[this.fieldPosition.length-2]:g,b=m);for(let y of n){let e=Number(y);if(!(0,a.le)(i[e])&&i[e][0]&&"row"===i[e][0].axis&&(0===this.dataSourceSettings.rows.length||"grand sum"!==i[e][0].type)){let n=i[e][0],y="olap"===this.parent.dataType?this.engineModule.tupRowInfo[n.ordinal]:void 0,v=-1,S=n.level;"olap"===this.parent.dataType?(f="[Measures]"===n.hierarchy?f:this.isAttributeDrill(n.hierarchy,y.drillInfo),b=b===m||"[Measures]"===n.hierarchy||n.isNamedSet||this.engineModule.fieldList[n.hierarchy]&&!this.engineModule.fieldList[n.hierarchy].hasAllMember?m:b,v=y.drillInfo.length-1,3===n.memberType||y.measureName&&y.measureName!==this.dataSourceSettings.values[0].name||(o=void 0===o?n.levelUniqueName:o,d=o===n.levelUniqueName?0:d,h=0===d?{}:h,d=l&&o!==n.levelUniqueName?l.hierarchy===n.hierarchy?d+(n.level-l.level):(0,a.le)(h[n.levelUniqueName])?u[n.hierarchy].start:h[n.levelUniqueName]:d,h[n.levelUniqueName]=d,S=d,c+=!l||b!==l.hierarchy||l.isDrilled&&l.hasChild?0:1,b=f?n.hierarchy:m,s=d,l=n)):"value"!==n.type&&(void 0===s||s<S||c++,s=S),this.maxLevel=S>this.maxLevel?S:this.maxLevel;let x="olap"===this.parent.dataType?n.formattedText:n.actualText?n.actualText.toString():n.formattedText.toString(),w=n.formattedText?n.formattedText.toString():x,C=n.hasChild&&!n.isNamedSet?(n.isDrilled?" - ":" + ")+w:w,M=y?y.uNameCollection:n.valueSort.levelName.toString(),T={name:x,text:C,hasChild:n.hasChild,isDrilled:n.isDrilled,levelName:M,level:S,fieldName:n.valueSort.axis?n.valueSort.axis.toString():"",rowIndex:e,colIndex:0,cell:n};("olap"===this.parent.dataType?3!==n.memberType:"value"!==n.type)&&(this.headerColl[c]||(this.headerColl[c]={}),this.headerColl[c][S]=T);let L,A=Object.keys(i[e]);p="olap"===this.parent.dataType?3!==n.memberType?n:p:"value"!==n.type?n:p;for(let s of A){let o=Number(s),l=i[e][o],h=!(0,a.le)(l.rowHeaders)||0===this.dataSourceSettings.rows.length,d="olap"===this.parent.dataType&&y&&y.measureName?y.measureName:l.actualText;if(("olap"!==this.parent.dataType||!l.isGrandSum)&&!r[l.colIndex]&&"value"===l.axis&&"header"!==n.type&&""!==d&&(t.enableMultipleAxis&&this.accumulationType.indexOf(t.chartSeries.type)<0||d===this.currentMeasure)){if((0,a.le)(n.members)&&(n.members=[]),"olap"===this.parent.dataType?g!==n.hierarchy&&!f||(3===n.memberType&&L?v!==this.measurePos||L.isDrilled&&L.hasChild:n.isDrilled&&n.hasChild):("value"===n.type&&L?L.members.length>0:n.members.length>0)||!h)break;let t="olap"===this.parent.dataType?l.columnHeaders.toString().split(/~~|::/).join(" - "):l.columnHeaders.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - "),i="olap"===this.parent.dataType?l.rowHeaders.toString().split(/~~|::/).join(" - "):l.rowHeaders.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - "),s=t+" | "+d,r="pivot"===this.parent.dataType&&this.engineModule.aggregatedValueMatrix[e]&&!(0,a.le)(this.engineModule.aggregatedValueMatrix[e][o])?Number(this.engineModule.aggregatedValueMatrix[e][o]):Number(l.value);0===r&&(this.accEmptyPoint=!0),this.columnGroupObject[s]?this.columnGroupObject[s].push({x:0===this.dataSourceSettings.rows.length?n.formattedText:i,y:r,rIndex:e,cIndex:o}):this.columnGroupObject[s]=[{x:0===this.dataSourceSettings.rows.length?n.formattedText:i,y:r,rIndex:e,cIndex:o}]}L=p}}}this.refreshChart()}refreshChart(){this.chartSeries=[];let e=Object.keys(this.columnGroupObject);this.persistSettings=JSON.parse(this.parent.getPersistData()).chartSettings;let t=this.parent.chartSettings.columnHeader&&""!==this.parent.chartSettings.columnHeader?this.parent.chartSettings.columnHeader.split(this.parent.chartSettings.columnDelimiter?this.parent.chartSettings.columnDelimiter:"-").join(" - "):"",i=this.chartSettings.chartSeries?this.chartSettings.chartSeries.type:void 0,s={};for(let l=0;l<this.parent.dataSourceSettings.values.length;l++)s[this.parent.dataSourceSettings.values[l].name]=(0,a.le)(this.parent.dataSourceSettings.values[l].caption)?void 0:this.parent.dataSourceSettings.values[l].caption;if(this.accumulationType.indexOf(i)>-1&&e.length>0){this.currentColumn=e.indexOf(t+" | "+this.currentMeasure)>-1&&void 0!==t?t+" | "+this.currentMeasure:e[0];let s={};s=this.persistSettings.chartSeries?this.frameChartSeries(this.persistSettings.chartSeries):s,((0,a.le)(s.palettes)||0==s.palettes.length)&&!(0,a.le)(this.persistSettings.palettes)&&this.persistSettings.palettes.length>0&&(s.palettes=this.persistSettings.palettes),s.dataSource=this.columnGroupObject[this.currentColumn],s.xName="x",s.yName="y",(0,a.xr)()&&(0,a.le)(this.persistSettings.chartSeries.dataLabel.visible)&&(this.persistSettings.chartSeries.dataLabel.visible=!0,this.persistSettings.chartSeries.dataLabel.position="Outside"),this.persistSettings.chartSeries&&this.persistSettings.chartSeries.dataLabel?(s.dataLabel=this.persistSettings.chartSeries.dataLabel,s.dataLabel.name="x"):(s.dataLabel={visible:!0,position:"Outside",name:"x"},this.parent.setProperties({chartSettings:{chartSeries:{dataLabel:{visible:!0,position:"Outside"}}}},!0)),this.accEmptyPoint&&s.emptyPointSettings?s.emptyPointSettings.mode="Zero":this.accEmptyPoint&&(s.emptyPointSettings={mode:"Zero"}),s.name=this.currentColumn,"Doughnut"===i?(s.type="Pie",s.innerRadius=this.chartSettings.chartSeries.innerRadius?this.chartSettings.chartSeries.innerRadius:"40%"):"Pie"===i&&(s.innerRadius=this.chartSettings.chartSeries.innerRadius?this.chartSettings.chartSeries.innerRadius:"0"),this.chartSeries=this.chartSeries.concat(s)}else for(let l of e){let e,t={};t=this.persistSettings.chartSeries?this.frameChartSeries(this.persistSettings.chartSeries):t,!(0,a.le)(t.palettes)&&t.palettes.length>0&&((0,a.le)(this.persistSettings.palettes)||0==this.persistSettings.palettes.length)&&(this.chartSettings.palettes=t.palettes);for(let i=0;i<this.columnGroupObject[l].length;i++)this.columnGroupObject[l][i].x=""===this.columnGroupObject[l][i].x?this.parent.localeObj.getConstant("blank"):this.columnGroupObject[l][i].x;if(t.dataSource=this.columnGroupObject[l],t.xName="x",t.yName="y",this.chartSettings.enableMultipleAxis){let t=l.split(" | ")[1];t=(0,a.le)(s[t])?t:s[t],e=l.split(" | ")[0]+" | "+t}if(t.name=this.chartSettings.enableMultipleAxis?e:l.split(" | ")[0],["Radar","Polar"].indexOf(i)<0){let e=l.split(" | ")[1];t.yAxisName=this.measuresNames[e]?this.measuresNames[e]:e}this.persistSettings.chartSeries&&this.persistSettings.chartSeries.emptyPointSettings&&(t.emptyPointSettings=this.persistSettings.chartSeries.emptyPointSettings),this.chartSeries=this.chartSeries.concat(t)}let o=this;this.parent.trigger("chartSeriesCreated",{series:this.chartSeries,cancel:!1},e=>{e.cancel?(o.element&&(0,a.Od)(o.element),o.parent.notify(Nr,{})):o.bindChart()})}frameObjectWithKeys(e){let t=Object.keys(e),i=0,s={};for(;i<t.length;)s[t[i]]=e[t[i]],i++;return s}frameChartSeries(e){let t=Object.keys(e),i=0,s={};for(;i<t.length;)this.accumulationType.indexOf(this.parent.chartSettings.chartSeries.type)>-1&&["fill","dashArray","width","segmentAxis","drawType","isClosed","segments","stackingGroup","marker","errorBar","trendlines","minRadius","splineType","maxRadius","cardinalSplineTension","columnWidth","columnSpacing","cornerRadius"].indexOf(t[i])>-1||this.accumulationType.indexOf(this.parent.chartSettings.chartSeries.type)<0&&["endAngle","explode","explodeAll","explodeIndex","explodeOffset","gapRatio","groupMode","groupTo","neckHeight","neckWidth","pyramidMode","startAngle","dataLabel","innerRadius"].indexOf(t[i])>-1||(s[t[i]]=e[t[i]]),i++;return s}bindChart(){this.parent.showWaitingPopup();let e=this.configXAxis(),t=this.configTooltipSettings(),i=this.configLegendSettings(),s=this.configZoomSettings(),o=this.frameAxesWithRows(),l=this.chartSettings.chartSeries.type;"Both"===this.parent.displayOption.view?this.element="Chart"===this.parent.displayOption.primary?this.parent.element.insertBefore(this.element?this.element:(0,a.az)("div",{className:dh,id:this.parent.element.id+"_chart"}),this.parent.element.querySelector(".e-grid")):this.parent.element.appendChild(this.element?this.element:(0,a.az)("div",{className:dh,id:this.parent.element.id+"_chart"})):this.element||(this.element=this.parent.element.appendChild((0,a.az)("div",{className:dh,id:this.parent.element.id+"_chart"}))),!this.chartElement&&this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&(this.parent.element.querySelector("."+dh).innerHTML="",this.chartElement=this.parent.element.querySelector("."+dh).appendChild((0,a.az)("div",{className:mh,id:this.parent.element.id+"_chartInner"}))),this.parent.element.querySelector("."+mh)&&(this.parent.element.querySelector("."+mh).innerHTML=""),this.element.style.minWidth=this.parent.showGroupingBar?"400px !important":"310px !important";let r=this.parent.width.toString();this.parent.showToolbar&&this.parent.grid&&(r=this.parent.getGridWidthAsNumber().toString());let h=this.getChartHeight();this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&this.accumulationType.indexOf(l)<0&&(this.parent.element.querySelector("."+dh).style.height=("auto"===h?this.getChartAutoHeight():h)+"px",this.parent.element.querySelector("."+dh).style.width=r+"px","Polar"!==this.parent.chartSettings.chartSeries.type&&"Radar"!==this.parent.chartSettings.chartSeries.type&&(this.parent.element.querySelector("."+dh).style.overflow="auto",this.parent.element.querySelector("."+dh).style.overflowX="hidden")),this.parent.chart&&("accumulationchart"===this.parent.chart.getModuleName()&&this.accumulationType.indexOf(l)<0||"chart"===this.parent.chart.getModuleName()&&this.accumulationType.indexOf(l)>-1)&&(this.parent.chart.destroy(),(0,a.Ys)("#"+this.parent.element.id+"_chart",this.parent.element)&&((0,a.Ys)("#"+this.parent.element.id+"_chart",this.parent.element).innerHTML="",(0,a.Ys)("#"+this.parent.element.id+"_chart",this.parent.element).appendChild((0,a.az)("div",{className:mh,id:this.parent.element.id+"_chartInner"})))),!(this.parent.chart&&this.parent.chart.element&&this.parent.element.querySelector(".e-chart")||this.parent.element.querySelector(".e-accumulationchart"))||this.parent.toolbarModule&&this.parent.toolbarModule.isMultiAxisChange?(this.parent.toolbarModule&&this.parent.toolbarModule.isMultiAxisChange&&this.parent.chart&&(this.parent.chart.isDestroyed||this.parent.chart.destroy(),this.parent.chart=void 0,(0,a.Ys)("#"+this.parent.element.id+"_chart",this.parent.element).innerHTML="",(0,a.Ys)("#"+this.parent.element.id+"_chart",this.parent.element).appendChild((0,a.az)("div",{className:mh,id:this.parent.element.id+"_chartInner"})),this.parent.toolbarModule.isMultiAxisChange=!1),ds.Inject(ys,Ls,Ps,xs,Ts,Is,Fs,bs,As,Os,Ns,Ys,Cs,Ms,Ss,ks,Rs,Ds,Gs,Qs,qs,Bs,us,Ws,Xs,Vs,Js,zs,js,gs,Hs),ho.Inject(ro,po,uo,mo,go,bo,Js),this.parent.chart=this.accumulationType.indexOf(l)>-1?new ho({series:this.chartSeries.length>0?this.chartSeries:[{}],legendSettings:i,tooltip:t,width:r,height:h.toString(),title:this.chartSettings.title,enableSmartLabels:this.chartSettings.enableSmartLabels,center:this.chartSettings.pieCenter,enableBorderOnMouseMove:this.chartSettings.enableBorderOnMouseMove,highLightMode:this.chartSettings.highlightMode,highlightPattern:this.chartSettings.highlightPattern,titleStyle:this.chartSettings.titleStyle,subTitle:this.chartSettings.subTitle,subTitleStyle:this.chartSettings.subTitleStyle,margin:this.chartSettings.margin,border:this.chartSettings.border,background:this.chartSettings.background,theme:this.chartSettings.theme,selectionMode:this.chartSettings.accumulationSelectionMode,isMultiSelect:this.chartSettings.isMultiSelect,enableExport:this.chartSettings.enableExport,selectedDataIndexes:this.chartSettings.selectedDataIndexes,enableAnimation:this.chartSettings.enableAnimation,useGroupingSeparator:this.chartSettings.useGroupingSeparator,locale:this.parent.locale,enableRtl:this.parent.enableRtl,beforePrint:this.chartSettings.beforePrint?this.chartSettings.beforePrint.bind(this):void 0,animationComplete:this.chartSettings.animationComplete?this.chartSettings.animationComplete.bind(this):void 0,legendRender:this.chartSettings.legendRender?this.chartSettings.legendRender.bind(this):void 0,textRender:this.chartSettings.textRender?this.chartSettings.textRender.bind(this):void 0,pointRender:this.chartSettings.pointRender?this.chartSettings.pointRender.bind(this):void 0,seriesRender:this.chartSettings.seriesRender?this.chartSettings.seriesRender.bind(this):void 0,chartMouseMove:this.chartSettings.chartMouseMove?this.chartSettings.chartMouseMove.bind(this):void 0,chartMouseClick:this.chartSettings.chartMouseClick?this.chartSettings.chartMouseClick.bind(this):void 0,pointMove:this.chartSettings.pointMove?this.chartSettings.pointMove.bind(this):void 0,pointClick:this.pointClick.bind(this),chartMouseLeave:this.chartSettings.chartMouseLeave?this.chartSettings.chartMouseLeave.bind(this):void 0,chartMouseDown:this.chartSettings.chartMouseDown?this.chartSettings.chartMouseDown.bind(this):void 0,chartMouseUp:this.chartSettings.chartMouseUp?this.chartSettings.chartMouseUp.bind(this):void 0,tooltipRender:this.tooltipRender.bind(this),loaded:this.loaded.bind(this),load:this.load.bind(this),resized:this.resized.bind(this)}):new ds({series:this.chartSeries.length>0?this.chartSeries:[{}],legendSettings:i,tooltip:t,zoomSettings:s,axes:"Polar"===l||"Radar"===l?[]:o.axes,rows:"Polar"===l||"Radar"===l?[{}]:"Bar"===l||"StackingBar"===l||"StackingBar100"===l&&this.chartSettings.enableMultipleAxis?[{height:"100%"}]:o.rows,columns:"Polar"===l||"Radar"===l?[{}]:"Bar"===l||"StackingBar"===l||"StackingBar100"===l&&this.chartSettings.enableMultipleAxis?o.columns:[{width:"100%"}],primaryYAxis:"Polar"===l||"Radar"===l?o.axes[0]:{visible:!1},primaryXAxis:e,width:r,height:"Polar"!==this.parent.chartSettings.chartSeries.type&&"Radar"!==this.parent.chartSettings.chartSeries.type&&this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&this.parent.dataSourceSettings.values.length>0?Number(h)>235*this.parent.dataSourceSettings.values.length+100?isNaN(Number(h))?h.toString():(Number(h)-5).toString():!isNaN(Number(h))||this.parent.dataSourceSettings.values.length>1?(235*this.parent.dataSourceSettings.values.length+100).toString():h.toString():h.toString(),title:this.chartSettings.title,titleStyle:this.chartSettings.titleStyle,subTitle:this.chartSettings.subTitle,subTitleStyle:this.chartSettings.subTitleStyle,margin:this.chartSettings.margin,border:this.chartSettings.border,background:this.chartSettings.background,chartArea:this.chartSettings.chartArea,palettes:this.chartSettings.palettes,theme:this.chartSettings.theme,crosshair:this.chartSettings.crosshair,selectionMode:this.chartSettings.selectionMode,isMultiSelect:this.chartSettings.isMultiSelect,enableExport:this.chartSettings.enableExport,selectedDataIndexes:this.chartSettings.selectedDataIndexes,isTransposed:this.chartSettings.isTransposed,enableAnimation:this.chartSettings.enableAnimation,enableCanvas:this.chartSettings.enableCanvas,useGroupingSeparator:this.chartSettings.useGroupingSeparator,description:this.chartSettings.description,tabIndex:this.chartSettings.tabIndex,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableSideBySidePlacement:this.chartSettings.enableSideBySidePlacement,beforePrint:this.chartSettings.beforePrint?this.chartSettings.beforePrint.bind(this):void 0,animationComplete:this.chartSettings.animationComplete?this.chartSettings.animationComplete.bind(this):void 0,legendRender:this.chartSettings.legendRender?this.chartSettings.legendRender.bind(this):void 0,textRender:this.chartSettings.textRender?this.chartSettings.textRender.bind(this):void 0,pointRender:this.chartSettings.pointRender?this.chartSettings.pointRender.bind(this):void 0,seriesRender:this.chartSettings.seriesRender?this.chartSettings.seriesRender.bind(this):void 0,axisMultiLabelRender:this.chartSettings.multiLevelLabelRender?this.chartSettings.multiLevelLabelRender.bind(this):void 0,chartMouseMove:this.chartSettings.chartMouseMove?this.chartSettings.chartMouseMove.bind(this):void 0,chartMouseClick:this.chartSettings.chartMouseClick?this.chartSettings.chartMouseClick.bind(this):void 0,pointMove:this.chartSettings.pointMove?this.chartSettings.pointMove.bind(this):void 0,pointClick:this.pointClick.bind(this),chartMouseLeave:this.chartSettings.chartMouseLeave?this.chartSettings.chartMouseLeave.bind(this):void 0,chartMouseDown:this.chartSettings.chartMouseDown?this.chartSettings.chartMouseDown.bind(this):void 0,chartMouseUp:this.chartSettings.chartMouseUp?this.chartSettings.chartMouseUp.bind(this):void 0,dragComplete:this.chartSettings.dragComplete?this.chartSettings.dragComplete.bind(this):void 0,zoomComplete:this.chartSettings.zoomComplete?this.chartSettings.zoomComplete.bind(this):void 0,scrollStart:this.chartSettings.scrollStart?this.chartSettings.scrollStart.bind(this):void 0,scrollEnd:this.chartSettings.scrollEnd?this.chartSettings.scrollEnd.bind(this):void 0,scrollChanged:this.chartSettings.scrollChanged?this.chartSettings.scrollChanged.bind(this):void 0,tooltipRender:this.tooltipRender.bind(this),loaded:this.loaded.bind(this),load:this.load.bind(this),resized:this.resized.bind(this),axisLabelRender:this.axisLabelRender.bind(this),multiLevelLabelClick:this.multiLevelLabelClick.bind(this)}),this.parent.chart.isStringTemplate=!0):(this.parent.chart.series=this.chartSeries,this.parent.chart.title=this.parent.chartSettings.title,this.parent.chart.subTitle=this.parent.chartSettings.subTitle,this.parent.chart.background=this.parent.chartSettings.background,this.parent.chart.theme=this.parent.chartSettings.theme,this.parent.chart.legendSettings=i,this.parent.chart.selectionMode=this.parent.chartSettings.selectionMode,this.parent.chart.enableExport=this.parent.chartSettings.enableExport,this.parent.chart.isMultiSelect=this.parent.chartSettings.isMultiSelect,this.parent.chart.enableAnimation=this.parent.chartSettings.enableAnimation,this.parent.chart.useGroupingSeparator=this.parent.chartSettings.useGroupingSeparator,this.parent.chart.highlightPattern=this.parent.chartSettings.highlightPattern,this.accumulationType.indexOf(l)>-1?(this.parent.chart.enableBorderOnMouseMove=this.parent.chartSettings.enableBorderOnMouseMove,this.parent.chart.highLightMode=this.parent.chartSettings.highlightMode,this.parent.chart.enableSmartLabels=this.parent.chartSettings.enableSmartLabels):(this.parent.chart.palettes=this.parent.chartSettings.palettes,this.parent.chart.isTransposed=this.parent.chartSettings.isTransposed,this.parent.chart.enableSideBySidePlacement=this.parent.chartSettings.enableSideBySidePlacement,this.parent.chart.tabIndex=this.parent.chartSettings.tabIndex,this.parent.chart.description=this.parent.chartSettings.description,this.parent.chart.enableCanvas=this.parent.chartSettings.enableCanvas),"Polar"===l||"Radar"===l?(this.parent.chart.primaryXAxis=e,this.parent.chart.primaryYAxis.visible=!0,this.parent.chart.primaryYAxis=o.axes[0],this.parent.chart.axes=[],this.parent.chart.rows=[{}]):this.accumulationType.indexOf(l)<0&&"chart"===this.parent.chart.getModuleName()&&(this.parent.chart.primaryYAxis.visible=!1,this.parent.chart.primaryXAxis=e,this.parent.chart.axes=o.axes,"Bar"===l||"StackingBar"===l||"StackingBar100"===l&&this.chartSettings.enableMultipleAxis?(this.parent.chart.rows=[{height:"100%"}],this.parent.chart.columns=o.columns):(this.parent.chart.rows=o.rows,this.parent.chart.columns=[{width:"100%"}])),this.parent.chart.refresh(),this.accumulationType.indexOf(l)>-1&&"accumulationchart"===this.parent.chart.getModuleName()&&(0===this.parent.dataSourceSettings.rows.length||0===this.parent.dataSourceSettings.columns.length)&&(this.parent.hideWaitingPopup(),this.parent.pivotFieldListModule&&(0,n.v3)(this.parent.pivotFieldListModule.fieldListSpinnerElement))),this.parent.chart.appendTo(this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis?"#"+this.parent.element.id+"_chartInner":"#"+this.parent.element.id+"_chart")}pointClick(e){let t=e.series.dataSource?e.series.dataSource:this.parent.chart.series[e.seriesIndex].dataSource;if((["Pie","Funnel","Doughnut","Pyramid","Radar","Polar"].indexOf(this.parent.chartSettings.chartSeries.type)>-1||!this.parent.chartSettings.showMultiLevelLabels)&&this.parent.dataSourceSettings.rows.length>1){this.pivotIndex={rIndex:t?t[e.pointIndex].rIndex:void 0,cIndex:t?t[e.pointIndex].cIndex:void 0},this.creatMenu();let i=this.parent.element.getBoundingClientRect(),s=(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:0)+(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:0)+(window.scrollY||document.documentElement.scrollTop)+i.top;this.accumulationMenu.open(s+e.y,e.x+i.left+(window.scrollX||document.documentElement.scrollLeft))}else if((this.parent.allowDrillThrough||this.parent.editSettings.allowEditing)&&this.parent.drillThroughModule){let i=t[e.pointIndex].rIndex,s=t[e.pointIndex].cIndex;this.parent.drillThroughModule.executeDrillThrough(this.parent.pivotValues[i][s],i,s)}this.parent.trigger("chartPointClick",e)}frameAxesWithRows(){let e=[],t=[],i=[],s=this.persistSettings.chartSeries&&("StackingColumn100"===this.persistSettings.chartSeries.type||"StackingBar100"===this.persistSettings.chartSeries.type||"StackingArea100"===this.persistSettings.chartSeries.type),o=["PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal"];if(this.chartSettings.enableMultipleAxis){let l=0,a=100/this.dataSourceSettings.values.length+"%";for(let r of this.dataSourceSettings.values){let n,h=this.engineModule.fieldList[r.name],d=("olap"===this.parent.dataType?"":this.parent.localeObj.getConstant(h.aggregateType)+" "+this.parent.localeObj.getConstant("of")+" ")+h.caption;for(let e of this.dataSourceSettings.formatSettings)if(e.name===r.name){n=e;break}let c=-1!==br.inArray(h.aggregateType,o)?"P2":n?null===n.format.toLowerCase().match(/n|p|c/)?"N":n.format:"olap"===this.parent.dataType?this.getFormat(h.formatString):"N",p="Polar"===this.chartSettings.chartSeries.type||"Radar"===this.chartSettings.chartSeries.type,u={};u=this.persistSettings.primaryYAxis?this.frameObjectWithKeys(this.persistSettings.primaryYAxis):u,u.labelFormat=u.labelFormat?u.labelFormat:s?"":p?"N":c,u.title=u.title?u.title:d,u.plotOffsetTop=u.plotOffsetTop?u.plotOffsetTop:"Bar"===this.chartSettings.chartSeries.type||"StackingBar"===this.chartSettings.chartSeries.type||"StackingBar100"===this.chartSettings.chartSeries.type?50:30,p||(u.name=this.measuresNames[r.name]?this.measuresNames[r.name]:r.name),e=e.concat(u),"Stacked"===this.chartSettings.multipleAxisMode?(u.rowIndex=l,u.columnIndex=l,t.push({height:a}),i.push({width:a})):(u.rowIndex=0,u.columnIndex=0,t=[{height:"100%"}],i=[{width:"100%"}]),l++}}else{let l,a,r=this.engineModule.fieldList[this.currentMeasure],n=("olap"===this.parent.dataType?"":this.parent.localeObj.getConstant(r.aggregateType)+" "+this.parent.localeObj.getConstant("of")+" ")+r.caption;for(let e of this.dataSourceSettings.formatSettings)if(e.name===this.currentMeasure){l=e;break}l&&(a=l.format.length);let h={},d=-1!==br.inArray(r.aggregateType,o)?"P2":l?null===l.format.toLowerCase().match(/n[0-10]|p[0-10]|c[0-10]/)||a>3?"N":l.format:"olap"===this.parent.dataType?this.getFormat(r.formatString):"N";h=this.persistSettings.primaryYAxis?this.frameObjectWithKeys(this.persistSettings.primaryYAxis):h,h.rowIndex=0,h.columnIndex=0,"Polar"!==this.chartSettings.chartSeries.type&&"Radar"!==this.chartSettings.chartSeries.type&&(h.name=this.measuresNames[this.currentMeasure]?this.measuresNames[this.currentMeasure]:this.currentMeasure),h.labelFormat=h.labelFormat?h.labelFormat:s?"":d,h.title=h.title?h.title:n,e=e.concat(h),t.push({height:"100%"}),i.push({width:"100%"})}return{axes:e,rows:t,columns:i}}getFormat(e){return"Currency"===e?"C":"Percent"===e?"P":"N"}getColumnTotalIndex(e){let t={},i=Object.keys(e);for(let s of i){let i,o=e[Number(s)];if(!(0,a.le)(o)){i=Object.keys(o);for(let e of i){let i=o[Number(e)];if(!(0,a.le)(i)){if("column"!==i.axis)return t;("sum"===i.type||0!==this.dataSourceSettings.columns.length&&"grand sum"===i.type)&&-1!==i.rowSpan&&(t[i.colIndex]=i.colIndex)}}}}return t}groupHierarchyWithLevels(e){this.fieldPosition=[];let t={},i=0,s={};this.measurePos=this.engineModule.tupRowInfo[0].measurePosition;for(let l=0;l<e.length;l++){let s=e[l][0];s&&"row"===s.axis&&"grand sum"!==s.type&&((0,a.le)(t[s.hierarchy])?(3===s.memberType?i===this.measurePos?(this.fieldPosition[this.measurePos]=s.hierarchy,t[s.hierarchy]={[s.levelUniqueName]:s.levelUniqueName}):i--:(this.fieldPosition[i]=s.hierarchy,t[s.hierarchy]={[s.levelUniqueName]:s.levelUniqueName}),i++):t[s.hierarchy][s.levelUniqueName]=s.levelUniqueName)}let o=-1;for(let l=0;l<this.fieldPosition.length;l++)this.measurePos!==l&&(s[this.fieldPosition[l]]={start:o+1,end:o+Object.keys(t[this.fieldPosition[l]]).length},o=s[this.fieldPosition[l]].end);return s}frameMultiLevelLabels(){let e=Object.keys(this.headerColl),t=this.headerColl[-.5];for(let o of e){let e=Number(o),i=this.headerColl[e],s=0,l=!1;for(;s<=this.maxLevel;)l?i[s]||(i[s]={name:i[s-1].name,text:"",hasChild:i[s-1].hasChild,isDrilled:i[s-1].isDrilled,levelName:i[s-1].levelName,level:i[s-1].level,fieldName:i[s-1].fieldName,rowIndex:i[s-1].rowIndex,colIndex:i[s-1].colIndex,span:-1}):i[s]?l=!0:i[s]=t[s],s++;t=this.headerColl[e]}let i={};for(let o of e){let e=Number(o),s=this.headerColl[e],l=Object.keys(s);for(let o of l){let l=Number(o);if(i[l]){let o=i[l].length;s[l].levelName===t[l].levelName?i[l][o-1].end=i[l][o-1].end+1:i[l].push({start:e,end:e+1,text:s[l].text,type:-1===s[l].span?"WithoutTopandBottomBorder":"WithoutTopBorder",customAttributes:s[l]})}else i[l]=[{start:e,end:e+1,text:s[l].text,type:-1===s[l].span?"WithoutTopandBottomBorder":"WithoutTopBorder",customAttributes:s[l]}]}t=s}let s=[];for(let o=Object.keys(i).length-1;o>-1;o--)s.push({categories:i[o],border:{width:1},overflow:"Trim"});return s}getZoomFactor(){this.calculatedWidth=isNaN(Number(this.parent.width))?this.parent.width.indexOf("%")>-1?this.parent.element.clientWidth*(parseFloat(this.parent.width)/100):this.parent.width.indexOf("px")>-1?Number(this.parent.width.toString().split("px")[0]):this.parent.element.clientWidth:Number(this.parent.width);let e=10*this.chartSeries.length>120?10*this.chartSeries.length:120,t=this.chartSeries.length>0?this.calculatedWidth/(Object.keys(this.chartSeries[0].dataSource).length*e):1;return t=t<1&&t>0?t:1,t}configTooltipSettings(){let e=this.persistSettings.tooltip?this.persistSettings.tooltip:this.chartSettings.tooltip;return e.enable=void 0===e.enable||e.enable,e.enable&&e.template&&(this.templateFn=this.parent.templateParser(e.template)),this.parent.tooltipTemplate&&(e.template=e.template?e.template:this.parent.tooltipTemplate),(0,a.xr)()?(this.parent.allowServerDataBinding=!1,this.parent.setProperties({chartSettings:{tooltip:{header:e.header?e.header:""}}},!0),this.parent.allowServerDataBinding=!0):e.header=e.header?e.header:"",e.enableMarker=void 0===e.enableMarker||e.enableMarker,e}configLegendSettings(){let e={};if(this.chartSettings.legendSettings){let t=0,i=Object.keys(this.chartSettings.legendSettings);for(;t<i.length;)e[i[t]]=this.chartSettings.legendSettings[i[t]],t++}return this.accumulationType.indexOf(this.chartSettings.chartSeries.type)>-1&&void 0===e.visible&&(e.visible=!1),e.padding=e.padding?e.padding:25,e.shapePadding=e.shapePadding?e.shapePadding:10,e}configXAxis(){let e={};return e=this.persistSettings.primaryXAxis?this.frameObjectWithKeys(this.persistSettings.primaryXAxis):e,e.valueType="Category",e.labelIntersectAction=e.labelIntersectAction?e.labelIntersectAction:"Rotate45",e.title=e.title?e.title:this.dataSourceSettings.rows.map(e=>e.caption||e.name).join(" / "),e.zoomFactor=(0,a.le)(this.parent.chartSettings.primaryXAxis.zoomFactor)?this.getZoomFactor():this.parent.chartSettings.primaryXAxis.zoomFactor,this.parent.chartSettings.zoomSettings.enableScrollbar||(e.zoomFactor=1),this.chartSettings.showMultiLevelLabels&&"Pareto"!==this.chartSettings.chartSeries.type?(e.multiLevelLabels=this.frameMultiLevelLabels(),e.border={width:1,type:"WithoutTopandBottomBorder"},e.majorTickLines={width:0,height:-10}):(e.multiLevelLabels=[],e.border={width:1,type:"Rectangle"},e.majorTickLines={width:0,height:5}),e}configZoomSettings(){let e=this.chartSettings.zoomSettings;return e.enableSelectionZooming=void 0===e.enableSelectionZooming||e.enableSelectionZooming,e.enableScrollbar=void 0===e.enableScrollbar||e.enableScrollbar,e}tooltipRender(e){let t=e.series.yAxisName?e.series.yAxisName.split("_CumulativeAxis")[0]:this.chartSettings.enableMultipleAxis&&this.accumulationType.indexOf(this.chartSettings.chartSeries.type)<0?e.series.name?e.series.name.split(" | ")[1]:e.data.seriesName?e.data.seriesName.split(" | ")[1]:this.currentMeasure:this.measuresNames[this.currentMeasure]?this.measuresNames[this.currentMeasure]:this.currentMeasure,i=e.series.dataSource?e.series.dataSource:this.parent.chart.series[e.data.seriesIndex].dataSource,s=i?i[e.data.pointIndex].rIndex:void 0,o=i?i[e.data.pointIndex].cIndex:void 0,l=this.engineModule.fieldList[this.measuresNames[t]?this.measuresNames[t]:t],a="olap"===this.parent.dataType?"":this.parent.localeObj.getConstant(l.aggregateType),r=("olap"===this.parent.dataType?"":a+" "+this.parent.localeObj.getConstant("of")+" ")+l.caption,n=this.accumulationType.indexOf(this.parent.chartSettings.chartSeries.type)<0?e.text.split("<b>")[1].split("</b>")[0]:this.engineModule.pivotValues[s][o].formattedText,h=this.engineModule.formatFields[l.id],d=h&&h.format&&null!==h.format.toLowerCase().match(/n|p|c/)&&this.chartSettings.useGroupingSeparator?"olap"===this.parent.dataType?this.engineModule.getFormattedValue(e.point.y,l.id,n):this.parent.engineModule.getFormattedValue(e.point.y,l.id).formattedText:n,c=e.series.name?e.series.name.split(" | ")[0]:e.data.seriesName.split(" | ")[0],p=e.point.x;if(this.parent.tooltipTemplate&&void 0!==this.parent.getTooltipTemplate()||this.chartSettings.tooltip.template){let t,r=i?this.parent.getHeaderField(s,o,"row"):"",n=i?this.parent.getHeaderField(s,o,"Column"):"",h={rowHeaders:p,columnHeaders:c,aggregateType:a,value:d,valueField:l.caption,rowFields:r,columnFields:n};t=this.parent.chartSettings&&this.parent.chartSettings.tooltip&&this.parent.chartSettings.tooltip.enable&&this.parent.chartSettings.tooltip.template?this.tooltipTemplateFn()(h,this,"tooltipTemplate",this.element.id+"1tooltipTemplate")[0].outerHTML:this.parent.getTooltipTemplate()(h,this,"tooltipTemplate",this.element.id+"tooltipTemplate")[0].outerHTML,e.template=t}else e.text=r+": "+d+(0===this.dataSourceSettings.columns.length?"":" <br/>"+this.parent.localeObj.getConstant("column")+": "+c)+(0===this.dataSourceSettings.rows.length?"":" <br/>"+this.parent.localeObj.getConstant("row")+": "+p),this.parent.trigger("chartTooltipRender",e)}tooltipTemplateFn(){return this.templateFn}loaded(e){if(this.parent.isChartLoaded=!0,this.parent.chart&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.showFieldList&&"Chart"===this.parent.currentView&&this.parent.groupingBarModule.alignIcon(),this.chartSettings.showMultiLevelLabels){let e=br.inArray(this.chartSettings.chartSeries.type,["Bar","StackingBar","StackingBar100"])>-1?"_chartYAxisMultiLevelLabel0":"_chartXAxisMultiLevelLabel0";(0,a.le)((0,a.Ys)("#"+this.parent.element.id+e,this.parent.element))||this.parent.element.querySelector("#"+this.parent.element.id+e).setAttribute("cursor","pointer")}["Pie","Funnel","Pyramid","Doughnut","Radar","Polar"].indexOf(this.parent.chartSettings.chartSeries.type)>=0&&this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis?this.parent.element.querySelector("."+dh).style.overflow="visible":this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&(this.parent.element.querySelector("."+dh).style.overflow="auto",this.parent.element.querySelector("."+dh).style.overflowX="hidden"),this.parent.chart.height=["Pie","Funnel","Pyramid","Doughnut","Radar","Polar"].indexOf(this.parent.chartSettings.chartSeries.type)<0&&this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&this.parent.dataSourceSettings.values.length>0?Number(this.parent.chart.height)>235*this.parent.dataSourceSettings.values.length+100?isNaN(Number(this.getChartHeight()))?this.getChartHeight().toString():(Number(this.getChartHeight())-5).toString():!isNaN(Number(this.getChartHeight()))||this.parent.dataSourceSettings.values.length>1?(235*this.parent.dataSourceSettings.values.length+100).toString():this.getChartHeight().toString():this.getChartHeight().toString(),this.updateView(),this.parent.notify(Nr,{}),this.parent.trigger("chartLoaded",e),("Server"===this.parent.dataSourceSettings.mode&&this.parent.isServerWaitingPopup||"Local"===this.parent.dataSourceSettings.mode)&&this.parent.hideWaitingPopup()}updateView(){this.parent.grid&&this.parent.chart&&this.parent.showToolbar&&("Table"===this.parent.currentView?(this.parent.grid.element.style.display="",this.parent.chart.element.style.display="none",this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-pivot-grouping-bar")&&this.parent.element.querySelector(".e-chart-grouping-bar")&&(this.parent.element.querySelector(".e-pivot-grouping-bar").style.display="",this.parent.element.querySelector(".e-chart-grouping-bar").style.display="none"),this.parent.chartSettings.enableMultipleAxis&&this.parent.chartSettings.enableScrollOnMultiAxis&&(this.parent.element.querySelector(".e-pivotchart").style.display="none")):(this.parent.grid.element.style.display="none",this.parent.chart.element.style.display="",this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-pivot-grouping-bar")&&this.parent.element.querySelector(".e-chart-grouping-bar")&&(this.parent.element.querySelector(".e-pivot-grouping-bar").style.display="none",this.parent.element.querySelector(".e-chart-grouping-bar").style.display=""),this.parent.chartSettings.enableMultipleAxis&&this.parent.chartSettings.enableScrollOnMultiAxis&&(this.parent.element.querySelector(".e-pivotchart").style.display="")))}creatMenu(){this.accumulationMenu&&!this.accumulationMenu.isDestroyed&&this.accumulationMenu.destroy();let e=(this.parent.allowDrillThrough||this.parent.editSettings.allowEditing)&&this.parent.drillThroughModule?["expand","collapse","drillThrough","exit"]:["expand","collapse","exit"],t=[];for(let a=0;a<e.length;a++)t.push({id:this.parent.element.id+"_DrillMenuChart_"+e[a],text:this.parent.localeObj.getConstant(e[a]),items:[]});let i=this.getMenuItems(),s=[],o=[];for(let a=0;a<i.length;a++)"expand"===i[a].type?s.push({id:this.element.id+"drillExpand_"+i[a].key,text:i[a].value}):o.push({id:this.element.id+"drillCollapse_"+i[a].key,text:i[a].value});s.length>0&&(t[0].items=s),o.length>0&&(t[1].items=o);let l,r={cssClass:this.parent.element.id+"_accumulationChart",items:t,enableRtl:this.parent.enableRtl,beforeOpen:this.drillMenuOpen.bind(this),select:this.drillMenuSelect.bind(this),locale:this.parent.locale};this.accumulationMenu=new d.xV(r),(0,a.Ys)("#"+this.parent.element.id+"_accumulationChart",this.parent.element)?(l=(0,a.Ys)("#"+this.parent.element.id+"_accumulationChart",this.parent.element),l.innerHTML=""):(l=(0,a.az)("ul",{id:this.parent.element.id+"_accumulationChart"}),this.parent.element.appendChild(l)),this.accumulationMenu.isStringTemplate=!0,this.accumulationMenu.appendTo(l)}drillMenuOpen(e){e.items[0]&&e.items[0].text===this.parent.localeObj.getConstant("expand")&&e.items[0].items&&0===e.items[0].items.length&&this.accumulationMenu.enableItems([this.parent.localeObj.getConstant("expand")],!1),e.items[1]&&e.items[1].text===this.parent.localeObj.getConstant("collapse")&&e.items[1].items&&0===e.items[1].items.length&&this.accumulationMenu.enableItems([this.parent.localeObj.getConstant("collapse")],!1)}getMenuItems(){let e=this.pivotIndex.rIndex,t=[],i=this.engineModule.pivotValues,s=[],o=i[e][this.pivotIndex.cIndex],l=!i[e][0].isNamedSet&&i[e][0].hasChild?i[e][0].level:void 0,a="olap"===this.parent.dataType?o.rowHeaders.toString().split(/~~|::/):o.rowHeaders.toString().split(this.engineModule.valueSortSettings.headerDelimiter);for(;i[e][0];){if(o=i[e][0],0!==a.length&&a.indexOf(o.formattedText.toString())===a.length-1){o.hasChild&&!o.isNamedSet&&s.indexOf(o.level)<0&&(l?l>=o.level:0!==l||0===o.level)&&(t.push(o.isDrilled&&o.hasChild?{key:e,type:"collapse",value:o.formattedText}:{key:e,type:"expand",value:o.formattedText}),s.push(o.level),l=l?l-1:o.level-1);let i=a.indexOf(o.formattedText.toString());a.splice(i,1)}0===o.level&&o.hasChild&&!o.isNamedSet&&(l=void 0,s=[]),e--}return t}drillMenuSelect(e){let t="olap"===this.parent.dataType?this.parent.olapEngineModule.pivotValues:this.parent.engineModule.pivotValues,i=e.element.id.split("_DrillMenuChart_")[1];if(0===e.element.id.indexOf(this.element.id+"drill")){let i=e.element.id.split(this.element.id+"drill")[1].indexOf("Expand")>=0?"drillExpand":"drillCollapse",s=Number(e.element.id.split(this.element.id+i+"_")[1]),o=t[s][0],l="olap"===this.parent.dataType?o.formattedText:o.actualText?o.actualText.toString():o.formattedText.toString(),a=o.formattedText?o.formattedText.toString():l,r=o.hasChild&&!o.isNamedSet?(o.isDrilled?" - ":" + ")+a:a,n="olap"===this.parent.dataType?this.engineModule.tupRowInfo[o.ordinal]:void 0,h=n?n.uNameCollection:o.valueSort.levelName.toString(),d={fieldName:o.valueSort.axis,level:o.level,hasChild:o.hasChild,levelName:h,name:l,text:r,rowIndex:s,colIndex:0,isDrilled:o.isDrilled,cell:o};"olap"===this.parent.dataType?this.parent.onDrill(void 0,d):this.onDrill({customAttributes:d})}else"drillThrough"===i?this.parent.drillThroughModule.executeDrillThrough(t[this.pivotIndex.rIndex][this.pivotIndex.cIndex],this.pivotIndex.rIndex,this.pivotIndex.rIndex):"exit"===i&&this.accumulationMenu.close()}getChartHeight(){let e,t;if((0,a.le)(this.parent.getHeightAsNumber()))e="auto";else{let i=this.parent.showToolbar?6:5;e=(this.parent.getHeightAsNumber()-i).toString(),t=this.parent.getHeightAsNumber()-i}return(0,a.le)(this.parent.getHeightAsNumber())?e="auto":this.parent.showToolbar&&this.parent.showGroupingBar?e=(t-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42)-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:62)).toString():this.parent.showToolbar?e=(t-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42)).toString():this.parent.showGroupingBar?e=(t-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:62)).toString():(this.parent.chart&&parseInt(this.parent.chart.height,10)<200||t<200)&&(e="200"),e}getChartAutoHeight(){let e=this.parent.element.offsetHeight;return this.parent.showToolbar&&this.parent.showGroupingBar?e=this.parent.element.offsetHeight-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42)-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:62):this.parent.showToolbar?e=this.parent.element.offsetHeight-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42):this.parent.showGroupingBar&&(e=this.parent.element.offsetHeight-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:62)),e}axisLabelRender(e){this.chartSettings.showMultiLevelLabels&&"Pareto"!==this.chartSettings.chartSeries.type&&"primaryXAxis"===e.axis.name&&(e.text=""),this.parent.trigger("chartAxisLabelRender",e)}multiLevelLabelClick(e){let t={axis:e.axis,text:e.text,cell:(0,a.le)(e.customAttributes)?void 0:e.customAttributes.cell,cancel:!1};this.parent.trigger("multiLevelLabelClick",t),!t.cancel&&e.customAttributes&&e.customAttributes.hasChild&&!e.customAttributes.cell.isNamedSet&&("olap"===this.parent.dataType?this.parent.onDrill(void 0,e.customAttributes):this.onDrill(e))}onDrill(e){let t=e.customAttributes,i=this.dataSourceSettings.drilledMembers[0]&&this.dataSourceSettings.drilledMembers[0].delimiter?this.dataSourceSettings.drilledMembers[0].delimiter:"**",s=t.fieldName,o=this.engineModule.pivotValues[t.rowIndex][t.colIndex],l=o.valueSort.levelName.split(this.engineModule.valueSortSettings.headerDelimiter).join(i),r=!1;if(0===this.dataSourceSettings.drilledMembers.length)this.parent.setProperties({dataSourceSettings:{drilledMembers:[{name:s,items:[l],delimiter:i}]}},!0);else{for(let e=0;e<this.dataSourceSettings.drilledMembers.length;e++){let t=this.dataSourceSettings.drilledMembers[e];if(l=l.split(i).join(t.delimiter?t.delimiter:i),i=t.delimiter=t.delimiter?t.delimiter:i,t.name===s){r=!0;let e=t.items.indexOf(l);e>-1?t.items.splice(e,1):t.items.push(l)}}r||this.dataSourceSettings.drilledMembers.push({name:s,items:[l],delimiter:i})}this.parent.showWaitingPopup();let n=this,h={fieldName:s,memberName:l,delimiter:i,axis:"row",action:t.isDrilled?"up":"down",currentCell:o},d={drillInfo:h,pivotview:(0,a.xr)()?void 0:n.parent};n.parent.trigger(Lr,d);let c={dataSourceSettings:br.getClonedDataSourceSettings(this.parent.dataSourceSettings)};if(this.parent.trigger(vr,c),this.parent.setProperties({dataSourceSettings:c.dataSourceSettings},!0),n.parent.enableVirtualization)if((0,a.xr)()){let e="sfBlazor",t=window[e].copyWithoutCircularReferences([n.dataSourceSettings],n.dataSourceSettings),i=window[e].copyWithoutCircularReferences([h],h);window[e].copyWithoutCircularReferences([d],d),n.parent.interopAdaptor.invokeMethodAsync("PivotInteropMethod","onDrill",{dataSourceSettings:t,drilledItem:i}).then(e=>{n.parent.updateBlazorData(e,n.parent),n.parent.engineModule.drilledMembers=n.dataSourceSettings.drilledMembers,n.parent.allowServerDataBinding=!1,n.parent.setProperties({pivotValues:n.engineModule.pivotValues},!0),delete n.parent.bulkChanges.pivotValues,n.parent.allowServerDataBinding=!0,n.parent.renderPivotGrid()})}else"Server"===n.parent.dataSourceSettings.mode?n.parent.getEngine("onDrill",h,null,null,null,null,null):(n.engineModule.drilledMembers=n.dataSourceSettings.drilledMembers,n.engineModule.onDrill(h));else"Server"===n.parent.dataSourceSettings.mode?n.parent.getEngine("onDrill",h,null,null,null,null,null):n.engineModule.generateGridData(n.dataSourceSettings);n.parent.allowServerDataBinding=!1,n.parent.setProperties({pivotValues:n.engineModule.pivotValues},!0),delete n.parent.bulkChanges.pivotValues,n.parent.allowServerDataBinding=!0;let p={dataSourceSettings:br.getClonedDataSourceSettings(this.parent.dataSourceSettings),pivotValues:this.parent.pivotValues};this.parent.trigger(Sr,p),n.engineModule.pivotValues=p.pivotValues,n.parent.renderPivotGrid()}isAttributeDrill(e,t){let i=!1;for(let s=0;s<this.dataSourceSettings.drilledMembers.length;s++)if(this.dataSourceSettings.drilledMembers[s].name===e)for(let e=0;e<this.dataSourceSettings.drilledMembers[s].items.length;e++){let o=this.dataSourceSettings.drilledMembers[s].items[e].split(this.dataSourceSettings.drilledMembers[s].delimiter),l="";for(let e=0;e<o.length;e++)t[e]&&t[e].uName&&(l=l+(""===l?"":this.dataSourceSettings.drilledMembers[s].delimiter)+(t[e].uName.indexOf("[Measures]")>-1?"[Measures]":t[e].uName));if(l===this.dataSourceSettings.drilledMembers[s].items[e]){i=!0;break}}return i}load(e){e.chart.zoomModule&&(e.chart.zoomModule.isZoomed=!0),this.parent.trigger("chartLoad",e)}resized(e){(0,a.xr)()&&(e.chart=this.parent.chart),this.accumulationType.indexOf(this.chartSettings.chartSeries.type)<0&&(e.chart.primaryXAxis.zoomFactor=(0,a.le)(this.parent.chartSettings.primaryXAxis.zoomFactor)?this.getZoomFactor():this.parent.chartSettings.primaryXAxis.zoomFactor,this.parent.chartSettings.zoomSettings.enableScrollbar||(e.chart.primaryXAxis.zoomFactor=(0,a.le)(this.parent.chartSettings.primaryXAxis.zoomFactor)?1:this.parent.chartSettings.primaryXAxis.zoomFactor)),this.parent.trigger("chartResized",e)}destroy(){this.parent&&this.parent.isDestroyed||(this.engineModule&&(this.engineModule.fieldList={},this.engineModule={}),this.chartSeries&&(this.chartSeries=null),this.columnGroupObject&&(this.columnGroupObject=null),this.chartSettings&&(this.chartSettings=null),this.dataSourceSettings&&(this.dataSourceSettings=null),this.accumulationMenu&&!this.accumulationMenu.isDestroyed&&(this.accumulationMenu.destroy(),this.accumulationMenu=null),this.parent&&this.parent.chart&&!this.parent.chart.isDestroyed&&(this.parent.chart.destroy(),this.parent.chart=null))}}var Kh=(()=>(function(e){e.axisLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.axisTitleFont={size:"14px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.chartTitleFont={size:"15px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.chartSubTitleFont={size:"11px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.crosshairLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.tooltipLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.legendLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.stripLineLabelFont={size:"12px",fontWeight:"Regular",color:"#353535",fontStyle:"Normal",fontFamily:"Segoe UI"},e.stockEventFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"}}(Kh||(Kh={})),Kh))(),$h=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};class ed extends a.rt{}$h([(0,a.Z9)(!0)],ed.prototype,"enable",void 0),$h([(0,a.Z9)(1e3)],ed.prototype,"duration",void 0),$h([(0,a.Z9)(0)],ed.prototype,"delay",void 0);class td extends a.rt{}$h([(0,a.Z9)(null)],td.prototype,"value",void 0),$h([(0,a.Z9)(null)],td.prototype,"color",void 0),$h([(0,a.Z9)("0")],td.prototype,"dashArray",void 0);class id extends a.rt{}$h([(0,a.Z9)("Normal")],id.prototype,"fontStyle",void 0),$h([(0,a.Z9)("16px")],id.prototype,"size",void 0),$h([(0,a.Z9)("Normal")],id.prototype,"fontWeight",void 0),$h([(0,a.Z9)("")],id.prototype,"color",void 0),$h([(0,a.Z9)("Center")],id.prototype,"textAlignment",void 0),$h([(0,a.Z9)("Segoe UI")],id.prototype,"fontFamily",void 0),$h([(0,a.Z9)(1)],id.prototype,"opacity",void 0),$h([(0,a.Z9)("Trim")],id.prototype,"textOverflow",void 0);class sd extends a.rt{}$h([(0,a.Z9)(10)],sd.prototype,"left",void 0),$h([(0,a.Z9)(10)],sd.prototype,"right",void 0),$h([(0,a.Z9)(10)],sd.prototype,"top",void 0),$h([(0,a.Z9)(10)],sd.prototype,"bottom",void 0);class od extends a.rt{}$h([(0,a.Z9)("")],od.prototype,"color",void 0),$h([(0,a.Z9)(1)],od.prototype,"width",void 0);class ld extends a.rt{}$h([(0,a.Z9)(0)],ld.prototype,"x",void 0),$h([(0,a.Z9)(0)],ld.prototype,"y",void 0);class ad extends a.rt{}$h([(0,a.Z9)(0)],ad.prototype,"series",void 0),$h([(0,a.Z9)(0)],ad.prototype,"point",void 0);class rd extends a.rt{}$h([(0,a.Zz)({},od)],rd.prototype,"border",void 0),$h([(0,a.Z9)("transparent")],rd.prototype,"background",void 0),$h([(0,a.Z9)(1)],rd.prototype,"opacity",void 0),$h([(0,a.Z9)(null)],rd.prototype,"backgroundImage",void 0);class nd extends a.rt{}$h([(0,a.Z9)(!1)],nd.prototype,"enable",void 0),$h([(0,a.Z9)("")],nd.prototype,"dashArray",void 0),$h([(0,a.Zz)({color:null,width:1},od)],nd.prototype,"line",void 0),$h([(0,a.Z9)("Both")],nd.prototype,"lineType",void 0);class hd extends a.rt{}$h([(0,a.Z9)(!1)],hd.prototype,"visible",void 0),$h([(0,a.Z9)(null)],hd.prototype,"name",void 0),$h([(0,a.Z9)("transparent")],hd.prototype,"fill",void 0),$h([(0,a.Z9)(1)],hd.prototype,"opacity",void 0),$h([(0,a.Z9)(0)],hd.prototype,"angle",void 0),$h([(0,a.Z9)(!1)],hd.prototype,"enableRotation",void 0),$h([(0,a.Z9)("Auto")],hd.prototype,"position",void 0),$h([(0,a.Z9)(5)],hd.prototype,"rx",void 0),$h([(0,a.Z9)(5)],hd.prototype,"ry",void 0),$h([(0,a.Z9)("Center")],hd.prototype,"alignment",void 0),$h([(0,a.Zz)({width:null,color:null},od)],hd.prototype,"border",void 0),$h([(0,a.Zz)({left:5,right:5,top:5,bottom:5},sd)],hd.prototype,"margin",void 0),$h([(0,a.Zz)({size:"11px",color:"",fontStyle:"Normal",fontWeight:"Normal",fontFamily:"Segoe UI"},id)],hd.prototype,"font",void 0),$h([(0,a.Z9)(null)],hd.prototype,"template",void 0);class dd extends a.rt{}$h([(0,a.Z9)("Line")],dd.prototype,"type",void 0),$h([(0,a.Z9)(null)],dd.prototype,"color",void 0),$h([(0,a.Z9)(1)],dd.prototype,"width",void 0),$h([(0,a.Z9)(null)],dd.prototype,"length",void 0),$h([(0,a.Z9)("")],dd.prototype,"dashArray",void 0);class cd extends a.rt{}$h([(0,a.Z9)(!0)],cd.prototype,"visible",void 0),$h([(0,a.Zz)({width:null,color:null},od)],cd.prototype,"border",void 0),$h([(0,a.Zz)({size:"11px",color:"",fontStyle:"Normal",fontWeight:"Normal",fontFamily:"Segoe UI"},id)],cd.prototype,"font",void 0),$h([(0,a.Z9)("transparent")],cd.prototype,"fill",void 0),$h([(0,a.Z9)(0)],cd.prototype,"angle",void 0),$h([(0,a.Z9)(!1)],cd.prototype,"enableRotation",void 0),$h([(0,a.Z9)("Outside")],cd.prototype,"position",void 0),$h([(0,a.Z9)(5)],cd.prototype,"rx",void 0),$h([(0,a.Z9)(5)],cd.prototype,"ry",void 0),$h([(0,a.Z9)(null)],cd.prototype,"template",void 0),$h([(0,a.Zz)({},dd)],cd.prototype,"connectorStyle",void 0);class pd extends a.rt{}$h([(0,a.Z9)(!1)],pd.prototype,"visible",void 0),$h([(0,a.Z9)("Circle")],pd.prototype,"shape",void 0),$h([(0,a.Z9)("")],pd.prototype,"imageUrl",void 0),$h([(0,a.Z9)(5)],pd.prototype,"width",void 0),$h([(0,a.Z9)(5)],pd.prototype,"height",void 0),$h([(0,a.Zz)({width:2,color:null},od)],pd.prototype,"border",void 0),$h([(0,a.Zz)({x:0,y:0},ld)],pd.prototype,"offset",void 0),$h([(0,a.Z9)(null)],pd.prototype,"fill",void 0),$h([(0,a.Z9)(1)],pd.prototype,"opacity",void 0),$h([(0,a.Zz)({},hd)],pd.prototype,"dataLabel",void 0);class ud extends a.rt{}$h([(0,a.Z9)(1)],ud.prototype,"width",void 0),$h([(0,a.Z9)(10)],ud.prototype,"length",void 0),$h([(0,a.Z9)(null)],ud.prototype,"color",void 0),$h([(0,a.Z9)(1)],ud.prototype,"opacity",void 0);class gd extends a.rt{}$h([(0,a.Z9)(!1)],gd.prototype,"visible",void 0),$h([(0,a.Z9)("Fixed")],gd.prototype,"type",void 0),$h([(0,a.Z9)("Both")],gd.prototype,"direction",void 0),$h([(0,a.Z9)("Vertical")],gd.prototype,"mode",void 0),$h([(0,a.Z9)(1)],gd.prototype,"verticalError",void 0),$h([(0,a.Z9)(null)],gd.prototype,"color",void 0),$h([(0,a.Z9)(1)],gd.prototype,"width",void 0),$h([(0,a.Z9)(1)],gd.prototype,"horizontalError",void 0),$h([(0,a.Z9)(3)],gd.prototype,"verticalNegativeError",void 0),$h([(0,a.Z9)(3)],gd.prototype,"verticalPositiveError",void 0),$h([(0,a.Z9)(1)],gd.prototype,"horizontalNegativeError",void 0),$h([(0,a.Z9)(1)],gd.prototype,"horizontalPositiveError",void 0),$h([(0,a.Zz)(null,ud)],gd.prototype,"errorBarCap",void 0);class md extends a.rt{}$h([(0,a.Z9)("")],md.prototype,"name",void 0),$h([(0,a.Z9)("0")],md.prototype,"dashArray",void 0),$h([(0,a.Z9)(!0)],md.prototype,"visible",void 0),$h([(0,a.Z9)(2)],md.prototype,"period",void 0),$h([(0,a.Z9)("Linear")],md.prototype,"type",void 0),$h([(0,a.Z9)(0)],md.prototype,"backwardForecast",void 0),$h([(0,a.Z9)(0)],md.prototype,"forwardForecast",void 0),$h([(0,a.Z9)(2)],md.prototype,"polynomialOrder",void 0),$h([(0,a.Zz)({},pd)],md.prototype,"marker",void 0),$h([(0,a.Z9)(!0)],md.prototype,"enableTooltip",void 0),$h([(0,a.Zz)({},ed)],md.prototype,"animation",void 0),$h([(0,a.Z9)("")],md.prototype,"fill",void 0),$h([(0,a.Z9)(1)],md.prototype,"width",void 0),$h([(0,a.Z9)(null)],md.prototype,"intercept",void 0),$h([(0,a.Z9)("SeriesType")],md.prototype,"legendShape",void 0);class bd extends a.rt{}$h([(0,a.Z9)(null)],bd.prototype,"fill",void 0),$h([(0,a.Zz)({color:"transparent",width:0},od)],bd.prototype,"border",void 0),$h([(0,a.Z9)("Gap")],bd.prototype,"mode",void 0);class fd extends a.rt{}$h([(0,a.Z9)(0)],fd.prototype,"topLeft",void 0),$h([(0,a.Z9)(0)],fd.prototype,"topRight",void 0),$h([(0,a.Z9)(0)],fd.prototype,"bottomLeft",void 0),$h([(0,a.Z9)(0)],fd.prototype,"bottomRight",void 0);class yd extends a.rt{}$h([(0,a.Z9)(!1)],yd.prototype,"enable",void 0),$h([(0,a.Z9)(null)],yd.prototype,"fill",void 0),$h([(0,a.Zz)(Kh.crosshairLabelFont,id)],yd.prototype,"textStyle",void 0);class vd extends a.rt{}$h([(0,a.Z9)(!0)],vd.prototype,"visible",void 0),$h([(0,a.Z9)(!1)],vd.prototype,"startFromAxis",void 0),$h([(0,a.Z9)(null)],vd.prototype,"start",void 0),$h([(0,a.Z9)(null)],vd.prototype,"end",void 0),$h([(0,a.Z9)(null)],vd.prototype,"size",void 0),$h([(0,a.Z9)("#808080")],vd.prototype,"color",void 0),$h([(0,a.Z9)(null)],vd.prototype,"dashArray",void 0),$h([(0,a.Z9)("Auto")],vd.prototype,"sizeType",void 0),$h([(0,a.Z9)(!1)],vd.prototype,"isRepeat",void 0),$h([(0,a.Z9)(null)],vd.prototype,"repeatEvery",void 0),$h([(0,a.Z9)(null)],vd.prototype,"repeatUntil",void 0),$h([(0,a.Z9)(!1)],vd.prototype,"isSegmented",void 0),$h([(0,a.Z9)(null)],vd.prototype,"segmentStart",void 0),$h([(0,a.Z9)(null)],vd.prototype,"segmentEnd",void 0),$h([(0,a.Z9)(null)],vd.prototype,"segmentAxisName",void 0),$h([(0,a.Zz)({color:"transparent",width:1},od)],vd.prototype,"border",void 0),$h([(0,a.Z9)("")],vd.prototype,"text",void 0),$h([(0,a.Z9)(null)],vd.prototype,"rotation",void 0),$h([(0,a.Z9)("Middle")],vd.prototype,"horizontalAlignment",void 0),$h([(0,a.Z9)("Middle")],vd.prototype,"verticalAlignment",void 0),$h([(0,a.Zz)(Kh.stripLineLabelFont,id)],vd.prototype,"textStyle",void 0),$h([(0,a.Z9)("Behind")],vd.prototype,"zIndex",void 0),$h([(0,a.Z9)(1)],vd.prototype,"opacity",void 0);class Sd extends a.rt{}$h([(0,a.Z9)("")],Sd.prototype,"color",void 0),$h([(0,a.Z9)(1)],Sd.prototype,"width",void 0),$h([(0,a.Z9)("Rectangle")],Sd.prototype,"type",void 0);class xd extends a.rt{}$h([(0,a.Z9)(1)],xd.prototype,"width",void 0),$h([(0,a.Z9)("")],xd.prototype,"dashArray",void 0),$h([(0,a.Z9)(null)],xd.prototype,"color",void 0);class wd extends a.rt{}$h([(0,a.Z9)(.7)],wd.prototype,"width",void 0),$h([(0,a.Z9)("")],wd.prototype,"dashArray",void 0),$h([(0,a.Z9)(null)],wd.prototype,"color",void 0);class Cd extends a.rt{}$h([(0,a.Z9)(1)],Cd.prototype,"width",void 0),$h([(0,a.Z9)("")],Cd.prototype,"dashArray",void 0),$h([(0,a.Z9)(null)],Cd.prototype,"color",void 0);class Md extends a.rt{}$h([(0,a.Z9)(1)],Md.prototype,"width",void 0),$h([(0,a.Z9)(5)],Md.prototype,"height",void 0),$h([(0,a.Z9)(null)],Md.prototype,"color",void 0);class Td extends a.rt{}$h([(0,a.Z9)(.7)],Td.prototype,"width",void 0),$h([(0,a.Z9)(5)],Td.prototype,"height",void 0),$h([(0,a.Z9)(null)],Td.prototype,"color",void 0);class Ld extends a.rt{}$h([(0,a.Z9)(0)],Ld.prototype,"x",void 0),$h([(0,a.Z9)(0)],Ld.prototype,"y",void 0);class Ad{}$h([(0,a.Z9)("")],Ad.prototype,"color",void 0),$h([(0,a.Z9)(1)],Ad.prototype,"width",void 0);class Dd{}$h([(0,a.Z9)(!0)],Dd.prototype,"enable",void 0),$h([(0,a.Z9)(1e3)],Dd.prototype,"duration",void 0),$h([(0,a.Z9)(0)],Dd.prototype,"delay",void 0);class Rd{}$h([(0,a.Z9)(null)],Rd.prototype,"value",void 0),$h([(0,a.Z9)(null)],Rd.prototype,"color",void 0),$h([(0,a.Z9)("0")],Rd.prototype,"dashArray",void 0);class Id{}$h([(0,a.Z9)(!1)],Id.prototype,"visible",void 0),$h([(0,a.Z9)("Circle")],Id.prototype,"shape",void 0),$h([(0,a.Z9)("")],Id.prototype,"imageUrl",void 0),$h([(0,a.Z9)(5)],Id.prototype,"height",void 0),$h([(0,a.Z9)(5)],Id.prototype,"width",void 0),$h([(0,a.Zz)({width:2,color:null},od)],Id.prototype,"border",void 0),$h([(0,a.Z9)(null)],Id.prototype,"fill",void 0),$h([(0,a.Z9)(1)],Id.prototype,"opacity",void 0),$h([(0,a.Zz)({},hd)],Id.prototype,"dataLabel",void 0);class Pd{}$h([(0,a.Z9)(!1)],Pd.prototype,"visible",void 0),$h([(0,a.Z9)("Fixed")],Pd.prototype,"type",void 0),$h([(0,a.Z9)("Both")],Pd.prototype,"direction",void 0),$h([(0,a.Z9)("Vertical")],Pd.prototype,"mode",void 0),$h([(0,a.Z9)(null)],Pd.prototype,"color",void 0),$h([(0,a.Z9)(1)],Pd.prototype,"verticalError",void 0),$h([(0,a.Z9)(1)],Pd.prototype,"width",void 0),$h([(0,a.Z9)(1)],Pd.prototype,"horizontalError",void 0),$h([(0,a.Z9)(3)],Pd.prototype,"verticalPositiveError",void 0),$h([(0,a.Z9)(3)],Pd.prototype,"verticalNegativeError",void 0),$h([(0,a.Z9)(1)],Pd.prototype,"horizontalPositiveError",void 0),$h([(0,a.Z9)(1)],Pd.prototype,"horizontalNegativeError",void 0),$h([(0,a.Zz)(null,ud)],Pd.prototype,"errorBarCap",void 0);class kd{}$h([(0,a.Z9)("")],kd.prototype,"name",void 0),$h([(0,a.Z9)("Linear")],kd.prototype,"type",void 0),$h([(0,a.Z9)(2)],kd.prototype,"period",void 0),$h([(0,a.Z9)(2)],kd.prototype,"polynomialOrder",void 0),$h([(0,a.Z9)(0)],kd.prototype,"backwardForecast",void 0),$h([(0,a.Z9)(0)],kd.prototype,"forwardForecast",void 0),$h([(0,a.Zz)({},ed)],kd.prototype,"animation",void 0),$h([(0,a.Zz)({},pd)],kd.prototype,"marker",void 0),$h([(0,a.Z9)(!0)],kd.prototype,"enableTooltip",void 0),$h([(0,a.Z9)(null)],kd.prototype,"intercept",void 0),$h([(0,a.Z9)("")],kd.prototype,"fill",void 0),$h([(0,a.Z9)(1)],kd.prototype,"width",void 0),$h([(0,a.Z9)("SeriesType")],kd.prototype,"legendShape",void 0);class Ed{}$h([(0,a.Z9)(null)],Ed.prototype,"fill",void 0),$h([(0,a.Zz)({color:"transparent",width:0},od)],Ed.prototype,"border",void 0),$h([(0,a.Z9)("Gap")],Ed.prototype,"mode",void 0);class Fd{}$h([(0,a.Z9)(0)],Fd.prototype,"topLeft",void 0),$h([(0,a.Z9)(0)],Fd.prototype,"topRight",void 0),$h([(0,a.Z9)(0)],Fd.prototype,"bottomLeft",void 0),$h([(0,a.Z9)(0)],Fd.prototype,"bottomRight",void 0);class Od{}$h([(0,a.Z9)("Normal")],Od.prototype,"fontStyle",void 0),$h([(0,a.Z9)("16px")],Od.prototype,"size",void 0),$h([(0,a.Z9)("Normal")],Od.prototype,"fontWeight",void 0),$h([(0,a.Z9)("")],Od.prototype,"color",void 0),$h([(0,a.Z9)("Center")],Od.prototype,"textAlignment",void 0),$h([(0,a.Z9)("Segoe UI")],Od.prototype,"fontFamily",void 0),$h([(0,a.Z9)(1)],Od.prototype,"opacity",void 0),$h([(0,a.Z9)("Trim")],Od.prototype,"textOverflow",void 0);class Nd{}$h([(0,a.Z9)(!1)],Nd.prototype,"enable",void 0),$h([(0,a.Z9)(null)],Nd.prototype,"fill",void 0),$h([(0,a.Zz)(Kh.crosshairLabelFont,id)],Nd.prototype,"textStyle",void 0);class zd{}$h([(0,a.Z9)(1)],zd.prototype,"width",void 0),$h([(0,a.Z9)(5)],zd.prototype,"height",void 0),$h([(0,a.Z9)(null)],zd.prototype,"color",void 0);class _d{}$h([(0,a.Z9)(1)],_d.prototype,"width",void 0),$h([(0,a.Z9)("")],_d.prototype,"dashArray",void 0),$h([(0,a.Z9)(null)],_d.prototype,"color",void 0);class Bd{}$h([(0,a.Z9)(.7)],Bd.prototype,"width",void 0),$h([(0,a.Z9)(5)],Bd.prototype,"height",void 0),$h([(0,a.Z9)(null)],Bd.prototype,"color",void 0);class Zd{}$h([(0,a.Z9)(.7)],Zd.prototype,"width",void 0),$h([(0,a.Z9)("")],Zd.prototype,"dashArray",void 0),$h([(0,a.Z9)(null)],Zd.prototype,"color",void 0);class Vd{}$h([(0,a.Z9)(1)],Vd.prototype,"width",void 0),$h([(0,a.Z9)("")],Vd.prototype,"dashArray",void 0),$h([(0,a.Z9)(null)],Vd.prototype,"color",void 0);class jd{}$h([(0,a.Z9)(!0)],jd.prototype,"visible",void 0),$h([(0,a.Z9)(!1)],jd.prototype,"startFromAxis",void 0),$h([(0,a.Z9)(null)],jd.prototype,"start",void 0),$h([(0,a.Z9)(null)],jd.prototype,"end",void 0),$h([(0,a.Z9)(null)],jd.prototype,"size",void 0),$h([(0,a.Z9)("#808080")],jd.prototype,"color",void 0),$h([(0,a.Z9)(null)],jd.prototype,"dashArray",void 0),$h([(0,a.Z9)("Auto")],jd.prototype,"sizeType",void 0),$h([(0,a.Z9)(!1)],jd.prototype,"isRepeat",void 0),$h([(0,a.Z9)(null)],jd.prototype,"repeatEvery",void 0),$h([(0,a.Z9)(null)],jd.prototype,"repeatUntil",void 0),$h([(0,a.Z9)(!1)],jd.prototype,"isSegmented",void 0),$h([(0,a.Z9)(null)],jd.prototype,"segmentStart",void 0),$h([(0,a.Z9)(null)],jd.prototype,"segmentEnd",void 0),$h([(0,a.Z9)(null)],jd.prototype,"segmentAxisName",void 0),$h([(0,a.Zz)({color:"transparent",width:1},od)],jd.prototype,"border",void 0),$h([(0,a.Z9)("")],jd.prototype,"text",void 0),$h([(0,a.Z9)(null)],jd.prototype,"rotation",void 0),$h([(0,a.Z9)("Middle")],jd.prototype,"horizontalAlignment",void 0),$h([(0,a.Z9)("Middle")],jd.prototype,"verticalAlignment",void 0),$h([(0,a.Zz)(Kh.stripLineLabelFont,id)],jd.prototype,"textStyle",void 0),$h([(0,a.Z9)("Behind")],jd.prototype,"zIndex",void 0),$h([(0,a.Z9)(1)],jd.prototype,"opacity",void 0);class Hd{}$h([(0,a.Z9)("")],Hd.prototype,"color",void 0),$h([(0,a.Z9)(1)],Hd.prototype,"width",void 0),$h([(0,a.Z9)("Rectangle")],Hd.prototype,"type",void 0);class qd{}$h([(0,a.Zz)({},od)],qd.prototype,"border",void 0),$h([(0,a.Z9)("transparent")],qd.prototype,"background",void 0),$h([(0,a.Z9)(1)],qd.prototype,"opacity",void 0);class Gd{}$h([(0,a.Z9)(!1)],Gd.prototype,"enable",void 0),$h([(0,a.Z9)("")],Gd.prototype,"dashArray",void 0),$h([(0,a.Zz)({color:null,width:1},od)],Gd.prototype,"line",void 0),$h([(0,a.Z9)("Both")],Gd.prototype,"lineType",void 0);class Yd{}$h([(0,a.Z9)(!0)],Yd.prototype,"visible",void 0),$h([(0,a.Z9)(null)],Yd.prototype,"height",void 0),$h([(0,a.Z9)(null)],Yd.prototype,"width",void 0),$h([(0,a.Zz)({x:0,y:0},Ld)],Yd.prototype,"location",void 0),$h([(0,a.Z9)("Auto")],Yd.prototype,"position",void 0),$h([(0,a.Z9)(8)],Yd.prototype,"padding",void 0),$h([(0,a.Z9)("Center")],Yd.prototype,"alignment",void 0),$h([(0,a.Zz)(Kh.legendLabelFont,id)],Yd.prototype,"textStyle",void 0),$h([(0,a.Z9)(10)],Yd.prototype,"shapeHeight",void 0),$h([(0,a.Z9)(10)],Yd.prototype,"shapeWidth",void 0),$h([(0,a.Zz)({},od)],Yd.prototype,"border",void 0),$h([(0,a.Zz)({left:0,right:0,top:0,bottom:0},sd)],Yd.prototype,"margin",void 0),$h([(0,a.Z9)(5)],Yd.prototype,"shapePadding",void 0),$h([(0,a.Z9)("transparent")],Yd.prototype,"background",void 0),$h([(0,a.Z9)(1)],Yd.prototype,"opacity",void 0),$h([(0,a.Z9)(!0)],Yd.prototype,"toggleVisibility",void 0),$h([(0,a.Z9)(null)],Yd.prototype,"description",void 0),$h([(0,a.Z9)(3)],Yd.prototype,"tabIndex",void 0);class Wd{}$h([(0,a.Z9)(0)],Wd.prototype,"series",void 0),$h([(0,a.Z9)(0)],Wd.prototype,"point",void 0);class Ud{}$h([(0,a.Z9)(10)],Ud.prototype,"left",void 0),$h([(0,a.Z9)(10)],Ud.prototype,"right",void 0),$h([(0,a.Z9)(10)],Ud.prototype,"top",void 0),$h([(0,a.Z9)(10)],Ud.prototype,"bottom",void 0);class Xd extends a.rt{}$h([(0,a.Z9)(null)],Xd.prototype,"fill",void 0),$h([(0,a.Z9)(null)],Xd.prototype,"endAngle",void 0),$h([(0,a.Z9)(!1)],Xd.prototype,"explode",void 0),$h([(0,a.Z9)(!1)],Xd.prototype,"explodeAll",void 0),$h([(0,a.Z9)(null)],Xd.prototype,"explodeIndex",void 0),$h([(0,a.Z9)(null)],Xd.prototype,"innerRadius",void 0),$h([(0,a.Z9)("30%")],Xd.prototype,"explodeOffset",void 0),$h([(0,a.Z9)(0)],Xd.prototype,"gapRatio",void 0),$h([(0,a.Z9)("Value")],Xd.prototype,"groupMode",void 0),$h([(0,a.Z9)(null)],Xd.prototype,"groupTo",void 0),$h([(0,a.Z9)("20%")],Xd.prototype,"neckHeight",void 0),$h([(0,a.Z9)("20%")],Xd.prototype,"neckWidth",void 0),$h([(0,a.Z9)("Linear")],Xd.prototype,"pyramidMode",void 0),$h([(0,a.Z9)([])],Xd.prototype,"palettes",void 0),$h([(0,a.Z9)(0)],Xd.prototype,"startAngle",void 0),$h([(0,a.Zz)(null,ed)],Xd.prototype,"animation",void 0),$h([(0,a.Zz)(null,cd)],Xd.prototype,"dataLabel",void 0),$h([(0,a.Z9)("0")],Xd.prototype,"dashArray",void 0),$h([(0,a.Z9)(1)],Xd.prototype,"width",void 0),$h([(0,a.Z9)("X")],Xd.prototype,"segmentAxis",void 0),$h([(0,a.Z9)("Line")],Xd.prototype,"drawType",void 0),$h([(0,a.Z9)(!0)],Xd.prototype,"isClosed",void 0),$h([(0,a.FE)([],td)],Xd.prototype,"segments",void 0),$h([(0,a.Z9)("")],Xd.prototype,"stackingGroup",void 0),$h([(0,a.Zz)({color:"transparent",width:0},od)],Xd.prototype,"border",void 0),$h([(0,a.Z9)(!0)],Xd.prototype,"visible",void 0),$h([(0,a.Z9)(1)],Xd.prototype,"opacity",void 0),$h([(0,a.Z9)("Line")],Xd.prototype,"type",void 0),$h([(0,a.Zz)(null,pd)],Xd.prototype,"marker",void 0),$h([(0,a.Zz)(null,gd)],Xd.prototype,"errorBar",void 0),$h([(0,a.Z9)(!0)],Xd.prototype,"enableTooltip",void 0),$h([(0,a.FE)([],md)],Xd.prototype,"trendlines",void 0),$h([(0,a.Z9)("")],Xd.prototype,"tooltipMappingName",void 0),$h([(0,a.Z9)("SeriesType")],Xd.prototype,"legendShape",void 0),$h([(0,a.Z9)(1)],Xd.prototype,"minRadius",void 0),$h([(0,a.Z9)(null)],Xd.prototype,"selectionStyle",void 0),$h([(0,a.Z9)("Natural")],Xd.prototype,"splineType",void 0),$h([(0,a.Z9)(3)],Xd.prototype,"maxRadius",void 0),$h([(0,a.Z9)(.5)],Xd.prototype,"cardinalSplineTension",void 0),$h([(0,a.Z9)(null)],Xd.prototype,"columnWidth",void 0),$h([(0,a.Zz)(null,bd)],Xd.prototype,"emptyPointSettings",void 0),$h([(0,a.Zz)(null,fd)],Xd.prototype,"cornerRadius",void 0),$h([(0,a.Z9)(0)],Xd.prototype,"columnSpacing",void 0);class Qd extends a.rt{}$h([(0,a.Z9)("Rotate45")],Qd.prototype,"labelIntersectAction",void 0),$h([(0,a.Zz)(Kh.axisLabelFont,id)],Qd.prototype,"labelStyle",void 0),$h([(0,a.Z9)("")],Qd.prototype,"title",void 0),$h([(0,a.Z9)(null)],Qd.prototype,"zoomFactor",void 0),$h([(0,a.Zz)({},yd)],Qd.prototype,"crosshairTooltip",void 0),$h([(0,a.Z9)("")],Qd.prototype,"labelFormat",void 0),$h([(0,a.Zz)(Kh.axisTitleFont,id)],Qd.prototype,"titleStyle",void 0),$h([(0,a.Z9)(!1)],Qd.prototype,"isIndexed",void 0),$h([(0,a.Z9)(0)],Qd.prototype,"plotOffset",void 0),$h([(0,a.Z9)("None")],Qd.prototype,"edgeLabelPlacement",void 0),$h([(0,a.Z9)("BetweenTicks")],Qd.prototype,"labelPlacement",void 0),$h([(0,a.Z9)("Outside")],Qd.prototype,"tickPosition",void 0),$h([(0,a.Z9)(!1)],Qd.prototype,"opposedPosition",void 0),$h([(0,a.Z9)(!0)],Qd.prototype,"visible",void 0),$h([(0,a.Z9)("Outside")],Qd.prototype,"labelPosition",void 0),$h([(0,a.Z9)(0)],Qd.prototype,"labelRotation",void 0),$h([(0,a.Z9)(0)],Qd.prototype,"minorTicksPerInterval",void 0),$h([(0,a.Z9)(null)],Qd.prototype,"maximum",void 0),$h([(0,a.Z9)(null)],Qd.prototype,"minimum",void 0),$h([(0,a.Z9)(34)],Qd.prototype,"maximumLabelWidth",void 0),$h([(0,a.Z9)(null)],Qd.prototype,"interval",void 0),$h([(0,a.Zz)({},Md)],Qd.prototype,"majorTickLines",void 0),$h([(0,a.Z9)(!1)],Qd.prototype,"enableTrim",void 0),$h([(0,a.Zz)({},xd)],Qd.prototype,"majorGridLines",void 0),$h([(0,a.Zz)({},Td)],Qd.prototype,"minorTickLines",void 0),$h([(0,a.Zz)({},Cd)],Qd.prototype,"lineStyle",void 0),$h([(0,a.Zz)({},wd)],Qd.prototype,"minorGridLines",void 0),$h([(0,a.Z9)(!1)],Qd.prototype,"isInversed",void 0),$h([(0,a.Z9)(null)],Qd.prototype,"description",void 0),$h([(0,a.Z9)(0)],Qd.prototype,"startAngle",void 0),$h([(0,a.Z9)(100)],Qd.prototype,"coefficient",void 0),$h([(0,a.FE)([],vd)],Qd.prototype,"stripLines",void 0),$h([(0,a.Z9)(2)],Qd.prototype,"tabIndex",void 0),$h([(0,a.Zz)({color:null,width:0,type:"Rectangle"},Sd)],Qd.prototype,"border",void 0);class Jd extends a.rt{}$h([(0,a.Z9)(!1)],Jd.prototype,"enableMarker",void 0),$h([(0,a.Z9)(!0)],Jd.prototype,"enable",void 0),$h([(0,a.Z9)(null)],Jd.prototype,"fill",void 0),$h([(0,a.Z9)(!1)],Jd.prototype,"shared",void 0),$h([(0,a.Z9)(.75)],Jd.prototype,"opacity",void 0),$h([(0,a.Z9)(null)],Jd.prototype,"header",void 0),$h([(0,a.Z9)(null)],Jd.prototype,"format",void 0),$h([(0,a.Zz)(Kh.tooltipLabelFont,id)],Jd.prototype,"textStyle",void 0),$h([(0,a.Z9)(null)],Jd.prototype,"template",void 0),$h([(0,a.Zz)({color:"#cccccc",width:.5},od)],Jd.prototype,"border",void 0),$h([(0,a.Z9)(!0)],Jd.prototype,"enableAnimation",void 0);class Kd extends a.rt{}$h([(0,a.Z9)("50%")],Kd.prototype,"x",void 0),$h([(0,a.Z9)("50%")],Kd.prototype,"y",void 0);class $d extends a.rt{}$h([(0,a.Z9)(!1)],$d.prototype,"enablePinchZooming",void 0),$h([(0,a.Z9)(!0)],$d.prototype,"enableSelectionZooming",void 0),$h([(0,a.Z9)(!1)],$d.prototype,"enableDeferredZooming",void 0),$h([(0,a.Z9)(!1)],$d.prototype,"enableMouseWheelZooming",void 0),$h([(0,a.Z9)("XY")],$d.prototype,"mode",void 0),$h([(0,a.Z9)(["Zoom","ZoomIn","ZoomOut","Pan","Reset"])],$d.prototype,"toolbarItems",void 0),$h([(0,a.Z9)(!0)],$d.prototype,"enableScrollbar",void 0),$h([(0,a.Z9)(!1)],$d.prototype,"enablePan",void 0);class ec extends a.rt{}$h([(0,a.Zz)({},Xd)],ec.prototype,"chartSeries",void 0),$h([(0,a.Zz)({},Qd)],ec.prototype,"primaryXAxis",void 0),$h([(0,a.Zz)({},Qd)],ec.prototype,"primaryYAxis",void 0),$h([(0,a.Z9)("")],ec.prototype,"value",void 0),$h([(0,a.Z9)("")],ec.prototype,"columnHeader",void 0),$h([(0,a.Z9)("-")],ec.prototype,"columnDelimiter",void 0),$h([(0,a.Z9)(!1)],ec.prototype,"enableMultiAxis",void 0),$h([(0,a.Z9)(!1)],ec.prototype,"enableMultipleAxis",void 0),$h([(0,a.Z9)("Stacked")],ec.prototype,"multipleAxisMode",void 0),$h([(0,a.Z9)(!1)],ec.prototype,"enableScrollOnMultiAxis",void 0),$h([(0,a.Zz)(Kh.chartTitleFont,id)],ec.prototype,"titleStyle",void 0),$h([(0,a.Z9)("")],ec.prototype,"title",void 0),$h([(0,a.Zz)(Kh.chartSubTitleFont,id)],ec.prototype,"subTitleStyle",void 0),$h([(0,a.Z9)("")],ec.prototype,"subTitle",void 0),$h([(0,a.Zz)({color:"#DDDDDD",width:0},od)],ec.prototype,"border",void 0),$h([(0,a.Zz)({},sd)],ec.prototype,"margin",void 0),$h([(0,a.Zz)({border:{color:null,width:.5},background:"transparent"},rd)],ec.prototype,"chartArea",void 0),$h([(0,a.Z9)(null)],ec.prototype,"background",void 0),$h([(0,a.Z9)("Material")],ec.prototype,"theme",void 0),$h([(0,a.Z9)([])],ec.prototype,"palettes",void 0),$h([(0,a.Zz)({},nd)],ec.prototype,"crosshair",void 0),$h([(0,a.Zz)({},Jd)],ec.prototype,"tooltip",void 0),$h([(0,a.Zz)(null,Kd)],ec.prototype,"pieCenter",void 0),$h([(0,a.Zz)({},$d)],ec.prototype,"zoomSettings",void 0),$h([(0,a.Z9)()],ec.prototype,"legendSettings",void 0),$h([(0,a.Z9)("None")],ec.prototype,"selectionMode",void 0),$h([(0,a.Z9)("None")],ec.prototype,"accumulationSelectionMode",void 0),$h([(0,a.Z9)(!0)],ec.prototype,"enableSmartLabels",void 0),$h([(0,a.Z9)(!0)],ec.prototype,"enableBorderOnMouseMove",void 0),$h([(0,a.Z9)("None")],ec.prototype,"highlightMode",void 0),$h([(0,a.Z9)("None")],ec.prototype,"highlightPattern",void 0),$h([(0,a.Z9)(!0)],ec.prototype,"enableExport",void 0),$h([(0,a.Z9)(!1)],ec.prototype,"isMultiSelect",void 0),$h([(0,a.FE)([],ad)],ec.prototype,"selectedDataIndexes",void 0),$h([(0,a.Z9)(!0)],ec.prototype,"enableAnimation",void 0),$h([(0,a.Z9)(!1)],ec.prototype,"enableCanvas",void 0),$h([(0,a.Z9)(!0)],ec.prototype,"useGroupingSeparator",void 0),$h([(0,a.Z9)(!1)],ec.prototype,"isTransposed",void 0),$h([(0,a.Z9)(1)],ec.prototype,"tabIndex",void 0),$h([(0,a.Z9)(null)],ec.prototype,"description",void 0),$h([(0,a.ju)()],ec.prototype,"resized",void 0),$h([(0,a.Z9)(!0)],ec.prototype,"enableSideBySidePlacement",void 0),$h([(0,a.ju)()],ec.prototype,"loaded",void 0),$h([(0,a.ju)()],ec.prototype,"beforePrint",void 0),$h([(0,a.ju)()],ec.prototype,"animationComplete",void 0),$h([(0,a.ju)()],ec.prototype,"load",void 0),$h([(0,a.ju)()],ec.prototype,"textRender",void 0),$h([(0,a.ju)()],ec.prototype,"legendRender",void 0),$h([(0,a.ju)()],ec.prototype,"seriesRender",void 0),$h([(0,a.ju)()],ec.prototype,"multiLevelLabelRender",void 0),$h([(0,a.ju)()],ec.prototype,"pointRender",void 0),$h([(0,a.ju)()],ec.prototype,"tooltipRender",void 0),$h([(0,a.ju)()],ec.prototype,"axisLabelRender",void 0),$h([(0,a.ju)()],ec.prototype,"multiLevelLabelClick",void 0),$h([(0,a.ju)()],ec.prototype,"chartMouseClick",void 0),$h([(0,a.ju)()],ec.prototype,"chartMouseMove",void 0),$h([(0,a.ju)()],ec.prototype,"pointMove",void 0),$h([(0,a.ju)()],ec.prototype,"pointClick",void 0),$h([(0,a.ju)()],ec.prototype,"chartMouseDown",void 0),$h([(0,a.ju)()],ec.prototype,"chartMouseLeave",void 0),$h([(0,a.ju)()],ec.prototype,"dragComplete",void 0),$h([(0,a.ju)()],ec.prototype,"chartMouseUp",void 0),$h([(0,a.ju)()],ec.prototype,"scrollStart",void 0),$h([(0,a.ju)()],ec.prototype,"zoomComplete",void 0),$h([(0,a.ju)()],ec.prototype,"scrollChanged",void 0),$h([(0,a.ju)()],ec.prototype,"scrollEnd",void 0),$h([(0,a.Z9)(!0)],ec.prototype,"showMultiLevelLabels",void 0);class tc{static getCellSets(e,t,i,s,o){this.engine=t,this.isMondrian=t.isMondrian,this.isMeasureAvail=t.isMeasureAvail,this.isPaging=t.isPaging,this.pageSettings=t.pageSettings,this.rows=t.rows,this.columns=t.columns,this.values=t.values,this.filters=t.filters,this.allowLabelFilter=t.allowLabelFilter,this.allowValueFilter=t.allowValueFilter,this.valueSortSettings=e.valueSortSettings?e.valueSortSettings:void 0,this.drilledMembers=t.updateDrilledItems(e.drilledMembers),this.calculatedFieldSettings=t.calculatedFieldSettings,this.valueAxis="row"===e.valueAxis?"rows":"columns",s&&(s.axis="row"===s.axis?"rows":"columns"),this.filterMembers=(0,a.l7)({},t.filterMembers,null,!0),this.fieldDataObj=t.fieldListObj,this.fieldList=t.fieldList,this.cellSetInfo="\nDIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE";let l=this.getMeasuresQuery(this.values),r=this.getDimensionsQuery(this.rows,l,"rows",s).replace(/\&/g,"&amp;"),n=this.getDimensionsQuery(this.columns,l,"columns",s).replace(/\&/g,"&amp;");if(this.isPaging&&i&&void 0!==this.pageSettings){let e=this.getPagingQuery(r,n);r=e.rowQuery,n=e.columnQuery}else if(this.isPaging&&!i&&void 0!==this.pageSettings){let e=this.getPagingCountQuery(r,n);r=e.rowQuery,n=e.columnQuery}r=r.length>0?r+(this.isPaging&&!i?"":this.cellSetInfo+" ON ROWS"):"",n=n.length>0?n+(this.isPaging&&!i?"":this.cellSetInfo+" ON COLUMNS"):"";let h=this.getSlicersQuery(this.filters,"filters").replace(/\&/g,"&amp;"),d=this.getfilterQuery(this.filterMembers,e.cube).replace(/\&/g,"&amp;").replace(/\>/g,"&gt;").replace(/\</g,"&lt;"),c=this.getCalculatedFieldQuery(this.calculatedFieldSettings).replace(/\&/g,"&amp;"),p=this.frameMDXQuery(r,n,h,d,c,i),u={catalog:e.catalog,cube:e.cube,url:e.url,request:p,LCID:e.localeIdentifier.toString()};t.mdxQuery=p.replace(/\&amp;/g,"&").replace(/\&gt;/g,">").replace(/\&lt;/g,"<").replace(/%280/g,'"'),s&&(s.axis="rows"===s.axis?"row":"column"),o||this.getTableCellData(u,this.isPaging&&!i?this.engine.generatePagingData.bind(this.engine):this.engine.generateEngine.bind(this.engine),s?{action:s.action,drillInfo:s}:{dataSourceSettings:e,action:"loadTableElements"})}static getTableCellData(e,t,i){let s=this.engine.getConnectionInfo(e.url,e.LCID);this.engine.doAjaxPost("POST",s.url,'<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header></Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement>'+e.request+"</Statement> </Command> <Properties> <PropertyList> <Catalog>"+e.catalog+"</Catalog> <LocaleIdentifier>"+s.LCID+"</LocaleIdentifier> </PropertyList> </Properties></Execute> </Body> </Envelope>",t,i)}static frameMDXQuery(e,t,i,s,o,l){let a=this.isPaging&&!l?""!==o?"":"\nWITH":"\nSelect ";return t.length>0&&(a+=t),e.length>0&&(a=a+(t.length>0?this.isPaging&&!l?"":", ":"")+e),a=o+a+(this.isPaging&&!l?"\nMEMBER [Measures].[3d268ce0-664d-4092-b9cb-fece97175006] AS Count([e16a30d0-2174-4874-8dae-a5085a75a3e2]) MEMBER [Measures].[8d7fe8c1-f09f-410e-b9ba-eaab75a1fc3e] AS Count ([d1876d2b-e50e-4547-85fe-5b8ed9d629de])\nSELECT { [Measures].[3d268ce0-664d-4092-b9cb-fece97175006] , [Measures].[8d7fe8c1-f09f-410e-b9ba-eaab75a1fc3e] } ON AXIS(0)":"")+s+i+"\nCELL PROPERTIES VALUE, FORMAT_STRING, FORMATTED_VALUE\n",a}static getPagingQuery(e,t){e=e.replace("NON EMPTY ( ","").slice(0,-1),t=t.replace("NON EMPTY ( ","").slice(0,-1);let i=e,s=(this.pageSettings.rowCurrentPage-1)*this.pageSettings.rowSize,o=(this.pageSettings.columnCurrentPage-1)*this.pageSettings.columnSize,l=3*this.pageSettings.rowSize,a=3*this.pageSettings.columnSize;return s=this.engine.rowCount<s+l?this.engine.rowCount>l?this.engine.rowCount-l:0:s,this.engine.pageRowStartPos=s,o=this.engine.columnCount<o+a?this.engine.columnCount>a?this.engine.columnCount-a:0:o,this.engine.pageColStartPos=o,{rowQuery:""!==e?"\nSUBSET ({ "+(this.isMondrian?"":"NONEMPTY")+" ("+e+(this.isMondrian||""===t?"":","+t)+")},"+s+","+l+")":"",columnQuery:""!==t?"\nSUBSET ({ "+(this.isMondrian?"":"NONEMPTY")+" ("+t+(this.isMondrian||""===i?"":","+i)+")},"+o+","+a+")":""}}static getPagingCountQuery(e,t){return e=e.replace("NON EMPTY ( ","").slice(0,-1),t=t.replace("NON EMPTY ( ","").slice(0,-1),{rowQuery:""!==e?"SET [d1876d2b-e50e-4547-85fe-5b8ed9d629de] as "+(this.isMondrian?"":"NONEMPTY")+" ("+e+(this.isMondrian||""===t?"":","+t)+")\n":"",columnQuery:""!==t?"\nSET [e16a30d0-2174-4874-8dae-a5085a75a3e2] as "+(this.isMondrian?"":"NONEMPTY")+" ("+t+(this.isMondrian||""===e?"":","+e)+")\n":""}}static getDimensionsQuery(e,t,i,s){let o="";if(e.length>0){o="\nNON EMPTY ( "+(this.drilledMembers.length>0?"HIERARCHIZE ({":"");let l=0;for(;l<e.length;){let s="";0===l?"[measures]"===e[l].name.toLowerCase()?""!==t&&(o+=t):(s="({"+this.getDimensionQuery(e[l],i)+"})",o+=s):"[measures]"===e[l].name.toLowerCase()?""!==t&&(o=o+" * "+t):(s="({"+this.getDimensionQuery(e[l],i)+"})",o=o+" * "+s),l++}let a=this.getDrillQuery(e,t,i,s);o=s&&s.axis===i?"\nNON EMPTY ( "+(this.drilledMembers.length>0?"HIERARCHIZE ({":"")+a.query:o+(""!==a.query?",":"")+a.query;let r=this.getAttributeDrillQuery(e,t,i,s);o=(this.valueAxis!==i?this.updateValueSortQuery(o,this.valueSortSettings):o)+(this.isPaging?(""!==r?"-":"")+r:"")+(this.drilledMembers.length>0?"})":"")+(this.isPaging?"":(""!==r?"-":"")+r)+")"}return o}static getAttributeDrillQuery(e,t,i,s){let o="",l=[];l=s&&s.axis===i&&"down"===s.action.toLowerCase()?[{name:s.fieldName,items:[s.memberName],delimiter:"~~"}]:this.drilledMembers;let a=i===this.valueAxis?this.getMeasurePos(i):0;for(let r of l)if(this.engine.fieldList[r.name]&&this.engine.fieldList[r.name].isHierarchy)for(let s of r.items){let l=[],n=s.split(r.delimiter?r.delimiter:"~~"),h=this.getDrillLevel(e,n),d=this.getDimensionPos(i,r.name),c=e.length-(a>d?1:0),p=!!this.isPaging&&this.isAttributeMemberExist(r.name,s.split(r.delimiter?r.delimiter:"~~"),r.delimiter,n,i);for(;h.level>0&&h.isDrill&&d+1!==a&&!p;){let i=[],s=0;for(;s<e.length;){if("[measures]"===e[s].name.toLowerCase())""!==t&&i.push("({{"+n[s]+"}})");else if(n[s]&&(-1!==n[s].indexOf(e[s].name)||e[s].isNamedSet&&this.fieldList[e[s].name]&&-1!==n[s].indexOf(this.fieldList[e[s].name].pid.split("Sets_")[1])))i.push(this.getHierarchyQuery(n[s],!1,!1,!1,h.level,!0));else{if(n[s]||!e[s]){i=[];break}i.push(this.getHierarchyQuery(e[s].name,!!(this.isPaging&&2===h.level||!this.isPaging&&c>s),e[s].isNamedSet,e[s].isCalculatedField,h.level,!1))}s++}i.length>0&&l.push("("+i.join("*")+")"),h.level--,c--}l.length>0&&(o=o+(""!==o?"-":"")+l.join(this.isPaging?"+":"-"))}return o}static getDimensionPos(e,t){let i=0,s="rows"===e?this.rows:this.columns;for(let o=0;o<s.length;o++)if(s[o].name===t){i=o;break}return i}static getMeasurePos(e){let t=0,i="rows"===e?this.rows:this.columns;for(let s=0;s<i.length;s++)if(0===i[s].name.indexOf("[Measures]")){t=s;break}return t}static getDrillLevel(e,t){let i=e.length,s=!1,o=0;for(;o<e.length;)t[o]&&-1!==t[o].indexOf(e[o].name)?(i-=1,e[o+1]&&!(e[o+1].isNamedSet||0===e[o+1].name.indexOf("[Measures]")||this.fieldList[e[o+1].name]&&!this.fieldList[e[o+1].name].hasAllMember)&&(s=!0)):(e[o].isNamedSet||0===e[o].name.indexOf("[Measures]")||this.fieldList[e[o].name]&&!this.fieldList[e[o].name].hasAllMember)&&(i-=1),o++;return{level:this.isPaging?2:i,isDrill:s}}static getHierarchyQuery(e,t,i,s,o,l){return!this.fieldList[e=s?this.fieldList[e].tag:e]||this.fieldList[e].hasAllMember||i||s?i||s?"({"+e+"})":this.isPaging?"({"+e+(t?".CHILDREN})":l||1!==o?"})":".[All]})"):"({DrilldownLevel({"+e+(t?".CHILDREN":"")+"},,,INCLUDE_CALC_MEMBERS)})":"(("+e+").levels(0).AllMembers)"}static isAttributeMemberExist(e,t,i,s,o){t.splice(s.length-1,1);let l=!1;if(""!==t.join(i)&&(!this.isPaging||1!==t.length||"[Measures]"!==t.join(i))&&this.engine.fieldList[e]&&this.engine.fieldList[e].hasAllMember){let s=this.getDimensionPos(o,e);for(let a=0;a<this.drilledMembers.length;a++)if(e!==this.drilledMembers[a].name&&this.engine.fieldList[this.drilledMembers[a].name]&&this.engine.fieldList[this.drilledMembers[a].name].isHierarchy){let e=this.getDimensionPos(o,this.drilledMembers[a].name);for(let r=0;r<this.drilledMembers[a].items.length;r++){let n=this.getDrillLevel("rows"===o?this.rows:this.columns,this.drilledMembers[a].items[r].split(this.drilledMembers[a].delimiter?this.drilledMembers[a].delimiter:"~~"));if((!this.isPaging||e<s&&n.isDrill)&&(0===this.drilledMembers[a].items[r].indexOf(t.join(i))||0===t.join(i).indexOf(this.drilledMembers[a].items[r]))){l=!0;break}}}}return l}static getDrillQuery(e,t,i,s){let o="",l=[],a=[],r=!1,n="";s&&s.axis===i&&"down"===s.action.toLowerCase()?(r=!0,a=[{name:s.fieldName,items:[s.memberName],delimiter:"~~"}]):a=this.drilledMembers;for(let h of a)if(!this.engine.fieldList[h.name]||!this.engine.fieldList[h.name].isHierarchy)for(let s of h.items){let a=[],d=[],c=0,p=s.split(h.delimiter?h.delimiter:"~~"),u=this.isAttributeMemberExist(h.name,s.split(h.delimiter?h.delimiter:"~~"),h.delimiter?h.delimiter:"~~",p,i);for(;c<e.length&&!u;){if(p[c]&&-1!==p[c].indexOf(e[c].name))-1!==p[p.length-1].indexOf(e[c].name)?r?n=n+(""!==n?" * ":"")+"({"+p[c]+".CHILDREN})":(a.push("("+p[c]+".CHILDREN)"),d.push("("+p[c]+")")):"[measures]"===p[c].toLowerCase()&&""!==t?r?n=n+(""!==n?" * ":"")+"("+t+")":(a.push("("+t+")"),d.push("("+t+")")):-1!==p[c].toLowerCase().indexOf("[measures]")?r?n=n+(""!==n?" * ":"")+"({"+p[c]+"})":(a.push("({"+p[c]+"})"),d.push("({"+p[c]+"})")):r?n=n+(""!==n?" * ":"")+"({"+p[c]+"})":(a.push("("+p[c]+")"),d.push("("+p[c]+")"));else{if(p[c]||!e[c]){a=[];break}"[measures]"===e[c].name.toLowerCase()&&""!==t?r?n=n+(""!==n?" * ":"")+"("+t+")":(a.push("("+t+")"),d.push("("+t+")")):r?n=n+(""!==n?" * ":"")+"({"+this.getDimensionQuery(e[c],i)+"})":(a.push("("+this.getDimensionQuery(e[c],i)+")"),d.push("("+this.getDimensionQuery(e[c],i)+")"))}c++}a.length>0&&a.length<p.length&&(a=[],d=[]),o=o+(""!==o&&a.length>0?",":"")+(a.length>0?"("+a.toString()+")":""),d.length>0&&l.push("("+d.toString()+")")}return{query:r?n:o,collection:r?[n]:l}}static updateValueSortQuery(e,t){if(t&&t.measure&&""!==t.measure){let i=this.drilledMembers.length>0?"HIERARCHIZE ({":"",s=this.fieldList[t.measure].isCalculatedField?this.fieldList[t.measure].tag:t.measure;switch(t.sortOrder){case"Ascending":e=(e=e.replace("NON EMPTY ( "+i,"NON EMPTY ( "+i+" ORDER ({"))+"},("+s+"), ASC)";break;case"Descending":e=(e=e.replace("NON EMPTY ( "+i,"NON EMPTY ( "+i+" ORDER ({"))+"},("+s+"), DESC)"}}return e}static getSlicersQuery(e,t){let i="",s=(0,a.l7)([],this.rows,null,!0);if(s=s.concat(this.columns),e.length>0){let o=0;for(;o<e.length;)s.filter(t=>{let i=this.getDimensionUniqueName(t.name),s=this.getDimensionUniqueName(e[o].name),l=!1;return l=i===s&&!(this.isMondrian&&""===s&&""===i),l}).length>0||(void 0===e[o].name||this.filterMembers[e[o].name]?this.filterMembers[e[o].name]&&(i=i+(""!==i?" * ":"")+"{"+this.filterMembers[e[o].name].toString()+"}"):i=i+(""!==i?" * ":"")+"{"+this.getDimensionQuery(e[o],t)+"}"),o++;i=""===i?"":"\nWHERE ("+i.replace(/DrilldownLevel/g,"")+")"}return i}static getDimensionQuery(e,t){let i="",s=e.isCalculatedField?this.fieldList[e.name].tag:e.name;return i=this.fieldList[e.name].hasAllMember||e.isNamedSet||e.isCalculatedField?e.isNamedSet?"{"+s+"}":this.isPaging?s+".CHILDREN":"DrilldownLevel({"+s+"}"+("rows"===t||"columns"===t?",,,INCLUDE_CALC_MEMBERS":"")+")":"(("+s+").levels(0).AllMembers)",i}static getDimensionUniqueName(e){let t=this.fieldDataObj.hierarchy,i=[];if(t){for(let s of t)s.id.toLowerCase()===e.toLowerCase()&&i.push(s);return i.length>0?i[0].pid:""}return e.split(".")[0]}static getMeasuresQuery(e){let t="";if(e.length>0){t="{{";let i="";for(let t of e){let e=t.isCalculatedField?this.fieldList[t.name].tag:t.name;i=i.length>0?i+", "+e:e}t=t+i+"}}"}return t}static getfilterQuery(e,t){let i="\nFROM ["+t+"]",s="\nFROM( SELECT (",o=[],l=[],a=[],r=[];for(let h of this.rows)e[h.name]&&e[h.name].length>0&&("string"==typeof e[h.name][0]?a.push(e[h.name]):(e[h.name][1]=e[h.name][0].type,o.push(e[h.name]),delete e[h.name]));for(let h of this.columns)if(e[h.name]&&e[h.name].length>0)if("string"==typeof e[h.name][0])r.push(e[h.name]);else{let t=e[h.name];t[1]=t[0].type,o.push(e[h.name]),delete e[h.name]}for(let h of this.filters){let t=!1;for(let i of this.columns)this.getDimensionUniqueName(i.name)===this.getDimensionUniqueName(h.name)&&e[h.name]&&(r.push(e[h.name]),t=!0);if(!t)for(let i of this.rows)this.getDimensionUniqueName(i.name)===this.getDimensionUniqueName(h.name)&&e[h.name]&&a.push(e[h.name])}if((this.allowLabelFilter||this.allowValueFilter)&&o.length>0){let e=["Value","Label"];for(let t of e)for(let e of o)e&&2===e.length&&"string"==typeof e[1]&&e[1]===t&&l.push(this.getAdvancedFilterQuery(e[0],s,"COLUMNS"))}for(let h=0,d=r.length;h<d;h++)s=0===h?s+"{"+r[h].toString()+"}":s+",{"+r[h].toString()+"}";r.length>0&&(s=a.length>0?s+" ) ON COLUMNS ,(":s+" ) ON COLUMNS");for(let h=0,d=a.length;h<d;h++)s=h>0?s+",{"+a[h].toString()+"}":s+"{"+a[h].toString()+"}";s=r.length>0&&a.length>0?s+=") ON ROWS ":0===r.length&&a.length>0?s+") ON COLUMNS ":s;let n="";return l.length>0&&(n=l.join(" ")+" "+(r.length>0||a.length>0?s:"")+" "+i+Array(l.length+1+(r.length>0||a.length>0?1:0)).join(")")),i=0===r.length&&0===a.length?i:s+i+")",n.length>0?n:i}static getAdvancedFilterQuery(e,t,i){return"\nFROM (SELECT Filter("+e.selectedField+".AllMembers, "+this.getAdvancedFilterCondtions(e.name,e.condition,e.value1,e.value2,e.type,e.measure)+")) on "+i}static getAdvancedFilterCondtions(e,t,i,s,o,l){let a="";switch(t){case"Equals":a="("+("Value"!==o?e+'.CurrentMember.member_caption ="'+i+'"':l+" = "+i);break;case"DoesNotEquals":a="("+("Value"!==o?e+'.CurrentMember.member_caption <>"'+i+'"':l+" <>"+i);break;case"Contains":a="( InStr (1,"+e+'.CurrentMember.member_caption,"'+i+'") >0';break;case"DoesNotContains":a="( InStr (1,"+e+'.CurrentMember.member_caption,"'+i+'")=0';break;case"BeginWith":a="( Left ("+e+".CurrentMember.member_caption,"+i.length+')="'+i+'"';break;case"DoesNotBeginWith":a="( Left ("+e+".CurrentMember.member_caption,"+i.length+') <>"'+i+'"';break;case"EndsWith":a="( Right ("+e+".CurrentMember.member_caption,"+i.length+')="'+i+'"';break;case"DoesNotEndsWith":a="( Right ("+e+".CurrentMember.member_caption,"+i.length+') <>"'+i+'"';break;case"GreaterThan":a="("+("Value"!==o?e+'.CurrentMember.member_caption >"'+i+'"':l+" >"+i);break;case"GreaterThanOrEqualTo":a="("+("Value"!==o?e+'.CurrentMember.member_caption >="'+i+'"':l+" >="+i);break;case"LessThan":a="("+("Value"!==o?e+'.CurrentMember.member_caption <"'+i+'"':l+" <"+i);break;case"LessThanOrEqualTo":a="("+("Value"!==o?e+'.CurrentMember.member_caption <="'+i+'"':l+" <="+i);break;case"Between":a="("+("Value"!==o?e+'.CurrentMember.member_caption >="'+i+'"AND '+e+'.CurrentMember.member_caption <="'+s+'"':l+" >="+i+" AND "+l+" <="+s);break;case"NotBetween":a="("+("Value"!==o?e+'.CurrentMember.member_caption >="'+i+'"OR '+e+'.CurrentMember.member_caption <="'+s+'"':l+" >="+i+" OR "+l+" <="+s);break;default:a="( InStr (1,"+e+'.CurrentMember.member_caption,"'+i+'") >0'}return a}static getCalculatedFieldQuery(e){let t="";if(e.length>0){t="\nWITH";for(let i of e){let e=(i.formula.indexOf("Measure")>-1?"[Measures].":i.hierarchyUniqueName+".")+"["+i.name+"]",s=(0,a.le)(i.formatString)?null:i.formatString;t+="\nMEMBER "+e+"as ("+i.formula+") "+((0,a.le)(s)?"":', FORMAT_STRING ="'+s.trim()+'"')}}return t}}class ic{constructor(){this.fieldList={},this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.pageColStartPos=0,this.enableSort=!1,this.enableValueSorting=!1,this.dataFields={},this.formatFields={},this.filterMembers={},this.drilledSets={},this.aggregatedValueMatrix=[],this.mappingFields={},this.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,this.formatRegex=/(^[ncpae]{1})([0-1]?[0-9]|20)?$/i,this.pivotValues=[],this.valueContent=[],this.headerContent=[],this.rowStartPos=0,this.pageRowStartPos=0,this.tupColumnInfo=[],this.tupRowInfo=[],this.gridJSON="",this.namedSetsPosition={},this.colDepth=0,this.totalCollection=[],this.parentObjCollection={},this.curDrillEndPos=-1,this.headerGrouping={},this.lastLevel=[],this.showRowSubTotals=!0,this.showColumnSubTotals=!0,this.hideRowTotalsObject={},this.hideColumnTotalsObject={},this.sortObject={},this.isColDrill=!1}renderEngine(e,t){this.isEmptyData=!1,this.mdxQuery="",this.isMeasureAvail=!1,this.allowMemberFilter=!1,this.allowLabelFilter=!1,this.allowValueFilter=!1,this.isMondrian=!1,this.aggregatedValueMatrix=[],this.measureReportItems=[],this.calcChildMembers=[],this.selectedItems=[],this.savedFieldList=void 0,this.savedFieldListData=void 0,this.formatFields={},this.filterMembers={},this.dataFields={},this.valueAxis="",this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.pageColStartPos=0,this.enableValueSorting=!1,this.sortObject={},this.globalize=new a.eC,this.locale=this.globalize.getCulture(),this.localeObj=t?t.localeObj:void 0,this.enableValueSorting=!!t&&t.enableValueSorting,e.url&&(this.dataSourceSettings=e,this.valueAxis="row"===e.valueAxis?"row":"column",this.getAxisFields(),this.formats=e.formatSettings?e.formatSettings:[],this.enableSort=void 0===e.enableSorting||e.enableSorting,this.valueSortSettings=e.valueSortSettings?e.valueSortSettings:void 0,this.filterSettings=e.filterSettings?e.filterSettings:[],this.sortSettings=e.sortSettings?e.sortSettings:[],this.allowMemberFilter=!!e.allowMemberFilter,this.allowLabelFilter=!!e.allowLabelFilter,this.allowValueFilter=!!e.allowValueFilter,this.drilledMembers=e.drilledMembers?this.updateDrilledItems(e.drilledMembers):[],this.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.emptyCellTextContent=e.emptyCellsTextContent?e.emptyCellsTextContent:"",this.pageSettings=t?t.pageSettings?t.pageSettings:this.pageSettings:void 0,this.isPaging=!!this.pageSettings,this.frameSortObject(),this.getFormattedFields(this.formats),this.savedFieldList=t?t.savedFieldList:void 0,this.savedFieldListData=t?t.savedFieldListData:void 0,this.fieldListData=[],this.fieldListObj={},this.setNamedSetsPosition(),this.savedFieldList&&this.savedFieldListData?this.updateFieldlist(!0):this.getFieldList(e),this.loadCalculatedMemberElements(this.calculatedFieldSettings),this.measureReportItems=[],this.updateFilterItems(this.filterSettings),this.generateGridData(e))}generateGridData(e,t){this.rows.length>0||this.columns.length>0||this.values.length>0||this.filters.length>0?tc.getCellSets(e,this,!(!t||"navPaging"!==t||!this.isPaging||void 0===this.pageSettings)):(tc.getCellSets(e,this,!0,void 0,!0),this.generateEngine(void 0,void 0,{dataSourceSettings:e,action:"loadTableElements"}))}generatePagingData(e,t,i){let s=[].slice.call(e.querySelectorAll("Axes, CellData")),o=s[1]?s[1].querySelectorAll("FmtValue"):null;o&&o.length>0&&(this.columnCount=Number(o[0].textContent),this.rowCount=Number(o[1].textContent)),tc.getCellSets(i.dataSourceSettings,this,!0)}scrollPage(e,t,i){tc.getCellSets(this.dataSourceSettings,this,!0)}generateEngine(e,t,i){"down"!==i.action&&(this.pivotValues=[],this.valueContent=[],this.headerContent=[],this.colDepth=0,this.tupColumnInfo=[],this.tupRowInfo=[],this.colMeasures={},this.colMeasurePos=void 0,this.rowMeasurePos=void 0,this.rowStartPos=-1),this.xmlDoc=e?e.cloneNode(!0):void 0,this.request=t,this.customArgs=i,this.totalCollection=[],this.parentObjCollection={},this.curDrillEndPos=-1,this.onDemandDrillEngine=[],this.getSubTotalsVisibility(),this.xmlaCellSet=e?e.querySelectorAll("Axes, CellData"):void 0;let s=this.xmlaCellSet&&this.xmlaCellSet.length>0?[].slice.call(this.xmlaCellSet[0].querySelectorAll('Axis[name|="Axis0"] Tuple')):[],o=this.xmlaCellSet&&this.xmlaCellSet.length>0?[].slice.call(this.xmlaCellSet[0].querySelectorAll('Axis[name|="Axis1"] Tuple')):[],l=this.xmlaCellSet&&this.xmlaCellSet.length>1?[].slice.call(this.xmlaCellSet[1].querySelectorAll("Cell")):[];if(this.drilledMembers.length>0){let e,t=this.getMeasureInfo();e=this.frameMeasureOrder(t,"column",s,l,s.length),s=e.orderedHeaderTuples,l=e.orderedValueTuples,e=this.frameMeasureOrder(t,"row",o,l,s.length),o=e.orderedHeaderTuples,l=e.orderedValueTuples}if("down"===i.action&&this.updateTupCollection("row"===i.drillInfo.axis?o.length:s.length),"down"===i.action&&"column"!==i.drillInfo.axis||(this.frameColumnHeader(s),this.isPaging||this.performColumnSorting()),"down"===i.action&&"row"!==i.drillInfo.axis||(this.frameRowHeader(o),this.isPaging||this.performRowSorting()),this.frameValues(l,s.length),this.performColumnSpanning(),!this.isPaging&&this.enableSort)for(let a=0;a<this.headerContent.length;a++)this.headerContent[a]=this.pivotValues[a];this.isEngineUpdated=!0,this.isEmptyData=0===s.length}getSubTotalsVisibility(){this.showRowSubTotals=this.dataSourceSettings.showRowSubTotals&&this.dataSourceSettings.showSubTotals,this.showColumnSubTotals=this.dataSourceSettings.showColumnSubTotals&&this.dataSourceSettings.showSubTotals,this.hideRowTotalsObject={},this.hideColumnTotalsObject={};let e=1;do{if(1===e){if(this.showColumnSubTotals)for(let e=0;e<this.dataSourceSettings.columns.length;e++)!1===this.dataSourceSettings.columns[e].showSubTotals&&(this.hideColumnTotalsObject[this.dataSourceSettings.columns[e].name]=e)}else if(this.showRowSubTotals)for(let e=0;e<this.dataSourceSettings.rows.length;e++)!1===this.dataSourceSettings.rows[e].showSubTotals&&(this.hideRowTotalsObject[this.dataSourceSettings.rows[e].name]=e);e++}while(e<3)}frameRowHeader(e){this.headerGrouping={},this.lastLevel=[];let t=this.pivotValues.length,i=[],s=[];"down"!==this.customArgs.action?(i=this.pivotValues,s=this.valueContent):t=this.customArgs.drillInfo.currentCell.rowIndex+1,this.rowStartPos=this.rowStartPos>0?this.rowStartPos:t;let o,l,a,r,n=0,h=[],d={},c=[],p=!1,u=-1,g=-1,m=[],b=[{axis:"row",colIndex:0,formattedText:"Grand Total",hasChild:!1,level:-1,rowIndex:0,index:[],type:"grand sum",ordinal:0,colSpan:1,rowSpan:1,memberType:2,isDrilled:!1,valueSort:{"Grand Total":1,levelName:"Grand Total"}}],f=[],y=this.customArgs.drillInfo&&"row"===this.customArgs.drillInfo.axis?this.customArgs.drillInfo.currentCell.ordinal+1:0;for(;n<e.length;){let t=e[n].querySelectorAll("Member");f=this.frameTupCollection(t,f,n+y,this.tupRowInfo,this.showRowSubTotals,this.hideRowTotalsObject,"row"),n++}n=0;let v=e.length;if("down"===this.customArgs.action){let e=this.customArgs.drillInfo.currentCell.ordinal+1;n=e,v+=e,l=this.tupRowInfo[e-1].allCount,o=this.tupRowInfo[e-1].allStartPos,r=this.tupRowInfo[e-1]}let S=n,x=0;for(;n<v;){let f,y=e["down"===this.customArgs.action?n-(this.customArgs.drillInfo.currentCell.ordinal+1):n].querySelectorAll("Member"),v=0,w=this.tupRowInfo[n].allCount,C=this.tupRowInfo[n].allStartPos,M=this.tupRowInfo[n].measure,T=this.tupRowInfo[n].typeCollection,L=this.tupRowInfo[n].drillStartPos,A=this.tupRowInfo[n].startDrillUniquename;if(0===n||n===S){let e="down"===this.customArgs.action?this.tupRowInfo[0].members:y;for(;v<e.length;)m[v]="1"===e[v].querySelector("MEMBER_TYPE").textContent&&0===Number(e[v].querySelector("LNum").textContent)?0:Number(e[v].querySelector("LNum").textContent),"1"===e[v].querySelector("MEMBER_TYPE").textContent?(d[v]=0,u=-1===u?v:u,g=v):(d[v]=1,p="3"!==e[v].querySelector("MEMBER_TYPE").textContent||p),v++;a=T.indexOf("3")}if(v=0,0===n&&(y.length>w+(M?1:0)||1===y.length&&M)&&b.pop(),0===n&&this.isPaging?0===b.length:!p||w===l||C!==o||1===y.length&&M){let e=this.checkAttributeDrill(this.tupRowInfo[n].drillInfo,"rows"),p=!(L>-1)||!(w>0)||e||C>L;p=r&&p&&L>-1?r.startDrillUniquename!==A||!(g>r.measurePosition||r.measureName===this.tupRowInfo[n].measureName||C!==L+1&&this.tupRowInfo[n].measurePosition!==L+1):p;let S=!(u>-1&&w>0)||e||C>g;if(y.length===w+(M?1:0)&&M){let e="Grand Total."+y[a].querySelector("Caption").textContent;b.push({axis:"row",actualText:this.getUniqueName(y[a].querySelector("UName").textContent),colIndex:0,formattedText:"3"===T[a]&&this.dataFields[this.getUniqueName(y[a].querySelector("UName").textContent)]&&this.dataFields[this.getUniqueName(y[a].querySelector("UName").textContent)].caption?this.dataFields[this.getUniqueName(y[a].querySelector("UName").textContent)].caption:y[a].querySelector("Caption").textContent,hasChild:!1,level:-1,rowIndex:t,index:[],ordinal:n,colSpan:1,rowSpan:1,memberType:Number(T[a]),isDrilled:!1,parentUniqueName:y[a].querySelector("PARENT_UNIQUE_NAME")?y[a].querySelector("PARENT_UNIQUE_NAME").textContent:void 0,levelUniqueName:y[a].querySelector("LName").textContent,hierarchy:y[a].getAttribute("Hierarchy"),valueSort:{levelName:e,axis:y[a].getAttribute("Hierarchy")}}),b[b.length-1].valueSort["Grand Total."+y[a].querySelector("Caption").textContent]=1}else if(0!==C&&(0!==a||1!==C)&&p&&S){r=this.tupRowInfo[n];let e=t,o=v;f={};let l=!1;for(;v<y.length;){let e=y[v];if(e.querySelector("UName").textContent!==h[v]&&"2"!==T[v]&&(!(Object.keys(f).length>0?f.isDrilled&&!this.fieldList[f.hierarchy].isHierarchy:l)||"3"===T[v]&&d[v-1]&&0!==d[v+1])){let l=Number(e.querySelector("LNum").textContent)-(d[v]&&"3"!==T[v]?1:m[v]),r=!!this.namedSetsPosition.row[v],p=this.getUniqueName(e.querySelector("UName").textContent),u=this.getDepth(this.tupRowInfo[n],p,Number(T[v]));if(!(this.isPaging&&i[x][0]&&this.fieldList[i[x][0].hierarchy]&&this.fieldList[i[x][0].hierarchy].isHierarchy&&i[x][0].hasChild&&!i[x][0].isDrilled&&!this.rows[v].isNamedSet&&(0===this.rows[v].name.indexOf("[Measures]")||this.fieldList[e.getAttribute("Hierarchy")]&&(this.fieldList[e.getAttribute("Hierarchy")].isHierarchy||this.fieldList[e.getAttribute("Hierarchy")].hasAllMember))&&i[x][0].depth<u)){i[t]=[{axis:"row",actualText:p,colIndex:0,formattedText:"3"===T[v]&&this.dataFields[p]&&this.dataFields[p].caption?this.dataFields[p].caption:e.querySelector("Caption").textContent,hasChild:!!(this.fieldList[e.getAttribute("Hierarchy")]&&this.fieldList[e.getAttribute("Hierarchy")].isHierarchy&&v<this.rows.length-1&&!this.rows[v+1].isNamedSet&&this.rows[v+1].name.indexOf("[Measures]")<0&&this.fieldList[this.rows[v+1].name]&&this.fieldList[this.rows[v+1].name].hasAllMember)||Number(e.querySelector("CHILDREN_CARDINALITY").textContent)>0,level:l,depth:u,rowIndex:t,index:[],ordinal:n,type:"header",colSpan:1,rowSpan:1,memberType:Number(T[v]),isDrilled:!(!this.fieldList[e.getAttribute("Hierarchy")]||!this.fieldList[e.getAttribute("Hierarchy")].isHierarchy||this.isAttributeDrill(e.getAttribute("Hierarchy"),this.tupRowInfo[n].drillInfo,"rows"))||this.tupRowInfo[n].drillInfo[v].isDrilled,parentUniqueName:e.querySelector("PARENT_UNIQUE_NAME")?e.querySelector("PARENT_UNIQUE_NAME").textContent:void 0,levelUniqueName:e.querySelector("LName").textContent,hierarchy:e.getAttribute("Hierarchy"),isNamedSet:r,valueSort:{levelName:"",axis:e.getAttribute("Hierarchy")}}],f="3"!==T[v]?i[t][0]:f,f||c.push(e.querySelector("Caption").textContent);let d=this.getCaptionCollectionWithMeasure(this.tupRowInfo[n]);i[t][0].valueSort.levelName=d,i[t][0].valueSort[d]=1,s[t-this.rowStartPos]={},s[t-this.rowStartPos][0]=i[t][0],M&&a>v&&(h[a]="");for(let e=v+1;e<y.length;e++)h[e]="";h[v]=e.querySelector("UName").textContent,x=3!==Number(T[v])?t:x,t++,o=v}}else"2"===T[v]?o=v:this.tupRowInfo[n].drillInfo[v].isDrilled&&0===d[v]&&(l=!0);this.tupRowInfo[n].drillInfo[v].isDrilled&&this.tupRowInfo[n].showTotals&&(this.tupRowInfo[n].showTotals=!!this.showRowSubTotals&&void 0===this.hideRowTotalsObject[this.tupRowInfo[n].drillInfo[v].hierarchy]),v++}e<t&&o>=y.length-1&&(i[t-1][0].ordinal=n,"header"===i[t-1][0].type&&delete i[t-1][0].type)}l=w,o=C}n++}if(b.length>1&&3!==b[0].memberType&&(b[0].ordinal=-1),"down"!==this.customArgs.action){if(this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals)for(let w=0;w<b.length;w++)b[w].rowIndex=t,i[t]=[b[w]],s[t-this.rowStartPos]={},s[t-this.rowStartPos][0]=i[t][0],t++}else this.updateRowEngine(i,s,e.length),this.onDemandDrillEngine=i}getDepth(e,t,i){let s=e.uNameCollection.indexOf(t),o=(e.uNameCollection.substring(0,s)+(3===i?"":t)).split("::[").map(e=>"["===e[0]?e:"["+e);3===i&&this.rowMeasurePos===o.length&&o.push(t);let l=-1;for(let a=0;a<o.length;a++)l+=o[a].split("~~").length;return l}checkAttributeDrill(e,t){let i=!1;for(let s=0;s<e.length&&(i=this.isAttributeDrill(e[s].hierarchy,e,t),!i);s++);return i}frameTupCollection(e,t,i,s,o,l,r){let n,h,d,c,p=0,u=0,g=[],m=[],b=[],f="",y="",v=!0,S=-1;for(;p<e.length;){let o=e[p],v=Number(o.querySelector("LNum").textContent),x=o.querySelector("UName").textContent;Number(o.querySelector("MEMBER_TYPE").textContent)>3&&(o.querySelector("MEMBER_TYPE").textContent=0===x.indexOf("[Measures]")?"3":"1");let w=0===x.indexOf("[Measures]")?"3":Number(o.querySelector("MEMBER_TYPE").textContent)>3?"1":o.querySelector("MEMBER_TYPE").textContent,C=o.querySelector("Caption").textContent;this.fieldList[C]&&"CalculatedField"===this.fieldList[C].type&&(C=this.fieldList[C].caption,o.querySelector("Caption").textContent=C);let M=o.getAttribute("Hierarchy"),T=o.querySelector("PARENT_UNIQUE_NAME")?o.querySelector("PARENT_UNIQUE_NAME").textContent:"";if("2"===w?(this.isPaging||u++,n=(0,a.le)(n)?p:n):"3"===w?(h=o,d=x,c=p,"column"===r?(this.colMeasures[x]=o,this.colMeasurePos=p):this.rowMeasurePos=p):S=l[M],"2"!==w){if(this.headerGrouping[p]){if(v>this.lastLevel[p])this.lastLevel[p]=v;else if(v<this.lastLevel[p]){let e=this.lastLevel[p];for(;e>=v;)delete this.headerGrouping[p].UName[e],delete this.headerGrouping[p].Caption[e],e--;this.lastLevel[p]=v}this.headerGrouping[p].UName[v]=x,this.headerGrouping[p].Caption[v]=C}else this.lastLevel[p]=v,this.headerGrouping[p]={UName:{[v]:x},Caption:{[v]:C}};if(this.isPaging){let e=T;for(;this.drilledSets[e];){let t=this.drilledSets[e].querySelector("Caption").textContent,i=Number(this.drilledSets[e].querySelector("LNum").textContent);this.headerGrouping[p].UName[i]=e,this.headerGrouping[p].Caption[i]=t,e=null===this.drilledSets[e].querySelector("PARENT_UNIQUE_NAME")?"":this.drilledSets[e].querySelector("PARENT_UNIQUE_NAME").textContent}}let e="",t=Object.keys(this.headerGrouping[p].UName);for(let o=0;o<t.length;o++){let i=t[o];e=0===o?this.headerGrouping[p].UName[i]:e+"~~"+this.headerGrouping[p].UName[i]}f=""===f?e:f+"::"+e;let i="",s=Object.keys(this.headerGrouping[p].Caption);for(let o=0;o<s.length;o++){let e=s[o];i=0===o?this.headerGrouping[p].Caption[e]:i+"~~"+this.headerGrouping[p].Caption[e]}p!==c&&(y=""===y?i:y+"::"+i)}if(g.push(w),m.push(v),((0,a.le)(t[p])||t[p]<v)&&(t[p]=v),b.push({level:v,uName:x,hierarchy:M,isDrilled:!1}),s[i-1]&&"1"===s[i-1].typeCollection[p]&&b[p].level>s[i-1].drillInfo[p].level){let e=f.split(/~~|::\[/).map(e=>"["===e[0]?e:"["+e);e.pop();let t=e.join("~~");this.setDrillInfo(T,t,p,i,s)}p++}return S>-1&&(v="2"!==g[S+1]),s[i]={allCount:u,allStartPos:n,measure:h,measureName:d,measurePosition:c,members:e,typeCollection:g,uNameCollection:f,captionCollection:y,levelCollection:m,drillInfo:b,drillStartPos:-1,drillEndPos:-1,showTotals:!(!o&&u>0&&n>(0===c?1:0))&&v},t}getCaptionCollectionWithMeasure(e){let t=e.captionCollection;if(e.measure){let i=e.measure.querySelector("Caption").textContent,s=e.uNameCollection.split(/[~~,::]+/g).indexOf(e.measureName),o=e.captionCollection.split(/[~~,::]+/g);o.splice(s,0,i),t=o.join(".")}else t=e.captionCollection.split(/[~~,::]+/g).join(".");return t}setNamedSetsPosition(){this.namedSetsPosition={};let e=0;do{let t={},i=e?this.dataSourceSettings.rows:this.dataSourceSettings.columns;for(let e=0;e<i.length;e++)i[e].isNamedSet&&(t[e]=i[e].name);this.namedSetsPosition[e?"row":"column"]=t,e++}while(e<2)}updateRowEngine(e,t,i){let s=this.pivotValues.length-1,o=Object.keys(e).length;for(;s>this.customArgs.drillInfo.currentCell.rowIndex;)this.pivotValues[s+o]=this.pivotValues[s],this.pivotValues[s+o][0].ordinal+=i,this.pivotValues[s+o][0].rowIndex+=o,this.valueContent[s+o-this.rowStartPos]=this.valueContent[s-this.rowStartPos],s--;for(let l=0;l<e.length;l++)this.pivotValues[l]=e[l],this.valueContent[Number(l)-this.rowStartPos]=t[Number(l)-this.rowStartPos];this.pivotValues[this.customArgs.drillInfo.currentCell.rowIndex][0].isDrilled=!0}updateTupCollection(e){let t="row"===this.customArgs.drillInfo.axis?this.tupRowInfo:this.tupColumnInfo,i=t.length-1;for(;i>this.customArgs.drillInfo.currentCell.ordinal;)t[i+e]=t[i],i--}frameColumnHeader(e){this.headerGrouping={},this.lastLevel=[];let t=0,i=[],s=[],o=[],l=-1,a=-1,r=this.customArgs.drillInfo&&"column"===this.customArgs.drillInfo.axis?this.customArgs.drillInfo.currentCell.ordinal+1:0;for(;t<e.length;){let s=e[t].querySelectorAll("Member");i=this.frameTupCollection(s,i,t+r,this.tupColumnInfo,this.showColumnSubTotals,this.hideColumnTotalsObject,"column"),t++}if(e.length>0){let t=e[0].querySelectorAll("Member"),i=0;for(;i<t.length;)o[i]="1"===t[i].querySelector("MEMBER_TYPE").textContent&&0===Number(t[i].querySelector("LNum").textContent)?0:Number(t[i].querySelector("LNum").textContent),"1"!==t[i].querySelector("MEMBER_TYPE").textContent||!this.isPaging&&0!==Number(t[i].querySelector("LNum").textContent)?s[i]=1:(s[i]=0,l=-1===l?i:l,a=i),i++}t=0;let n,h=1,d={},c=!0,p=!1;for(;t<e.length;){let r=e[t].querySelectorAll("Member"),u=this.tupColumnInfo[t].allCount,g=this.tupColumnInfo[t].allStartPos,m=this.tupColumnInfo[t].measure,b=this.tupColumnInfo[t].typeCollection,f=this.tupColumnInfo[t].drillInfo,y=this.tupColumnInfo[t].drillStartPos,v=this.tupColumnInfo[t].startDrillUniquename,S=this.tupColumnInfo[t].endDrillUniquename,x=this.tupColumnInfo[t].drillEndPos,w=this.tupColumnInfo[t].levelCollection,C="2"!==b[0]&&("3"!==b[0]||"2"!==b[1]),M=0;if(i.map((e,t)=>{M+=0===s[t]?e+(1-(o[t]>1?1:o[t])):0===e?this.isPaging&&"2"===b[t]?0:1:e}),this.colDepth=this.colDepth>M?this.colDepth:M,0===t&&r.length>u+(m?1:0)&&(p=!0,C=u>0&&C?g>l:C),C&&0===u){let e=[-1,-1,-1];this.tupColumnInfo[t-1]&&0===this.tupColumnInfo[t-1].allCount?e=this.levelCompare(w,this.tupColumnInfo[t-1].levelCollection):p&&n&&(e=this.levelCompare(w,n.levelCollection)),this.tupColumnInfo[t].drillStartPos<0?(!c&&e[0]>-1&&e[2]>-1&&(h=this.mergeTotCollection(h,u,i,o,s,g,f,e)),this.setParentCollection(r),this.frameCommonColumnLoop(r,t,h,i,s,o),this.tupColumnInfo[t].showTotals||h--,!c&&e[0]>-1&&e[2]>-1&&(h=this.mergeTotCollection(h,u,i,o,s,g,f,e)),c=!1,this.isColDrill?this.isColDrill=!1:h++):d.drillStartPos===y&&d.startDrillUniquename===v&&d.allCount!==u||(!c&&e[0]>-1&&e[2]>-1&&(h=this.mergeTotCollection(h,u,i,o,s,g,f,e),c=!0),this.setParentCollection(r),(!p||a<=y)&&(this.totalCollection[this.totalCollection.length]={allCount:u,ordinal:t,members:r,drillInfo:f},d.allCount=u,d.allStartPos=g,d.drillStartPos=y,d.startDrillUniquename=v,d.endDrillUniquename=S)),n=this.tupColumnInfo[t]}let T=this.checkAttributeDrill(this.tupColumnInfo[t].drillInfo,"columns");if(u>0&&(!p||C&&(T||a<g))&&(u===d.allCount||g!==d.allStartPos)){let e=x===y||d.endDrillUniquename===S,l=g!==d.allStartPos?d.startDrillUniquename!==v:e;y>-1&&!l||(c||(h=this.mergeTotCollection(h,u,i,o,s,g,f),c=!0),this.setParentCollection(r),p&&y>-1&&!(a<=y)||(this.totalCollection[this.totalCollection.length]={allCount:u,ordinal:t,members:r,allStartPos:g,drillInfo:f},d.allCount=u,d.allStartPos=g,d.drillStartPos=y,d.startDrillUniquename=v,d.endDrillUniquename=S))}t++}if(this.totalCollection.length>0)if(Object.keys(this.colMeasures).length>1)this.orderTotals(h,i,s,o);else{this.totalCollection=this.totalCollection.reverse();for(let e of this.totalCollection)if(!(0===this.tupColumnInfo[e.ordinal].measurePosition?1===this.tupColumnInfo[e.ordinal].allStartPos:0===this.tupColumnInfo[e.ordinal].allStartPos)||this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showColumnGrandTotals){this.frameCommonColumnLoop(e.members,e.ordinal,h,i,o,s);let t=this.checkAttributeDrill(this.tupColumnInfo[e.ordinal].drillInfo,"columns");(this.tupColumnInfo[e.ordinal].showTotals||t)&&h++}}}orderTotals(e,t,i,s){let o={},l=1;for(let n of this.totalCollection)if(!(0===this.tupColumnInfo[n.ordinal].measurePosition?1===this.tupColumnInfo[n.ordinal].allStartPos:0===this.tupColumnInfo[n.ordinal].allStartPos)||this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showColumnGrandTotals){let e=this.tupColumnInfo[n.ordinal].measure.querySelector("UName").textContent;o[e]?(o[e].coll.push(n),o[e].count++,l=l<o[e].count?o[e].count:l):o[e]={coll:[n],count:1}}let a=Object.keys(o),r=l-1;for(;r>-1;){for(let l of a){let a=o[l].coll[r];a&&(this.frameCommonColumnLoop(a.members,a.ordinal,e,t,i,s),this.tupColumnInfo[a.ordinal].showTotals&&e++)}r--}}setParentCollection(e){let t=0;for(;e.length>t;){let i=e[t],s=Number(i.querySelector("MEMBER_TYPE").textContent)>2?"3":i.querySelector("MEMBER_TYPE").textContent,o=Number(i.querySelector("LNum").textContent),l=i.querySelector("UName").textContent,a=i.querySelector("PARENT_UNIQUE_NAME")?i.querySelector("PARENT_UNIQUE_NAME").textContent:"",r=!0,n=!1;if(this.parentObjCollection[t]){let e=Object.keys(this.parentObjCollection[t]),i=this.parentObjCollection[t][o-1];r=i?a===i.querySelector("UName").textContent:0===e.length,n="1"===this.tupColumnInfo[0].typeCollection[t]}"2"===s?delete this.parentObjCollection[t]:(!this.isPaging&&!n||r||delete this.parentObjCollection[t],this.parentObjCollection[t]?this.parentObjCollection[t][o]&&this.parentObjCollection[t][o].querySelector("UName").textContent===l||(this.parentObjCollection[t][o]=i):(this.parentObjCollection[t]={},this.parentObjCollection[t][o]=i)),t++}}setDrillInfo(e,t,i,s,o){for(s--;o[s]&&o[s].drillInfo[i].uName===e&&!(o[s].uNameCollection.split(/~~|::\[/).map(e=>"["===e[0]?e:"["+e).join("~~").indexOf(t)<0);)o[s].drillInfo[i].isDrilled=!0,this.curDrillEndPos<=i&&(o[s].drillEndPos=this.curDrillEndPos=i,o[s].endDrillUniquename=e),(o[s].drillStartPos>i||-1===o[s].drillStartPos)&&(o[s].drillStartPos=i),o[s].startDrillUniquename=e,s--}levelCompare(e,t){let i=[-1,0];for(let s=0;s<t.length;s++)if(e[s]!==t[s]){i=[s,e[s],t[s]-e[s]];break}return i}mergeTotCollection(e,t,i,s,o,l,r,n){let h=(0,a.le)(l)?n[0]:l-(this.colMeasurePos===l-1?2:1),d=r[h]&&r[h].level,c=this.getLevelsAsString(h-1,r),p={},u=1,g=!1;for(let a of this.totalCollection)if(g||a.allCount<=t&&(!(d>-1&&a.drillInfo[h])||a.drillInfo[h].level>=d&&this.getLevelsAsString(h-1,a.drillInfo)===c)){let e=this.tupColumnInfo[a.ordinal].measure?this.tupColumnInfo[a.ordinal].measure.querySelector("UName").textContent:"measure";p[e]?(p[e].coll.push(a),p[e].count++,u=u<p[e].count?p[e].count:u):p[e]={coll:[a],count:1},g=!1}let m=Object.keys(p),b=u-1;for(;b>-1;){for(let t of m){let l=p[t].coll[b];l&&((!(0===this.tupColumnInfo[l.ordinal].measurePosition?1===this.tupColumnInfo[l.ordinal].allStartPos:0===this.tupColumnInfo[l.ordinal].allStartPos)||this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showColumnGrandTotals)&&(this.frameCommonColumnLoop(l.members,l.ordinal,e,i,o,s),this.tupColumnInfo[l.ordinal].showTotals&&e++),this.totalCollection.pop())}b--}return e}getLevelsAsString(e,t){let i=[];for(let s=0;s<e;s++)i[s]=t[s].level;return i.length>0?i.toString():""}frameCommonColumnLoop(e,t,i,s,o,l){let a=-1;if(this.tupColumnInfo[t].showTotals){let i=0,r=0;for(;i<e.length;)r+=l[i]>0&&this.getMeasurePosition(this.tupColumnInfo[t].uNameCollection,this.tupColumnInfo[t].measurePosition)!==i?s[i]:s[i]+(1-o[i]),this.tupColumnInfo[t].drillInfo[i].isDrilled&&this.tupColumnInfo[t].showTotals&&(this.tupColumnInfo[t].showTotals=!!this.showColumnSubTotals&&void 0===this.hideColumnTotalsObject[this.tupColumnInfo[t].drillInfo[i].hierarchy],r-=s[i]-this.tupColumnInfo[t].levelCollection[i],a=this.tupColumnInfo[t].showTotals?-1:r-1),i++}let r=this.checkAttributeDrill(this.tupColumnInfo[t].drillInfo,"columns");if(this.tupColumnInfo[t].showTotals||r){let a=0,r=0,n={};for(;a<e.length;){let h=e[a],d=Number(h.querySelector("MEMBER_TYPE").textContent)>2?"3":h.querySelector("MEMBER_TYPE").textContent,c=0;for(let p="2"!==d?l[a]?1:o[a]:1;p<=("3"===d?1:s[a]);p++){let s=!1;this.pivotValues[r]||(this.pivotValues[r]=[]),Number(e[a].querySelector("LNum").textContent)>p&&"2"!==d?(this.parentObjCollection[a][p]||this.getDrilledParent(e[a],p,this.parentObjCollection[a]),this.parentObjCollection[a][p]&&(h=this.parentObjCollection[a][p]),s=!0):(h=e[a],c++),"2"!==d&&(n[h.querySelector("UName").textContent]=h.querySelector("Caption").textContent);let o="",u=Object.keys(n);for(let e=0;e<u.length;e++){let t=u[e];o=0===e?n[t]:o+"."+n[t]}let g=!!this.namedSetsPosition.column[a],m=this.getUniqueName(h.querySelector("UName").textContent),b=this.getDepth(this.tupColumnInfo[t],m,Number(d));if(this.isPaging&&this.pivotValues[r-1]&&this.pivotValues[r-1][i]&&this.fieldList[this.pivotValues[r-1][i].hierarchy]&&this.fieldList[this.pivotValues[r-1][i].hierarchy].isHierarchy&&this.pivotValues[r-1][i].hasChild&&!this.pivotValues[r-1][i].isDrilled&&!this.columns[a].isNamedSet&&this.fieldList[h.getAttribute("Hierarchy")]&&(this.fieldList[h.getAttribute("Hierarchy")].isHierarchy||this.fieldList[h.getAttribute("Hierarchy")].hasAllMember)&&this.pivotValues[r-1][i].depth<b){this.isColDrill=!0;break}this.pivotValues[r][i]={axis:"column",actualText:m,colIndex:i,formattedText:"3"===d&&this.dataFields[m]&&this.dataFields[m].caption?this.dataFields[m].caption:h.querySelector("Caption").textContent,hasChild:!!(this.fieldList[h.getAttribute("Hierarchy")]&&this.fieldList[h.getAttribute("Hierarchy")].isHierarchy&&a<this.columns.length-1&&!this.columns[a+1].isNamedSet&&this.columns[a+1].name.indexOf("[Measures]")<0&&this.fieldList[this.columns[a+1].name]&&this.fieldList[this.columns[a+1].name].hasAllMember)||Number(h.querySelector("CHILDREN_CARDINALITY").textContent)>0,level:c>1?-1:Number(h.querySelector("LNum").textContent)-(l[a]&&"3"!==d?1:0),rowIndex:r,ordinal:t,memberType:Number(d),depth:b,isDrilled:!(!this.fieldList[h.getAttribute("Hierarchy")]||!this.fieldList[h.getAttribute("Hierarchy")].isHierarchy||this.isAttributeDrill(h.getAttribute("Hierarchy"),this.tupColumnInfo[t].drillInfo,"columns"))||s||this.tupColumnInfo[t].drillInfo[a].isDrilled,parentUniqueName:h.querySelector("PARENT_UNIQUE_NAME")?h.querySelector("PARENT_UNIQUE_NAME").textContent:void 0,levelUniqueName:h.querySelector("LName").textContent,hierarchy:h.getAttribute("Hierarchy"),isNamedSet:g,valueSort:{levelName:o,[o]:1,axis:h.getAttribute("Hierarchy")}},this.headerContent[r]||(this.headerContent[r]={}),this.headerContent[r][i]=this.pivotValues[r][i],r++}a++}}else if(a>-1)this.pivotValues[a][i-1].ordinal=t;else if(this.tupColumnInfo[t].allCount>0){let e=0,a=0;for(;e<this.tupColumnInfo[t].allStartPos;)a+=l[e]>0&&this.getMeasurePosition(this.tupColumnInfo[t].uNameCollection,this.tupColumnInfo[t].measurePosition)!==e?s[e]:s[e]+(1-o[e]),e++;a-=this.tupColumnInfo[t].allStartPos===this.tupColumnInfo[t].measurePosition+1?s[this.tupColumnInfo[t].allStartPos-2]-this.tupColumnInfo[t].levelCollection[this.tupColumnInfo[t].allStartPos-2]+1:s[this.tupColumnInfo[t].allStartPos-1]-this.tupColumnInfo[t].levelCollection[this.tupColumnInfo[t].allStartPos-1],this.pivotValues[a-1][i-1].ordinal=t}}isAttributeDrill(e,t,i){let s=!1;if(!this.isAdjacentToMeasure(e,i))for(let o=0;o<this.drilledMembers.length;o++)if(this.drilledMembers[o].name===e)for(let e=0;e<this.drilledMembers[o].items.length;e++){let i=this.drilledMembers[o].items[e].split(this.drilledMembers[o].delimiter),l="";for(let e=0;e<i.length;e++)t[e]&&t[e].uName&&(l=l+(""===l?"":this.drilledMembers[o].delimiter)+t[e].uName);if(l===this.drilledMembers[o].items[e]){s=!0;break}}return s}isAdjacentToMeasure(e,t){let i=!1,s="rows"===t?this.rows:this.columns;for(let o=0;o<s.length;o++)if(s[o].name===e&&s[o+1]&&("[Measures]"===s[o+1].name||s[o+1].isNamedSet||this.fieldList[s[o+1].name]&&!this.fieldList[s[o+1].name].hasAllMember)){i=!0;break}return i}getDrilledParent(e,t,i){let s=Number(e.querySelector("LNum").textContent),o=e;for(let l=s-1;l>=t;l--){let e=this.drilledSets[o.querySelector("PARENT_UNIQUE_NAME").textContent];if(!e)break;i[l]=e,o=e}}performRowSorting(){if(this.enableSort&&this.tupRowInfo.length>0){let e=this.pivotValues.length,t={},i={},s=[],o=!1,l=this.tupRowInfo[0].typeCollection.lastIndexOf("1");for(let c=this.colDepth;c<e;c++){let e=this.pivotValues[c][0],a=this.tupRowInfo[e.ordinal],r=a?0===a.measurePosition&&3===e.memberType?a.measureName:a.uNameCollection:"";if(""!==r){l>-1&&(r=this.frameUniqueName(r,e,a));let s=r.split(/~~|::\[/).length;if(3===e.memberType&&this.tupRowInfo[0].measurePosition>0){let t=this.getParentUname(r,e,!0,!0);i[t]?i[t].push(e):i[t]=[e]}else t[s]?t[s][r]=[e]:t[s]={[r]:[e]}}o&&s.push(e),"grand sum"===e.type&&(o=!0)}let a=Object.keys(i).length>0&&this.tupRowInfo[0].measurePosition>0,r=Object.keys(t).map(e=>Number(e)).sort((e,t)=>e>t?1:t>e?-1:0),n={};for(let c=r.length-1;c>=0;c--){let e={},s=t[r[c]],o=Object.keys(s);for(let t=0;t<o.length;t++){let i=0===c?"parent":this.getParentUname(o[t],s[o[t]][0],a,!1);e[i]?e[i].push(s[o[t]][0]):e[i]=s[o[t]]}let h=Object.keys(e);for(let t=0;t<h.length;t++)e[h[t]]=this.sortRowHeaders(e[h[t]]);if(n[r[c+1]])for(let t=0;t<h.length;t++){let s=[],o=e[h[t]];for(let e=0;e<o.length;e++){let t=this.tupRowInfo[o[e].ordinal],h=0===t.measurePosition&&3===o[e].memberType?t.measureName:t.uNameCollection;s.push(o[e]),l>-1&&(h=this.frameUniqueName(h,o[e],t));let d=!1;if(a){let l=this.getParentUname(h,o[e],a,!0);if(i[l]){i[l]=this.sortRowHeaders(i[l]);let e=h.lastIndexOf("::[")===h.indexOf("::[Measures]"),o=h.split("::[").length-1===t.measurePosition,a=!t.drillInfo[t.measurePosition-1].isDrilled,p=t.members.length>t.measurePosition+1;if(e&&o&&a&&p){d=!0;for(let e=0;e<i[l].length;e++){s.push(i[l][e]);let t=h.substring(0,h.indexOf("::[Measures]"))+"::"+i[l][e].actualText;n[r[c+1]][t]&&(s=s.concat(n[r[c+1]][t]))}}else s=s.concat(i[l])}}!d&&n[r[c+1]][h]&&(s=s.concat(n[r[c+1]][h]))}e[h[t]]=s}else if(a)for(let t=0;t<h.length;t++){let s=e[h[t]],o=[];for(let e=0;e<s.length;e++){o.push(s[e]);let t=this.tupRowInfo[s[e].ordinal].uNameCollection;l>-1&&(t=this.frameUniqueName(t,s[e],this.tupRowInfo[s[e].ordinal]));let a=this.getParentUname(t,s[e],!0,!0);i[a]&&(i[a]=this.sortRowHeaders(i[a]),o=o.concat(i[a]))}e[h[t]]=o}n[r[c]]=e}let h=0,d=0;o=!1,s=this.sortRowHeaders(s);for(let c=this.colDepth;c<e;c++){let e=o?s:n[r[0]].parent,t=o?h-d:h;e[t]&&(this.pivotValues[c]=[e[t]],this.pivotValues[c][0].rowIndex=c,this.valueContent[h][0]=this.pivotValues[c][0]),h++,"grand sum"===this.pivotValues[c][0].type&&(o=!0,d=h)}}}performColumnSorting(){if(this.enableSort)for(let e=0;e<this.dataSourceSettings.columns.length;e++){let e=[],t=0,i=[];for(let s=0;s<this.pivotValues.length;s++){let o,l,r=this.pivotValues[s],n={},h=1;i[t]=[],e[t]=[];let d=1;for(d=d;d<r.length;d++)if(!r[d].isNamedSet){if(2!=r[d].memberType&&"[Measures]"!=r[d].hierarchy&&-1!=r[d].level){if((0,a.le)(n[r[d].formattedText])||(0,a.le)(this.pivotValues[s-1]))n[r[d].formattedText]=n[r[d].formattedText]?n[r[d].formattedText]:[],n[r[d].formattedText][r[d].colIndex]=r[d];else if(n[r[d].formattedText]&&this.pivotValues[s-1]){let i=this.pivotValues[s-1][r[d].colIndex],o=Number(Object.keys(n[r[d].formattedText])[0]);if(i.formattedText!==this.pivotValues[s-1][n[r[d].formattedText][o].colIndex].formattedText){let i=Object.keys(n);i=this.sortColumnHeaders(i,this.sortObject[r[d-1].levelUniqueName]||this.sortObject[r[d].hierarchy]),(0,a.le)(e[t])&&(e[t]=[]);for(let s=0;s<i.length;s++){let o=Object.keys(n[i[s]]).length;for(let l=0;l<o;l++)h=0===e[t].length?1:0,e[t][e[t].length+h]=n[i[s]][Number(Object.keys(n[i[s]])[l])]}n={},n[r[d].formattedText]=[],n[r[d].formattedText][r[d].colIndex]=r[d]}else n[r[d].formattedText][r[d].colIndex]=r[d]}}else if(Object.keys(n).length>0){i[t][i[t].length+h]=r[d],o=Object.keys(n),o=this.sortColumnHeaders(o,this.sortObject[r[d-1].levelUniqueName]||this.sortObject[r[d].hierarchy]),(0,a.le)(e[t])&&(e[t]=[]);for(let i=0;i<o.length;i++){let s=Object.keys(n[o[i]]).length;for(let l=0;l<s;l++)h=0===e[t].length?1:0,e[t][e[t].length+h]=n[o[i]][Number(Object.keys(n[o[i]])[l])]}}else(-1===r[d].level||0===r[d].level)&&Object.keys(n).length>=0&&"[Measures]"!=r[d].hierarchy&&(i[t][i[t].length+h]=r[d]);if(-1!=r[d].level&&1===Object.keys(n).length&&"[Measures]"!=r[d].hierarchy&&!(0,a.le)(r[d+1])&&-1===r[d+1].level){let e=Object.keys(n[r[d].formattedText]).length,s=Object.keys(n[r[d].formattedText]);if(e>1)for(let o=0;o<e;o++)h=0===i[t].length?1:0,i[t][i[t].length+h]=n[r[d].formattedText][Number(s[o])];else i[t][i[t].length+h]=r[d]}if(Object.keys(i[t]).length>0){h=0===e[t].length?1:0;let s=i[t].length;if(s>2)for(let o=1;o<s;o++)h=0===e[t].length?1:0,e[t][e[t].length+h]=i[t][o];else e[t][e[t].length+h]=i[t][1]||i[t][0];n={},i[t]=[]}}if(Object.keys(n).length>0){i[t][i[t].length+h]=r[d],l=Object.keys(n),o=this.sortColumnHeaders(l,this.sortObject[r[d-1].levelUniqueName]||this.sortObject[r[d-1].hierarchy]),(0,a.le)(e[t])&&(e[t]=[]);for(let i=0;i<l.length;i++){let s=Object.keys(n[l[i]]).length;for(let a=0;a<s;a++)h=0===e[t].length?1:0,e[t][e[t].length+h]=n[o[i]][Number(Object.keys(n[l[i]])[a])]}}for(let i=1;i<e[t].length;i++)this.pivotValues[t][i]=e[t][i];for(let e=s;e<this.pivotValues.length;e++){let t=(0,a.l7)({},this.pivotValues[e+1],null,!0),i=(0,a.l7)({},this.pivotValues[e],null,!0);if(Object.keys(t).length===Object.keys(i).length&&Object.keys(t).length>2){for(let o=1;o<this.pivotValues[s].length;o++)Object.keys(t).length>0&&i[o].colIndex!=t[o].colIndex&&(this.pivotValues[e+1][o]=t[i[o].colIndex]);break}}t++,n={}}for(let s=0;s<this.pivotValues.length;s++){let e=this.pivotValues[s];for(let t=1;t<e.length;t++)e[t].colIndex=t}}}frameUniqueName(e,t,i){let s=e.indexOf(t.actualText.toString()+"::[Measures]")>-1,o=(e=e.substring(0,e.indexOf(t.actualText.toString()))+t.actualText.toString()).split("::[").length<=this.getMeasurePosition(e,i.measurePosition);return e+(s||o?"::"+i.measureName:"")}getMeasurePosition(e,t){let i=t,s=e.split("::[");for(let o=0;o<s.length;o++)if(s[o]&&s[o].indexOf("Measures")>-1){i=o;break}return i}sortRowHeaders(e){if(e.length>0&&3!==e[0].memberType&&!e[0].isNamedSet){let t=this.sortObject[e[0].hierarchy]||this.sortObject[e[0].levelUniqueName];"Ascending"===t||void 0===t?e.sort((e,t)=>e.formattedText>t.formattedText?1:t.formattedText>e.formattedText?-1:0):"Descending"===t&&e.sort((e,t)=>e.formattedText<t.formattedText?1:t.formattedText<e.formattedText?-1:0)}return e}sortColumnHeaders(e,t){return"Ascending"===t||void 0===t?e.sort((e,t)=>e>t?1:t>e?-1:0):"Descending"===t&&e.sort((e,t)=>e<t?1:t<e?-1:0),e}frameSortObject(){if(this.enableSort)for(let e=0;e<this.sortSettings.length;e++)this.sortObject[this.sortSettings[e].name]=this.sortSettings[e].order}getParentUname(e,t,i,s){let o="";if(i&&!s){let i=this.tupRowInfo[t.ordinal],s=[],l={};for(let t=0;t<e.length;t++)"~"!==e[t]&&":"!==e[t]||(s.push(t),l[t]=e[t]+e[t],t++);if(this.getMeasurePosition(e,i.measurePosition)>=e.split("::[").length-1)o=s[s.length-2]>-1?e.substring(0,s[s.length-2])+l[s[s.length-1]]+i.measureName:"parent";else{let t=e.lastIndexOf("~~")>e.lastIndexOf("::[")?e.lastIndexOf("~~"):e.lastIndexOf("::[");o=t>-1?e.substring(0,t):"parent"}}else{let t=e.lastIndexOf("~~")>e.lastIndexOf("::[")?e.lastIndexOf("~~"):e.lastIndexOf("::[");o=t>-1?e.substring(0,t):"parent"}return o}performColumnSpanning(){let e={},t=this.rowStartPos-1,i=Object.keys(this.colMeasures).length;for(;t>-1;){e[t]={};let s=this.pivotValues[t].length-1;for(;s>0;){e[t][s]=1;let o=this.pivotValues[t][s+1],l=this.pivotValues[t+1]&&this.rowStartPos-t>1?this.pivotValues[t+1][s]:void 0,a=this.pivotValues[t][s],r=!1,n=!1,h=this.tupColumnInfo[a.ordinal],d=h.allStartPos>("3"===h.typeCollection[0]?1:0),c=this.checkAttributeDrill(h.drillInfo,"columns");if(l&&o&&(2===a.memberType||-1===a.level?o.actualText===a.actualText:3===a.memberType&&a.actualText===o.actualText||o.valueSort.levelName===a.valueSort.levelName)&&(2===a.memberType?a.colSpan=d&&"sum"!==o.type||o.colSpan+1>(h.measurePosition>t?i:0)?1:o.colSpan+1:(a.colSpan=o.colSpan+1,a.ordinal=o.ordinal),r=!0),2===a.memberType){if(d)c||(a.type="sum"),a.formattedText="Total",a.valueSort[a.valueSort.levelName.toString()]=1;else{let e="Grand Total";l&&i>0&&(e=3===l.memberType?"Grand Total."+l.formattedText:l.valueSort.levelName),a.type="grand sum",a.formattedText="Grand Total",a.valueSort.levelName=e,a.valueSort[e.toString()]=1}a.hasChild=!1}else-1===a.level&&(a.type="sum",a.formattedText="Total",a.hasChild=!1,a.valueSort[a.valueSort.levelName.toString()]=1);l?2===a.memberType&&2===l.memberType||l.actualText===a.actualText?(e[t][s]=e[t+1]?e[t+1][s]+1:1,0===t||1===a.memberType&&a.level>-1&&1===l.memberType&&-1===l.level?(a.rowSpan=!a.isDrilled||this.fieldList[a.hierarchy]&&this.fieldList[a.hierarchy].isHierarchy&&!a.hasChild?e[t+1][s]+1:1,l.rowSpan=!l.isDrilled||this.fieldList[l.hierarchy]&&this.fieldList[l.hierarchy].isHierarchy&&!l.hasChild||-1!==l.level?l.rowSpan:e[t+1][s]):a.rowSpan=3===a.memberType?1:-1,n=!0):!a.isDrilled||this.fieldList[a.hierarchy]&&this.fieldList[a.hierarchy].isHierarchy&&!a.hasChild||-1!==a.level||2!==l.memberType?(a.rowSpan=0===t?e[t][s]:-1,l.rowSpan=l.level>-1&&(!l.isDrilled||this.fieldList[l.hierarchy]&&this.fieldList[l.hierarchy].isHierarchy&&!l.hasChild)||2!==a.memberType&&2===l.memberType?e[t+1][s]:1):(e[t][s]=e[t+1]?e[t+1][s]+1:1,a.rowSpan=-1,n=!0):a.rowSpan=a.level>-1||1===this.rowStartPos?e[t][s]:-1,r||(a.colSpan=1),n||(e[t][s]=1),s--}t--}}frameValues(e,t){let i=this.colDepth,s=this.pivotValues.length,o=0;if("down"===this.customArgs.action){let e=Object.keys(this.onDemandDrillEngine);i=Number(e[0]),s=Number(e[e.length-1])+1,o=this.onDemandDrillEngine[i][0].ordinal}let l={};for(let a=0;a<e.length;a++)l[Number(e[a].getAttribute("CellOrdinal"))]=e[a];for(let r=i;r<s;r++){let e=this.pivotValues[r],i=e[0].ordinal;for(let s=1;s<this.pivotValues[0].length;s++)if(this.pivotValues[this.colDepth-1][s]){let n=this.pivotValues[this.colDepth-1][s].ordinal,h=this.pivotValues[this.colDepth-1][s],d=3===e[0].memberType?e[0].actualText.toString():this.tupColumnInfo[h.ordinal]&&this.tupColumnInfo[h.ordinal].measure?this.tupColumnInfo[h.ordinal].measure.querySelector("UName").textContent:e[0].actualText;if("header"===e[0].type)e[s]={axis:"value",actualText:this.getUniqueName(d),formattedText:"",value:0,colIndex:s,rowIndex:r};else{let h,c,p="0",u=this.getUniqueName(d),g=!0,m=this.fieldList[e[0].hierarchy]&&this.fieldList[e[0].hierarchy].isHierarchy&&e[0].isDrilled;g=this.tupRowInfo[i]?this.tupRowInfo[i].showTotals:this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals,h=l[(i-o)*t+n],c=!g&&m?"":(0,a.le)(h)||(0,a.le)(h.querySelector("FmtValue"))?this.emptyCellTextContent:h.querySelector("FmtValue").textContent,p=!g&&m?"0":(0,a.le)(h)||(0,a.le)(h.querySelector("Value"))?null:h.querySelector("Value").textContent,c=g&&!(0,a.le)(p)?this.getFormattedValue(Number(p),u,""!==c?c:p):c;let b=!this.tupColumnInfo[n]||this.tupColumnInfo[n].allCount>0||this.tupColumnInfo[n].drillStartPos>-1||!this.tupRowInfo[i]||this.tupRowInfo[i].allCount>0||this.tupRowInfo[i].drillStartPos>-1,f=!!this.tupRowInfo[i]&&(0===this.tupRowInfo[i].measurePosition?1===this.tupRowInfo[i].allStartPos:0===this.tupRowInfo[i].allStartPos)||!!this.tupColumnInfo[n]&&(0===this.tupColumnInfo[n].measurePosition?1===this.tupColumnInfo[n].allStartPos:0===this.tupColumnInfo[n].allStartPos);e[s]={axis:"value",actualText:u,formattedText:c,colOrdinal:n,rowOrdinal:i,columnHeaders:this.tupColumnInfo[n]?this.tupColumnInfo[n].captionCollection:"",rowHeaders:this.tupRowInfo[i]?this.tupRowInfo[i].captionCollection:"",value:(0,a.le)(p)?null:Number(p),colIndex:s,rowIndex:r,isSum:b,isGrandSum:f}}this.valueContent[r-this.rowStartPos][s]=e[s]}}}getFormattedValue(e,t,i){let s=i;if(this.formatFields[t]&&!(0,a.le)(e)){let i=(0,a.l7)({},this.formatFields[t].properties?this.formatFields[t].properties:this.formatFields[t],null,!0);if(delete i.name,!i.minimumSignificantDigits&&i.minimumSignificantDigits<1&&delete i.minimumSignificantDigits,!i.maximumSignificantDigits&&i.maximumSignificantDigits<1&&delete i.maximumSignificantDigits,i.type)s=this.globalize.formatDate(new Date(e.toString()),i);else{if(delete i.type,i.format&&!this.formatRegex.test(i.format)){let e=i.format.match(this.customRegex);i.useGrouping=-1!==e[6].indexOf(",")}s=this.globalize.formatNumber(e,i)}}return s}getMeasureInfo(){let e,t="column",i=[];for(let s of this.values)i[i.length]=s.isCalculatedField?this.fieldList[s.name].tag:s.name;if(i.length>1){if(this.isMeasureAvail){let i=!1;for(let s=0,o=this.rows.length;s<o;s++)if("[measures]"===this.rows[s].name.toLowerCase()){t="row",e=s,i=!0;break}if(!i)for(let s=0,o=this.columns.length;s<o;s++)if("[measures]"===this.columns[s].name.toLowerCase()){t="column",e=s,i=!0;break}}else t=this.valueAxis,e="row"===t?this.rows.length-1:this.columns.length-1;return{measureAxis:t,measureIndex:e,valueInfo:i}}return{measureAxis:t,measureIndex:-1,valueInfo:[]}}frameMeasureOrder(e,t,i,s,o){let l=[],a=[],r=[],n={},h=[],d=e.measureAxis,c=e.measureIndex,p=e.valueInfo;if(d===t&&p.length>0){let e={},t=[];for(let s=0,o=i.length;s<o;s++){let o=i[s],l=[].slice.call(o.querySelectorAll("Member")),a="",r="",d=0;for(;d<l.length;)a=a+(""!==a?"~~":"")+l[d].querySelector("UName").textContent,(d===c&&0===c||d===c-1)&&(r=a),d++;e[r]?e[r][e[r].length]=a:(e[r]=[a],t[t.length]=r),n[a]={index:s,node:o},h[h.length]=a}if(h.length>0&&t.length>0)if(0===c){for(let i of p)for(let s of t)if(s===i)for(let t of e[s])r[r.length]=n[t].index,l[l.length]=n[t].node}else for(let i of t)for(let t of p)for(let s of e[i])s.split("~~")[c]===t&&(r[r.length]=n[s].index,l[l.length]=n[s].node);if(s.length>0){let e=[],t=[],i=0,l=0;for(let a=0,r=s.length;a<r;a++)i>o-1?(l++,i=0,e[l]||(e[l]=[]),e[l][i]=a,i++):(e[l]||(e[l]=[]),e[l][i]=a,i++),t[t.length]=Number(s[a].getAttribute("CellOrdinal"));if("column"===d){if(e.length>0&&e[0].length===r.length)for(let n=0,h=r.length;n<h;n++){let i=0;for(;i<e.length;){let l=i*o+n,h=t[l].toString(),d=s[Number(e[i][r[n]])];d.setAttribute("CellOrdinal",h.toString()),a[l]=d,i++}}}else if(e.length===r.length)for(let n=0,h=r.length;n<h;n++){let i=0;for(;i<e[r[n]].length;){let l=t[n*o+i].toString(),h=s[Number(e[r[n]][i])];h.setAttribute("CellOrdinal",l.toString()),a[a.length]=h,i++}}}return{orderedHeaderTuples:l,orderedValueTuples:a}}return{orderedHeaderTuples:i,orderedValueTuples:s}}getDrilledSets(e,t,i,s){let o=[],l=t.actualText.toString(),r="row"===s?this.tupRowInfo:this.tupColumnInfo,n=r[t.ordinal],h=0===r[0].typeCollection.indexOf("3")?1:0,d=0,c="1"===r[0].typeCollection[i];for(;d<r.length;)((0,a.le)(r[d].allStartPos)||r[d].allStartPos>h)&&(o[o.length]=r[d].uNameCollection),d++;let p=e.split("::[").map(e=>"["===e[0]?e:"["+e),u=[];for(let a=0;a<=i;a++)if(p[a])if((c||this.isPaging)&&a===i){let e=p[a].split("~~"),t=e.indexOf(l),i=[];for(let s=0;s<=t;s++)i.push(e[s]);u[u.length]=i.length>0?i.join("~~"):p[a]}else u[u.length]=p[a];e=u.join("::");let g=[],m={};for(let a of o)if(0===a.indexOf(e)&&(g.push(a),this.isPaging)){let e=a.split("::[")[i];e="["===e[0]?e:"["+e;let t=e.split("~~");for(let i=t.indexOf(l);i<t.length;i++)m[t[i]]=t[i]}if(this.isPaging){let e=n.uNameCollection.split("::[").map(e=>"["===e[0]?e:"["+e),t=[];for(let o=0;o<e.length;o++)o!==i&&(t[o]=e[o]);let s=Object.keys(m);for(let o=0;o<s.length;o++)t[i]=s[o],g.push(t.join("::"))}let b={};for(let a of g){let e=a.split("::[").map(e=>"["===e[0]?e:"["+e),t="";for(let s=0;s<=i;s++){let i=e[s];if(i){let e=i.split("~~");t=t+(""!==t?"~~":"")+e[e.length-1]}}b[t]=t}return b}updateDrilledInfo(e){this.dataSourceSettings=e,this.drilledMembers=e.drilledMembers?this.updateDrilledItems(e.drilledMembers):[],this.generateGridData(e)}updateCalcFields(e,t){this.dataSourceSettings=e,this.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.getAxisFields(),this.updateFieldlist(),this.loadCalculatedMemberElements(this.calculatedFieldSettings),this.dataFields[t.name]?this.generateGridData(e):tc.getCellSets(e,this,!0,void 0,!0)}onSort(e){this.dataSourceSettings=e,this.sortSettings=e.sortSettings?e.sortSettings:[],this.getAxisFields(),this.frameSortObject(),this.updateFieldlist(),this.xmlaCellSet.length>0&&this.xmlDoc?this.generateEngine(this.xmlDoc,this.request,this.customArgs):this.generateGridData(e)}updateFieldlist(e){let t=0;for(;t<this.savedFieldListData.length;){let i=this.savedFieldListData[t].id,s=this.savedFieldListData[t].pid;if(this.savedFieldList[i]){let s=this.enableSort?this.sortObject[i]?this.sortObject[i]:"Ascending":"None";this.savedFieldList[i].isSelected=!1,this.savedFieldList[i].isExcelFilter=!1,this.savedFieldList[i].sort=s,this.savedFieldList[i].allowDragAndDrop=!0,this.savedFieldList[i].showFilterIcon=!0,this.savedFieldList[i].showSortIcon=!0,this.savedFieldList[i].showEditIcon=!0,this.savedFieldList[i].showRemoveIcon=!0,this.savedFieldList[i].showValueTypeIcon=!0,this.savedFieldList[i].showSubTotals=!0,this.savedFieldListData[t].sort=s,this.savedFieldListData[t].allowDragAndDrop=!0,this.savedFieldListData[t].showFilterIcon=!0,this.savedFieldListData[t].showSortIcon=!0,this.savedFieldListData[t].showEditIcon=!0,this.savedFieldListData[t].showRemoveIcon=!0,this.savedFieldListData[t].showValueTypeIcon=!0,this.savedFieldListData[t].showSubTotals=!0,e&&(this.savedFieldList[i].filter=[],this.savedFieldList[i].actualFilter=[])}if(this.dataFields[i]&&this.savedFieldList[i]&&this.selectedItems.indexOf(i)>-1?(this.savedFieldList[i].isSelected=!0,this.savedFieldList[i].allowDragAndDrop=!this.dataFields[i]||this.dataFields[i].allowDragAndDrop,this.savedFieldList[i].showFilterIcon=!this.dataFields[i]||this.dataFields[i].showFilterIcon,this.savedFieldList[i].showSortIcon=!this.dataFields[i]||this.dataFields[i].showSortIcon,this.savedFieldList[i].showEditIcon=!this.dataFields[i]||this.dataFields[i].showEditIcon,this.savedFieldList[i].showRemoveIcon=!this.dataFields[i]||this.dataFields[i].showRemoveIcon,this.savedFieldList[i].showValueTypeIcon=!this.dataFields[i]||this.dataFields[i].showValueTypeIcon,this.savedFieldList[i].showSubTotals=!this.dataFields[i]||this.dataFields[i].showSubTotals,this.savedFieldListData[t].isSelected=!0,this.savedFieldListData[t].allowDragAndDrop=!this.dataFields[i]||this.dataFields[i].allowDragAndDrop,this.savedFieldListData[t].showFilterIcon=!this.dataFields[i]||this.dataFields[i].showFilterIcon,this.savedFieldListData[t].showSortIcon=!this.dataFields[i]||this.dataFields[i].showSortIcon,this.savedFieldListData[t].showEditIcon=!this.dataFields[i]||this.dataFields[i].showEditIcon,this.savedFieldListData[t].showRemoveIcon=!this.dataFields[i]||this.dataFields[i].showRemoveIcon,this.savedFieldListData[t].showValueTypeIcon=!this.dataFields[i]||this.dataFields[i].showValueTypeIcon,this.savedFieldListData[t].showSubTotals=!this.dataFields[i]||this.dataFields[i].showSubTotals):this.savedFieldListData[t].isSelected=!!(this.dataFields[s]&&this.savedFieldList[s]&&this.selectedItems.indexOf(s)>-1),this.savedFieldList[i]&&this.savedFieldList[i].isCalculatedField||"[calculated members].[_0]"===i.toLowerCase()){let e=!1;for(let s of this.calculatedFieldSettings)if(i===s.name){let o=s.formula,l=s.formatString;this.savedFieldListData[t].formula=o,this.savedFieldListData[t].formatString=l,this.savedFieldListData[t].parentHierarchy=o.toLowerCase().indexOf("measure")>-1?void 0:s.hierarchyUniqueName,this.savedFieldList[i].formula=o,this.savedFieldList[i].formatString=l,this.savedFieldList[i].parentHierarchy=this.savedFieldListData[t].parentHierarchy,e=!0}(!e||"[calculated members].[_0]"===i.toLowerCase()&&0===this.calculatedFieldSettings.length)&&(this.savedFieldListData.splice(t,1),t--,this.savedFieldList[i]&&delete this.savedFieldList[i])}t++}this.fieldList=this.savedFieldList,this.fieldListData=this.savedFieldListData}updateFieldlistData(e,t){for(let i of this.fieldListData)if(i.id===e){i.isSelected=!!t;break}}getFormattedFields(e){this.formatFields={};let t=e.length;for(;t--;)this.formatFields[e[t].name]=e[t]}getFieldList(e){let t={catalog:e.catalog,cube:e.cube,url:e.url,LCID:e.localeIdentifier.toString(),request:"MDSCHEMA_HIERARCHIES"};this.getTreeData(t,this.getFieldListItems.bind(this),{dataSourceSettings:e,action:"loadFieldElements"})}getTreeData(e,t,i){let s=this.getConnectionInfo(e.url,e.LCID);this.doAjaxPost("POST",s.url,'<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>'+e.request+"</RequestType><Restrictions><RestrictionList><CATALOG_NAME>"+e.catalog+"</CATALOG_NAME><CUBE_NAME>"+e.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.catalog+"</Catalog> <LocaleIdentifier>"+s.LCID+"</LocaleIdentifier></PropertyList></Properties></Discover></Body></Envelope>",t,i)}getAxisFields(){this.rows=this.dataSourceSettings.rows?this.dataSourceSettings.rows:[],this.columns=this.dataSourceSettings.columns?this.dataSourceSettings.columns:[],this.filters=this.dataSourceSettings.filters?this.dataSourceSettings.filters:[],this.values=this.dataSourceSettings.values?this.dataSourceSettings.values:[];let e=(0,a.l7)([],this.rows,null,!0);e=e.concat(this.columns,this.values,this.filters);let t=e.length;for(;t--;)this.dataFields[e[t].name]=e[t],"[measures]"===e[t].name.toLowerCase()?this.isMeasureAvail=!0:this.selectedItems.push(e[t].name);if(this.mappingFields={},this.dataSourceSettings.fieldMapping)for(let i of this.dataSourceSettings.fieldMapping)this.mappingFields[i.name]=i;if(!this.isMeasureAvail&&this.values.length>0){let e={name:"[Measures]",caption:"Measures",showRemoveIcon:!0,allowDragAndDrop:!0};"row"===this.valueAxis?this.rows.push(e):this.columns.push(e),this.isMeasureAvail=!0}}getAggregateType(e,t){let i;switch(t){case"1":i="Sum";break;case"2":i="Count";break;case"3":i="Min";break;case"4":i="Max";break;case"5":i="Avg";break;case"8":i="DistinctCount";break;case"127":i="CalculatedField";break;default:i=void 0}return i||void 0}getUniqueName(e){let t=e;for(let i of this.calculatedFieldSettings)if(e===(i.formula.toLowerCase().indexOf("measure")>-1?"[Measures].":i.hierarchyUniqueName+".")+"["+i.name+"]"){t=i.name;break}return t}updateFilterItems(e){let t=(0,a.l7)([],this.rows,null,!0);t=t.concat(this.columns);for(let i of e)if("Include"===i.type&&this.allowMemberFilter){let e=this.fieldList[i.name].members,t=e&&Object.keys(e).length>0;this.fieldList[i.name].actualFilter=[...i.items];let s=(0,a.l7)([],i.items,null,!0);if(t){let t=0;for(;t<s.length;){let o=[];o=this.getParentNode(s[t],e,o);for(let e of o){let t=br.inArray(e,i.items);-1!==t&&i.items.splice(t,1)}t++}}let o=[];for(let l of i.items)o.push(l),this.fieldList[i.name].filter.push(t?e[l].caption:l);this.filterMembers[i.name]=o,this.fieldList[i.name].isExcelFilter=!1}else if((this.allowValueFilter||this.allowLabelFilter)&&-1!==["Date","Label","Number","Value"].indexOf(i.type))for(let e of t)if(e.name===i.name){let e=this.filterMembers[i.name];e&&"object"==typeof e[0]&&e[0].type===i.type?e[e.length]=i:this.filterMembers[i.name]=[i],this.fieldList[i.name].isExcelFilter=!0;break}}getParentNode(e,t,i){if(t[e].parent&&e!==t[e].parent){let s=t[e].parent;i.push(s),this.getParentNode(s,t,i)}return i}updateDrilledItems(e){let t=[],i=(0,a.l7)([],this.rows,null,!0);i=i.concat(this.columns);for(let s of e)for(let e of i)if(s.name===e.name){t.push(s);break}return t}getDrillThroughData(e,t){let i,s=this.tupColumnInfo[e.colOrdinal]&&this.tupColumnInfo[e.colOrdinal].uNameCollection&&""!==this.tupColumnInfo[e.colOrdinal].uNameCollection?this.tupColumnInfo[e.colOrdinal].uNameCollection.split("::[").map(e=>"["===e[0]?e:"["+e):[],o=this.tupRowInfo[e.rowOrdinal]&&this.tupRowInfo[e.rowOrdinal].uNameCollection&&""!==this.tupRowInfo[e.rowOrdinal].uNameCollection?this.tupRowInfo[e.rowOrdinal].uNameCollection.split("::[").map(e=>"["===e[0]?e:"["+e):[],l=[],a="";for(let p=0;p<this.filters.length;p++)if(i=this.filterMembers[this.filters[p].name],i){for(let e=0;e<i.length;e++)a+=i[e],a=e<i.length-1?a+",":a+"";l[p]=a,a=""}for(let p=0;p<l.length;p++)a=""===a?"{"+l[p]+"}":a+",{"+l[p]+"}";let r="",n="";for(let p=0;p<s.length;p++)r=(r.length>0?r+",":"")+(s[p].split("~~").length>1?s[p].split("~~")[s[p].split("~~").length-1]:s[p]);for(let p=0;p<o.length;p++)n=(n.length>0?n+",":"")+(o[p].split("~~").length>1?o[p].split("~~")[o[p].split("~~").length-1]:o[p]);let h="DRILLTHROUGH MAXROWS "+t+" Select("+(r.length>0?r:"")+(r.length>0&&n.length>0?",":"")+(n.length>0?n:"")+") on 0 from "+(""===a?"["+this.dataSourceSettings.cube+"]":"(SELECT ("+a+") ON COLUMNS FROM ["+this.dataSourceSettings.cube+"])");h=h.replace(/&/g,"&amp;");let d=this.getSoapMsg(this.dataSourceSettings,h),c=this.getConnectionInfo(this.dataSourceSettings.url,this.dataSourceSettings.localeIdentifier);this.doAjaxPost("POST",c.url,d,this.drillThroughSuccess.bind(this),{dataSourceSettings:this.dataSourceSettings,action:"drillThrough"})}drillThroughSuccess(e){let t=[].slice.call(e.querySelectorAll("row")),i="";if(t.length>0){let e=[],s=0;for(;s<t.length;){let i=[].slice.call(t[s].children),o=0;for(;o<i.length;)e.push('"'+i[o].tagName+'":"'+i[o].textContent+'"'),o++;s++}let o=e[0],l=0;for(;l<e.length;)Object.keys(JSON.parse("[{"+e[l]+"}]")[0])[0]!==Object.keys(JSON.parse("[{"+o+"}]")[0])[0]?(i+=","+e[l],l++):(i+=""===i?"[{"+e[l]:"}, {"+e[l],l++);i+="}]"}else{let t=[].slice.call(e.querySelectorAll("faultstring")),s=0;for(;s<t.length;)i+=t[s].textContent,s++}this.gridJSON=i}getFilterMembers(e,t,i,s,o){let l,a=this.fieldList[t].levels,r=this.fieldList[t].levelCount;return l=o?"Descendants({"+a[r].id+"}, "+a[i-1].id+", "+(i-r==1?"SELF)":"SELF_AND_BEFORE)"):t+", Descendants({"+a[0].id+"}, "+a[i-1].id+", SELF_AND_BEFORE)",this.fieldList[t].levelCount=i,s||this.getMembers(e,t,!1,l,o),l}getMembers(e,t,i,s,o){let l,a="DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE",r=this.fieldList[t].hasAllMember,n=(r?t:t+".LEVELS(0)").replace(/\&/g,"&amp;");l=i?"SELECT ({"+n+".ALLMEMBERS})"+a+" ON 0 FROM ["+e.cube+"]":"SELECT ({"+(s||(r?n+", "+n+".CHILDREN":n+".ALLMEMBERS"))+"})"+a+" ON 0 FROM ["+e.cube+"]";let h=this.getSoapMsg(e,l),d=this.getConnectionInfo(e.url,e.localeIdentifier);o||(this.fieldList[t].filterMembers=[],this.fieldList[t].childMembers=[],this.fieldList[t].searchMembers=[],this.fieldList[t].members={},this.fieldList[t].currrentMembers={}),this.doAjaxPost("POST",d.url,h,this.generateMembers.bind(this),{dataSourceSettings:e,fieldName:t,loadLevelMembers:o,action:"fetchMembers"})}getChildMembers(e,t,i){let s="SELECT ({"+t.replace(/\&/g,"&amp;")+".CHILDREN})DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE ON 0 FROM ["+e.cube+"]",o=this.getSoapMsg(e,s),l=this.getConnectionInfo(e.url,e.localeIdentifier);this.doAjaxPost("POST",l.url,o,this.generateMembers.bind(this),{dataSourceSettings:e,fieldName:i,action:"fetchChildMembers"})}getCalcChildMembers(e,t){this.calcChildMembers=[];let i="SELECT ({"+t.replace(/\&/g,"&amp;")+".MEMBERS})DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE ON 0 FROM ["+e.cube+"]",s=this.getConnectionInfo(e.url,e.localeIdentifier),o=this.getSoapMsg(e,i);this.doAjaxPost("POST",s.url,o,this.generateMembers.bind(this),{dataSourceSettings:e,action:"fetchCalcChildMembers"})}getSearchMembers(e,t,i,s,o,l){if(this.fieldList[t].searchMembers=[],this.fieldList[t].currrentMembers={},""!==i){let a="DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE",r=t.replace(/\&/g,"&amp;"),n="WITH SET [SearchMembersSet] AS &#39;FILTER("+(o?r+".ALLMEMBERS, ":"{"+(l>1?this.getFilterMembers(e,t,l,!0):r+", "+r+".CHILDREN")+"},")+"(INSTR(1, "+r+'.CurrentMember.member_caption, "'+i+'") > 0))&#39;SET [SearchParentsSet] AS &#39;GENERATE([SearchMembersSet], ASCENDANTS([SearchMembersSet].Current))&#39;SET [SearchSet] AS &#39;HIERARCHIZE(DISTINCT({[SearchMembersSet], [SearchParentsSet]}))&#39;SELECT SUBSET([SearchSet], 0, '+s+")"+a+" ON 0 FROM ["+e.cube+"]",h=this.getSoapMsg(e,n),d=this.getConnectionInfo(e.url,e.localeIdentifier);this.doAjaxPost("POST",d.url,h,this.generateMembers.bind(this),{dataSourceSettings:e,fieldName:t,action:"fetchSearchMembers"})}}generateMembers(e,t,i){let s,o=[].slice.call(e.querySelectorAll('Axis[name="Axis0"] Tuple')),l=i.fieldName,a={};for(let r of o){let e=r.querySelector("Member"),t=e.querySelector("MEMBER_TYPE").textContent,o=e.querySelector("UName").textContent,n=e.querySelector("Caption").textContent,h=e.querySelector("PARENT_UNIQUE_NAME")?e.querySelector("PARENT_UNIQUE_NAME").textContent:"",d={"data-fieldName":l,"data-memberId":o};if(""===h&&"1"===t)a={hasChildren:!!r.querySelector("CHILDREN_CARDINALITY")&&"0"!==r.querySelector("CHILDREN_CARDINALITY").textContent,isSelected:!1,id:o,tag:o,name:n,caption:n,htmlAttributes:d},"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[l].members[o]={name:o,caption:n,parent:void 0,isNodeExpand:!1,isSelected:!1},this.fieldList[l].filterMembers.push(a),this.fieldList[l].childMembers.push(a)):"fetchSearchMembers"===i.action?(this.fieldList[l].currrentMembers[o]={name:o,caption:n,parent:void 0,isNodeExpand:!1,isSelected:!1},this.fieldList[l].searchMembers.push(a),a.expanded=!0):this.calcChildMembers.push(a);else if(""!==h&&"1"===t)if(h===s&&"1"===t)a={hasChildren:!!r.querySelector("CHILDREN_CARDINALITY")&&"0"!==r.querySelector("CHILDREN_CARDINALITY").textContent,id:o,name:n,isSelected:!1,caption:n,htmlAttributes:d,tag:o},"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[l].filterMembers.push(a),this.fieldList[l].childMembers.push(a),this.fieldList[l].members[o]={name:o,caption:n,parent:void 0,isNodeExpand:!1,isSelected:!1}):"fetchSearchMembers"===i.action?(a.expanded=!0,this.fieldList[l].searchMembers.push(a),this.fieldList[l].currrentMembers[o]={name:o,caption:n,parent:void 0,isNodeExpand:!1,isSelected:!1}):this.calcChildMembers.push(a);else{if("fetchMembers"===i.action&&this.fieldList[l].members[o])continue;let e=!!i.loadLevelMembers&&this.fieldList[l].members[h].isSelected;a={hasChildren:!!r.querySelector("CHILDREN_CARDINALITY")&&"0"!==r.querySelector("CHILDREN_CARDINALITY").textContent,htmlAttributes:d,isSelected:!1,id:o,pid:h,name:n,caption:n,tag:o},"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[l].isHierarchy=!1,this.fieldList[l].filterMembers.push(a),this.fieldList[l].childMembers.push(a),this.fieldList[l].members[o]={name:o,caption:n,parent:h,isNodeExpand:!1,isSelected:e}):"fetchSearchMembers"===i.action?(this.fieldList[l].searchMembers.push(a),a.expanded=!0,this.fieldList[l].currrentMembers[o]={name:o,caption:n,parent:h,isNodeExpand:!1,isSelected:!1}):this.calcChildMembers.push(a)}else"2"===t&&(s=o)}}getFieldListItems(e,t,i){let s={},o=[],l=[].slice.call(e.querySelectorAll("row"));for(let r of l){let e=[].slice.call(r.querySelectorAll("ALL_MEMBER")).length>0,t=r.querySelector("DIMENSION_UNIQUE_NAME").textContent,i=r.querySelector("HIERARCHY_UNIQUE_NAME").textContent,s=t===i&&"[measures]"!==t.toLowerCase()&&"[measures]"!==i.toLowerCase();o.push({pid:this.isMondrian||s?t+"~#^Dim":t,id:i,name:r.querySelector("HIERARCHY_CAPTION").textContent,caption:r.querySelector("HIERARCHY_CAPTION").textContent,tag:i,hasAllMember:e,allMember:e?r.querySelectorAll("ALL_MEMBER")[0].textContent:void 0,type:"string"})}s={hierarchy:o,hierarchySuccess:e,measures:[]},this.fieldListObj=s;let a={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_DIMENSIONS"};this.getTreeData(a,this.loadDimensionElements.bind(this),i)}loadCalculatedMemberElements(e){if(e.length>0){let t=this.fieldListData,i={hasChildren:!0,isSelected:!1,id:"[Calculated Members].[_0]",name:"[Calculated Members].[_0]",caption:"Calculated Members",spriteCssClass:"e-calcMemberGroupCDB "+Gr,tag:"[Calculated Members].[_0]",type:"string"};t.length>0&&"[measures]"===t[0].id.toLowerCase()&&t.splice(0,0,i);for(let s of e)if(!this.fieldList[s.name]){let e=s.formula,i=(e.toLowerCase().indexOf("measure")>-1?"[Measures].":s.hierarchyUniqueName+".")+"["+s.name+"]",o=s.formatString,l={hasChildren:!1,isSelected:!1,id:s.name,pid:"[Calculated Members].[_0]",name:s.name,caption:this.dataFields[s.name]&&this.dataFields[s.name].caption?this.dataFields[s.name].caption:this.mappingFields[s.name]&&this.mappingFields[s.name].caption?this.mappingFields[s.name].caption:s.name,spriteCssClass:"e-calc-member "+(e.toLowerCase().indexOf("measure")>-1?"e-calc-measure-icon":"e-calc-dimension-icon")+" "+Gr,tag:i,formula:e,formatString:o,aggregateType:void 0,type:"CalculatedField",filter:[],dateMember:[],sort:"Ascending",actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},isHierarchy:!0,isExcelFilter:!1,isCalculatedField:!0,allowDragAndDrop:this.dataFields[s.name]?this.dataFields[s.name].allowDragAndDrop:!this.mappingFields[s.name]||this.mappingFields[s.name].allowDragAndDrop,showFilterIcon:this.dataFields[s.name]?this.dataFields[s.name].showFilterIcon:!this.mappingFields[s.name]||this.mappingFields[s.name].showFilterIcon,showSortIcon:this.dataFields[s.name]?this.dataFields[s.name].showSortIcon:!this.mappingFields[s.name]||this.mappingFields[s.name].showSortIcon,showEditIcon:this.dataFields[s.name]?this.dataFields[s.name].showEditIcon:!this.mappingFields[s.name]||this.mappingFields[s.name].showEditIcon,showRemoveIcon:this.dataFields[s.name]?this.dataFields[s.name].showRemoveIcon:!this.mappingFields[s.name]||this.mappingFields[s.name].showRemoveIcon,showValueTypeIcon:this.dataFields[s.name]?this.dataFields[s.name].showValueTypeIcon:!this.mappingFields[s.name]||this.mappingFields[s.name].showValueTypeIcon,showSubTotals:this.dataFields[s.name]?this.dataFields[s.name].showSubTotals:!this.mappingFields[s.name]||this.mappingFields[s.name].showSubTotals,fieldType:e.toLowerCase().indexOf("measure")>-1?"Measure":"Dimension",parentHierarchy:e.toLowerCase().indexOf("measure")>-1?void 0:s.hierarchyUniqueName};t.push(l),this.fieldList[l.id]=l}}}loadDimensionElements(e,t,i){let s=[],o=[].slice.call(e.querySelectorAll("row")),l={};for(let n of o){let e=n.querySelector("DIMENSION_UNIQUE_NAME").textContent,t=n.querySelector("DEFAULT_HIERARCHY").textContent,i=n.querySelector("DIMENSION_CAPTION").textContent,r=e===t;e.toLowerCase().indexOf("[measure")>=0?l={hasChildren:!0,isSelected:!1,id:e,name:e,caption:i,spriteCssClass:"[measures]"===e.toLowerCase()?"e-measureGroupCDB-icon "+Gr:"e-dimensionCDB-icon "+Gr,tag:e,type:"string"}:(0,a.le)(o[0].querySelector("HIERARCHY_CAPTION"))&&s.push({hasChildren:!0,isSelected:!1,id:this.isMondrian||r?e+"~#^Dim":e,name:e,caption:i,spriteCssClass:"e-dimensionCDB-icon "+Gr,tag:e,defaultHierarchy:n.querySelector("DEFAULT_HIERARCHY").textContent,type:"string"})}s.splice(0,0,l),this.fieldListData=s;let r={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_SETS"};this.getTreeData(r,this.loadNamedSetElements.bind(this),i)}loadNamedSetElements(e,t,i){let s=(0,a.l7)([],this.rows,null,!0);s=s.concat(this.columns,this.filters);let o=this.fieldListData,l=[];for(let a of s)l.push(a.name);let r=[],n=[].slice.call(e.querySelectorAll("row"));for(let a of n){r.indexOf(a.querySelector("DIMENSIONS").textContent.split(".")[0])>=0||(o.push({hasChildren:!0,isSelected:!1,pid:a.querySelector("DIMENSIONS").textContent.split(".")[0],id:a.querySelector("SET_DISPLAY_FOLDER").textContent+"_"+a.querySelector("DIMENSIONS").textContent.split(".")[0],name:a.querySelector("SET_DISPLAY_FOLDER").textContent,spriteCssClass:"e-folderCDB-icon e-icons namedSets",caption:a.querySelector("SET_DISPLAY_FOLDER").textContent,type:"string"}),r.push(a.querySelector("DIMENSIONS").textContent.split(".")[0]));let e="["+a.querySelector("SET_NAME").textContent.trim()+"]",t={hasChildren:!0,isNamedSets:!0,isSelected:l.indexOf("["+a.querySelector("SET_NAME").textContent+"]")>=0,pid:a.querySelector("SET_DISPLAY_FOLDER").textContent+"_"+a.querySelector("DIMENSIONS").textContent.split(".")[0],id:e,name:a.querySelector("SET_CAPTION").textContent,caption:this.dataFields[e]&&this.dataFields[e].caption?this.dataFields[e].caption:this.mappingFields[e]&&this.mappingFields[e].caption?this.mappingFields[e].caption:a.querySelector("SET_CAPTION").textContent,spriteCssClass:"e-namedSetCDB-icon "+Gr,tag:a.querySelector("EXPRESSION").textContent,type:"string",filter:[],dateMember:[],actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},isHierarchy:!0,isExcelFilter:!1,allowDragAndDrop:this.dataFields[e]?this.dataFields[e].allowDragAndDrop:!this.mappingFields[e]||this.mappingFields[e].allowDragAndDrop,showFilterIcon:this.dataFields[e]?this.dataFields[e].showFilterIcon:!this.mappingFields[e]||this.mappingFields[e].showFilterIcon,showSortIcon:this.dataFields[e]?this.dataFields[e].showSortIcon:!this.mappingFields[e]||this.mappingFields[e].showSortIcon,showEditIcon:this.dataFields[e]?this.dataFields[e].showEditIcon:!this.mappingFields[e]||this.mappingFields[e].showEditIcon,showRemoveIcon:this.dataFields[e]?this.dataFields[e].showRemoveIcon:!this.mappingFields[e]||this.mappingFields[e].showRemoveIcon,showValueTypeIcon:this.dataFields[e]?this.dataFields[e].showValueTypeIcon:!this.mappingFields[e]||this.mappingFields[e].showValueTypeIcon,showSubTotals:this.dataFields[e]?this.dataFields[e].showSubTotals:!this.mappingFields[e]||this.mappingFields[e].showSubTotals};o.push(t),this.fieldList[e]=t}i.hierarchy=this.fieldListData,i.hierarchySuccess=this.fieldListObj.hierarchySuccess,this.loadHierarchyElements(i)}loadHierarchyElements(e){let t=e.hierarchySuccess,i=e.hierarchy,s=(0,a.l7)([],this.rows,null,!0);s=s.concat(this.columns,this.filters);let o=[];for(let a of s)o.push(a.name);let l=[].slice.call(t.querySelectorAll("row"));for(let a of l){let e,t=a.querySelector("DIMENSION_UNIQUE_NAME").textContent,s=a.querySelector("HIERARCHY_UNIQUE_NAME").textContent,l=[].slice.call(a.querySelectorAll("ALL_MEMBER")).length>0;if(l){let t=a.querySelectorAll("ALL_MEMBER")[0].textContent.replace(/[\[\]\&']+/g,"").split(".");e=t[t.length-1].trim()}else e=void 0;let r=a.querySelector("HIERARCHY_DISPLAY_FOLDER")?a.querySelector("HIERARCHY_DISPLAY_FOLDER").textContent:"",n=[];for(let o of i)o.tag===t&&n.push(o);if(n.length>0){let n=t===s&&"[measures]"!==t.toLowerCase()&&"[measures]"!==s.toLowerCase();if("[measures]"!==t.toLowerCase()&&"[measures]"!==s.toLowerCase()){let h=t+(this.isMondrian||n?"~#^Dim":"");if(""!==r){let e=t+(this.isMondrian||n?"~#^Dim":"")+"_"+r,s=[];for(let t of i)t.tag===e&&t.pid===h&&s.push(t);0===s.length&&i.push({hasChildren:!0,isSelected:!1,pid:t+(this.isMondrian||n?"~#^Dim":""),id:e,name:r,spriteCssClass:"e-folderCDB-icon "+Gr,tag:e,caption:r,type:"string"}),h=e}let d={hasChildren:!a.querySelector("HIERARCHY_ORIGIN")||"2"!==a.querySelector("HIERARCHY_ORIGIN").textContent&&"6"!==a.querySelector("HIERARCHY_ORIGIN").textContent,isSelected:o.indexOf(s)>=0,pid:h,id:s,name:a.querySelector("HIERARCHY_CAPTION").textContent,spriteCssClass:(a.querySelector("HIERARCHY_ORIGIN")?"2"!==a.querySelector("HIERARCHY_ORIGIN").textContent&&"6"!==a.querySelector("HIERARCHY_ORIGIN").textContent?"e-hierarchyCDB-icon":"e-attributeCDB-icon":"e-hierarchyCDB-icon")+" "+Gr,hasAllMember:l,allMember:e,tag:s,caption:this.dataFields[s]&&this.dataFields[s].caption?this.dataFields[s].caption:this.mappingFields[s]&&this.mappingFields[s].caption?this.mappingFields[s].caption:a.querySelector("HIERARCHY_CAPTION").textContent,type:"string",filter:[],dateMember:[],sort:this.enableSort?this.sortObject[s]?this.sortObject[s]:"Ascending":"None",actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},levels:[],levelCount:1,isHierarchy:!!a.querySelector("HIERARCHY_ORIGIN")&&("2"===a.querySelector("HIERARCHY_ORIGIN").textContent||"6"===a.querySelector("HIERARCHY_ORIGIN").textContent),isExcelFilter:!1,allowDragAndDrop:this.dataFields[s]?this.dataFields[s].allowDragAndDrop:!this.mappingFields[s]||this.mappingFields[s].allowDragAndDrop,showFilterIcon:this.dataFields[s]?this.dataFields[s].showFilterIcon:!this.mappingFields[s]||this.mappingFields[s].showFilterIcon,showSortIcon:this.dataFields[s]?this.dataFields[s].showSortIcon:!this.mappingFields[s]||this.mappingFields[s].showSortIcon,showEditIcon:this.dataFields[s]?this.dataFields[s].showEditIcon:!this.mappingFields[s]||this.mappingFields[s].showEditIcon,showRemoveIcon:this.dataFields[s]?this.dataFields[s].showRemoveIcon:!this.mappingFields[s]||this.mappingFields[s].showRemoveIcon,showValueTypeIcon:this.dataFields[s]?this.dataFields[s].showValueTypeIcon:!this.mappingFields[s]||this.mappingFields[s].showValueTypeIcon,showSubTotals:this.dataFields[s]?this.dataFields[s].showSubTotals:!this.mappingFields[s]||this.mappingFields[s].showSubTotals};i.push(d),this.fieldList[s]=d}}}let r={catalog:e.dataSourceSettings.catalog,cube:e.dataSourceSettings.cube,url:e.dataSourceSettings.url,LCID:e.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_LEVELS"};this.getTreeData(r,this.loadLevelElements.bind(this),e)}loadLevelElements(e,t,i){let s=[],o=this.fieldListData;s=[];let l=[].slice.call(e.querySelectorAll("row"));for(let r of l)if(1!==parseInt(r.querySelector("LEVEL_TYPE").textContent,10)&&"[measures]"!==r.querySelector("HIERARCHY_UNIQUE_NAME").textContent.toLowerCase()){let e=r.querySelector("HIERARCHY_UNIQUE_NAME").textContent,t=r.querySelector("LEVEL_UNIQUE_NAME").textContent,i=r.querySelector("LEVEL_CAPTION").textContent,o={hasChildren:!1,isChecked:!1,isSelected:this.fieldList[e].isSelected,pid:e,id:t,name:i,tag:t,spriteCssClass:"e-level-members e-hierarchy-level-"+parseInt(r.querySelector("LEVEL_NUMBER").textContent,10)+"-icon "+Gr,caption:i,type:"string"};s.push(o),this.fieldList[e]&&this.fieldList[e].spriteCssClass&&-1===this.fieldList[e].spriteCssClass.indexOf("e-attributeCDB-icon")?(this.fieldList[e].levels.push(o),this.fieldList[e].isHierarchy=!1):this.fieldList[e].isHierarchy=!0}this.fieldListData=o=o.concat(s);let a={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_MEASURES"};this.getTreeData(a,this.loadMeasureElements.bind(this),i)}loadMeasureElements(e,t,i){let s,o=this.fieldListData,l=[],r=(0,a.l7)([],this.values,null,!0),n=[];for(let a of r)n.push(a.name);if("en-US"!==this.locale){let e={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_MEASUREGROUPS"};this.getTreeData(e,this.loadMeasureGroups.bind(this),i)}let h=[].slice.call(e.querySelectorAll("row"));for(let d of h){let e=(0,a.le)(d.querySelector("MEASUREGROUP_NAME"))?"":d.querySelector("MEASUREGROUP_NAME").textContent,t=d.querySelector("MEASURE_UNIQUE_NAME").textContent,i=d.querySelector("DEFAULT_FORMAT_STRING")?d.querySelector("DEFAULT_FORMAT_STRING").textContent:"#,#",r=d.querySelector("MEASURE_AGGREGATOR")?d.querySelector("MEASURE_AGGREGATOR").textContent:"1";if(!(l.indexOf(e)>=0)){if("en-US"!==this.locale){let t=[];for(let i of this.fieldListObj.measuresGroups)i.querySelector("MEASUREGROUP_NAME").textContent===e&&t.push(i);s=t.length>0?t[0].querySelector("MEASUREGROUP_CAPTION").textContent:e}else s=e;""!==e&&(o.push({hasChildren:!0,isChecked:!1,isSelected:!1,pid:"[Measures]",id:e,name:s,spriteCssClass:"e-measureCDB e-folderCDB-icon "+Gr,tag:e,caption:s,aggregateType:this.getAggregateType(e,r),type:"string"}),l.push(e))}let h={hasChildren:!1,isSelected:n.indexOf(t)>=0,pid:""===e?"[Measures]":e,id:t,name:d.querySelector("MEASURE_CAPTION").textContent,spriteCssClass:"e-measure-icon "+Gr,tag:t,caption:this.dataFields[t]&&this.dataFields[t].caption?this.dataFields[t].caption:this.mappingFields[t]&&this.mappingFields[t].caption?this.mappingFields[t].caption:d.querySelector("MEASURE_CAPTION").textContent,aggregateType:this.getAggregateType(t,r),type:"number",filter:[],actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},formatString:i,allowDragAndDrop:this.dataFields[t]?this.dataFields[t].allowDragAndDrop:!this.mappingFields[t]||this.mappingFields[t].allowDragAndDrop,showFilterIcon:this.dataFields[t]?this.dataFields[t].showFilterIcon:!this.mappingFields[t]||this.mappingFields[t].showFilterIcon,showSortIcon:this.dataFields[t]?this.dataFields[t].showSortIcon:!this.mappingFields[t]||this.mappingFields[t].showSortIcon,showEditIcon:this.dataFields[t]?this.dataFields[t].showEditIcon:!this.mappingFields[t]||this.mappingFields[t].showEditIcon,showRemoveIcon:this.dataFields[t]?this.dataFields[t].showRemoveIcon:!this.mappingFields[t]||this.mappingFields[t].showRemoveIcon,showValueTypeIcon:this.dataFields[t]?this.dataFields[t].showValueTypeIcon:!this.mappingFields[t]||this.mappingFields[t].showValueTypeIcon,showSubTotals:this.dataFields[t]?this.dataFields[t].showSubTotals:!this.mappingFields[t]||this.mappingFields[t].showSubTotals};o.push(h),this.fieldList[t]=h,n.indexOf(t)>=0&&n.splice(n.indexOf(t),1)}this.measureReportItems=n}loadMeasureGroups(e,t,i){(0,a.le)(this.fieldListObj)&&(this.fieldListObj={}),this.fieldListObj.measuresGroups=[].slice.call(e.querySelectorAll("row"))}doAjaxPost(e,t,i,s,o){new a.tk({mode:!1,contentType:"text/xml",url:t,data:i,dataType:"xml",type:e,beforeSend:this.beforeSend.bind(this),onSuccess:(e,t)=>{let i=(new DOMParser).parseFromString(e,"text/xml");s(i,t,o)},onFailure:e=>e}).send()}beforeSend(e){this.dataSourceSettings.authentication.userName&&this.dataSourceSettings.authentication.password&&e.httpRequest.setRequestHeader("Authorization","Basic "+btoa(this.dataSourceSettings.authentication.userName+":"+this.dataSourceSettings.authentication.password))}getSoapMsg(e,t){let i="",s="",o=this.getConnectionInfo(e.url,e.localeIdentifier);return this.isMondrian?(s="",i='<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><SOAP-ENV:Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement><![CDATA['+t+"]]></Statement></Command><Properties><PropertyList><DataSourceInfo>"+s+"</DataSourceInfo><Catalog>"+e.catalog+"</Catalog><AxisFormat>TupleFormat</AxisFormat><Content>Data</Content><Format>Multidimensional</Format></PropertyList></Properties></Execute></SOAP-ENV:Body></SOAP-ENV:Envelope>"):i='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header></Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement> '+t+" </Statement> </Command> <Properties> <PropertyList> <Catalog>"+e.catalog+"</Catalog> <LocaleIdentifier>"+o.LCID+"</LocaleIdentifier></PropertyList> </Properties> </Execute> </Body> </Envelope>",i}getConnectionInfo(e,t){let i={url:"",LCID:(0,a.le)(t)?"1033":t.toString()};if(""!==e)for(let s of e.split(";"))s.toLowerCase().indexOf("locale")<0&&0===i.url.length?i.url=s:s.toLowerCase().indexOf("locale")>=0&&(i.LCID=s.replace(/ /g,"").split("=")[1]);return i}getMDXQuery(e){return tc.getCellSets(e,this,!0,void 0,!0),this.mdxQuery}}var sc,oc=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};let lc=(()=>{class e extends a.rt{}return oc([(0,a.Z9)(!0)],e.prototype,"showFilterIcon",void 0),oc([(0,a.Z9)(!0)],e.prototype,"showSortIcon",void 0),oc([(0,a.Z9)(!0)],e.prototype,"showRemoveIcon",void 0),oc([(0,a.Z9)(!0)],e.prototype,"showValueTypeIcon",void 0),oc([(0,a.Z9)("Both")],e.prototype,"displayMode",void 0),oc([(0,a.Z9)(!0)],e.prototype,"allowDragAndDrop",void 0),oc([(0,a.Z9)(!1)],e.prototype,"showFieldsPanel",void 0),e})(),ac=(()=>{class e extends a.rt{}return oc([(0,a.Z9)(!1)],e.prototype,"allowAdding",void 0),oc([(0,a.Z9)(!1)],e.prototype,"allowEditing",void 0),oc([(0,a.Z9)(!1)],e.prototype,"allowDeleting",void 0),oc([(0,a.Z9)(!1)],e.prototype,"allowCommandColumns",void 0),oc([(0,a.Z9)(!1)],e.prototype,"allowInlineEditing",void 0),oc([(0,a.Z9)("Normal")],e.prototype,"mode",void 0),oc([(0,a.Z9)(!0)],e.prototype,"allowEditOnDblClick",void 0),oc([(0,a.Z9)(!0)],e.prototype,"showConfirmDialog",void 0),oc([(0,a.Z9)(!1)],e.prototype,"showDeleteConfirmDialog",void 0),e})(),rc=(()=>{class e extends a.rt{}return oc([(0,a.Z9)()],e.prototype,"measure",void 0),oc([(0,a.Z9)()],e.prototype,"label",void 0),oc([(0,a.Z9)("NotEquals")],e.prototype,"conditions",void 0),oc([(0,a.Z9)()],e.prototype,"value1",void 0),oc([(0,a.Z9)()],e.prototype,"value2",void 0),e})(),nc=(()=>{class e extends a.rt{}return oc([(0,a.Z9)(!1)],e.prototype,"showHyperlink",void 0),oc([(0,a.Z9)(!1)],e.prototype,"showRowHeaderHyperlink",void 0),oc([(0,a.Z9)(!1)],e.prototype,"showColumnHeaderHyperlink",void 0),oc([(0,a.Z9)(!1)],e.prototype,"showValueCellHyperlink",void 0),oc([(0,a.Z9)(!1)],e.prototype,"showSummaryCellHyperlink",void 0),oc([(0,a.FE)([],rc)],e.prototype,"conditionalSettings",void 0),oc([(0,a.Z9)()],e.prototype,"headerText",void 0),oc([(0,a.Z9)("")],e.prototype,"cssClass",void 0),e})(),hc=(()=>{class e extends a.rt{}return oc([(0,a.Z9)("Table")],e.prototype,"view",void 0),oc([(0,a.Z9)("Table")],e.prototype,"primary",void 0),e})(),dc=sc=class extends a.wA{constructor(e,t){super(e,t),this.verticalScrollScale=1,this.horizontalScrollScale=1,this.scrollerBrowserLimit=8e6,this.lastSortInfo={},this.lastFilterInfo={},this.lastAggregationInfo={},this.lastCalcFieldInfo={},this.isScrolling=!1,this.isInitial=!0,this.shiftLockedPos=[],this.savedSelectedCellsPos=[],this.cellSelectionPos=[],this.isPopupClicked=!1,this.isMouseDown=!1,this.isMouseUp=!1,this.fieldsType={},this.remoteData=[],this.defaultItems={},this.isCellBoxMultiSelection=!1,this.gridHeaderCellInfo=[],this.gridCellCollection={},this.rowRangeSelection={enable:!1,startIndex:0,endIndex:0},this.isStaticRefresh=!1,this.resizeInfo={},this.scrollPosObject={vertical:0,horizontal:0,verticalSection:0,horizontalSection:0,top:0,left:0,scrollDirection:{direction:"",position:0}},this.pivotColumns=[],this.totColWidth=0,this.posCount=0,this.isModified=!1,this.isInitialRendering=!1,this.needsID=!0,this.pivotRefresh=a.wA.prototype.refresh,this.request=new XMLHttpRequest,this.isServerWaitingPopup=!1,this.isHScrollEnd=!1,this.pivotView=this,(0,a.sO)("mergePersistData",this.mergePersistPivotData,this)}requiredModules(){let e=[];return e.push({args:[this],member:"groupingBar"}),this.allowConditionalFormatting&&e.push({args:[this],member:"conditionalFormatting"}),this.allowNumberFormatting&&e.push({args:[this],member:"numberFormatting"}),this.allowCalculatedField&&e.push({args:[this],member:"calculatedField"}),this.showToolbar&&(this.toolbar.length>0||this.toolbarTemplate)&&e.push({args:[this],member:"toolbar"}),this.showFieldList&&e.push({args:[this],member:"fieldList"}),this.allowExcelExport&&e.push({args:[this],member:"excelExport"}),this.allowPdfExport&&e.push({args:[this],member:"pdfExport"}),this.enableVirtualization&&e.push({args:[this],member:"virtualscroll"}),this.allowGrouping&&e.push({args:[this],member:"grouping"}),e}preRender(){this.dataSourceSettings&&"SSAS"===this.dataSourceSettings.providerType?(this.dataType="olap",this.olapEngineModule=new ic):(this.dataType="pivot",this.engineModule=new fr),this.isAdaptive=a.AR.isDevice,a.AR.isIE||"edge"===a.AR.info.name?this.scrollerBrowserLimit=15e5:"chrome"===a.AR.info.name&&(this.scrollerBrowserLimit=15e6),this.isTouchMode=!!(0,a.oq)(this.element,"e-bigger"),this.initProperties(),this.renderToolTip(),this.keyboardModule=new Yh(this),this.contextMenuModule=new Wh(this),this.globalize=new a.eC(this.locale),(this.showFieldList||this.showGroupingBar||this.allowNumberFormatting||this.allowCalculatedField||this.toolbar||this.allowGrouping||this.gridSettings.contextMenuItems)&&(this.commonModule=new Lh(this)),this.defaultLocale={grandTotal:"Grand Total",total:"Total",value:"Value",noValue:"No value",row:"Row",column:"Column",collapse:"Collapse",expand:"Expand",rowAxisPrompt:"Drop row here",columnAxisPrompt:"Drop column here",valueAxisPrompt:"Drop value here",filterAxisPrompt:"Drop filter here",filter:"Filter",filtered:"Filtered",sort:"Sort",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",close:"Close",cancel:"Cancel",delete:"Delete",CalculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",alert:"Alert",warning:"Warning",ok:"OK",search:"Search",drag:"Drag",remove:"Remove",allFields:"All Fields",formula:"Formula",addToRow:"Add to Row",addToColumn:"Add to Column",addToValue:"Add to Value",addToFilter:"Add to Filter",emptyData:"No records to display",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",sortAscending:"Sort ascending order",sortDescending:"Sort descending order",sortNone:"Sort data order",clearCalculatedField:"Clear edited field info",editCalculatedField:"Edit calculated field",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",all:"All",multipleItems:"Multiple items",member:"Member",label:"Label",date:"Date",enterValue:"Enter value",chooseDate:"Enter date",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",And:"and",Sum:"Sum",Count:"Count",DistinctCount:"Distinct Count",Product:"Product",Avg:"Avg",Median:"Median",Min:"Min",SampleVar:"Sample Var",PopulationVar:"Population Var",RunningTotals:"Running Totals",Max:"Max",Index:"Index",SampleStDev:"Sample StDev",PopulationStDev:"Population StDev",PercentageOfRowTotal:"% of Row Total",PercentageOfParentTotal:"% of Parent Total",PercentageOfParentColumnTotal:"% of Parent Column Total",PercentageOfParentRowTotal:"% of Parent Row Total",DifferenceFrom:"Difference From",PercentageOfDifferenceFrom:"% of Difference From",PercentageOfGrandTotal:"% of Grand Total",PercentageOfColumnTotal:"% of Column Total",MoreOption:"More...",NotEquals:"Not Equals",AllValues:"All Values",conditionalFormating:"Conditional Formatting",apply:"Apply",condition:"Add Condition",formatLabel:"Format",valueFieldSettings:"Value field settings",baseField:"Base field",baseItem:"Base item",summarizeValuesBy:"Summarize values by",sourceName:"Field name :",sourceCaption:"Field caption",example:"e.g:",editorDataLimitMsg:" more items. Search to refine further.",details:"Details",manageRecords:"Manage Records",Years:"Years",Quarters:"Quarters",Months:"Months",Days:"Days",Hours:"Hours",Minutes:"Minutes",Seconds:"Seconds",save:"Save a report",new:"Create a new report",load:"Load",saveAs:"Save as current report",rename:"Rename a current report",deleteReport:"Delete a current report",export:"Export",subTotals:"Sub totals",grandTotals:"Grand totals",reportName:"Report Name :",pdf:"PDF",excel:"Excel",csv:"CSV",png:"PNG",jpeg:"JPEG",svg:"SVG",mdxQuery:"MDX Query",showSubTotals:"Show sub totals",doNotShowSubTotals:"Do not show sub totals",showSubTotalsRowsOnly:"Show sub totals rows only",showSubTotalsColumnsOnly:"Show sub totals columns only",showGrandTotals:"Show grand totals",doNotShowGrandTotals:"Do not show grand totals",showGrandTotalsRowsOnly:"Show grand totals rows only",showGrandTotalsColumnsOnly:"Show grand totals columns only",fieldList:"Show fieldlist",grid:"Show table",toolbarFormatting:"Conditional formatting",chart:"Chart",reportMsg:"Please enter vaild report name!!!",reportList:"Report list",removeConfirm:"Are you sure you want to delete this report?",emptyReport:"No reports found!!",bar:"Bar",pie:"Pie",funnel:"Funnel",doughnut:"Doughnut",pyramid:"Pyramid",stackingcolumn:"Stacked Column",stackingarea:"Stacked Area",stackingbar:"Stacked Bar",stepline:"Step Line",steparea:"Step Area",splinearea:"Spline Area",spline:"Spline",stackingcolumn100:"100% Stacked Column",stackingbar100:"100% Stacked Bar",stackingarea100:"100% Stacked Area",bubble:"Bubble",pareto:"Pareto",radar:"Radar",line:"Line",area:"Area",scatter:"Scatter",polar:"Polar",of:"of",emptyFormat:"No format found!!!",emptyInput:"Enter a value",newReportConfirm:"Do you want to save the changes to this report?",emptyReportName:"Enter a report name",qtr:"Qtr",null:"null",undefined:"undefined",groupOutOfRange:"Out of Range",fieldDropErrorAction:"The field you are moving cannot be placed in that area of the report",aggregate:"Aggregate",drillThrough:"Drill Through",ascending:"Ascending",descending:"Descending",number:"Number",currency:"Currency",percentage:"Percentage",formatType:"Format Type",customText:"Currency Symbol",symbolPosition:"Symbol Position",left:"Left",right:"Right",grouping:"Grouping",true:"True",false:"False",decimalPlaces:"Decimal Places",numberFormat:"Number Formatting",memberType:"Field Type",formatString:"Format",expressionField:"Expression",customFormat:"Enter custom format string",numberFormatString:"Example: C, P, 0000 %, ###0.##0#, etc.",selectedHierarchy:"Parent Hierarchy",olapDropText:"Example: [Measures].[Order Quantity] + ([Measures].[Order Quantity] * 0.10)",Percent:"Percent",Currency:"Currency",Custom:"Custom",Measure:"Measure",Dimension:"Dimension",Standard:"Standard",blank:"(Blank)",fieldTooltip:'Drag and drop fields to create an expression. And, if you want to edit the existing calculated fields! You can achieve it by simply selecting the field under "Calculated Members".',fieldTitle:"Field Name",QuarterYear:"Quarter Year",drillError:"Cannot show the raw items of calculated fields.",caption:"Field Caption",copy:"Copy",defaultReport:"Sample Report",customFormatString:"Custom Format",invalidFormat:"Invalid Format.",group:"Group",unGroup:"Ungroup",invalidSelection:"Cannot group that selection.",groupName:"Enter the caption to display in header",captionName:"Enter the caption for group field",selectedItems:"Selected items",groupFieldCaption:"Field caption",groupTitle:"Group name",startAt:"Starting at",endAt:"Ending at",groupBy:"Interval by",selectGroup:"Select groups",multipleAxes:"Multiple Axis",showLegend:"Show Legend",exit:"Exit",chartTypeSettings:"Chart Type Settings",ChartType:"Chart Type",yes:"Yes",no:"No",numberFormatMenu:"Number Formatting...",conditionalFormatingMenu:"Conditional Formatting...",removeCalculatedField:"Are you sure you want to delete this calculated field?",replaceConfirmBefore:"A report named ",replaceConfirmAfter:" already exists. Do you want to replace it?",invalidJSON:"Invalid JSON data",invalidCSV:"Invalid CSV data",stacked:"Stacked",single:"Single",multipleAxisMode:"Multiple Axis Mode"},this.localeObj=new a.E7(this.getModuleName(),this.defaultLocale,this.locale),this.renderContextMenu(),this.isDragging=!1,this.addInternalEvents()}onBeforeTooltipOpen(e){e.element.classList.add("e-pivottooltipwrap")}renderToolTip(){this.showTooltip?(this.tooltip=new n.u(this.tooltipTemplate?{target:"td.e-valuescontent",cssClass:"e-pivottooltiptemplate",showTipPointer:!1,position:"BottomRight",mouseTrail:!0,enableRtl:this.enableRtl,locale:this.locale,beforeRender:this.setToolTip.bind(this),beforeOpen:this.onBeforeTooltipOpen}:{target:"td.e-valuescontent",showTipPointer:!1,position:"BottomRight",mouseTrail:!0,enableRtl:this.enableRtl,locale:this.locale,beforeRender:this.setToolTip.bind(this),beforeOpen:this.onBeforeTooltipOpen}),this.tooltip.isStringTemplate=!0,this.tooltip.appendTo(this.element)):this.tooltip&&this.tooltip.destroy()}renderContextMenu(){if(this.gridSettings.contextMenuItems||this.allowGrouping&&"pivot"===this.dataType){let e=[],t=[],i=[],s=[],o=[],l=[],a=[];if(this.gridSettings.contextMenuItems)for(let r of this.gridSettings.contextMenuItems)if("string"==typeof r&&-1!==this.getDefaultItems().indexOf(r))if(-1!==r.toString().toLowerCase().indexOf("aggregate")&&"pivot"===this.dataType){a=[{text:this.localeObj.getConstant("Sum")}];let e=this.buildDefaultItems("Aggregate");e.items=a,o.push(e)}else-1!==r.toString().toLowerCase().indexOf("export")?s.push(this.buildDefaultItems(r)):e.push(this.buildDefaultItems(r));else"string"!=typeof r&&i.push(r);if(this.allowGrouping&&"pivot"===this.dataType&&(this.getFieldByID(this.element.id+"_custom_group",this.gridSettings.contextMenuItems)||t.push(this.buildDefaultItems("Group")),this.getFieldByID(this.element.id+"_custom_ungroup",this.gridSettings.contextMenuItems)||t.push(this.buildDefaultItems("Ungroup"))),s.length>0){let e=this.buildDefaultItems("export");e.items=s,l.push(e)}this.gridSettings.contextMenuItems=[],Array.prototype.push.apply(this.gridSettings.contextMenuItems,o),Array.prototype.push.apply(this.gridSettings.contextMenuItems,e),Array.prototype.push.apply(this.gridSettings.contextMenuItems,t),Array.prototype.push.apply(this.gridSettings.contextMenuItems,l),Array.prototype.push.apply(this.gridSettings.contextMenuItems,i)}}getFieldByID(e,t){return new r.hm({json:t}).executeLocal((new r.AE).where("id","equal",e))[0]}getAllSummaryType(){return["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"]}getDefaultItems(){return["Drillthrough","Expand","Collapse","Pdf Export","Excel Export","Csv Export","Sort Ascending","Sort Descending","Aggregate","CalculatedField"]}buildDefaultItems(e){let t;switch(e){case"Aggregate":t={text:this.localeObj.getConstant("aggregate"),target:"th.e-valuesheader,td.e-valuescontent,.e-stot.e-rowsheader",id:this.element.id+"_aggregate"};break;case"CalculatedField":t={text:this.localeObj.getConstant("CalculatedField"),target:"td.e-valuescontent",id:this.element.id+"_CalculatedField"};break;case"Drillthrough":t={text:this.localeObj.getConstant("drillThrough"),target:"td.e-valuescontent",id:this.element.id+"_drillthrough_menu",iconCss:"e-pivotview-grid "+Gr};break;case"export":t={text:this.localeObj.getConstant("export"),target:"td.e-valuescontent",id:this.element.id+"_exporting",iconCss:"e-pivotview-export "+Gr};break;case"Pdf Export":t={text:this.localeObj.getConstant("pdf"),id:this.element.id+"_pdf",iconCss:"e-pivotview-pdf-export "+Gr};break;case"Excel Export":t={text:this.localeObj.getConstant("excel"),id:this.element.id+"_excel",iconCss:"e-pivotview-excel-export "+Gr};break;case"Csv Export":t={text:this.localeObj.getConstant("csv"),id:this.element.id+"_csv",iconCss:"e-pivotview-csv-export "+Gr};break;case"Expand":t={text:this.localeObj.getConstant("expand"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_expand",iconCss:"e-pivotview-expand "+Gr};break;case"Collapse":t={text:this.localeObj.getConstant("collapse"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_collapse",iconCss:"e-pivotview-collapse "+Gr};break;case"Sort Ascending":t={text:this.localeObj.getConstant("ascending"),target:"th.e-valuesheader,.e-stot",id:this.element.id+"_sortasc",iconCss:"e-icon-ascending "+Gr};break;case"Sort Descending":t={text:this.localeObj.getConstant("descending"),target:"th.e-valuesheader,.e-stot",id:this.element.id+"_sortdesc",iconCss:"e-icon-descending "+Gr};break;case"Group":t={text:this.localeObj.getConstant("group"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_custom_group",iconCss:"e-pivotview-group "+Gr};break;case"Ungroup":t={text:this.localeObj.getConstant("unGroup"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_custom_ungroup",iconCss:"e-pivotview-ungroup "+Gr}}return this.defaultItems[e]={text:t.text,id:t.id,target:t.target,iconCss:t.iconCss},this.defaultItems[e]}initProperties(){this.pivotRefresh=a.wA.prototype.refresh,this.minHeight=(0,a.le)(this.minHeight)?300:this.minHeight<10?10:this.minHeight,this.isScrolling=!1,this.allowServerDataBinding=!1,this.isStaticRefresh=!1,this.setProperties({pivotValues:[]},!0),delete this.bulkChanges.pivotValues,this.allowServerDataBinding=!0,this.scrollPosObject={vertical:0,horizontal:0,verticalSection:0,horizontalSection:0,top:0,left:0,scrollDirection:{direction:"",position:0}},this.queryCellInfo=this.gridSettings.queryCellInfo?this.gridSettings.queryCellInfo.bind(this):void 0,this.headerCellInfo=this.gridSettings.headerCellInfo?this.gridSettings.headerCellInfo.bind(this):void 0,this.resizing=this.gridSettings.resizing?this.gridSettings.resizing.bind(this):void 0,this.resizeStop=this.gridSettings.resizeStop?this.gridSettings.resizeStop.bind(this):void 0,this.pdfHeaderQueryCellInfo=this.gridSettings.pdfHeaderQueryCellInfo?this.gridSettings.pdfHeaderQueryCellInfo.bind(this):void 0,this.pdfQueryCellInfo=this.gridSettings.pdfQueryCellInfo?this.gridSettings.pdfQueryCellInfo.bind(this):void 0,this.excelHeaderQueryCellInfo=this.gridSettings.excelHeaderQueryCellInfo?this.gridSettings.excelHeaderQueryCellInfo.bind(this):void 0,this.excelQueryCellInfo=this.gridSettings.excelQueryCellInfo?this.gridSettings.excelQueryCellInfo.bind(this):void 0,this.columnDragStart=this.gridSettings.columnDragStart?this.gridSettings.columnDragStart.bind(this):void 0,this.columnDrag=this.gridSettings.columnDrag?this.gridSettings.columnDrag.bind(this):void 0,this.columnDrop=this.gridSettings.columnDrop?this.gridSettings.columnDrop.bind(this):void 0,this.beforeColumnsRender=this.gridSettings.columnRender?this.gridSettings.columnRender:void 0,this.selected=this.gridSettings.cellSelected?this.gridSettings.cellSelected:void 0,this.cellDeselected=this.gridSettings.cellDeselected?this.gridSettings.cellDeselected:void 0,this.rowSelected=this.gridSettings.rowSelected?this.gridSettings.rowSelected:void 0,this.rowDeselected=this.gridSettings.rowDeselected?this.gridSettings.rowDeselected:void 0,this.chartTooltipRender=this.chartSettings.tooltipRender?this.chartSettings.tooltipRender:void 0,this.chartLoaded=this.chartSettings.loaded?this.chartSettings.loaded:void 0,this.chartLoad=this.chartSettings.load?this.chartSettings.load:void 0,this.chartResized=this.chartSettings.resized?this.chartSettings.resized:void 0,this.chartAxisLabelRender=this.chartSettings.axisLabelRender?this.chartSettings.axisLabelRender:void 0,this.multiLevelLabelClick=this.chartSettings.multiLevelLabelClick?this.chartSettings.multiLevelLabelClick:void 0,this.chartPointClick=this.chartSettings.pointClick?this.chartSettings.pointClick:void 0,this.contextMenuClick=this.gridSettings.contextMenuClick?this.gridSettings.contextMenuClick:void 0,this.contextMenuOpen=this.gridSettings.contextMenuOpen?this.gridSettings.contextMenuOpen:void 0,this.beforePdfExport=this.gridSettings.beforePdfExport?this.gridSettings.beforePdfExport.bind(this):void 0,this.beforeExcelExport=this.gridSettings.beforeExcelExport?this.gridSettings.beforeExcelExport.bind(this):void 0,null===this.gridSettings.rowHeight&&this.setProperties(this.isTouchMode?{gridSettings:{rowHeight:36}}:{gridSettings:{rowHeight:this.isAdaptive?36:30}},!0),this.chartSettings&&this.chartSettings.enableMultiAxis&&!this.chartSettings.enableMultipleAxis&&this.setProperties({chartSettings:{enableMultipleAxis:!0}},!0),this.element.style.height="100%",this.enableVirtualization&&(this.updatePageSettings(!0),this.allowExcelExport&&sc.Inject(qh),this.allowPdfExport&&sc.Inject(Gh),this.editSettings.allowEditing&&sc.Inject(Qh)),this.isCellBoxMultiSelection=this.gridSettings.allowSelection&&"Box"===this.gridSettings.selectionSettings.cellSelectionMode&&"Cell"===this.gridSettings.selectionSettings.mode&&"Multiple"===this.gridSettings.selectionSettings.type,this.allowGrouping&&!this.isCellBoxMultiSelection&&(this.isCellBoxMultiSelection=!0,this.setProperties({gridSettings:{allowSelection:!0,selectionSettings:{cellSelectionMode:"Box",mode:"Cell",type:"Multiple"}}},!0)),"Table"!==this.displayOption.view&&(this.chartModule=new Jh),this.currentView=this.currentView?this.currentView:"Both"===this.displayOption.view?this.displayOption.primary:this.displayOption.view}updatePageSettings(e){if(this.enableVirtualization){let t=1,i=1;this.dataSourceSettings.values.length>1&&"pivot"===this.dataType&&("row"===this.dataSourceSettings.valueAxis?i=this.dataSourceSettings.values.length:t=this.dataSourceSettings.values.length);let s=this.getHeightAsNumber();isNaN(s)&&(s=this.element.offsetHeight),this.pageSettings={columnCurrentPage:e?1:this.pageSettings.columnCurrentPage,rowCurrentPage:e?1:this.pageSettings.rowCurrentPage,columnSize:Math.ceil((Math.floor(this.getWidthAsNumber()/this.gridSettings.columnWidth)-1)/t),rowSize:Math.ceil(Math.floor(s/this.gridSettings.rowHeight)/i),allowDataCompression:this.allowDataCompression}}}render(){this.loadData()}loadData(){if(this.dataSourceSettings.formatSettings.length>0){let e=this.dataSourceSettings.formatSettings;for(let t=0;t<e.length;t++)(0,a.le)(e[t].maximumFractionDigits)&&(0,a.le)(e[t].minimumFractionDigits)||null!==e[t].format.match(/^(P|N|C|P[0-9]|C[0-9]|N[0-9])$/g)||(e[t].maximumFractionDigits=void 0,e[t].minimumIntegerDigits=void 0)}"pivot"===this.dataType&&this.dataSourceSettings.url&&""!==this.dataSourceSettings.url?"Server"===this.dataSourceSettings.mode?(this.guid=br.generateUUID(),this.initialLoad(),"Chart"!==this.displayOption.view&&this.renderEmptyGrid(),this.showWaitingPopup()):(this.request.open("GET",this.dataSourceSettings.url,!0),this.request.withCredentials=!1,this.request.onreadystatechange=this.onReadyStateChange.bind(this),this.request.setRequestHeader("Content-type","text/plain"),this.request.send(null)):this.initialLoad()}onSuccess(){if(this.request.readyState===XMLHttpRequest.DONE){this.isServerWaitingPopup=!0;try{let e=JSON.parse(this.request.responseText);if("fetchFieldMembers"===this.currentAction){let t=JSON.parse(e.members),i=[],s={},o={};for(let e=0;e<t.length;e++)i.push({formattedText:t[e].FormattedText,actualText:t[e].ActualText}),s[t[e].FormattedText]={},o[t[e].ActualText]={};this.engineModule.fieldList[e.memberName].dateMember=i,this.engineModule.fieldList[e.memberName].formattedMembers=s,this.engineModule.fieldList[e.memberName].members=o,this.showGroupingBar?this.pivotButtonModule.updateFilterEvents():this.pivotFieldListModule.pivotButtonModule.updateFilterEvents()}else if("fetchRawData"===this.currentAction){let t=this.engineModule.fieldList[this.drillThroughValue.actualText.toString()]?this.engineModule.fieldList[this.drillThroughValue.actualText.toString()].caption:this.drillThroughValue.actualText.toString(),i=this.engineModule.fieldList[this.drillThroughValue.actualText]?this.engineModule.fieldList[this.drillThroughValue.actualText].aggregateType:"",s=JSON.parse(e.rawData),o=JSON.parse(e.indexObject),l={};for(let e=0;e<o.length;e++)l[o[e].Key]=o[e].Value;this.drillThroughValue.indexObject=l,this.drillThroughModule.triggerDialog(t,i,s,this.drillThroughValue,this.drillThroughElement)}else{let t,i=br.formatFieldList(JSON.parse(e.fieldList));if(this.engineModule.fieldList){let e=Object.keys(this.engineModule.fieldList);for(let t=0;t<e.length;t++)this.engineModule.fieldList[e[t]]&&i[e[t]]&&(i[e[t]].dateMember=this.engineModule.fieldList[e[t]].dateMember,i[e[t]].formattedMembers=this.engineModule.fieldList[e[t]].formattedMembers,i[e[t]].members=this.engineModule.fieldList[e[t]].members)}this.engineModule.fieldList=i,this.engineModule.fields=JSON.parse(e.fields),this.engineModule.rowCount=JSON.parse(e.pivotCount).RowCount,this.engineModule.columnCount=JSON.parse(e.pivotCount).ColumnCount,this.engineModule.rowStartPos=JSON.parse(e.pivotCount).RowStartPosition,this.engineModule.colStartPos=JSON.parse(e.pivotCount).ColumnStartPosition,this.engineModule.rowFirstLvl=JSON.parse(e.pivotCount).RowFirstLevel,this.engineModule.colFirstLvl=JSON.parse(e.pivotCount).ColumnFirstLevel;let s=br.formatPivotValues(JSON.parse(e.pivotValue));for(let e=0;e<s.length;e++)if(s[e]&&s[e][0]&&"row"===s[e][0].axis){t=e;break}this.engineModule.headerContent=br.frameContent(s,"header",t,this),this.engineModule.pageSettings=this.pageSettings,this.dataSourceSettings.groupSettings.length>0&&br.updateReport(this,JSON.parse(e.dataSourceSettings));let o=JSON.parse(e.dataSourceSettings).ValueSortSettings;this.engineModule.valueSortSettings={headerText:o.HeaderText,headerDelimiter:o.HeaderDelimiter,sortOrder:o.SortOrder,columnIndex:o.ColumnIndex},this.engineModule.pivotValues=s}}catch(e){this.engineModule.pivotValues=[]}if("onScroll"===this.currentAction)if("vertical"===this.scrollDirection){let e="row"===this.dataSourceSettings.valueAxis?this.dataSourceSettings.values.length:1,t=this.pageSettings.rowSize*e*this.gridSettings.rowHeight,i=Math.ceil(this.engineModule.rowStartPos/(this.pageSettings.rowSize*e));this.scrollPosObject.verticalSection=t*i-this.engineModule.rowFirstLvl*e*this.gridSettings.rowHeight}else if("horizondal"===this.scrollDirection){let e="column"===this.dataSourceSettings.valueAxis?this.dataSourceSettings.values.length:1,t=this.pageSettings.columnSize*e*this.gridSettings.columnWidth,i=Math.ceil(this.engineModule.colStartPos/(this.pageSettings.columnSize*e));this.scrollPosObject.horizontalSection=t*i-this.engineModule.colFirstLvl*e*this.gridSettings.columnWidth}"fetchFieldMembers"!==this.currentAction&&"fetchRawData"!==this.currentAction&&(this.initEngine(),this.calculatedFieldModule&&this.calculatedFieldModule.isRequireUpdate&&(this.calculatedFieldModule.endDialog(),this.calculatedFieldModule.isRequireUpdate=!1),this.pivotFieldListModule&&this.pivotFieldListModule.calculatedFieldModule&&this.pivotFieldListModule.calculatedFieldModule.isRequireUpdate&&(this.pivotFieldListModule.calculatedFieldModule.endDialog(),this.pivotFieldListModule.calculatedFieldModule.isRequireUpdate=!1))}}getEngine(e,t,i,s,o,l,a,r,n){this.currentAction=e,this.isServerWaitingPopup=!1;let h={pageSettings:this.pageSettings,enableValueSorting:this.enableValueSorting,enableDrillThrough:this.allowDrillThrough||this.editSettings.allowEditing,locale:JSON.stringify(br.getLocalizedObject(this))};this.request.open("POST",this.dataSourceSettings.url,!0);let d={request:this.request,dataSourceSettings:JSON.parse(this.getPersistData()).dataSourceSettings,action:e,customProperties:{},internalProperties:h,drillItem:t,sortItem:i,aggregatedItem:s,calculatedItem:o,filterItem:l,memberName:a,fetchRawDataArgs:r,editArgs:n,hash:this.guid};this.trigger(Er,d,e=>{this.request=e.request,d.internalProperties=e.internalProperties,d.customProperties=e.customProperties,d.dataSourceSettings=e.dataSourceSettings,d.calculatedItem=e.calculatedItem,d.drillItem=e.drillItem,d.editArgs=e.editArgs,d.fetchRawDataArgs=e.fetchRawDataArgs,d.filterItem=e.filterItem,d.hash=e.hash,d.memberName=e.memberName,d.sortItem=e.sortItem}),this.request.withCredentials=!1,this.request.onreadystatechange=this.onSuccess.bind(this),this.request.setRequestHeader("Content-type","application/json"),this.request.send(JSON.stringify(d))}onReadyStateChange(){if(this.request.readyState===XMLHttpRequest.DONE){let t=[];if("CSV"===this.dataSourceSettings.type){let e=this.request.responseText.split(/\r?\n|\r/);for(let i=0;i<e.length;i++)(0,a.le)(e[i])||""===e[i]||t.push(e[i].split(","))}else try{t=JSON.parse(this.request.responseText)}catch(e){t=[]}(0,a.xr)()&&t&&t.length>0?this.remoteData=t:t&&t.length>0&&this.setProperties({dataSourceSettings:{dataSource:t}},!0),this.initialLoad()}}initialLoad(){this.cellTemplateFn=this.templateParser(this.cellTemplate),this.tooltipTemplateFn=this.templateParser(this.tooltipTemplate),(0,n.rj)(this.spinnerTemplate?{target:this.element,template:this.spinnerTemplate}:{target:this.element},this.createElement);let e={dataSourceSettings:(0,a.xr)()?br.getClonedDataSourceSettings(this.dataSourceSettings):this.dataSourceSettings,pivotview:(0,a.xr)()?void 0:this,fieldsType:{}};this.trigger(yr,e,e=>{(0,a.xr)()?(e.dataSourceSettings.dataSource=this.dataSourceSettings.dataSource,br.updateDataSourceSettings(this,e.dataSourceSettings)):this.dataSourceSettings=e.dataSourceSettings,this.fieldsType=e.fieldsType,this.updateClass(),this.notify(_r,{}),"Server"!==this.dataSourceSettings.mode&&this.notify(Fr,{}),this.isAdaptive&&this.contextMenuModule.render(),this.notify("init-toolbar",{})}),(0,a.xr)()&&this.renderComplete()}addInternalEvents(){this.on(Fr,this.generateData,this),this.on(zr,this.renderPivotGrid,this),this.on(Nr,this.onContentReady,this)}removeInternalEvents(){this.off(Fr,this.generateData),this.off(zr,this.renderPivotGrid),this.off(Nr,this.onContentReady)}getPersistData(){let e=this.gridSettings.columnRender;this.gridSettings.columnRender=void 0,this.chartSettings.tooltipRender=void 0;let t=this.addOnPersist(["dataSourceSettings","pivotValues","gridSettings","chartSettings","displayOption"]);return this.gridSettings.columnRender=e,t}loadPersistData(e){let t;(0,a.xr)()?(t="string"==typeof e?JSON.parse(e):e,t.dataSourceSettings.dataSource=this.dataSourceSettings.dataSource):t=JSON.parse(e),this.allowServerDataBinding=!1,this.setProperties({gridSettings:t.gridSettings,pivotValues:t.pivotValues,chartSettings:t.chartSettings,displayOption:t.displayOption},!0),delete this.bulkChanges.pivotValues,this.allowServerDataBinding=!0,this.dataSourceSettings=t.dataSourceSettings}mergePersistPivotData(){let e;(0,a.xr)()&&(e=this.dataSourceSettings.dataSource);let t=window.localStorage.getItem(this.getModuleName()+this.element.id);(0,a.le)(t)||""===t||this.setProperties(JSON.parse(t),!0),this.dataSourceSettings.dataSource instanceof Object&&(0,a.xr)()&&this.setProperties({dataSourceSettings:{dataSource:e}},!0)}showConditionalFormattingDialog(){this.conditionalFormattingModule&&this.conditionalFormattingModule.showConditionalFormattingDialog()}createCalculatedFieldDialog(){this.calculatedFieldModule&&this.calculatedFieldModule.createCalculatedFieldDialog()}getModuleName(){return"pivotview"}copy(e){this.grid.copy(e)}onPropertyChanged(e,t){for(let i of Object.keys(e))switch(i){case"dataSourceSettings":case"hyperlinkSettings":case"allowDrillThrough":case"editSettings":case"allowDataCompression":if(e.dataSourceSettings&&1===Object.keys(e.dataSourceSettings).length&&e.dataSourceSettings.groupSettings&&"pivot"===this.dataType&&this.updateGroupingReport(e.dataSourceSettings.groupSettings,"Date"),e.dataSourceSettings&&1===Object.keys(e.dataSourceSettings).length&&"dataSource"===Object.keys(e.dataSourceSettings)[0])!(0,a.le)(this.savedDataSourceSettings)&&this.dataSourceSettings.dataSource.length>0&&(br.updateDataSourceSettings(this,this.savedDataSourceSettings),this.savedDataSourceSettings=void 0),0===(e.dataSourceSettings.dataSource&&e.dataSourceSettings.dataSource).length&&(this.savedDataSourceSettings=br.getClonedDataSourceSettings(this.dataSourceSettings),this.setProperties({dataSourceSettings:{rows:[]}},!0),this.setProperties({dataSourceSettings:{columns:[]}},!0),this.setProperties({dataSourceSettings:{values:[]}},!0),this.setProperties({dataSourceSettings:{filters:[]}},!0)),this.isStaticRefresh||(this.pivotValues=[],this.engineModule.fieldList=null),this.dataSourceSettings.groupSettings.length>0&&(this.clonedDataSet=e.dataSourceSettings.dataSource,this.updateGroupingReport(this.dataSourceSettings.groupSettings,"Date")),this.showWaitingPopup(),clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.refreshData.bind(this),100);else if(br.isButtonIconRefesh(i,t,e)){if(this.showGroupingBar&&this.groupingBarModule&&this.axisFieldModule.render(),this.showFieldList&&this.pivotFieldListModule){let e=br.cloneFieldSettings(this.dataSourceSettings.rows),t=br.cloneFieldSettings(this.dataSourceSettings.columns),i=br.cloneFieldSettings(this.dataSourceSettings.values),s=br.cloneFieldSettings(this.dataSourceSettings.filters);this.pivotFieldListModule.setProperties({dataSourceSettings:{rows:e,columns:t,values:i,filters:s}},!0),this.pivotFieldListModule.axisFieldModule.render(),this.pivotFieldListModule.treeViewModule.fieldTable&&!this.isAdaptive&&this.pivotFieldListModule.notify(Br,{})}}else this.remoteData=[],"pivot"===this.dataType&&this.dataSourceSettings.url&&""!==this.dataSourceSettings.url&&("type"in e.dataSourceSettings||"url"in e.dataSourceSettings)?(this.engineModule.fieldList=null,this.loadData()):(e.dataSourceSettings&&"dataSource"in e.dataSourceSettings&&(e.dataSourceSettings.dataSource&&0===e.dataSourceSettings.dataSource.length&&(this.savedDataSourceSettings=br.getClonedDataSourceSettings(this.dataSourceSettings),this.setProperties({dataSourceSettings:{rows:[]}},!0),this.setProperties({dataSourceSettings:{columns:[]}},!0),this.setProperties({dataSourceSettings:{values:[]}},!0),this.setProperties({dataSourceSettings:{filters:[]}},!0)),this.isStaticRefresh||(this.engineModule.fieldList=null,this.pivotValues=[])),this.notify(Fr,{}));break;case"height":case"width":this.layoutRefresh();break;case"pivotValues":case"displayOption":!this.showToolbar&&e.displayOption&&1===Object.keys(e.displayOption).length&&e.displayOption.view?(this.currentView="Both"===e.displayOption.view?this.displayOption.primary:e.displayOption.view,(this.showGroupingBar||this.showFieldList)&&(this.showFieldList&&this.pivotFieldListModule&&this.pivotFieldListModule.destroy(),this.showGroupingBar&&this.groupingBarModule&&this.groupingBarModule.destroy(),this.notify(_r,this)),this.grid||"Chart"===e.displayOption.view?this.chartModule||"Table"===this.displayOption.view||(this.chartModule=new Jh):(this.renderEmptyGrid(),"Table"===e.displayOption.view&&this.chartModule&&(this.chartModule.destroy(),this.chart=void 0,this.chartModule=void 0))):this.showToolbar&&!(0,a.le)(e.displayOption)&&e.displayOption.view&&(this.currentView="Both"===e.displayOption.view?this.displayOption.primary:e.displayOption.view);let s="pivot"===this.dataType?this.engineModule:this.olapEngineModule;(0,a.le)(s.fieldList)&&(0,a.le)(s.pivotValues)||this.notify(zr,{});break;case"gridSettings":this.lastGridSettings=e.gridSettings,this.isCellBoxMultiSelection=this.gridSettings.allowSelection&&"Box"===this.gridSettings.selectionSettings.cellSelectionMode&&"Cell"===this.gridSettings.selectionSettings.mode&&"Multiple"===this.gridSettings.selectionSettings.type,this.allowGrouping&&this.groupingModule&&!this.isCellBoxMultiSelection&&(this.setProperties({gridSettings:{allowSelection:!0,selectionSettings:{cellSelectionMode:"Box",mode:"Cell",type:"Multiple"}}},!0),this.isCellBoxMultiSelection=!0),this.renderModule.updateGridSettings();break;case"chartSettings":this.showGroupingBar&&this.groupingBarModule&&(-1!==Object.keys(e.chartSettings).indexOf("enableMultipleAxis")||e.chartSettings.chartSeries&&-1!==Object.keys(e.chartSettings.chartSeries).indexOf("type"))&&this.groupingBarModule.renderLayout(),(0,a.le)(this.chartModule)&&"Table"!==this.displayOption.view&&(this.chartModule=new Jh);let o="pivot"===this.dataType?this.engineModule:this.olapEngineModule;(0,a.le)(this.chartModule)||(0,a.le)(o.pivotValues)||this.chartModule.loadChart(this,this.chartSettings),(0,a.le)(o.pivotValues)||(0,a.le)(o.fieldList)||this.notify(Or,this);break;case"locale":case"currencyCode":case"enableRtl":if(this.tooltip&&this.tooltip.destroy(),this.dataSourceSettings.groupSettings&&this.dataSourceSettings.groupSettings.length>0&&this.clonedDataSet&&!(0,a.xr)()){let e=br.getClonedData(this.clonedDataSet);this.setProperties({dataSourceSettings:{dataSource:e}},!0)}(0,a.xr)()?this.refresh():super.refresh(),this.updateClass();break;case"enableValueSorting":this.enableValueSorting=e.enableValueSorting,this.updateDataSource();break;case"showGroupingBar":this.element.querySelector(".e-grouping-bar")&&this.element.querySelector(".e-grouping-bar").remove(),(0,a.le)(e.showFieldList)&&this.renderPivotGrid();break;case"showFieldList":this.initialLoad();break;case"groupingBarSettings":e.groupingBarSettings&&this.showGroupingBar&&this.groupingBarModule&&Object.keys(e.groupingBarSettings).indexOf("showFieldsPanel")>-1?(this.groupingBarModule.RefreshFieldsPanel(),this.layoutRefresh()):this.axisFieldModule.render();break;case"showTooltip":this.renderToolTip();break;case"toolbar":this.toolbarModule&&this.toolbarModule.refreshToolbar();break;case"chartTypes":this.toolbarModule&&this.toolbarModule.createChartMenu();break;case"aggregateTypes":this.showGroupingBar&&this.axisFieldModule&&this.axisFieldModule.render(),this.showFieldList&&this.pivotFieldListModule&&this.pivotFieldListModule.axisFieldModule&&(this.pivotFieldListModule.setProperties({aggregateTypes:e.aggregateTypes},!0),this.pivotFieldListModule.axisFieldModule.render())}}templateParser(e){if(e)try{if(document.querySelectorAll(e).length)return(0,a.MY)(document.querySelector(e).innerHTML.trim())}catch(t){return(0,a.MY)(e)}}getCellTemplate(){return this.cellTemplateFn}appendHtml(e,t){let i=document.createElement("div");return i.innerHTML=t,(0,a.le)(i.firstChild)||e.appendChild(i.firstChild),e}renderPivotGrid(){this.clearTemplate(),"Table"===this.currentView&&this.cellTemplate&&(0,a.xr)()&&(0,a.oL)(this.element.id+"_cellTemplate","CellTemplate"),this.chartModule&&(this.chartModule.engineModule=this.engineModule,this.chartModule.loadChart(this,this.chartSettings),this.enableRtl&&this.chart&&"rtl"!==document.body.getAttribute("dir")&&(0,a.cn)([this.chart.element],"e-ltr")),(this.showFieldList||this.showGroupingBar||this.allowNumberFormatting||this.allowCalculatedField||this.toolbar||this.allowGrouping||this.gridSettings.contextMenuItems)&&(this.notify(Or,this),this.pivotFieldListModule&&this.allowDeferLayoutUpdate&&(this.pivotFieldListModule.clonedDataSource=(0,a.l7)({},this.dataSourceSettings,null,!0))),this.enableVirtualization&&(this.virtualscrollModule=new Uh(this)),(this.allowDrillThrough||this.editSettings.allowEditing)&&(this.drillThroughModule=new Qh(this)),"Chart"!==this.displayOption.view?(this.hyperlinkSettings&&(this.isRowCellHyperlink=!!this.hyperlinkSettings.showRowHeaderHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isColumnCellHyperlink=!!this.hyperlinkSettings.showColumnHeaderHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isValueCellHyperlink=!!this.hyperlinkSettings.showValueCellHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isSummaryCellHyperlink=!!this.hyperlinkSettings.showSummaryCellHyperlink||!!this.hyperlinkSettings.showHyperlink,this.applyHyperlinkSettings()),this.renderModule=new yh(this),this.renderModule.render()):this.grid&&(0,a.Od)(this.grid.element),this.allowConditionalFormatting&&this.applyFormatting(this.pivotValues),this.showToolbar&&"Both"===this.displayOption.view&&this.chart&&this.grid&&(this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector(".e-grouping-bar")&&this.groupingBarModule.refreshUI(),this.toolbarModule&&this.toolbarModule.toolbar&&(this.toolbarModule.toolbar.width=this.getGridWidthAsNumber()-2),this.chart.element.style.width=(0,a.Ac)(this.getGridWidthAsNumber()),this.chart.width=(0,a.Ac)(this.getGridWidthAsNumber()),"Table"===this.currentView?(this.grid.element.style.display="",this.chart.element.style.display="none",this.chartSettings.enableMultipleAxis&&this.chartSettings.enableScrollOnMultiAxis&&(this.element.querySelector(".e-pivotchart").style.display="none")):(this.grid.element.style.display="none",this.chart.element.style.display="",this.chartSettings.enableMultipleAxis&&this.chartSettings.enableScrollOnMultiAxis&&(this.element.querySelector(".e-pivotchart").style.display=""))),this.toolbarModule&&(this.showFieldList&&(0,a.Ys)("#"+this.element.id+"_PivotFieldList",this.element)&&((0,a.Ys)("#"+this.element.id+"_PivotFieldList",this.element).style.display="none"),this.toolbar&&-1!==this.toolbar.indexOf("FieldList")&&this.showToolbar&&this.element.querySelector(".e-toggle-field-list")&&(this.element.querySelector(".e-toggle-field-list").style.display="none"),this.toolbarModule&&"New"!==this.toolbarModule.action&&"Load"!==this.toolbarModule.action&&"Remove"!==this.toolbarModule.action&&(this.isModified=!0),this.isInitialRendering||(this.isModified=!1,this.isInitialRendering=!this.isInitialRendering),this.toolbarModule.action="")}showWaitingPopup(){(0,n.yh)(this.grid&&this.grid.element&&!this.spinnerTemplate&&"Table"===this.currentView?this.grid.element:this.element)}hideWaitingPopup(){(0,n.v3)(this.grid&&this.grid.element&&!this.spinnerTemplate&&"Table"===this.currentView?this.grid.element:this.element)}updateDataSource(e){this.showWaitingPopup();let t=this,i=Object.keys(t.lastSortInfo).length>0,s=Object.keys(t.lastFilterInfo).length>0,o=Object.keys(t.lastAggregationInfo).length>0,l=Object.keys(t.lastCalcFieldInfo).length>0,r={dataSourceSettings:br.getClonedDataSourceSettings(t.dataSourceSettings)};t.trigger(vr,r,e=>{if(t.enableVirtualization&&(i||s||o||l)||br.updateDataSourceSettings(t,e.dataSourceSettings),t.updatePageSettings(!1),"pivot"===t.dataType&&t.enableVirtualization&&(i||s||o||l)){let e={};if(i&&(t.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),(0,a.xr)()?e={key:"onSort",arg:window.sfBlazor.copyWithoutCircularReferences([t.lastSortInfo],t.lastSortInfo)}:"Server"===this.dataSourceSettings.mode?t.getEngine("onSort",null,t.lastSortInfo,null,null,null,null):t.engineModule.onSort(t.lastSortInfo),t.lastSortInfo={}),o&&((0,a.xr)()?e={key:"onAggregation",arg:window.sfBlazor.copyWithoutCircularReferences([t.lastAggregationInfo],t.lastAggregationInfo)}:"Server"===this.dataSourceSettings.mode?t.getEngine("onAggregation",null,null,t.lastAggregationInfo,null,null,null):t.engineModule.onAggregation(t.lastAggregationInfo),t.lastAggregationInfo={}),l){if((0,a.xr)()){let i=window.sfBlazor.copyWithoutCircularReferences([t.dataSourceSettings.properties],t.dataSourceSettings.properties);e={key:"onCalcOperation",arg:{lastCalcFieldInfo:t.lastCalcFieldInfo,values:i.values,calculatedFieldSettings:i.calculatedFieldSettings}}}else"Server"===this.dataSourceSettings.mode?t.getEngine("onCalcOperation",null,null,null,t.lastCalcFieldInfo,null,null):t.engineModule.onCalcOperation(t.lastCalcFieldInfo);t.lastCalcFieldInfo={}}s&&((0,a.xr)()?e={key:"onFilter",arg:{lastFilterInfo:window.sfBlazor.copyWithoutCircularReferences([t.lastFilterInfo],t.lastFilterInfo),filterSettings:window.sfBlazor.copyWithoutCircularReferences([t.dataSourceSettings.filterSettings],t.dataSourceSettings.filterSettings)}}:"Server"===this.dataSourceSettings.mode?t.getEngine("onFilter",null,null,null,null,t.lastFilterInfo,null):t.engineModule.onFilter(t.lastFilterInfo,t.dataSourceSettings),t.lastFilterInfo={}),(0,a.xr)()?t.interopAdaptor.invokeMethodAsync("PivotInteropMethod",e.key,e.arg).then(e=>{t.updateBlazorData(e,t),t.allowServerDataBinding=!1,t.setProperties({pivotValues:t.engineModule.pivotValues},!0),delete t.bulkChanges.pivotValues,t.allowServerDataBinding=!0,t.enginePopulatedEventMethod("updateDataSource",t),t.calculatedFieldModule&&t.calculatedFieldModule.isRequireUpdate&&(t.calculatedFieldModule.endDialog(),t.calculatedFieldModule.isRequireUpdate=!1)}):(t.allowServerDataBinding=!1,t.setProperties({pivotValues:t.engineModule.pivotValues},!0),delete t.bulkChanges.pivotValues,t.allowServerDataBinding=!0,"Server"!==t.dataSourceSettings.mode&&t.enginePopulatedEventMethod("updateDataSource"))}else if("olap"===t.dataType){let e={mode:"",savedFieldList:t.olapEngineModule.fieldList,savedFieldListData:t.olapEngineModule.fieldListData,pageSettings:t.pageSettings,enableValueSorting:t.enableValueSorting,isDrillThrough:t.allowDrillThrough||t.editSettings.allowEditing,localeObj:t.localeObj};l||i?(t.olapEngineModule.savedFieldList=t.olapEngineModule.fieldList,t.olapEngineModule.savedFieldListData=t.olapEngineModule.fieldListData,l?(t.olapEngineModule.updateCalcFields(t.dataSourceSettings,t.lastCalcFieldInfo),t.lastCalcFieldInfo={}):(t.olapEngineModule.onSort(t.dataSourceSettings),t.lastSortInfo={})):t.olapEngineModule.renderEngine(t.dataSourceSettings,e),t.allowServerDataBinding=!1,t.setProperties({pivotValues:t.olapEngineModule.pivotValues},!0),delete t.bulkChanges.pivotValues,t.allowServerDataBinding=!0,t.enginePopulatedEventMethod("updateDataSource")}else{let e={mode:"",savedFieldList:t.engineModule.fieldList,pageSettings:t.pageSettings,enableValueSorting:t.enableValueSorting,isDrillThrough:t.allowDrillThrough||t.editSettings.allowEditing,localeObj:t.localeObj,fieldsType:t.fieldsType,clonedReport:t.clonedReport};if((0,a.xr)()&&t.enableVirtualization){let i="sfBlazor",s=window[i].copyWithoutCircularReferences([e],e),o=window[i].copyWithoutCircularReferences([t.dataSourceSettings],t.dataSourceSettings);t.interopAdaptor.invokeMethodAsync("PivotInteropMethod","renderEngine",{dataSourceSettings:o,customProperties:s}).then(e=>{t.updateBlazorData(e,t),t.allowServerDataBinding=!1,t.setProperties({pivotValues:t.engineModule.pivotValues},!0),delete t.bulkChanges.pivotValues,t.allowServerDataBinding=!0,t.enginePopulatedEventMethod("updateDataSource",t)})}else"Server"===t.dataSourceSettings.mode?(i?t.getEngine("onSort",null,t.lastSortInfo,null,null,null,null):o?t.getEngine("onAggregation",null,null,t.lastAggregationInfo,null,null,null):l?t.getEngine("onCalcOperation",null,null,null,t.lastCalcFieldInfo,null,null):s?t.getEngine("onFilter",null,null,null,null,t.lastFilterInfo,null):t.getEngine("onDrop",null,null,null,null,null,null),t.lastSortInfo={},t.lastAggregationInfo={},t.lastCalcFieldInfo={},t.lastFilterInfo={}):(t.engineModule.renderEngine(t.dataSourceSettings,e,t.getValueCellInfo.bind(t)),t.allowServerDataBinding=!1,t.setProperties({pivotValues:t.engineModule.pivotValues},!0),delete t.bulkChanges.pivotValues,t.allowServerDataBinding=!0,t.enginePopulatedEventMethod("updateDataSource"))}})}excelExport(e,t,i,s){this.enableVirtualization&&"Server"!==this.dataSourceSettings.mode?this.excelExportModule.exportToExcel("Excel",e):(this.exportType="Excel",this.grid.excelExport(e,t,i,s))}csvExport(e,t,i,s){this.enableVirtualization&&"Server"!==this.dataSourceSettings.mode?this.excelExportModule.exportToExcel("CSV",e):(this.exportType="CSV",this.grid.csvExport(e,t,i,s))}pdfExport(e,t,i,s){this.enableVirtualization&&"Server"!==this.dataSourceSettings.mode?this.pdfExportModule.exportToPDF(e):this.grid.pdfExport(e,t,i,s)}chartExport(e,t,i,s,o){this.chart&&this.chart.enableExport&&this.chart.exportModule.export(e,t,i,null,s,o)}printChart(){this.chart&&this.chart.print()}onDrill(e,t){let i=this.dataSourceSettings.drilledMembers[0]&&this.dataSourceSettings.drilledMembers[0].delimiter?this.dataSourceSettings.drilledMembers[0].delimiter:"**",s="",o="",l="";if(t?(s=t.fieldName,o=t.cell.axis,l=t.isDrilled?"up":"down"):(s=e.parentElement.getAttribute("fieldname"),o=e.parentElement.classList.contains(Rn)?"row":"column",l=e.classList.contains(Tn)?"up":"down"),"pivot"===this.dataType){let r=br.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers),n=t?t.cell:this.engineModule.pivotValues[Number(e.parentElement.getAttribute("index"))][Number(e.parentElement.getAttribute("aria-colindex"))],h=n.valueSort.levelName.split(this.engineModule.valueSortSettings.headerDelimiter).join(i),d=!1;if(0===this.dataSourceSettings.drilledMembers.length)this.setProperties({dataSourceSettings:{drilledMembers:[{name:s,items:[h],delimiter:i}]}},!0);else{let e=br.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers);for(let t=0;t<e.length;t++){let o=e[t];if(h=h.split(i).join(o.delimiter?o.delimiter:i),i=o.delimiter=o.delimiter?o.delimiter:i,o.name===s){d=!0;let e=o.items.indexOf(h);e>-1?o.items.splice(e,1):o.items.push(h)}}this.setProperties({dataSourceSettings:{drilledMembers:e}},!0),d||this.dataSourceSettings.drilledMembers.push({name:s,items:[h],delimiter:i})}this.showWaitingPopup();let c=this,p={fieldName:s,memberName:h,delimiter:i,axis:o,action:l,currentCell:n},u={drillInfo:p,pivotview:(0,a.xr)()?void 0:c,cancel:!1};c.trigger(Lr,u,e=>{if(e.cancel)this.hideWaitingPopup(),this.setProperties({dataSourceSettings:{drilledMembers:r}},!0);else{let e={dataSourceSettings:br.getClonedDataSourceSettings(this.dataSourceSettings)};if(c.trigger(vr,e),c.setProperties({dataSourceSettings:e.dataSourceSettings},!0),c.enableVirtualization)if((0,a.xr)()){let e="sfBlazor",t=window[e].copyWithoutCircularReferences([c.dataSourceSettings],c.dataSourceSettings),i=window[e].copyWithoutCircularReferences([p],p);window[e].copyWithoutCircularReferences([u],u),c.interopAdaptor.invokeMethodAsync("PivotInteropMethod","onDrill",{dataSourceSettings:t,drilledItem:i}).then(e=>{c.updateBlazorData(e,c),c.engineModule.drilledMembers=c.dataSourceSettings.drilledMembers,c.allowServerDataBinding=!1,c.setProperties({pivotValues:c.engineModule.pivotValues},!0),delete c.bulkChanges.pivotValues,c.allowServerDataBinding=!0,c.renderPivotGrid()})}else"Server"===this.dataSourceSettings.mode?this.getEngine("onDrill",p,null,null,null,null,null):(c.engineModule.drilledMembers=c.dataSourceSettings.drilledMembers,c.engineModule.onDrill(p));else"Server"===this.dataSourceSettings.mode?this.getEngine("onDrill",p,null,null,null,null,null):c.engineModule.generateGridData(c.dataSourceSettings);if(!(0,a.xr)()||!c.enableVirtualization){c.allowServerDataBinding=!1,c.setProperties({pivotValues:c.engineModule.pivotValues},!0),delete c.bulkChanges.pivotValues,c.allowServerDataBinding=!0;let t={dataSourceSettings:br.getClonedDataSourceSettings(e.dataSourceSettings),pivotValues:this.pivotValues};this.trigger(Sr,t),c.engineModule.pivotValues=t.pivotValues,c.renderPivotGrid()}}})}else this.onOlapDrill(s,o,l,i,e,t)}onOlapDrill(e,t,i,s,o,l){let r=this,n=br.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers),h=l?l.cell:this.olapEngineModule.pivotValues[Number(o.parentElement.getAttribute("index"))][Number(o.parentElement.getAttribute("aria-colindex"))],d="row"===t?this.olapEngineModule.tupRowInfo[h.ordinal]:this.olapEngineModule.tupColumnInfo[h.ordinal],c={axis:t,action:i,fieldName:e,delimiter:"~~",memberName:d.uNameCollection,currentCell:h};this.showWaitingPopup();let p={drillInfo:c,pivotview:(0,a.xr)()?void 0:r,cancel:!1},u=this.olapEngineModule.fieldList[c.fieldName]&&this.olapEngineModule.fieldList[c.fieldName].isHierarchy,g=d.drillInfo.map(e=>e.hierarchy).indexOf(h.hierarchy.toString()),m=br.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers);if(c&&"down"===c.action){let e=d.drillInfo.map(e=>e.uName),i="";for(let t=0;t<=g;t++){let s=e[t].split("~~");i=i+(""!==i?"~~":"")+s[s.length-1]}let s=this.olapEngineModule.getDrilledSets(c.memberName,h,this.olapEngineModule.fieldList[h.hierarchy]&&!this.olapEngineModule.fieldList[h.hierarchy].hasAllMember?h.valueSort.levelName.split(this.dataSourceSettings.valueSortSettings.headerDelimiter).length-1:g,t),o=Object.keys(s);for(let t of o){let e=s[t];for(let t=0,i=m.length;t<i;t++){let i=m[t],s=e;i.delimiter&&(s=s.replace(/~~/g,i.delimiter));let o=[];for(let e=0;e<i.items.length;e++)0!==i.items[e].indexOf(s)&&(o[o.length]=i.items[e]);i.items=o}}this.olapEngineModule.drilledSets[h.actualText]=d.members[g],c.memberName=i;let l=[];for(let t of m)t.name===c.fieldName&&l.push(t);if(l.length>0){if(l[0].delimiter&&(i=i.replace(/~~/g,l[0].delimiter)),-1===br.inArray(i,l[0].items)&&l[0].items.push(i),u){let e=0;for(;e<l[0].items.length;)l[0].items[e]===i?l[0].items.splice(e,1):++e}}else if(!u){let e={name:c.fieldName,items:[i],delimiter:"~~"};m?m.push(e):m=[e]}p.drillInfo.memberName=i,this.setProperties({dataSourceSettings:{drilledMembers:m}},!0),r.trigger(Lr,p,e=>{if(e.cancel)this.hideWaitingPopup(),this.setProperties({dataSourceSettings:{drilledMembers:n}},!0);else{let e={dataSourceSettings:br.getClonedDataSourceSettings(this.dataSourceSettings)};this.trigger(vr,e),this.setProperties({dataSourceSettings:e.dataSourceSettings},!0),this.olapEngineModule.updateDrilledInfo(this.dataSourceSettings),this.allowServerDataBinding=!1,this.setProperties({pivotValues:this.olapEngineModule.pivotValues},!0),delete this.bulkChanges.pivotValues,this.allowServerDataBinding=!0;let t={dataSourceSettings:br.getClonedDataSourceSettings(e.dataSourceSettings),pivotValues:r.olapEngineModule.pivotValues};this.trigger(Sr,t),this.olapEngineModule.pivotValues=t.pivotValues,this.renderPivotGrid()}})}else{delete this.olapEngineModule.drilledSets[h.actualText];let e=this.olapEngineModule.getDrilledSets(c.memberName,h,g,t),i=Object.keys(e),s=d.drillInfo.map(e=>e.uName),o="";for(let t=0;t<=g;t++){let e=s[t].split("~~");o=o+(""!==o?"~~":"")+e[e.length-1]}for(let t of i){let i=e[t],s=[];for(let e=0,t=m.length;e<t;e++){let t=m[e],o=i;if(t.name===c.fieldName&&s.push(t),t.delimiter&&(o=i.replace(/~~/g,t.delimiter)),!u){let e=[];for(let i=0;i<t.items.length;i++)0!==t.items[i].indexOf(o)&&(e[e.length]=t.items[i]);t.items=e}}if(u)if(s.length>0)s[0].delimiter&&(o=o.replace(/~~/g,s[0].delimiter)),-1===br.inArray(o,s[0].items)&&s[0].items.push(o);else{let e={name:c.fieldName,items:[o],delimiter:"~~"};m?m.push(e):m=[e]}}let l=[];for(let t of m)t.items.length>0&&l.push(t);this.setProperties({dataSourceSettings:{drilledMembers:m}},!0),r.trigger(Lr,p,e=>{if(e.cancel)this.hideWaitingPopup(),this.setProperties({dataSourceSettings:{drilledMembers:n}},!0);else{let e={dataSourceSettings:br.getClonedDataSourceSettings(this.dataSourceSettings)};this.trigger(vr,e),this.setProperties({dataSourceSettings:e.dataSourceSettings},!0),this.setProperties({dataSourceSettings:{drilledMembers:l}},!0),this.olapEngineModule.updateDrilledInfo(this.dataSourceSettings),this.allowServerDataBinding=!1,this.setProperties({pivotValues:this.olapEngineModule.pivotValues},!0),delete this.bulkChanges.pivotValues,this.allowServerDataBinding=!0;let t={dataSourceSettings:br.getClonedDataSourceSettings(e.dataSourceSettings),pivotValues:r.olapEngineModule.pivotValues};this.trigger(Sr,t),this.olapEngineModule.pivotValues=t.pivotValues,this.renderPivotGrid()}})}}onContentReady(){if("Table"!==this.currentView&&this.cellTemplate&&(0,a.xr)()&&(0,a.oL)(this.element.id+"_cellTemplate","CellTemplate"),this.isPopupClicked=!1,this.showFieldList?(0,n.v3)(this.pivotFieldListModule.fieldListSpinnerElement):this.fieldListSpinnerElement&&(0,n.v3)(this.fieldListSpinnerElement),this.isEmptyGrid?(this.isEmptyGrid=!1,this.notEmpty=!0):(("Server"===this.dataSourceSettings.mode&&this.isServerWaitingPopup||"Local"===this.dataSourceSettings.mode)&&this.hideWaitingPopup(),this.trigger(Mr)),this.grid){let e="pivot"===this.dataType?this.engineModule:this.olapEngineModule;if(this.enableVirtualization&&e){this.element.querySelector(".e-movablecontent")&&!this.element.querySelector(".e-movablecontent").querySelector(".e-virtualtrack")&&(this.virtualDiv=(0,a.az)("div",{className:th}),this.element.querySelector(".e-movablecontent").appendChild(this.virtualDiv)),this.element.querySelector(".e-movableheader")&&!this.element.querySelector(".e-movableheader").querySelector(".e-virtualtrack")?(this.virtualHeaderDiv=(0,a.az)("div",{className:th}),this.element.querySelector(".e-movableheader").appendChild(this.virtualHeaderDiv)):this.virtualHeaderDiv=this.element.querySelector(".e-movableheader").querySelector(".e-virtualtrack");let t=this.element.querySelector(".e-movablecontent").querySelector(".e-table"),i=this.gridSettings.rowHeight*e.rowCount+.1-t.clientHeight;i>this.scrollerBrowserLimit&&(this.verticalScrollScale=i/this.scrollerBrowserLimit,i=this.scrollerBrowserLimit);let s=this.gridSettings.columnWidth*e.columnCount;s>this.scrollerBrowserLimit&&(this.horizontalScrollScale=s/this.scrollerBrowserLimit,s=this.scrollerBrowserLimit),(0,a.V7)(this.virtualDiv,{height:(i>.1?i:.1)+"px",width:(s>.1?s:.1)+"px"}),(0,a.V7)(this.virtualHeaderDiv,{height:0,width:(s>.1?s:.1)+"px"});let o=this.element.querySelector(".e-movablecontent"),l=this.element.querySelector(".e-frozencontent"),r=this.element.querySelector(".e-movableheader");this.isAdaptive&&(o.parentElement.parentElement.querySelector(".e-movablescrollbar").children[0].style.minHeight="1px",o.parentElement.parentElement.querySelector(".e-movablescrollbar").style.minHeight="1px");let n=this.isAdaptive?o:o.parentElement.parentElement.querySelector(".e-movablescrollbar"),h=o.parentElement.scrollTop>this.scrollerBrowserLimit?o.querySelector("."+An).style.transform.split(",")[1].trim():-(o.parentElement.scrollTop*this.verticalScrollScale-this.scrollPosObject.verticalSection-o.parentElement.scrollTop)+"px)",d=n.scrollLeft>this.scrollerBrowserLimit?o.querySelector("."+An).style.transform.split(",")[0].trim()+",":"translate("+-(n.scrollLeft*this.horizontalScrollScale-this.scrollPosObject.horizontalSection-n.scrollLeft)+"px,";(0,a.V7)(l.querySelector(".e-table"),{transform:"translate(0px,"+h}),(0,a.V7)(o.querySelector(".e-table"),{transform:d+h}),(0,a.V7)(r.querySelector(".e-table"),{transform:d+0+"px)"}),this.renderModule.isOverflows||(s=this.renderModule.calculateColWidth(this.pivotColumns.length)*e.columnCount-3*e.columnCount),(0,a.le)(this.resizedValue)||(this.element.querySelector(".e-frozenscrollbar").style.width=this.resizedValue+"px"),this.grid.element.querySelector(".e-movablechild").style.width=s+(o.parentElement.offsetWidth-o.parentElement.clientWidth)+"px";let c=this.pageSettings.columnSize*("pivot"===this.dataType&&"column"===this.dataSourceSettings.valueAxis?this.dataSourceSettings.values.length:1)*this.gridSettings.columnWidth,p=n.scrollWidth-(n.scrollLeft+n.offsetWidth);if(this.virtualscrollModule&&c>0&&p<=c){this.virtualDiv.style.display="none";let e=o.scrollWidth-(o.scrollLeft+o.offsetWidth);this.virtualDiv.style.display="";let t=o.scrollWidth-(o.scrollLeft+o.offsetWidth);this.scrollPosObject.horizontalSection-=this.isHScrollEnd?e>p?e:-t:t===e?e-p:e<t&&(p===t||p>e)?-(t-e):0,d=n.scrollLeft>this.scrollerBrowserLimit?o.querySelector("."+An).style.transform.split(",")[0].trim()+",":"translate("+-(n.scrollLeft*this.horizontalScrollScale-this.scrollPosObject.horizontalSection-n.scrollLeft)+"px,",(0,a.V7)(o.querySelector(".e-table"),{transform:d+h}),(0,a.V7)(r.querySelector(".e-table"),{transform:d+0+"px)"}),this.isHScrollEnd=!1}this.grid.contentModule.setHeightToContent("auto"!==this.grid.height?this.virtualDiv.offsetHeight+t.clientHeight:this.element.querySelector(".e-frozencontent ."+An).offsetHeight)}"Chart"!==this.currentView&&this.grid.hideScroll(),this.showGroupingBar?(this.element.style.minWidth="400px",this.grid.element.style.minWidth="400px"):(this.element.style.minWidth="310px",this.grid.element.style.minWidth="310px")}if(this.unwireEvents(),this.wireEvents(),this.isChartLoaded=!1,this.cellTemplate&&(0,a.xr)()){let e=Object.keys(this.gridCellCollection);if(e.length>0){for(let t of e){let e={},i=this.gridCellCollection[t],s=Number(i.getAttribute("aria-colindex")),o=Number(i.getAttribute("index")),l=this.pivotValues[o][s];e.axis=l.axis,"column"===e.axis||"row"===e.axis?(e.fieldName=l.valueSort.axis,e.formattedText=l.formattedText):(e.fieldName=l.actualText,e.formattedText=l.formattedText,e.value=l.value),e.rowHeaders=l.rowHeaders,e.columnHeaders=l.columnHeaders,e.rowIndex=l.rowIndex,e.columnIndex=l.colIndex,e.isGrandTotal=l.isGrandSum,e.isTotal=l.isSum,e.rowSpan=l.rowSpan,e.columnSpan=l.colSpan,e.isDrilled=l.isDrilled,e.hasChild=l.hasChild,e.valueSortInfo=l.valueSort;let r=this.getCellTemplate()(e,this,"cellTemplate",this.element.id+"_cellTemplate");r&&""!==r&&r.length>0&&this.appendHtml(i,this.enableHtmlSanitizer?a.pJ.sanitize(r[0].outerHTML):r[0].outerHTML)}(0,a.tx)(this.element.id+"_cellTemplate","CellTemplate",this)}}}setToolTip(e){let t,i,s=Number(e.target.getAttribute("aria-colindex")),o=Number(e.target.getAttribute("index")),l=this.dataSourceSettings.values.length>0&&this.pivotValues&&this.pivotValues[o]&&this.pivotValues[o][s]?this.pivotValues[o][s]:void 0;this.tooltip.content="";let a=!1;if(l&&"olap"===this.dataType){if(this.olapEngineModule.fieldList[l.actualText]){let e=this.olapEngineModule.fieldList[l.actualText];t=e.isCalculatedField?e.type:e.aggregateType,i=this.olapEngineModule.dataFields[l.actualText]&&this.olapEngineModule.dataFields[l.actualText].caption?this.olapEngineModule.dataFields[l.actualText].caption:e.caption,a=!0}}else if(l&&this.engineModule.fieldList[l.actualText]){let e=this.engineModule.fieldList[l.actualText];t=e.aggregateType,i=e.caption,a=!0}if(l&&a){let e=this.getRowText(o,0),a=this.getColText(0,s,o),r="0"===l.formattedText||""===l.formattedText?this.localeObj.getConstant("noValue"):l.formattedText;if(this.tooltipTemplate&&void 0!==this.getTooltipTemplate()){let l={rowHeaders:e,columnHeaders:a,aggregateType:t,valueField:i,value:r,rowFields:this.getHeaderField(o,s,"row"),columnFields:this.getHeaderField(o,s,"column")};this.tooltip.content=this.getTooltipTemplate()(l,this,"tooltipTemplate",this.element.id+"tooltipTemplate")[0].outerHTML}else this.tooltip.content="<div class=e-pivottooltip><p class=e-tooltipheader>"+this.localeObj.getConstant("row")+":</p><p class=e-tooltipcontent>"+e+"</p></br><p class=e-tooltipheader>"+this.localeObj.getConstant("column")+":</p><p class=e-tooltipcontent>"+a+"</p></br>"+(""!==l.actualText?"<p class=e-tooltipheader>"+("olap"===this.dataType?"":this.localeObj.getConstant(t)+" "+this.localeObj.getConstant("of")+" ")+i+":</p><p class=e-tooltipcontent>"+r+"</p></div>":"")}else e.cancel=!0}getTooltipTemplate(){return this.tooltipTemplateFn}getHeaderField(e,t,i){let s,o="",l="olap"===this.dataType?this.olapEngineModule:this.engineModule,a=l.valueSortSettings.headerDelimiter;if("row"===i){s=this.pivotValues[e][0].valueSort.levelName.toString().split(a).length;for(let e=0;e<s&&l.rows.length>0&&l.rows[e];e++)o+=(e?" - ":"")+(l.rows[e].caption?l.rows[e].caption:l.rows[e].name)}else{if(l.columns.length>0){let e=0===l.values.length?0:Number(Object.keys(l.headerContent)[Object.keys(l.headerContent).length-1]);s=this.pivotValues[e][t].valueSort.levelName.toString().split(a).length,s=l.values.length>1?s-1:s}for(let e=0;e<s&&l.columns.length>0&&l.columns[e];e++)o+=(e?" - ":"")+(l.columns[e].caption?l.columns[e].caption:l.columns[e].name)}return o}getRowText(e,t){let i=this.pivotValues[e][t],s=i.level,o="grand sum"===i.type?this.localeObj.getConstant("grandTotal"):i.formattedText;for(;s>0||void 0===i.index;)e--,i=this.pivotValues[e][t],void 0!==i.index&&s>i.level&&(o=o+" - "+i.formattedText,s-=1);return o.split(" - ").reverse().join(" - ")}getColText(e,t,i){let s=this.pivotValues[0][t],o=s.axis,l="grand sum"===s.type?this.localeObj.getConstant("grandTotal"):s.formattedText;for(;"value"!==o&&i>e;)e++,this.pivotValues[e]&&(s=this.pivotValues[e][t],o=s.axis,"sum"!==s.type&&"grand sum"!==s.type&&"value"!==o&&(l=l+" - "+s.formattedText));return l}updateClass(){this.enableRtl?(0,a.cn)([this.element],Hr):(0,a.IV)([this.element],Hr),this.isAdaptive?(0,a.cn)([this.element],qr):(0,a.IV)([this.element],qr)}mouseRclickHandler(e){(3===e.which||0===e.which)&&(this.lastCellClicked=e.target),this.lastCellClicked=e.target}mouseDownHandler(e){if(3===e.which&&(this.lastCellClicked=e.target),this.isCellBoxMultiSelection){this.isMouseDown=!0,this.isMouseUp=!1;let t=this.parentAt(e.target,"TH");this.clearSelection(t,e,Number(t.getAttribute("aria-colindex")),Number(t.getAttribute("index"))),this.lastSelectedElement=void 0}}mouseMoveHandler(e){if(this.isCellBoxMultiSelection&&(e.preventDefault(),this.isMouseDown&&e.target)){let t=this.parentAt(e.target,"TH");this.lastSelectedElement&&this.lastSelectedElement!==t&&t.classList.contains(sh)?(this.lastSelectedElement.classList.remove(ah),this.lastSelectedElement.classList.remove(sh),this.lastSelectedElement=t):(this.lastSelectedElement=t,t.classList.add(ah),t.classList.add(sh)),this.renderModule.selected()}}mouseUpHandler(e){this.isCellBoxMultiSelection&&(this.isMouseDown=!1,this.isMouseUp=!0)}parentAt(e,t){for(;e.tagName!==t&&e.parentElement;)e=e.parentElement;return e}mouseClickHandler(e){(3===e.which||0===e.which)&&(this.lastCellClicked=e.target);let t=e.target;if((t.classList.contains("e-headercell")||t.classList.contains("e-headercelldiv")||t.classList.contains("e-rowsheader")||t.classList.contains("e-rowcell")||t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-headertext")||t.classList.contains("e-ascending")||t.classList.contains("e-descending"))&&this.enableValueSorting&&"pivot"===this.dataType){let i=null;if(t.classList.contains("e-headercell")||t.classList.contains("e-rowsheader")||t.classList.contains("e-rowcell")?i=t:t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-headercelldiv")||t.classList.contains("e-ascending")||t.classList.contains("e-descending")?i=t.parentElement:t.classList.contains("e-headertext")&&(i=t.parentElement.parentElement),this.CellClicked(t,e),i.parentElement.parentElement.parentElement.parentElement.classList.contains("e-movableheader")&&"column"===this.dataSourceSettings.valueAxis||i.parentElement.classList.contains("e-row")&&"row"===this.dataSourceSettings.valueAxis&&(i.classList.contains("e-rowsheader")||i.classList.contains("e-stot"))){let e=Number(i.getAttribute("aria-colindex")),t=Number(i.getAttribute("index"));"row"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)?t="value"===this.pivotValues[t][e].type?t:t+1:"column"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)&&(e=Number(i.getAttribute("aria-colindex"))+Number(i.getAttribute("aria-colspan"))-1,t=this.engineModule.headerContent.length-1),this.setProperties({dataSourceSettings:{valueSortSettings:{columnIndex:Number(i.getAttribute("aria-colindex"))+Number(i.getAttribute("aria-colspan"))-1,sortOrder:"Descending"===this.dataSourceSettings.valueSortSettings.sortOrder?"Ascending":"Descending",headerText:this.pivotValues[t][e].valueSort.levelName,headerDelimiter:this.dataSourceSettings.valueSortSettings.headerDelimiter?this.dataSourceSettings.valueSortSettings.headerDelimiter:"."}}},!0),this.showWaitingPopup();let s=this;if(s.engineModule.enableValueSorting=!0,s.enableVirtualization){if(s.dataSourceSettings.enableSorting){for(let e of Object.keys(s.engineModule.fieldList))s.engineModule.fieldList[e].sort="Ascending";s.setProperties({dataSourceSettings:{sortSettings:[]}},!0)}(0,a.xr)()?s.interopAdaptor.invokeMethodAsync("PivotInteropMethod","applyValueSorting",{valueSortSettings:s.dataSourceSettings.valueSortSettings.properties}).then(e=>{s.updateBlazorData(e,s),s.allowServerDataBinding=!1,s.setProperties({pivotValues:s.engineModule.pivotValues},!0),delete s.bulkChanges.pivotValues,s.allowServerDataBinding=!0,s.renderPivotGrid()}):"Server"===s.dataSourceSettings.mode?s.getEngine("onValueSort",null,null,null,null,null,null):(s.engineModule.rMembers=s.engineModule.headerCollection.rowHeaders,s.engineModule.cMembers=s.engineModule.headerCollection.columnHeaders,s.engineModule.applyValueSorting(),s.engineModule.updateEngine())}else"Server"===s.dataSourceSettings.mode?s.getEngine("onValueSort",null,null,null,null,null,null):s.engineModule.generateGridData(s.dataSourceSettings);(0,a.xr)()&&s.enableVirtualization||(s.allowServerDataBinding=!1,s.setProperties({pivotValues:s.engineModule.pivotValues},!0),delete s.bulkChanges.pivotValues,s.allowServerDataBinding=!0,s.renderPivotGrid())}}else{if(!t.classList.contains(Tn)&&!t.classList.contains(Ln))return void this.CellClicked(t,e);this.onDrill(t)}}updateTotColWidth(){this.totColWidth=0;for(let e of this.pivotColumns)this.totColWidth=this.totColWidth+e.width}framePivotColumns(e){for(let t of e)if(t.columns&&t.columns.length>0)this.framePivotColumns(t.columns);else{let e="0.formattedText"===t.field?"":t.customAttributes?t.customAttributes.cell.valueSort.levelName:"",i=this.renderModule.setSavedWidth("0.formattedText"===t.field?t.field:e,Number("auto"===t.width?t.minWidth:t.width));this.pivotColumns.push({allowReordering:t.allowReordering,allowResizing:t.allowResizing,headerText:e,width:i}),this.totColWidth=this.totColWidth+Number(i)}}setGridColumns(e){if(!(0,a.le)(this.totColWidth)&&this.totColWidth>0){for(let t of e)if(t.columns&&t.columns.length>0)this.setGridColumns(t.columns);else{let e="0.formattedText"===t.field?"":t.customAttributes?t.customAttributes.cell.valueSort.levelName:"";t.allowReordering=this.pivotColumns[this.posCount].allowReordering,t.allowResizing=this.pivotColumns[this.posCount].allowResizing;let i=this.renderModule.setSavedWidth("0.formattedText"===t.field?t.field:e,Number(this.pivotColumns[this.posCount].width));"auto"!==t.width?t.width=i:t.minWidth=i,this.posCount++,t.allowReordering&&(this.gridSettings.allowReordering=!0),t.allowResizing&&(this.gridSettings.allowResizing=!0)}this.gridSettings.allowReordering&&h.rjZ.Inject(h.tmU),this.gridSettings.allowResizing&&h.rjZ.Inject(h.t$0)}}fillGridColumns(e){for(let t of e)t.allowReordering=this.gridSettings.allowReordering,t.allowResizing=this.gridSettings.allowResizing,this.posCount++,t.columns&&t.columns.length>0&&this.fillGridColumns(t.columns)}triggerColumnRenderEvent(e){this.pivotColumns=[],this.totColWidth=0,this.framePivotColumns(e);let t=this.pivotColumns[0].width,i={columns:this.pivotColumns,dataSourceSettings:this.dataSourceSettings};this.trigger("beforeColumnsRender",i),this.enableVirtualization&&i.columns.length>0&&i.columns[0].width!==e[0].width&&(this.element.querySelector(".e-frozenscrollbar").style.width=Number(i.columns[0].width.toString().split("px")[0])+"px"),this.updateTotColWidth(),t!==this.pivotColumns[0].width&&(this.firstColWidth=this.pivotColumns[0].width,this.renderModule.resColWidth=parseInt(this.firstColWidth.toString())),this.posCount=0,this.setGridColumns(e)}setCommonColumnsWidth(e,t){for(let i of e)"0.formattedText"!==i.field?i.columns?this.setCommonColumnsWidth(i.columns,t):"auto"!==i.width?i.width=t:i.minWidth=t:i.width=this.firstColWidth?this.firstColWidth:i.width}getHeightAsNumber(){let e;return isNaN(this.height)?this.height.toString().indexOf("%")>-1?e=parseFloat(this.height.toString())/100*this.element.offsetHeight:this.height.toString().indexOf("px")>-1&&(e=Number(this.height.toString().split("px")[0])):e=Number(this.height),e<this.minHeight&&(e=this.minHeight),e}getWidthAsNumber(){let e;return isNaN(this.width)?(this.width.toString().indexOf("%")>-1?e=parseFloat(this.width.toString())/100*this.element.offsetWidth:this.width.toString().indexOf("px")>-1&&(e=Number(this.width.toString().split("px")[0])),isNaN(e)&&(e=this.element.offsetWidth)):e=Number(this.width),e<400&&(e=400),e}getGridWidthAsNumber(){let e,t=this.element.offsetWidth?this.element.offsetWidth:this.element.getBoundingClientRect().width;return isNaN(this.grid.width)?(this.grid.width.toString().indexOf("%")>-1?e=parseFloat(this.grid.width.toString())/100*t:this.grid.width.toString().indexOf("px")>-1&&(e=Number(this.grid.width.toString().split("px")[0])),isNaN(e)&&(e=t)):e=Number(this.grid.width),e}onWindowResize(){clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.layoutRefresh.bind(this),500)}refresh(){(0,a.xr)()?this.layoutRefresh():this.pivotRefresh()}layoutRefresh(){if(this.element&&this.element.classList.contains("e-pivotview")&&("olap"===this.dataType?this.olapEngineModule&&this.olapEngineModule.pivotValues:this.engineModule&&this.engineModule.pivotValues)){if(this.grid){let e=this.renderModule.resizeColWidth("olap"===this.dataType&&this.olapEngineModule.pivotValues.length>0?this.olapEngineModule.pivotValues[0].length:this.dataSourceSettings.values.length>0&&this.engineModule.pivotValues.length>0?this.engineModule.pivotValues[0].length:2);this.grid.width=this.renderModule.calculateGridWidth(),this.renderModule.calculateGridHeight(!0),this.gridSettings.allowAutoResizing&&this.setCommonColumnsWidth(this.grid.columns,e),this.pivotColumns=[],this.totColWidth=0,this.framePivotColumns(this.grid.columns),this.posCount=0,this.showGroupingBar||this.setGridColumns(this.grid.columns),"Table"===this.currentView&&this.cellTemplate&&(0,a.xr)()&&(0,a.oL)(this.element.id+"_cellTemplate","CellTemplate"),this.grid.refreshColumns(),this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector(".e-grouping-bar")&&this.groupingBarModule.setGridRowWidth()}this.showToolbar&&this.toolbarModule&&this.toolbarModule.toolbar&&(this.toolbarModule.toolbar.width=this.grid?this.getGridWidthAsNumber()-2:this.getWidthAsNumber()-2),this.chart&&(this.showToolbar&&"Chart"===this.currentView||!this.showToolbar)&&(this.chart.width=this.showToolbar&&this.grid||"Both"===this.displayOption.view&&this.grid?this.getGridWidthAsNumber().toString():this.getWidthAsNumber().toString(),"Chart"===this.displayOption.view&&this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector(".e-chart-grouping-bar")&&this.groupingBarModule.refreshUI())}}CellClicked(e,t){let i=null;if(e.classList.contains("e-headercell")||e.classList.contains("e-rowcell")?i=e:e.classList.contains("e-stackedheadercelldiv")||e.classList.contains("e-cellvalue")||e.classList.contains("e-headercelldiv")?i=e.parentElement:e.classList.contains("e-headertext")?i=e.parentElement.parentElement:e.classList.contains("e-rowselect")&&(this.isPopupClicked=!e.classList.contains(rh)),i&&!(0,a.le)(this.pivotValues)&&this.pivotValues.length>0){let e=Number(i.getAttribute("aria-colindex")),s=Number(i.getAttribute("index")),o=Number(i.getAttribute("aria-colspan"));this.trigger(Tr,{cancel:!1,isCellClick:!0,currentCell:i,data:this.pivotValues[s][e]},l=>{this.gridSettings.allowSelection&&(("Both"===this.gridSettings.selectionSettings.mode?i.classList.contains(lh):"Row"===this.gridSettings.selectionSettings.mode)?this.clearSelection(i,t,e,s):(this.clearSelection(i,t,e,s),l.cancel||this.applyColumnSelection(t,i,e,e+(o>0?o-1:0),s)),"Column"===this.gridSettings.selectionSettings.mode||i.classList.contains(Dn)||this.rowDeselect(i,t,s,this.gridSettings.selectionSettings.mode,l),"Column"===this.gridSettings.selectionSettings.mode||l.cancel||(("Multiple"===this.gridSettings.selectionSettings.type?t.ctrlKey||t.shiftKey:this.selectedRowIndex===s)?this.selectedRowIndex=void 0:(this.selectedRowIndex=s,this.grid.selectionModule.selectRow(s-this.renderModule.rowStartPos)))),this.cellClick&&l.isCellClick&&this.trigger("cellClick",{currentCell:i,data:this.pivotValues[s][e],nativeEvent:t}),this.getSelectedCellsPos()})}}rowDeselect(e,t,i,s,o){!t.shiftKey&&!t.ctrlKey&&"Both"!==this.gridSettings.selectionSettings.mode||"Single"===this.gridSettings.selectionSettings.type?e.classList.contains(ih)||e.classList.contains(sh)||e.classList.contains(ah)?((0,a.IV)(this.element.querySelectorAll("."+ih),ih),(0,a.IV)(this.element.querySelectorAll("."+sh),sh),(0,a.IV)(this.element.querySelectorAll(".e-active"),ah),o.cancel?this.setSavedSelectedCells():"Cell"===s?(0,a.cn)([e],[ih]):"Row"!==s&&"Single"!==this.gridSettings.selectionSettings.type||((0,a.cn)(this.element.querySelectorAll('[index="'+i+'"]'),[sh,ah]),"Row"!==s&&e.classList.add(ih))):o.cancel?this.setSavedSelectedCells():((0,a.IV)(this.element.querySelectorAll("."+ih),ih),(0,a.IV)(this.element.querySelectorAll("."+sh),sh),(0,a.IV)(this.element.querySelectorAll(".e-active"),ah)):(t.shiftKey||t.ctrlKey||"Both"==this.gridSettings.selectionSettings.mode)&&o.cancel&&((0,a.IV)(this.element.querySelectorAll("."+ih),ih),(0,a.IV)(this.element.querySelectorAll("."+sh),sh),(0,a.IV)(this.element.querySelectorAll(".e-active"),ah),this.setSavedSelectedCells())}clearSelection(e,t,i,s){if(!t.shiftKey&&!t.ctrlKey||"Single"===this.gridSettings.selectionSettings.type)if("Cell"===this.gridSettings.selectionSettings.mode)e.classList.contains(Dn)?(0,a.IV)(this.element.querySelectorAll(".e-rowcell."+ih),ih):(0,a.IV)(this.element.querySelectorAll(".e-columnsheader.e-active"),[ah,sh]);else if("Both"===this.gridSettings.selectionSettings.mode)if(e.classList.contains(lh))for(let o of[].slice.call(this.element.querySelectorAll("."+sh+", ."+ih)))(0,a.IV)([o],[ah,sh,ih]);else(0,a.IV)(this.element.querySelectorAll("."+ih),ih)}applyRowSelection(e,t,i){let s=this.engineModule.pivotValues[t][e];if(i.ctrlKey||i.shiftKey||!s||this.selectedRowIndex===t)this.selectedRowIndex=void 0;else{this.selectedRowIndex=t;let i=s.level,o=t;do{o++,s=this.engineModule.pivotValues[o][e]}while(s&&i<s.level);let l=this;this.isAdaptive?this.rowRangeSelection={enable:!0,startIndex:t-l.renderModule.rowStartPos,endIndex:o-(1+l.renderModule.rowStartPos)}:l.grid.selectionModule.selectRowsByRange(t-l.renderModule.rowStartPos,o-(1+l.renderModule.rowStartPos))}}applyColumnSelection(e,t,i,s,o){if(!t.classList.contains(Rn)&&("Cell"!==this.gridSettings.selectionSettings.mode||t.classList.contains(Dn))){let l=e.ctrlKey;this.isAdaptive&&"Multiple"===this.gridSettings.selectionSettings.type&&(this.grid.selectionModule.showPopup(e),this.isPopupClicked?(this.element.querySelector(".e-rowselect").classList.add(rh),l=!0):(this.element.querySelector(".e-rowselect").classList.remove(rh),l=!1));let r=[],n=this.gridSettings.selectionSettings.type,h=t.classList.contains(ah),d=[],c={};for(let e=i;e<=s;e++)d.push(e.toString());if(l&&"Single"!==n)h=!1;else{for(let e of[].slice.call(this.element.querySelectorAll(".e-active"))){(0,a.IV)([e],[ah,sh]),-1===d.indexOf(e.getAttribute("aria-colindex"))&&(h=!1);let t=Number(e.getAttribute("aria-colindex"));c[t]=t}d=Object.keys(c).length>0?Object.keys(c).sort(function(e,t){return e-t}):d}"Multiple"===n&&e.shiftKey?(this.shiftLockedPos=0===this.shiftLockedPos.length?d:this.shiftLockedPos,Number(this.shiftLockedPos[0])<=i?i=Number(this.shiftLockedPos[0]):s=s<Number(this.shiftLockedPos[this.shiftLockedPos.length-1])?Number(this.shiftLockedPos[this.shiftLockedPos.length-1]):s):this.shiftLockedPos=[];let p=[];if(e.ctrlKey&&"Both"===this.gridSettings.selectionSettings.mode&&"Multiple"===n&&!t.classList.contains(Rn))for(let e of[].slice.call(this.element.querySelectorAll(".e-rowsheader."+ih)))p.push(e.getAttribute("index"));let u=i;for(;u<=s;)r.push('[aria-colindex="'+u+'"]'+("Cell"===this.gridSettings.selectionSettings.mode?'[index="'+o+'"]':"")),u++;if(!h){o=t.classList.contains("e-headercell")?o:this.renderModule.rowStartPos-1;let e=t.classList.contains(ah);for(let t of[].slice.call(this.element.querySelectorAll(r.toString())))Number(t.getAttribute("index"))>=o&&(e&&l&&-1===p.indexOf(t.getAttribute("index"))?(0,a.IV)([t],[ah,sh]):(0,a.cn)([t],[ah,sh]))}this.renderModule.selected()}}getSelectedCellsPos(){let e=this;e.savedSelectedCellsPos=[],e.cellSelectionPos=[];for(let t of[].slice.call(this.element.querySelectorAll("."+sh)))e.savedSelectedCellsPos.push({rowIndex:t.getAttribute("index"),colIndex:t.getAttribute("aria-colindex")});for(let t of[].slice.call(this.element.querySelectorAll("."+ih)))e.cellSelectionPos.push({rowIndex:t.getAttribute("index"),colIndex:t.getAttribute("aria-colindex")})}setSavedSelectedCells(){let e=this;for(let t of[].slice.call(this.savedSelectedCellsPos))(0,a.cn)([e.element.querySelector('[aria-colindex="'+t.colIndex+'"][index="'+t.rowIndex+'"]')],[ah,sh]);for(let t of[].slice.call(this.cellSelectionPos))(0,a.cn)([e.element.querySelector('[aria-colindex="'+t.colIndex+'"][index="'+t.rowIndex+'"]')],[ih])}renderEmptyGrid(){if(this.isEmptyGrid=!0,this.notEmpty=!1,this.isInitial=!0,this.renderModule=new yh(this),this.grid&&this.grid.element&&this.element.querySelector(".e-grid"))this.notEmpty=!0,this.grid.setProperties({columns:this.renderModule.frameEmptyColumns(),dataSource:this.renderModule.frameEmptyData()},!0),this.grid.notify("datasource-modified",{}),this.grid.refreshColumns();else{this.element.querySelector(".e-grid")&&(0,a.Od)(this.element.querySelector(".e-grid")),this.renderModule.bindGrid(this,!0),this.grid.showSpinner=()=>{},this.grid.hideSpinner=()=>{};let e=(0,a.az)("div",{id:this.element.id+"_grid"});this.element.appendChild(e),this.grid.isStringTemplate=!0,this.grid.appendTo(e),this.grid.on("refresh-frozen-height",()=>{this.enableVirtualization||this.grid.contentModule.setHeightToContent(this.grid.contentModule.getTable().offsetHeight)}),this.grid.off("data-ready",this.grid.dataReady),this.grid.on("data-ready",()=>{this.grid.scrollModule.setWidth(),this.grid.scrollModule.setHeight()})}}initEngine(){if("pivot"===this.dataType){let e=(0,a.le)(this.dataSourceSettings.dataSource)?(0,a.le)(this.engineModule.data)?void 0:this.engineModule.data[0]:this.dataSourceSettings.dataSource[0];if(e&&this.pivotCommon){let t="[object Array]"==Object.prototype.toString.call(e);if(t&&"JSON"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidJSON"));if(!t&&"CSV"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidCSV"))}}let e={dataSourceSettings:br.getClonedDataSourceSettings(this.dataSourceSettings)};this.trigger(vr,e,e=>{br.updateDataSourceSettings(this,e.dataSourceSettings),this.updatePageSettings(!1);let t={mode:"",savedFieldList:void 0,pageSettings:this.pageSettings,enableValueSorting:this.enableValueSorting,isDrillThrough:this.allowDrillThrough||this.editSettings.allowEditing,localeObj:this.localeObj,fieldsType:this.fieldsType,clonedReport:this.clonedReport};if("pivot"===this.dataType){if(this.dataSourceSettings.groupSettings&&this.dataSourceSettings.groupSettings.length>0){let e=this.engineModule.data;if(this.clonedDataSet=this.clonedDataSet?this.clonedDataSet:br.getClonedData(e),(0,a.xr)())this.clonedReport=this.clonedReport?this.clonedReport:(0,a.l7)({},this.dataSourceSettings,null,!0);else{let e=JSON.parse(this.getPersistData()).dataSourceSettings;e.dataSource=[],this.clonedReport=this.clonedReport?this.clonedReport:e}}if((0,a.xr)()&&this.enableVirtualization){let e=this,i="sfBlazor",s=window[i].copyWithoutCircularReferences([t],t),o=window[i].copyWithoutCircularReferences([e.dataSourceSettings],e.dataSourceSettings);e.interopAdaptor.invokeMethodAsync("PivotInteropMethod","renderEngine",{dataSourceSettings:o,customProperties:s}).then(t=>{0!==t?(e.updateBlazorData(t,e),br.setPivotProperties(e,{pivotValues:e.engineModule.pivotValues}),e.enginePopulatedEventMethod("initEngine",e)):this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("CSV"===e.dataSourceSettings.type?"invalidCSV":"invalidJSON"))})}else"Server"!==this.dataSourceSettings.mode&&this.engineModule.renderEngine(this.dataSourceSettings,t,this.getValueCellInfo.bind(this)),this.allowServerDataBinding=!1,this.setProperties({pivotValues:this.engineModule.pivotValues},!0),delete this.bulkChanges.pivotValues,this.allowServerDataBinding=!0,this.enginePopulatedEventMethod("initEngine")}else"SSAS"===this.dataSourceSettings.providerType&&"olap"===this.dataType&&(t.savedFieldList=this.olapEngineModule.fieldList,t.savedFieldListData=this.olapEngineModule.fieldListData,this.olapEngineModule.renderEngine(this.dataSourceSettings,t),this.allowServerDataBinding=!1,this.setProperties({pivotValues:this.olapEngineModule.pivotValues},!0),delete this.bulkChanges.pivotValues,this.allowServerDataBinding=!0,this.enginePopulatedEventMethod("initEngine"))})}enginePopulatedEventMethod(e,t){if("initEngine"===e){const e=t||this;this.trigger(Sr,{pivotValues:this.pivotValues},t=>{"olap"===e.dataType?(e.olapEngineModule.pivotValues=(0,a.xr)()?this.olapEngineModule.pivotValues:t.pivotValues,e.pivotValues=e.olapEngineModule.pivotValues):(e.engineModule.pivotValues=(0,a.xr)()?this.engineModule.pivotValues:t.pivotValues,e.pivotValues=e.engineModule.pivotValues),e.notify(zr,{}),e.notEmpty=!0})}else{let e=t||this,i={dataSourceSettings:e.dataSourceSettings,pivotValues:(0,a.xr)()?"olap"===e.dataType?e.olapEngineModule.pivotValues:e.engineModule.pivotValues:e.pivotValues};e.trigger(Sr,i,t=>{let i=e.dataSourceSettings.dataSource;(0,a.xr)()&&t.dataSourceSettings.dataSource instanceof Object&&(t.dataSourceSettings.dataSource=i),e.dataSourceSettings=t.dataSourceSettings,"olap"===e.dataType?(e.olapEngineModule.pivotValues=(0,a.xr)()?e.olapEngineModule.pivotValues:t.pivotValues,e.allowServerDataBinding=!1,e.setProperties({pivotValues:e.olapEngineModule.pivotValues},!0),delete e.bulkChanges.pivotValues,e.allowServerDataBinding=!0):(e.engineModule.pivotValues=(0,a.xr)()?e.engineModule.pivotValues:t.pivotValues,e.allowServerDataBinding=!1,e.setProperties({pivotValues:e.engineModule.pivotValues},!0),delete e.bulkChanges.pivotValues,e.allowServerDataBinding=!0),e.pivotCommon.engineModule="olap"===e.dataType?e.olapEngineModule:e.engineModule,e.pivotCommon.dataSourceSettings=e.dataSourceSettings,e.renderPivotGrid()})}}updateBlazorData(e,t){let i,s,o,l;t.allowServerDataBinding=!1;let a=t,r=[],n=[];s=JSON.parse(e.fieldList),i=JSON.parse(e.pivotValue),o=JSON.parse(e.fields),l=JSON.parse(e.valueSortSettings);let h=i.length,d=JSON.parse(i[0]).length;var c=new Array(h);for(p=0;p<h;p++)c[p]=new Array(d);for(var p=0;p<h;p++)if(null!=i[p]){let e=JSON.parse(i[p]),t=e.length;for(let i=0;i<t;i++)c[p][i]=e[i]}else c[p]=void 0;let u,g=c;for(let m=0;m<g.length;m++)if(g[m]&&g[m][0]&&"row"===g[m][0].axis){u=m;break}a.pivotValues=c,r=br.frameContent(c,"value",u,a),n=br.frameContent(c,"header",u,a),this.engineModule.pivotValues=c,this.engineModule.fieldList=s,this.engineModule.fields=o,this.engineModule.valueSortSettings=l,this.engineModule.valueContent=r,this.engineModule.headerContent=n,this.engineModule.isEngineUpdated=JSON.parse(e.isEngineUpdated),this.engineModule.isEmptyData=JSON.parse(e.isEmptyData),this.engineModule.rowCount=JSON.parse(e.rowCount),this.engineModule.columnCount=JSON.parse(e.columnCount),this.engineModule.rowStartPos=JSON.parse(e.rowStartPos),this.engineModule.colStartPos=JSON.parse(e.colStartPos),this.engineModule.rowFirstLvl=JSON.parse(e.rowFirstLvl),this.engineModule.colFirstLvl=JSON.parse(e.colFirstLvl),t.allowServerDataBinding=!0}generateData(){this.isStaticRefresh||("Chart"!==this.displayOption.view?(this.renderEmptyGrid(),this.showWaitingPopup()):"Chart"===this.displayOption.view&&(this.showWaitingPopup(),clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.refreshData.bind(this),100)))}refreshData(){let e=this;e.isStaticRefresh?(e.isStaticRefresh=!1,e.hideWaitingPopup()):((0,a.xr)()&&"olap"===e.dataType&&e.dataSourceSettings.dataSource instanceof r.hm&&(e.allowServerDataBinding=!1,e.setProperties({dataSourceSettings:{dataSource:void 0}},!0),e.allowServerDataBinding=!0),e.dataSourceSettings&&(e.dataSourceSettings.dataSource||e.dataSourceSettings.url)?e.dataSourceSettings.dataSource instanceof r.hm?(0,a.xr)()&&e.enableVirtualization?(e.element.querySelector(".e-spinner-pane")||this.showWaitingPopup(),e.initEngine()):"pivot"===e.dataType&&e.remoteData.length>0?(this.element.querySelector(".e-spinner-pane")||this.showWaitingPopup(),this.engineModule.data=e.remoteData,this.initEngine()):setTimeout(e.getData.bind(e),100):""!==this.dataSourceSettings.url&&"olap"===this.dataType||e.dataSourceSettings.dataSource&&e.dataSourceSettings.dataSource.length>0||this.engineModule.data.length>0?("pivot"===e.dataType&&(this.hideWaitingPopup(),e.engineModule.data=e.dataSourceSettings.dataSource),e.initEngine()):"Server"===this.dataSourceSettings.mode?this.getEngine("onRefresh"):this.hideWaitingPopup():(0,a.xr)()&&"pivot"===e.dataType&&this.engineModule.data&&this.engineModule.data.length>0?this.initEngine():this.hideWaitingPopup())}getValueCellInfo(e){let t=e;return this.trigger(Dr,t),t}bindTriggerEvents(e){this.trigger((0,h.RKj)("name",e),e)}getData(){(0,a.xr)()?this.dataSourceSettings.dataSource.executeQuery((new r.AE).requiresCount()).then(this.executeQuery.bind(this)):this.dataSourceSettings.dataSource.defaultQuery?this.dataSourceSettings.dataSource.executeQuery(this.dataSourceSettings.dataSource.defaultQuery).then(this.executeQuery.bind(this)):this.dataSourceSettings.dataSource.executeQuery(new r.AE).then(this.executeQuery.bind(this))}executeQuery(e){this.element.querySelector(".e-spinner-pane")||this.showWaitingPopup();let t=this;t.engineModule.data=e.result,!(0,a.le)(t.engineModule.data)&&t.engineModule.data.length>0?t.initEngine():this.hideWaitingPopup()}applyFormatting(e){if(e){let t=[];for(let s=e.length,o=0;o<s;o++)void 0!==e[o]&&void 0===e[o][0]&&t.push(o);for(let s=0;s<e.length;s++)for(let t=1;e[s]&&t<e[s].length;t++)if("value"===e[s][t].axis&&""!==e[s][t].formattedText){e[s][t].style=void 0,e[s][t].cssClass=void 0;let i=this.dataSourceSettings.conditionalFormatSettings;for(let o=0;o<i.length;o++)(!0===i[o].applyGrandTotals||(0,a.le)(i[o].applyGrandTotals)||""!==e[s][t].rowHeaders&&""!==e[s][t].columnHeaders)&&this.checkCondition(e[s][t].value,i[o].conditions,i[o].value1,i[o].value2)&&(i[o].measure&&e[s][t].actualText!==i[o].measure||void 0!==i[o].measure&&""===i[o].measure||void 0!==i[o].label&&""===i[o].label||!(!i[o].label||e[s][0].valueSort.levelName.indexOf(i[o].label)>-1||e[s][t].rowHeaders.indexOf(i[o].label)>-1||e[s][t].columnHeaders.indexOf(i[o].label)>-1)||(i[o].style&&i[o].style.backgroundColor&&(i[o].style.backgroundColor=this.conditionalFormattingModule.isHex(i[o].style.backgroundColor.substr(1))?i[o].style.backgroundColor:this.conditionalFormattingModule.colourNameToHex(i[o].style.backgroundColor)),i[o].style&&i[o].style.color&&(i[o].style.color=this.conditionalFormattingModule.isHex(i[o].style.color.substr(1))?i[o].style.color:this.conditionalFormattingModule.colourNameToHex(i[o].style.color)),e[s][t].style=i[o].style,e[s][t].cssClass="format"+this.element.id+o))}let i=this.dataSourceSettings.conditionalFormatSettings;for(let e=0;e<i.length;e++)this.createStyleSheet.bind(this)().insertRule(".format"+this.element.id+e+"{color: "+i[e].style.color+"!important;background-color: "+i[e].style.backgroundColor+"!important;font-size: "+i[e].style.fontSize+"!important;font-family: "+i[e].style.fontFamily+" !important;}",0)}}createStyleSheet(){let e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}applyHyperlinkSettings(){if(this.pivotValues){let e=this.pivotValues,t=[];for(let i=e.length,s=0;s<i;s++)(0,a.le)(e[s])||void 0!==e[s][0]||t.push(s);if(this.hyperlinkSettings.conditionalSettings.length>0)for(let i=0;i<e.length;i++)for(let s=1;e[i]&&s<e[i].length;s++)if("value"===e[i][s].axis){e[i][s].enableHyperlink=!1;let o=this.hyperlinkSettings.conditionalSettings;for(let l=0;l<o.length;l++)if(this.checkCondition(e[i][s].value,o[l].conditions,o[l].value1,o[l].value2)){let a="row"===this.dataSourceSettings.valueAxis?i:"pivot"===this.dataType?this.engineModule.headerContent.length-1:this.olapEngineModule.headerContent.length-1,r="row"===this.dataSourceSettings.valueAxis?0:s;(!o[l].measure||1===this.dataSourceSettings.values.length||e[a][r].valueSort&&e[a][r].actualText===o[l].measure)&&(!o[l].label||e[t[o[l].label.split(".").length-1]]&&e[t[o[l].label.split(".").length-1]][s]&&e[t[o[l].label.split(".").length-1]][s].valueSort&&e[t[o[l].label.split(".").length-1]][s].valueSort[o[l].label]||e[i][0].valueSort.levelName.indexOf(o[l].label)>-1)&&(e[i][s].enableHyperlink=!0)}}if((0,a.le)(this.hyperlinkSettings.headerText))return;{let i=this.dataSourceSettings.valueSortSettings.headerDelimiter?this.dataSourceSettings.valueSortSettings.headerDelimiter:".";for(let s=0;s<e.length;s++)for(let o=1;e[s]&&o<e[s].length;o++)if("value"===e[s][o].axis){let l=this.hyperlinkSettings.headerText;if(e[s][0].valueSort.levelName.indexOf(l)>-1)e[s][0].enableHyperlink=!0,e[s][o].enableHyperlink=!0;else{let a=!1;for(let s=0;s<t.length;s++)l=i+this.hyperlinkSettings.headerText,(i+e[t[s]][o].valueSort.levelName).indexOf(l)>-1&&(e[t[s]][o].enableHyperlink=!0,a=!0);e[s][o].enableHyperlink=a}}}}}checkCondition(e,t,i,s){switch(t){case"LessThan":return e<i;case"LessThanOrEqualTo":return e<=i;case"GreaterThan":return e>i;case"GreaterThanOrEqualTo":return e>=i;case"Equals":return e===i;case"NotEquals":return e!==i;case"Between":return i<s&&e>=i&&e<=s||i>s&&e<=i&&e>=s;case"NotBetween":return!(i<s&&e>=i&&e<=s||i>s&&e<=i&&e>=s);default:return!1}}updateGroupingReport(e,t){if(!this.clonedDataSet&&!this.clonedReport)if(this.clonedDataSet=br.getClonedData(this.engineModule.data),(0,a.xr)())this.clonedReport=br.getClonedDataSourceSettings(this.dataSourceSettings);else{let e=JSON.parse(this.getPersistData()).dataSourceSettings;e.dataSource=[],this.clonedReport=this.clonedReport?this.clonedReport:e}let i=/_date_group_years|_date_group_quarters|_date_group_quarterYear|_date_group_months|_date_group_days|_date_group_hours|_date_group_minutes|_date_group_seconds/g,s=br.getClonedData(this.clonedDataSet),o=this.dataSourceSettings,l=this.clonedReport.properties?this.clonedReport.properties:this.clonedReport,r=[o.rows,o.columns,o.values,o.filters],n=[o.filterSettings,o.sortSettings,o.formatSettings,o.drilledMembers],h=l.rows;if(h=h.concat(l.columns,l.values,l.filters),0===e.length||e.length>0){this.engineModule.groupingFields={},(0,a.xr)()||this.setProperties({dataSourceSettings:{dataSource:s,groupSettings:e.length>0?o.groupSettings:[]}},!0);let d="Date"===t,c=[];for(let e=0,t=r.length;e<t;e++)for(let s=0,l=r[e].length;s<l;s++){let t=r[e][s].name;-1===c.indexOf(t)&&c.push(t);let n=c.indexOf(t);if(br.getFieldByName(t,o.groupSettings),!(0,a.le)(t.match(i))&&d||-1!==t.indexOf("_custom_group")&&!br.getFieldByName(t.replace("_custom_group",""),o.groupSettings))r[e].splice(s,1),c.splice(n,1),s--,l--;else{let i=br.getFieldByName(t,h);i&&r[e].splice(s,1,i)}}for(let e of c){let t=br.getFilterItemByName(e,l.filterSettings),s=br.getFieldByName(e,l.sortSettings),r=br.getFieldByName(e,l.formatSettings),h=br.getFieldByName(e,l.drilledMembers),c=[t,s,r,h];for(let l=0,p=n.length;l<p;l++){let p=!1;for(let t=0,s=n[l].length;t<s;t++){let r=n[l][t].name;if(!(0,a.le)(r.match(i))&&d||-1!==r.indexOf("_custom_group")&&!br.getFieldByName(r.replace("_custom_group",""),o.groupSettings))n[l].splice(t,1),t--,s--;else if(e===n[l][t].name){p=!0,c[l]?n[l].splice(t,1,c[l]):(n[l].splice(t,1),t--,s--);break}}!p&&0===l&&t&&n[l].push(t),!p&&1===l&&s&&n[l].push(s),!p&&2===l&&r&&n[l].push(r),!p&&3===l&&h&&n[l].push(h)}}(0,a.xr)()&&(this.engineModule.data=s,this.allowServerDataBinding=!1,this.setProperties({dataSourceSettings:{rows:r[0],columns:r[1],values:r[2],filters:r[3],filterSettings:n[0],sortSettings:n[1],formatSettings:n[2],drilledMembers:n[3],groupSettings:e.length>0?o.groupSettings:[]}},!0),this.allowServerDataBinding=!0)}}removeButtonFocus(e){document.querySelectorAll(".e-btn-focused")&&(0,a.IV)(document.querySelectorAll(".e-btn-focused"),"e-btn-focused")}wireEvents(){"Chart"!==this.displayOption.view&&(a.bi.add(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler,this),a.bi.add(this.element,"mousedown",this.mouseDownHandler,this),a.bi.add(this.element.querySelector(".e-gridheader"),"mousemove",this.mouseMoveHandler,this),a.bi.add(this.element,"mouseup",this.mouseUpHandler,this),a.bi.add(this.element,this.isAdaptive?"touchend":"contextmenu",this.mouseRclickHandler,this)),a.bi.add(document,this.isAdaptive?"touchend":"click",this.removeButtonFocus,this),window.addEventListener("resize",this.onWindowResize.bind(this),!0)}unwireEvents(){"Chart"!==this.displayOption.view&&(a.bi.remove(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler),a.bi.remove(this.element,"mousedown",this.mouseDownHandler),this.element.querySelector(".e-gridheader")&&a.bi.remove(this.element.querySelector(".e-gridheader"),"mousemove",this.mouseMoveHandler),a.bi.remove(this.element,"mouseup",this.mouseUpHandler),a.bi.remove(this.element,this.isAdaptive?"touchend":"contextmenu",this.mouseRclickHandler)),a.bi.remove(document,this.isAdaptive?"touchend":"click",this.removeButtonFocus),window.removeEventListener("resize",this.onWindowResize.bind(this),!0)}destroy(){this.removeInternalEvents(),this.engineModule&&(this.engineModule.fieldList={},this.engineModule.rMembers=null,this.engineModule.cMembers=null,this.engineModule.valueMatrix=null,this.engineModule.indexMatrix=null,this.engineModule={}),this.olapEngineModule&&(this.olapEngineModule.fieldList={},this.olapEngineModule={}),this.showGroupingBar&&this.groupingBarModule&&this.groupingBarModule.destroy(),this.allowGrouping&&this.groupingModule&&this.groupingModule.destroy(),this.showToolbar&&this.toolbarModule&&this.toolbarModule.destroy(),this.enableVirtualization&&this.virtualscrollModule&&this.virtualscrollModule.destroy(),this.allowConditionalFormatting&&this.conditionalFormattingModule&&this.conditionalFormattingModule.destroy(),this.allowNumberFormatting&&this.numberFormattingModule&&this.numberFormattingModule.destroy(),this.contextMenuModule&&this.contextMenuModule.destroy(),this.keyboardModule&&this.keyboardModule.destroy(),this.tooltip&&!this.tooltip.isDestroyed&&this.tooltip.destroy(),this.calculatedFieldModule&&this.calculatedFieldModule.destroy(),this.chart&&!this.chart.isDestroyed&&(this.chart.destroy(),this.chart.isDestroyed&&(0,a.Ys)("#"+this.element.id+"_chart",this.element)&&(0,a.Od)((0,a.Ys)("#"+this.element.id+"_chart",this.element))),this.grid&&!this.grid.isDestroyed&&(this.grid.destroy(),this.grid.isDestroyed&&(0,a.Ys)("#"+this.element.id+"_grid",this.element)&&(0,a.Od)((0,a.Ys)("#"+this.element.id+"_grid",this.element))),this.commonModule&&this.commonModule.destroy(),this.chartModule&&this.chartModule.destroy(),this.pivotButtonModule&&!this.pivotButtonModule.isDestroyed&&this.pivotButtonModule.destroy(),this.pivotFieldListModule&&!this.pivotFieldListModule.isDestroyed&&this.pivotFieldListModule.destroy(),this.unwireEvents(),super.destroy(),this.groupingBarModule&&(this.groupingBarModule=null),this.groupingModule&&(this.groupingModule=null),this.pivotFieldListModule&&(this.pivotFieldListModule=null),this.calculatedFieldModule&&(this.calculatedFieldModule=null),this.conditionalFormattingModule&&(this.conditionalFormattingModule=null),this.numberFormattingModule&&(this.numberFormattingModule=null),this.toolbarModule&&(this.toolbarModule=null),this.virtualscrollModule&&(this.virtualscrollModule=null),this.contextMenuModule&&(this.contextMenuModule=null),this.keyboardModule&&(this.keyboardModule=null),this.tooltip&&(this.tooltip=null),this.chart&&(this.chart=null),this.grid&&(this.grid=null),this.commonModule&&(this.commonModule=null),this.chartModule&&(this.chartModule=null),this.pivotButtonModule&&(this.pivotButtonModule=null),this.renderModule&&(this.renderModule=null),this.axisFieldModule&&(this.axisFieldModule=null),this.pdfExportModule&&(this.pdfExportModule=null),this.excelExportModule&&(this.excelExportModule=null),(0,a.xr)()&&this.isServerRendered?(this.element.querySelector(".e-spinner-pane")&&(0,a.Od)(this.element.querySelector(".e-spinner-pane")),this.showFieldList&&(0,a.Ys)("#"+this.element.id+"_PivotFieldList",document)&&(0,a.Od)((0,a.Ys)("#"+this.element.id+"_PivotFieldList",document))):this.element.innerHTML="",(0,a.IV)([this.element],jr),(0,a.IV)([this.element],Hr),(0,a.IV)([this.element],qr)}showNumberFormattingDialog(){this.allowNumberFormatting&&this.numberFormattingModule.showNumberFormattingDialog()}};oc([(0,a.Z9)("USD")],dc.prototype,"currencyCode",void 0),oc([(0,a.Z9)(!1)],dc.prototype,"showFieldList",void 0),oc([(0,a.Zz)({},Hh)],dc.prototype,"gridSettings",void 0),oc([(0,a.Zz)({},ec)],dc.prototype,"chartSettings",void 0),oc([(0,a.Zz)({},lc)],dc.prototype,"groupingBarSettings",void 0),oc([(0,a.Zz)({},nc)],dc.prototype,"hyperlinkSettings",void 0),oc([(0,a.Zz)({},Zh)],dc.prototype,"dataSourceSettings",void 0),oc([(0,a.Zz)({},ac)],dc.prototype,"editSettings",void 0),oc([(0,a.Zz)({},hc)],dc.prototype,"displayOption",void 0),oc([(0,a.Z9)()],dc.prototype,"pivotValues",void 0),oc([(0,a.Z9)(!1)],dc.prototype,"showGroupingBar",void 0),oc([(0,a.Z9)(!0)],dc.prototype,"showTooltip",void 0),oc([(0,a.Z9)(!1)],dc.prototype,"showToolbar",void 0),oc([(0,a.Z9)([])],dc.prototype,"toolbar",void 0),oc([(0,a.Z9)(!1)],dc.prototype,"showValuesButton",void 0),oc([(0,a.Z9)(!1)],dc.prototype,"allowCalculatedField",void 0),oc([(0,a.Z9)(!1)],dc.prototype,"enableValueSorting",void 0),oc([(0,a.Z9)(!1)],dc.prototype,"allowConditionalFormatting",void 0),oc([(0,a.Z9)(!1)],dc.prototype,"allowNumberFormatting",void 0),oc([(0,a.Z9)("auto")],dc.prototype,"height",void 0),oc([(0,a.Z9)("auto")],dc.prototype,"width",void 0),oc([(0,a.Z9)(!1)],dc.prototype,"allowExcelExport",void 0),oc([(0,a.Z9)(!1)],dc.prototype,"enableVirtualization",void 0),oc([(0,a.Z9)(!1)],dc.prototype,"allowDrillThrough",void 0),oc([(0,a.Z9)(!1)],dc.prototype,"allowPdfExport",void 0),oc([(0,a.Z9)(!1)],dc.prototype,"allowDeferLayoutUpdate",void 0),oc([(0,a.Z9)(!1)],dc.prototype,"allowDataCompression",void 0),oc([(0,a.Z9)(1e3)],dc.prototype,"maxNodeLimitInMemberEditor",void 0),oc([(0,a.Z9)(1e4)],dc.prototype,"maxRowsInDrillThrough",void 0),oc([(0,a.Z9)(!0)],dc.prototype,"loadOnDemandInMemberEditor",void 0),oc([(0,a.Z9)(!0)],dc.prototype,"enableHtmlSanitizer",void 0),oc([(0,a.Z9)()],dc.prototype,"cellTemplate",void 0),oc([(0,a.Z9)()],dc.prototype,"toolbarTemplate",void 0),oc([(0,a.Z9)()],dc.prototype,"tooltipTemplate",void 0),oc([(0,a.Z9)()],dc.prototype,"spinnerTemplate",void 0),oc([(0,a.Z9)(!1)],dc.prototype,"allowGrouping",void 0),oc([(0,a.Z9)(!0)],dc.prototype,"exportAllPages",void 0),oc([(0,a.Z9)(["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"])],dc.prototype,"aggregateTypes",void 0),oc([(0,a.Z9)(["Column","Bar","Line","Area","Scatter","Polar","StackingColumn","StackingArea","StackingBar","StepLine","StepArea","SplineArea","Spline","StackingColumn100","StackingBar100","StackingArea100","Bubble","Pareto","Radar","Pie","Doughnut","Funnel","Pyramid"])],dc.prototype,"chartTypes",void 0),oc([(0,a.ju)()],dc.prototype,"queryCellInfo",void 0),oc([(0,a.ju)()],dc.prototype,"headerCellInfo",void 0),oc([(0,a.ju)()],dc.prototype,"resizing",void 0),oc([(0,a.ju)()],dc.prototype,"resizeStop",void 0),oc([(0,a.ju)()],dc.prototype,"pdfHeaderQueryCellInfo",void 0),oc([(0,a.ju)()],dc.prototype,"pdfQueryCellInfo",void 0),oc([(0,a.ju)()],dc.prototype,"excelHeaderQueryCellInfo",void 0),oc([(0,a.ju)()],dc.prototype,"excelQueryCellInfo",void 0),oc([(0,a.ju)()],dc.prototype,"columnDragStart",void 0),oc([(0,a.ju)()],dc.prototype,"columnDrag",void 0),oc([(0,a.ju)()],dc.prototype,"columnDrop",void 0),oc([(0,a.ju)()],dc.prototype,"beforePdfExport",void 0),oc([(0,a.ju)()],dc.prototype,"beforeExcelExport",void 0),oc([(0,a.ju)()],dc.prototype,"beforeColumnsRender",void 0),oc([(0,a.ju)()],dc.prototype,"selected",void 0),oc([(0,a.ju)()],dc.prototype,"cellDeselected",void 0),oc([(0,a.ju)()],dc.prototype,"rowSelected",void 0),oc([(0,a.ju)()],dc.prototype,"rowDeselected",void 0),oc([(0,a.ju)()],dc.prototype,"chartTooltipRender",void 0),oc([(0,a.ju)()],dc.prototype,"chartLoaded",void 0),oc([(0,a.ju)()],dc.prototype,"chartLoad",void 0),oc([(0,a.ju)()],dc.prototype,"chartResized",void 0),oc([(0,a.ju)()],dc.prototype,"chartAxisLabelRender",void 0),oc([(0,a.ju)()],dc.prototype,"multiLevelLabelClick",void 0),oc([(0,a.ju)()],dc.prototype,"chartPointClick",void 0),oc([(0,a.ju)()],dc.prototype,"contextMenuClick",void 0),oc([(0,a.ju)()],dc.prototype,"contextMenuOpen",void 0),oc([(0,a.ju)()],dc.prototype,"onPdfCellRender",void 0),oc([(0,a.ju)()],dc.prototype,"saveReport",void 0),oc([(0,a.ju)()],dc.prototype,"fetchReport",void 0),oc([(0,a.ju)()],dc.prototype,"loadReport",void 0),oc([(0,a.ju)()],dc.prototype,"renameReport",void 0),oc([(0,a.ju)()],dc.prototype,"removeReport",void 0),oc([(0,a.ju)()],dc.prototype,"newReport",void 0),oc([(0,a.ju)()],dc.prototype,"toolbarRender",void 0),oc([(0,a.ju)()],dc.prototype,"toolbarClick",void 0),oc([(0,a.ju)()],dc.prototype,"load",void 0),oc([(0,a.ju)()],dc.prototype,"enginePopulating",void 0),oc([(0,a.ju)()],dc.prototype,"enginePopulated",void 0),oc([(0,a.ju)()],dc.prototype,"onFieldDropped",void 0),oc([(0,a.ju)()],dc.prototype,"fieldDrop",void 0),oc([(0,a.ju)()],dc.prototype,"fieldDragStart",void 0),oc([(0,a.ju)()],dc.prototype,"dataBound",void 0),oc([(0,a.ju)()],dc.prototype,"created",void 0),oc([(0,a.ju)()],dc.prototype,"destroyed",void 0),oc([(0,a.ju)()],dc.prototype,"beforeExport",void 0),oc([(0,a.ju)()],dc.prototype,"conditionalFormatting",void 0),oc([(0,a.ju)()],dc.prototype,"memberFiltering",void 0),oc([(0,a.ju)()],dc.prototype,"cellClick",void 0),oc([(0,a.ju)()],dc.prototype,"drillThrough",void 0),oc([(0,a.ju)()],dc.prototype,"editCompleted",void 0),oc([(0,a.ju)()],dc.prototype,"beginDrillThrough",void 0),oc([(0,a.ju)()],dc.prototype,"hyperlinkCellClick",void 0),oc([(0,a.ju)()],dc.prototype,"cellSelecting",void 0),oc([(0,a.ju)()],dc.prototype,"drill",void 0),oc([(0,a.ju)()],dc.prototype,"cellSelected",void 0),oc([(0,a.ju)()],dc.prototype,"chartSeriesCreated",void 0),oc([(0,a.ju)()],dc.prototype,"aggregateCellInfo",void 0),oc([(0,a.ju)()],dc.prototype,"fieldListRefreshed",void 0),oc([(0,a.ju)()],dc.prototype,"memberEditorOpen",void 0),oc([(0,a.ju)()],dc.prototype,"calculatedFieldCreate",void 0),oc([(0,a.ju)()],dc.prototype,"numberFormatting",void 0),oc([(0,a.ju)()],dc.prototype,"aggregateMenuOpen",void 0),oc([(0,a.ju)()],dc.prototype,"fieldRemove",void 0),oc([(0,a.ju)()],dc.prototype,"beforeServiceInvoke",void 0),dc=sc=oc([a.Zl],dc);class cc{constructor(e){this.parent=e}render(){let e=(0,a.az)("div",{id:this.parent.element.id+"_Wrapper",className:Ur+" "+("olap"===this.parent.dataType?"e-olapfieldlist-wrapper":""),styles:"width:"+this.parent.element.style.width});this.parent.isAdaptive?(0,a.cn)([e],qr):(0,a.IV)([e],qr),this.parent.enableRtl?(0,a.cn)([e],Hr):(0,a.IV)([e],Hr),this.parent.cssClass&&(0,a.cn)([e],this.parent.cssClass),this.parentElement=(0,a.az)("div",{className:"e-field-list-container"}),this.parent.element.appendChild(e),this.parent.isAdaptive&&(e.removeAttribute("style"),this.parentElement=(0,a.az)("div",{className:"e-adaptive-container"}),this.renderAdaptiveLayout(e)),"Popup"===this.parent.renderMode?(this.renderFieldListDialog(e),this.unWireDialogEvent(this.parent.element.querySelector(".e-toggle-field-list")),this.wireDialogEvent(this.parent.element.querySelector(".e-toggle-field-list"))):this.renderStaticLayout(e)}renderStaticLayout(e){if(!this.parent.isAdaptive){let t=(0,a.az)("div",{className:"e-field-list-title"}),i=(0,a.az)("div",{className:"e-title-content",innerHTML:this.parent.localeObj.getConstant("staticFieldList")});t.appendChild(i),t.appendChild(this.createCalculatedButton()),(0,a.cn)([e],Xr),e.appendChild(t),e.appendChild(this.parentElement),(0,a.cn)([e],Xr),this.parent.allowDeferLayoutUpdate&&(e.appendChild(this.createDeferUpdateButtons()),this.renderDeferUpdateButtons())}}renderDeferUpdateButtons(){this.parent.allowDeferLayoutUpdate&&(this.deferUpdateCheckBox=new m.Jg({label:this.parent.localeObj.getConstant("deferLayoutUpdate"),checked:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,change:this.onCheckChange.bind(this)}),this.deferUpdateCheckBox.isStringTemplate=!0,this.deferUpdateCheckBox.appendTo("#"+this.parent.element.id+"DeferUpdateCheckBox"),this.deferUpdateApplyButton=new m.zx({cssClass:"e-defer-apply-button e-defer-update-btn"+("Popup"===this.parent.renderMode?" e-flat":""),content:this.parent.localeObj.getConstant("apply"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,isPrimary:!0}),this.deferUpdateApplyButton.isStringTemplate=!0,this.deferUpdateApplyButton.appendTo("#"+this.parent.element.id+"_DeferUpdateButton1"),this.deferUpdateApplyButton.element.onclick="Fixed"===this.parent.renderMode?this.applyButtonClick.bind(this):this.onDeferUpdateClick.bind(this)),this.deferUpdateCancelButton=new m.zx({cssClass:"e-defer-cancel-button e-cancel-btn"+("Popup"===this.parent.renderMode?" e-flat":""),content:this.parent.localeObj.getConstant(this.parent.allowDeferLayoutUpdate?"cancel":"close"),enableRtl:this.parent.enableRtl,isPrimary:!this.parent.allowDeferLayoutUpdate,locale:this.parent.locale}),this.deferUpdateCancelButton.isStringTemplate=!0,this.deferUpdateCancelButton.appendTo("#"+this.parent.element.id+"_DeferUpdateButton2"),this.deferUpdateCancelButton.element.onclick="Fixed"===this.parent.renderMode?this.cancelButtonClick.bind(this):this.onCloseFieldList.bind(this)}createDeferUpdateButtons(){let e=(0,a.az)("div",{className:"e-layout-footer"});if(this.parent.allowDeferLayoutUpdate){let t=(0,a.az)("div",{className:"e-checkbox-layout",attrs:{title:this.parent.localeObj.getConstant("deferLayoutUpdate")}}),i=(0,a.az)("input",{id:this.parent.element.id+"DeferUpdateCheckBox"});t.appendChild(i),e.appendChild(t)}let t=(0,a.az)("div",{className:"e-button-layout"});if(this.parent.allowDeferLayoutUpdate){let e=(0,a.az)("button",{id:this.parent.element.id+"_DeferUpdateButton1",attrs:{type:"button",title:this.parent.localeObj.getConstant("apply")}});t.appendChild(e)}let i=(0,a.az)("button",{id:this.parent.element.id+"_DeferUpdateButton2",attrs:{type:"button",title:this.parent.localeObj.getConstant("cancel")}});return t.appendChild(i),e.appendChild(t),e}onCheckChange(e){e.checked&&(this.parent.clonedDataSource=(0,a.l7)({},this.parent.dataSourceSettings,null,!0),this.parent.clonedFieldList=(0,a.l7)({},this.parent.pivotFieldList,null,!0)),this.parent.allowDeferLayoutUpdate=!this.parent.allowDeferLayoutUpdate,"Fixed"===this.parent.renderMode?(this.deferUpdateApplyButton.setProperties({disabled:!this.parent.allowDeferLayoutUpdate}),this.deferUpdateCancelButton.setProperties({disabled:!this.parent.allowDeferLayoutUpdate})):this.parent.allowDeferLayoutUpdate?(this.deferUpdateApplyButton.element.style.display="",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("cancel")}),this.deferUpdateCancelButton.isPrimary=!1):(this.deferUpdateApplyButton.element.style.display="none",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("close")}),this.deferUpdateCancelButton.isPrimary=!0),this.cancelButtonClick()}applyButtonClick(){"pivotfieldlist"===this.parent.getModuleName()&&this.parent.allowDeferLayoutUpdate&&(this.parent.pivotChange=!1),this.parent.updateDataSource(!1);let e=this.parent;e.axisFieldModule.render(),e.clonedDataSource=(0,a.l7)({},e.dataSourceSettings,null,!0),e.clonedFieldList=(0,a.l7)({},e.pivotFieldList,null,!0)}cancelButtonClick(){if((0,a.xr)()&&!this.parent.isPopupView?br.updateDataSourceSettings(this.parent,br.getClonedDataSourceSettings(this.parent.clonedDataSource.properties)):this.parent.setProperties({dataSourceSettings:this.parent.clonedDataSource.properties},!0),"olap"===this.parent.dataType){this.parent.olapEngineModule.fieldList=(0,a.l7)({},this.parent.clonedFieldList,null,!0);for(let e of Object.keys(this.parent.clonedFieldList)){let t=this.parent.clonedFieldList[e];this.parent.olapEngineModule.updateFieldlistData(t.id,t.isSelected)}}else this.parent.engineModule.fieldList=(0,a.l7)({},this.parent.clonedFieldList,null,!0);this.parent.updateDataSource(!1,!0)}renderFieldListDialog(e){let t=(0,a.az)("div",{className:"e-toggle-field-list e-icons e-select-table",attrs:{tabindex:"0",title:this.parent.localeObj.getConstant("fieldList"),"aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("fieldList")}});if(this.parent.element.appendChild(t),this.parent.isAdaptive){let t='<div class=e-title-mobile-header><span class="e-icons '+oh+'"></span><div class=e-title-mobile-content>'+this.parent.localeObj.getConstant("fieldList")+"</div></div>",i=[{click:this.showFieldListDialog.bind(this),buttonModel:{cssClass:"e-field-list-btn e-small e-round",iconCss:"e-icons e-add-icon",isPrimary:!0}},{click:this.showCalculatedField.bind(this),buttonModel:{cssClass:"e-calculated-field-btn e-small e-round e-disable",iconCss:"e-icons e-add-icon",enableRtl:this.parent.enableRtl,isPrimary:!0}}];this.fieldListDialog=new n.Vq({animationSettings:{effect:this.parent.enableRtl?"SlideRight":"SlideLeft"},header:t,content:this.parentElement,isModal:!0,showCloseIcon:!1,visible:!1,allowDragging:!1,closeOnEscape:!1,enableRtl:this.parent.enableRtl,locale:this.parent.locale,width:"100%",height:"100%",position:{X:"center",Y:"center"},buttons:i,target:document.body,close:this.removeFieldListIcon.bind(this),open:this.dialogOpen.bind(this)}),this.fieldListDialog.isStringTemplate=!0,this.fieldListDialog.appendTo(e),(0,a.V7)((0,a.Ys)("#"+e.id+"_dialog-content",e),{padding:"0"});let s=e.querySelector(".e-footer-content");(0,a.cn)([s],Qr),(0,a.IV)([s.querySelector(".e-calculated-field-btn")],vn),(0,a.IV)([s.querySelector(".e-field-list-btn")],vn),this.fieldListDialog.element.querySelector("."+oh).onclick=this.parent.allowDeferLayoutUpdate?this.onDeferUpdateClick.bind(this):this.onCloseFieldList.bind(this)}else{let t=this.createDeferUpdateButtons().outerHTML,i="<div class=e-title-header><div class=e-title-content>"+this.parent.localeObj.getConstant("fieldList")+"</div></div>";this.fieldListDialog=new n.Vq({animationSettings:{effect:"Zoom"},header:i,content:this.parentElement,isModal:!1,showCloseIcon:!1,visible:!1,allowDragging:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,width:this.parent.element.style.width,position:{X:"center",Y:this.parent.element.offsetTop},footerTemplate:t,closeOnEscape:!1,target:(0,a.le)(this.parent.target)?document.body:"string"==typeof this.parent.target?document.querySelector(this.parent.target):this.parent.target,close:this.removeFieldListIcon.bind(this)}),this.fieldListDialog.isStringTemplate=!0,this.fieldListDialog.appendTo(e),this.renderDeferUpdateButtons(),(0,a.V7)((0,a.Ys)("#"+e.id+"_title",e),{width:"100%"}),e.querySelector(".e-title-header").appendChild(this.createCalculatedButton())}}dialogOpen(){this.adaptiveElement.refresh()}updateDataSource(e){let t=["filters","columns","rows","values"];for(let i of e){let e=i,s=t[this.adaptiveElement.selectedItem];this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.dataSourceUpdate.updateDataSource(e,s,-1)}this.parent.axisFieldModule.render(),this.parent.allowDeferLayoutUpdate?this.parent.triggerPopulateEvent():this.parent.updateDataSource(!0)}onDeferUpdateClick(){this.parent.updateDataSource(),this.parent.dialogRenderer.fieldListDialog.hide()}renderAdaptiveLayout(e){let t=(0,a.az)("div",{className:Qr});e.appendChild(this.parentElement);let i=[{header:{text:this.parent.localeObj.getConstant("filters")},content:this.createAxisTable("filters")},{header:{text:this.parent.localeObj.getConstant("columns")},content:this.createAxisTable("columns")},{header:{text:this.parent.localeObj.getConstant("rows")},content:this.createAxisTable("rows")},{header:{text:this.parent.localeObj.getConstant("values")},content:this.createAxisTable("values")},{header:{text:this.parent.localeObj.getConstant("createCalculatedField")},content:"Calculated Field Related UI"}];this.parent.allowCalculatedField||i.pop(),this.adaptiveElement=new d.OK({heightAdjustMode:"Auto",items:i,height:"100%",enableRtl:this.parent.enableRtl,locale:this.parent.locale,selected:this.tabSelect.bind(this)}),"Fixed"===this.parent.renderMode?(t.appendChild(this.createAddButton()),(0,a.cn)([e],Xr),this.adaptiveElement.isStringTemplate=!0,this.adaptiveElement.appendTo(this.parentElement),this.parentElement.appendChild(t)):(this.adaptiveElement.isStringTemplate=!0,this.adaptiveElement.appendTo(this.parentElement))}tabSelect(e){let t=(0,a.oq)(this.parentElement,"."+Ur);t&&t.querySelector(".e-field-list-btn")&&(4!==e.selectedIndex?((0,a.cn)([t.querySelector(".e-calculated-field-btn")],Yr),(0,a.IV)([t.querySelector(".e-field-list-btn")],Yr)):((0,a.IV)([t.querySelector(".e-calculated-field-btn")],Yr),(0,a.cn)([t.querySelector(".e-field-list-btn")],Yr))),4===e.selectedIndex?(this.adaptiveElement.items[4].content="",this.adaptiveElement.dataBind(),this.parent.notify(Vr,{})):this.parent.axisFieldModule.render()}createCalculatedButton(){let e=(0,a.az)("button",{id:this.parent.element.id+"_CalculatedField",attrs:{type:"button",tabindex:"0","aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("CalculatedField")}}),t=new m.zx({cssClass:"e-calculated-field e-disable",content:this.parent.localeObj.getConstant("CalculatedField"),enableRtl:this.parent.enableRtl,locale:this.parent.locale});return t.isStringTemplate=!0,t.appendTo(e),this.parent.calculatedFieldModule&&(0,a.IV)([e],Yr),t.element.onclick=this.showCalculatedField.bind(this),e}createAddButton(){let e=(0,a.az)("div",{className:"e-field-list-footer-content"}),t=(0,a.az)("div",{}),i=(0,a.az)("div",{}),s=new m.zx({cssClass:"e-calculated-field-btn e-small e-round e-disable",iconCss:"e-icons e-add-icon",enableRtl:this.parent.enableRtl,locale:this.parent.locale}),o=new m.zx({cssClass:"e-field-list-btn e-small e-round",iconCss:"e-icons e-add-icon",enableRtl:this.parent.enableRtl,locale:this.parent.locale});return o.isStringTemplate=!0,o.appendTo(t),s.isStringTemplate=!0,s.appendTo(i),e.appendChild(t),e.appendChild(i),s.element.onclick=this.showCalculatedField.bind(this),o.element.onclick=this.showFieldListDialog.bind(this),e}createAxisTable(e){let t=(0,a.az)("div",{className:"e-field-list-"+e}),i=(0,a.az)("div",{className:"e-axis-content e-"+e}),s=(0,a.az)("span",{className:Jr,innerHTML:this.parent.localeObj.getConstant("addPrompt")});return t.appendChild(i),t.appendChild(s),t}showCalculatedField(e){this.parent.isAdaptive||this.parent.dialogRenderer.fieldListDialog&&(this.parent.dialogRenderer.fieldListDialog.hide(),(0,a.cn)([this.parent.element.querySelector(".e-toggle-field-list")],Wr)),this.parent.notify(Vr,{})}showFieldListDialog(e){this.parent.treeViewModule.render(this.adaptiveElement.selectedItem)}onShowFieldList(){this.parent.allowDeferLayoutUpdate&&(this.parent.isAdaptive&&this.parent.axisFieldModule.render(),this.parent.clonedDataSource=(0,a.l7)({},this.parent.dataSourceSettings,null,!0),this.parent.clonedFieldList=(0,a.l7)({},this.parent.pivotFieldList,null,!0)),(0,a.cn)([this.parent.element.querySelector(".e-toggle-field-list")],Wr),this.parent.dialogRenderer.fieldListDialog.show(),this.parent.dialogRenderer.fieldListDialog.element.style.top=parseInt(this.parent.dialogRenderer.fieldListDialog.element.style.top,10)<0?"0px":this.parent.dialogRenderer.fieldListDialog.element.style.top}onCloseFieldList(){this.parent.allowDeferLayoutUpdate&&(this.parent.dataSourceSettings=(0,a.l7)({},this.parent.clonedDataSource.properties,null,!0),this.parent.isPopupView&&this.parent.pivotGridModule&&(this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule,this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.clonedDataSource.properties},!0)),Object.keys(this.parent.clonedFieldList).length>0&&("olap"===this.parent.dataType?this.parent.olapEngineModule.fieldList=(0,a.l7)({},this.parent.clonedFieldList,null,!0):this.parent.engineModule.fieldList=(0,a.l7)({},this.parent.clonedFieldList,null,!0)),this.parent.isPopupView&&this.parent.pivotGridModule?(this.parent.pivotGridModule.notify(Or,this),this.parent.pivotGridModule.notify(Nr,this)):this.cancelButtonClick()),this.parent.dialogRenderer.fieldListDialog.hide()}removeFieldListIcon(){this.parent.isAdaptive&&this.parent.allowCalculatedField&&this.parent.calculatedFieldModule&&this.adaptiveElement&&4===this.adaptiveElement.selectedItem&&((0,a.Ys)("#"+this.parent.element.id+"droppable",this.adaptiveElement.element)?this.parent.calculatedFieldModule.updateAdaptiveCalculatedField(!1):this.parent.notify(Vr,{edit:!1})),document.getElementById(this.parent.element.id+"calculateddialog")||(0,a.IV)([this.parent.element.querySelector(".e-toggle-field-list")],Wr)}keyPress(e){if(13===e.keyCode&&e.target)return e.target.click(),void e.preventDefault()}wireDialogEvent(e){a.bi.add(e,"keydown",this.keyPress,this),a.bi.add(e,"click",this.onShowFieldList,this)}unWireDialogEvent(e){a.bi.remove(e,"keydown",this.keyPress),a.bi.remove(e,"click",this.onShowFieldList)}destroy(){"Popup"===this.parent.renderMode&&this.unWireDialogEvent(this.parent.element.querySelector(".e-toggle-field-list")),this.deferUpdateCheckBox&&!this.deferUpdateCheckBox.isDestroyed&&(this.deferUpdateCheckBox.destroy(),this.deferUpdateCheckBox=null),this.deferUpdateApplyButton&&!this.deferUpdateApplyButton.isDestroyed&&(this.deferUpdateApplyButton.destroy(),this.deferUpdateApplyButton=null),this.deferUpdateCancelButton&&!this.deferUpdateCancelButton.isDestroyed&&(this.deferUpdateCancelButton.destroy(),this.deferUpdateCancelButton=null),"Popup"===this.parent.renderMode&&(this.fieldListDialog&&!this.fieldListDialog.isDestroyed&&(this.fieldListDialog.destroy(),this.fieldListDialog=null),document.getElementById(this.parent.element.id+"_Wrapper")&&(0,a.Od)(document.getElementById(this.parent.element.id+"_Wrapper")))}}class pc{constructor(e){this.selectedNodes=[],this.parent=e,this.addEventListener()}render(e){if(this.parentElement=this.parent.dialogRenderer.parentElement,this.fieldListSort="None",this.parent.isAdaptive)this.renderTreeDialog(e);else{let e=(0,a.az)("div",{className:"e-field-table "+("olap"===this.parent.dataType?"e-olap-field-table":"")}),t=(0,a.az)("div",{className:"e-field-header",innerHTML:this.parent.localeObj.getConstant("allFields")}),i=(0,a.az)("div",{className:"e-field-list-tree-outer-div"});this.treeViewElement=(0,a.az)("div",{id:this.parent.element.id+"_TreeView",className:"e-field-list "+("olap"===this.parent.dataType?"e-olap-field-list-tree":"")});let s=(0,a.az)("div",{className:"e-field-header-wrapper"});if(s.appendChild(t),e.appendChild(s),this.updateSortElements(s),i.appendChild(this.treeViewElement),e.appendChild(i),this.parentElement.appendChild(e),"Fixed"===this.parent.renderMode){let e=(0,a.az)("div",{className:"e-center-div"}),t=(0,a.az)("div",{className:"e-center-title",innerHTML:this.parent.localeObj.getConstant("centerHeader")});this.parentElement.appendChild(e),this.parentElement.appendChild(t)}this.renderTreeView()}}updateSortElements(e){let t={None:"sortNone",Ascend:"sortAscending",Descend:"sortDescending"},i=Object.keys(t);for(let s of i){let i=(0,a.az)("span",{attrs:{tabindex:"0","aria-disabled":"false","aria-label":"Sort "+s,"data-sort":s,title:this.parent.localeObj.getConstant(t[s])},className:Gr+" e-sort-"+s.toLowerCase()+" "+(this.fieldListSort===s?"e-selected":"")});e.appendChild(i),this.unWireFieldListEvent(i),this.wireFieldListEvent(i)}}renderTreeView(){this.fieldTable=new d.LQ({fields:{dataSource:this.getTreeData(),id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"},nodeChecked:this.nodeStateChange.bind(this),cssClass:"e-field-list-tree",showCheckBox:!0,allowDragAndDrop:!0,sortOrder:"None",autoCheck:!1,loadOnDemand:"olap"!==this.parent.dataType,enableRtl:this.parent.enableRtl,locale:this.parent.locale,nodeDragStart:this.dragStart.bind(this),nodeDragStop:this.dragStop.bind(this),drawNode:this.updateTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),nodeSelected:e=>{(0,a.IV)([e.node],"e-active"),e.cancel=!0}}),this.treeViewElement.innerHTML="",this.fieldTable.isStringTemplate=!0,this.fieldTable.appendTo(this.treeViewElement);let e="Fixed"===this.parent.renderMode?this.parent.element:this.parentElement;(0,a.le)(e.querySelector(".e-field-list"))||(e.querySelector(".e-field-list").ej2_instances[0].dragObj.enableAutoScroll=!1)}updateNodeIcon(e){if("olap"===this.parent.dataType)if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-icon")>-1){let t=e.node.querySelector(".e-list-icon");(0,a.IV)([t],"e-folderCDB-icon"),(0,a.cn)([t],"e-folderCDB-open-icon")}else if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-open-icon")>-1){let t=e.node.querySelector(".e-list-icon");(0,a.IV)([t],"e-folderCDB-open-icon"),(0,a.cn)([t],"e-folderCDB-icon")}}updateTreeNode(e){let t=!1;t="olap"!==this.parent.dataType||this.updateOlapTreeNode(e);let i=e.node.querySelector(".e-text-content");if(e.node.querySelector(".e-list-icon")&&i){let t=e.node.querySelector(".e-list-icon");i.insertBefore(t,e.node.querySelector(".e-list-text"))}if(t&&!this.parent.isAdaptive){let s=br.getFieldInfo(e.nodeData.id,this.parent);t=!1;let o=(0,a.az)("span",{attrs:{tabindex:"-1",title:s.fieldItem?s.fieldItem.allowDragAndDrop?this.parent.localeObj.getConstant("drag"):"":this.parent.localeObj.getConstant("drag"),"aria-disabled":"false"},className:"e-icons e-drag "+(s.fieldItem?s.fieldItem.allowDragAndDrop?"":an:"")});e.node.querySelector(".e-checkbox-wrapper")&&!e.node.querySelector(".cls.DRAG_CLASS")&&i&&i.insertBefore(o,e.node.querySelector(".e-checkbox-wrapper"))}e.node.querySelector(".e-check")&&(0,a.cn)([e.node.querySelector(".e-list-text")],Sn)}updateOlapTreeNode(e){let t=!1;return"olap"===this.parent.dataType?(e.node&&e.node.querySelector(".e-calcMemberGroupCDB,.e-measureGroupCDB-icon,.e-folderCDB-icon,.e-folderCDB-open-icon,.e-dimensionCDB-icon,.e-kpiCDB-icon")&&(e.node.querySelector(".e-checkbox-wrapper").style.display="none"),e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-list-icon").className.indexOf("e-level-members")>-1&&(this.parent.isAdaptive?e.node.querySelector(".e-checkbox-wrapper").style.display="none":e.node.querySelector(".e-checkbox-wrapper").style.visibility="hidden"),e.node&&(e.node.querySelector(".e-hierarchyCDB-icon,.e-attributeCDB-icon,.e-namedSetCDB-icon")||e.node.querySelector(".e-measure-icon,.e-kpiGoal-icon,.e-kpiStatus-icon,.e-kpiTrend-icon,.e-kpiValue-icon")||e.node.querySelector(".e-calc-measure-icon,.e-calc-dimension-icon"))&&(e.node.querySelector(".e-measure-icon")?(e.node.querySelector(".e-list-icon").style.display="none",t=!0):t=!0)):t=!0,t}renderTreeDialog(e){let t=(0,a.az)("div",{id:this.parent.element.id+"_FieldListTreeView",className:"e-adaptive-field-list-dialog "+("olap"===this.parent.dataType?"e-olap-editor-dialog":"")});this.parentElement.appendChild(t),this.fieldDialog=new n.Vq({animationSettings:{effect:"Fade"},allowDragging:!1,header:this.parent.localeObj.getConstant("adaptiveFieldHeader"),content:this.createTreeView(this.getTreeData(e)),isModal:!0,visible:!0,showCloseIcon:!1,enableRtl:this.parent.enableRtl,locale:this.parent.locale,width:"auto",height:"350px",position:{X:"center",Y:"center"},buttons:[{click:this.closeTreeDialog.bind(this),buttonModel:{cssClass:pn,content:this.parent.localeObj.getConstant("cancel")}},{click:this.onFieldAdd.bind(this),buttonModel:{cssClass:cn,content:this.parent.localeObj.getConstant("add"),isPrimary:!0}}],closeOnEscape:!1,target:this.parentElement.parentElement,close:this.dialogClose.bind(this)}),this.fieldDialog.isStringTemplate=!0,this.fieldDialog.appendTo(t)}dialogClose(){document.getElementById(this.parent.element.id+"_FieldListTreeView")&&(0,a.Od)(document.getElementById(this.parent.element.id+"_FieldListTreeView"))}createTreeView(e){let t=(0,a.az)("div",{id:this.parent.element.id+"EditorDiv",className:nn}),i=(0,a.az)("div",{id:this.parent.element.id+"_SearchDiv",attrs:{tabindex:"-1"},className:En}),s=(0,a.az)("input",{attrs:{type:"text"}});i.appendChild(s);let o=(0,a.az)("div",{className:"e-member-editor-container-outer-div"}),l=(0,a.az)("div",{className:"e-member-editor-container "+("olap"===this.parent.dataType?"e-olap-field-list-tree":"")});t.appendChild(i),this.editorSearch=new c.g3({showClearButton:!0,placeholder:this.parent.localeObj.getConstant("search"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:Fn,change:this.textChange.bind(this)}),this.editorSearch.isStringTemplate=!0,this.editorSearch.appendTo(s);let r=(0,a.az)("div",{className:"e-member-prompt e-disable",innerHTML:this.parent.localeObj.getConstant("noMatches")});return t.appendChild(r),o.appendChild(l),t.appendChild(o),this.fieldTable=new d.LQ({fields:{dataSource:e,id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"},showCheckBox:!0,autoCheck:!1,loadOnDemand:"olap"!==this.parent.dataType,sortOrder:"olap"===this.parent.dataType?"None":"Ascending",enableRtl:this.parent.enableRtl,locale:this.parent.locale,nodeChecked:this.addNode.bind(this),drawNode:this.updateTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),nodeSelected:e=>{(0,a.IV)([e.node],"e-active"),e.cancel=!0}}),this.fieldTable.isStringTemplate=!0,this.fieldTable.appendTo(l),t}textChange(e){this.parent.pivotCommon.eventBase.searchTreeNodes(e,this.fieldTable,!0);let t=this.fieldDialog.element.querySelector(".e-member-prompt"),i=[].slice.call(this.fieldTable.element.querySelectorAll("li")),s=[].slice.call(this.fieldTable.element.querySelectorAll("li.e-disable"));i.length===s.length?(0,a.IV)([t],Yr):(0,a.cn)([t],Yr)}dragStart(e){if(e.event.target.classList.contains(ln)&&!e.event.target.classList.contains(an)){let t=br.getFieldInfo(e.draggedNode.getAttribute("data-uid"),this.parent);(this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(kr,{fieldName:t.fieldName,fieldItem:t.fieldItem,axis:t.axis,dataSourceSettings:this.parent.dataSourceSettings,cancel:!1},t=>{if(t.cancel)this.parent.isDragging=!1,e.cancel=!0;else{let t;this.parent.isDragging=!0,(0,a.cn)([e.draggedNode.querySelector(".e-list-text")],yn),t="olap"===this.parent.dataType?this.parent.olapEngineModule.fieldList[e.draggedNode.getAttribute("data-uid")]:this.parent.engineModule.fieldList[e.draggedNode.getAttribute("data-uid")];let i=[gn,mn,bn];if(t&&"CalculatedField"===t.aggregateType)for(let e of i)(0,a.cn)([this.parentElement.querySelector("."+e)],fn);let s=e.clonedNode;s&&"Popup"===("pivotfieldlist"===this.parent.getModuleName()&&this.parent.renderMode)&&(s.style.zIndex=(this.parent.dialogRenderer.fieldListDialog.zIndex+1).toString())}})}else this.parent.isDragging=!1,e.cancel=!0}dragStop(e){e.cancel=!0,this.parent.isDragging=!1;let t=[gn,mn,bn];for(let o of t)(0,a.IV)([this.parentElement.querySelector("."+o)],fn);(0,a.IV)([e.draggedNode.querySelector(".e-list-text")],yn),this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();let i=e.draggedNodeData.id.toString();if(!this.isNodeDropped(e,i))return;let s=this.parent.pivotFieldList[i];this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.nodeStateModified.onStateModified(e,i)&&(this.parent.allowDeferLayoutUpdate?(s.isSelected=!0,this.updateDataSource()):this.parent.updateDataSource(),this.parent.axisFieldModule.render())}isNodeDropped(e,t){let i=!0;if("true"===e.draggedNodeData.isChecked){let s=this.getButton(t),o=(0,a.oq)(s,".e-droppable"),l=(0,a.oq)(e.target,".e-droppable");if(s&&o===l){let t,l=[].slice.call(o.querySelectorAll(".e-pivot-button")),r=(0,a.oq)(e.target,".e-pvt-btn-div"),n=-1;for(let e=0,i=l.length;e<i;e++)if(l[e].id===s.id&&(t=e),r){let t=r.querySelector(".e-pivot-button");l[e].id===t.id&&(n=e)}if(t===n||t===l.length-1&&-1===n){let e=document.getElementById(this.parent.element.id+"_Wrapper");(0,a.IV)([].slice.call(e.querySelectorAll(".e-drop-indicator")),rn),i=!1}}}return i}getButton(e){let t,i=document.getElementById(this.parent.element.id+"_Wrapper"),s=[].slice.call(i.querySelectorAll(".e-pivot-button"));for(let o=0,l=s.length;o<l;o++)if(s[o].id===e){t=s[o];break}return t}nodeStateChange(e){let t=(0,a.oq)(e.node,".e-text-content");if(!(0,a.le)(t)){let i=(0,a.oq)(t,"li"),s=i.getAttribute("data-uid");this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();let o=this.parent.pivotFieldList[s],l=br.getFieldInfo(s,this.parent),r=this.parent.isPopupView?this.parent.pivotGridModule:this.parent;if("check"===e.action){let n={fieldName:s,dropField:l.fieldItem,dataSourceSettings:br.getClonedDataSourceSettings(this.parent.dataSourceSettings),dropAxis:"number"===o.type||"CalculatedField"===o.type&&o.formula&&o.formula.indexOf("Measure")>-1&&"olap"===this.parent.dataType?"values":"rows",dropPosition:l.position,draggedAxis:"fieldlist",cancel:!1};r.trigger(xr,n,r=>{if(r.cancel)this.updateCheckState(o);else{(0,a.cn)([t.querySelector(".e-list-text")],Sn),this.updateSelectedNodes(i,e.action);let n=this.parent.pivotCommon.dataSourceUpdate.getNewField(s,l.fieldItem);this.updateReportSettings(n,r),this.updateNodeStateChange(s,e,o)}})}else{let n={cancel:!1,fieldName:s,dataSourceSettings:br.getClonedDataSourceSettings(this.parent.dataSourceSettings),fieldItem:l.fieldItem,axis:l.axis};r.trigger(Ir,n,l=>{l.cancel?this.updateCheckState(o):((0,a.IV)([t.querySelector(".e-list-text")],Sn),this.updateSelectedNodes(i,e.action),this.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(s),"olap"===this.parent.dataType&&0===this.parent.dataSourceSettings.values.length&&this.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[Measures]"),this.updateNodeStateChange(s,e,o))})}}}updateReportSettings(e,t){let i=t.dropPosition;switch(t.dropAxis){case"filters":-1!==i?this.parent.dataSourceSettings.filters.splice(i,0,e):this.parent.dataSourceSettings.filters.push(e);break;case"rows":-1!==i?this.parent.dataSourceSettings.rows.splice(i,0,e):this.parent.dataSourceSettings.rows.push(e);break;case"columns":-1!==i?this.parent.dataSourceSettings.columns.splice(i,0,e):this.parent.dataSourceSettings.columns.push(e);break;case"values":-1!==i?this.parent.dataSourceSettings.values.splice(i,0,e):this.parent.dataSourceSettings.values.push(e),"olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.isMeasureAvail&&("row"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.rows:this.parent.dataSourceSettings.columns).push({name:"[Measures]",caption:"Measures",baseField:void 0,baseItem:void 0})}}updateCheckState(e){let t=this.fieldTable.element.querySelectorAll(".e-checkbox-wrapper"),i=this.fieldTable.element.querySelectorAll(".e-list-text"),s=this.fieldTable.element.querySelectorAll(".e-frame");for(let o=0;o<t.length;o++)e.caption===i[o].textContent&&("false"===t[o].getAttribute("aria-checked")?(t[o].setAttribute("aria-checked","false"),s[o].classList.add(hn)):(t[o].setAttribute("aria-checked","true"),s[o].classList.remove(hn)))}updateNodeStateChange(e,t,i){this.parent.allowDeferLayoutUpdate?(i.isSelected="check"===t.action,"olap"===this.parent.dataType&&this.parent.olapEngineModule.updateFieldlistData(e,"check"===t.action),this.updateDataSource()):this.parent.updateDataSource(!0);let s=this.parent;setTimeout(()=>{s.axisFieldModule.render()})}updateSelectedNodes(e,t){if(e&&e.querySelector("ul"))for(let i of[].slice.call(e.querySelectorAll("li")))"check"===t?(0,a.cn)([i.querySelector(".e-list-text")],Sn):(0,a.IV)([i.querySelector(".e-list-text")],Sn)}updateDataSource(){this.parent.isPopupView?("olap"===this.parent.dataType?this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule:this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0),this.parent.pivotGridModule.notify(Or,this)):this.parent.triggerPopulateEvent()}addNode(e){let t=this.parent.pivotFieldList[e.data[0].id.toString()],i=br.getFieldInfo(t.id.toString(),this.parent),s=this.parent.isPopupView?this.parent.pivotGridModule:this.parent;if("check"===e.action){let e={fieldName:i.fieldName,dropField:i.fieldItem,dataSourceSettings:br.getClonedDataSourceSettings(this.parent.dataSourceSettings),dropAxis:"rows",draggedAxis:"fieldlist",cancel:!1};s.trigger(xr,e,e=>{e.cancel?this.updateCheckState(t):this.selectedNodes.push(t.id.toString())})}else{let e={cancel:!1,fieldName:i.fieldName,dataSourceSettings:br.getClonedDataSourceSettings(this.parent.dataSourceSettings),fieldItem:i.fieldItem,axis:i.axis};s.trigger(Ir,e,e=>{if(e.cancel)this.updateCheckState(t);else{let e=this.selectedNodes.length;for(;e--;)if(this.selectedNodes[e]===t.id.toString()){this.selectedNodes.splice(e,1);break}}})}}refreshTreeView(){if(this.fieldTable){let e=this.getUpdatedData();this.fieldTable.fields={dataSource:e,id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"},this.fieldTable.dataBind()}}getUpdatedData(){let e=this.getTreeData();return this.updateExpandedNodes(e,this.fieldTable.expandedNodes),this.applySorting(e,this.fieldListSort)}getTreeData(e){let t=[];if("olap"===this.parent.dataType)t=this.getOlapTreeData(e);else{let i=this.parent.pivotFieldList?Object.keys(this.parent.pivotFieldList):[],s={};for(let e of i){let t=this.parent.pivotFieldList[e];s[e]={id:t.id,caption:t.caption,isSelected:t.isSelected}}if(this.parent.isAdaptive){let t=[this.parent.dataSourceSettings.filters,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.values][e],o=i.length;for(;o--;)s[i[o]].isSelected=!1;for(let e of t)s[e.name].isSelected=!0}let o=s;for(let e of i)t.push(o[e])}return t}getOlapTreeData(e){let t=[],i=this.parent.olapEngineModule.fieldListData?this.parent.olapEngineModule.fieldListData:[];if(this.parent.isAdaptive){let s=[this.parent.dataSourceSettings.filters,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.values][e],o=0;for(;o<i.length;){let l,a=i[o];if(3===e){if("[measures]"!==a.id.toLowerCase()&&(0===a.id.toLowerCase().indexOf("[measures]")||a.spriteCssClass&&-1!==a.spriteCssClass.indexOf("e-measureCDB"))||"[calculated members].[_0]"===a.id.toLowerCase()||a.spriteCssClass&&-1!==a.spriteCssClass.indexOf("e-calc-measure-icon")){l={id:a.id,caption:a.caption,hasChildren:a.hasChildren,type:a.type,aggregateType:a.aggregateType,isSelected:a.isSelected,pid:a.pid,spriteCssClass:a.spriteCssClass},l.isSelected=!1,l.spriteCssClass&&-1!==l.spriteCssClass.indexOf("e-measureCDB")&&(l.spriteCssClass=l.spriteCssClass.replace("e-folderCDB-icon","e-measureGroupCDB-icon"),l.pid=void 0);for(let e of s)if(l.id===e.name){l.isSelected=!0;break}t.push(l)}}else if(!(0===a.id.toLowerCase().indexOf("[measures]")||a.spriteCssClass&&-1!==a.spriteCssClass.indexOf("e-measureCDB")||a.spriteCssClass&&-1!==a.spriteCssClass.indexOf("e-calc-measure-icon"))){l={id:a.id,caption:a.caption,hasChildren:a.hasChildren,type:a.type,aggregateType:a.aggregateType,isSelected:a.isSelected,pid:a.pid,spriteCssClass:a.spriteCssClass},l.isSelected=!1;for(let e of s)if(l.id===e.name){l.isSelected=!0;break}t.push(l)}o++}}else t=br.getClonedData(this.parent.olapEngineModule.fieldListData);return t}updateExpandedNodes(e,t){if(t.length>0){let i=0;for(let s of e)if(t.indexOf(s.id)>-1&&(i++,s.expanded=!0,s.spriteCssClass=s.spriteCssClass&&s.spriteCssClass.toString().indexOf("e-folderCDB-icon")>-1?s.spriteCssClass.toString().replace("e-folderCDB-icon","e-folderCDB-open-icon"):s.spriteCssClass,i===t.length))break}}updateSorting(e){let t=e.target,i=t.getAttribute("data-sort");if(-1===t.className.indexOf("e-selected")){switch(i){case"None":this.fieldListSort="None",(0,a.cn)([t],"e-selected"),(0,a.IV)([this.parentElement.querySelector(".e-sort-ascend")],"e-selected"),(0,a.IV)([this.parentElement.querySelector(".e-sort-descend")],"e-selected");break;case"Ascend":this.fieldListSort="Ascend",(0,a.cn)([t],"e-selected"),(0,a.IV)([this.parentElement.querySelector(".e-sort-none")],"e-selected"),(0,a.IV)([this.parentElement.querySelector(".e-sort-descend")],"e-selected");break;case"Descend":this.fieldListSort="Descend",(0,a.cn)([t],"e-selected"),(0,a.IV)([this.parentElement.querySelector(".e-sort-ascend")],"e-selected"),(0,a.IV)([this.parentElement.querySelector(".e-sort-none")],"e-selected")}this.refreshTreeView()}}applySorting(e,t){if("olap"===this.parent.dataType){let i,s;this.parent.dataSourceSettings.calculatedFieldSettings.length>0&&"[calculated members].[_0]"===e[0].id.toLowerCase()?(s=e[0],i=e[1],e.splice(0,2)):(i=e[0],e.splice(0,1)),e="Ascend"===t?e.sort((e,t)=>e.caption>t.caption?1:t.caption>e.caption?-1:0):"Descend"===t?e.sort((e,t)=>e.caption<t.caption?1:t.caption<e.caption?-1:0):e,s?e.splice(0,0,s,i):e.splice(0,0,i)}else this.fieldTable.sortOrder="Ascend"===t?"Ascending":"Descend"===t?"Descending":"None";return e}onFieldAdd(e){this.parent.dialogRenderer.updateDataSource(this.selectedNodes),this.closeTreeDialog()}closeTreeDialog(){this.selectedNodes=[],this.fieldDialog.hide()}keyPress(e){if(13===e.keyCode&&e.target)return e.target.click(),void e.preventDefault()}wireFieldListEvent(e){a.bi.add(e,"keydown",this.keyPress,this),a.bi.add(e,"click",this.updateSorting,this)}unWireFieldListEvent(e){a.bi.remove(e,"keydown",this.keyPress),a.bi.remove(e,"click",this.updateSorting)}addEventListener(){this.parent.on(Br,this.refreshTreeView,this)}removeEventListener(){this.parent.isDestroyed||this.parent.off(Br,this.refreshTreeView)}destroy(){this.removeEventListener(),this.fieldTable&&!this.fieldTable.isDestroyed&&(this.fieldTable.destroy(),this.fieldTable=null),this.fieldDialog&&!this.fieldDialog.isDestroyed&&(this.fieldDialog.destroy(),this.fieldDialog=null),this.editorSearch&&!this.editorSearch.isDestroyed&&(this.editorSearch.destroy(),this.editorSearch=null)}}class uc{constructor(e){this.parent=e}render(){if(!this.parent.isAdaptive){let e=(0,a.az)("div",{className:"e-axis-table "+("olap"===this.parent.dataType?"e-olap-axis-table":"")});this.leftAxisPanel=(0,a.az)("div",{className:"e-left-axis-fields"}),this.rightAxisPanel=(0,a.az)("div",{className:"e-right-axis-fields"}),this.parent.dialogRenderer.parentElement.appendChild(e),e.appendChild(this.leftAxisPanel),e.appendChild(this.rightAxisPanel),this.axisTable=e,this.renderAxisTable()}this.parent.axisFieldModule.render()}renderAxisTable(){let e=["filters","rows","columns","values"];for(let t=0,i=e.length;t<i;t++){let i=(0,a.az)("div",{className:"e-field-list-"+e[t]}),s=(0,a.az)("div",{className:"e-axis-wrapper"}),o=(0,a.az)("div",{className:"e-axis-header",attrs:{title:this.parent.localeObj.getConstant(e[t])},innerHTML:this.parent.localeObj.getConstant(e[t])});s.appendChild(this.getIconupdate(e[t])),s.appendChild(o);let l,r=(0,a.az)("div",{className:"e-axis-content e-"+e[t]});l=this.parent.localeObj.getConstant("rows"===e[t]?"dropRowPrompt":"columns"===e[t]?"dropColPrompt":"values"===e[t]?"dropValPrompt":"dropFilterPrompt");let n=(0,a.az)("span",{className:Jr,innerHTML:l});new a.bK(r,{}),i.appendChild(s),i.appendChild(r),i.appendChild(n),t<=1?this.leftAxisPanel.appendChild(i):this.rightAxisPanel.appendChild(i),this.unWireEvent(r),this.wireEvent(r)}}getIconupdate(e){let t=(0,a.az)("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-axis-icon-wrapper"}),i=(0,a.az)("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-icons e-axis-"+e});return t.appendChild(i),t}wireEvent(e){a.bi.add(e,"mouseover",this.updateDropIndicator,this),a.bi.add(e,"mouseleave",this.updateDropIndicator,this)}unWireEvent(e){a.bi.remove(e,"mouseover",this.updateDropIndicator),a.bi.remove(e,"mouseleave",this.updateDropIndicator)}updateDropIndicator(e){let t=this.parent.dialogRenderer.parentElement;if(this.parent.isDragging&&e.target.classList.contains("e-axis-content")&&"mouseover"===e.type){(0,a.IV)([].slice.call(t.querySelectorAll(".e-drop-indicator")),rn),(0,a.IV)([].slice.call(t.querySelectorAll(".e-drop-indicator-last")),rn);let i=[].slice.call(e.target.querySelectorAll(".e-pvt-btn-div"));i.length>0&&(0,a.cn)([i[i.length-1].querySelector(".e-drop-indicator-last")],rn)}else"mouseleave"===e.type&&((0,a.IV)([].slice.call(t.querySelectorAll(".e-drop-indicator")),rn),(0,a.IV)([].slice.call(t.querySelectorAll(".e-drop-indicator-last")),rn))}}class gc{constructor(e){this.parent=e,this.menuOption=new fh(this.parent),this.parent.pivotButtonModule=this,this.addEventListener(),this.parent instanceof yc&&(this.axisField=new mc(this.parent)),this.isDestroyed=!1}renderPivotButton(e){let t,i=(0,a.l7)([],e.field,null,!0),s=e.axis,o=-1,l="pivot"===this.parent.dataType&&("pivotfieldlist"===this.parent.getModuleName()&&this.parent.pivotGridModule?this.parent.pivotGridModule.showValuesButton:this.parent.showValuesButton);if(("row"===this.parent.dataSourceSettings.valueAxis&&"rows"===e.axis||"column"===this.parent.dataSourceSettings.valueAxis&&"columns"===e.axis)&&l&&this.parent.dataSourceSettings.values.length>1&&(o=i.length,(0,a.le)(br.getFieldByName(this.parent.localeObj.getConstant("values"),i))&&i.push({name:this.parent.localeObj.getConstant("values"),caption:this.parent.localeObj.getConstant("values"),axis:e.axis,showRemoveIcon:!0,allowDragAndDrop:!0})),this.parentElement="pivotview"===this.parent.getModuleName()?this.parent.element:document.getElementById(this.parent.element.id+"_Wrapper"),"pivotfieldlist"===this.parent.getModuleName()){if(this.parentElement=document.getElementById(this.parent.element.id+"_Wrapper"),!this.parentElement.querySelector(".e-field-list-"+s))return;{let e=this.parentElement.querySelector(".e-field-list-"+s).querySelector(".e-draggable-prompt");0===i.length?(0,a.IV)([e],Yr):(0,a.cn)([e],Yr),t=this.parentElement.querySelector(".e-field-list-"+s).querySelector(".e-axis-content")}}else this.parentElement=this.parent.element,t=this.parentElement.querySelector(".e-group-"+s);if(t)if("pivotview"===this.parent.getModuleName()&&0===i.length){for(let r of this.parentElement.querySelectorAll(".e-group-"+s))if(!r.classList.contains(ph)&&!r.classList.contains(ch)){let e=(0,a.az)("span",{className:Jr,innerHTML:this.parent.groupingBarSettings.allowDragAndDrop?this.parent.localeObj.getConstant("rows"===s?"rowAxisPrompt":"columns"===s?"columnAxisPrompt":"values"===s?"valueAxisPrompt":"filters"===s?"filterAxisPrompt":"allFields"):""});r.appendChild(e)}}else{for(let e=0,l=i.length;e<l;e++)for(let r of"pivotfieldlist"===this.parent.getModuleName()?[t]:this.parentElement.querySelectorAll(".e-group-"+s)){r=r;let t="olap"===this.parent.dataType&&("[measures]"===i[e].name.toLowerCase()||"values"===s),l="olap"===this.parent.dataType&&"values"===s;if(!r.classList.contains(ph)&&!r.classList.contains(ch)){let n=(0,a.az)("div",{className:"e-pvt-btn-div"+(0===e&&"all-fields"!==s?" e-first-btn":""),attrs:{"data-tag":s+":"+i[e].name}}),h=(0,a.az)("div",{id:i[e].name,className:"e-pivot-button "+i[e].name.replace(/[^A-Z0-9]/gi,""),attrs:{"data-uid":i[e].name,tabindex:"pivotview"===this.parent.getModuleName()&&this.parent.grid&&"rows"===s&&!r.classList.contains("e-group-chart-rows")?"-1":"0",isvalue:e===o||t&&!l?"true":"false","aria-disabled":"false","aria-label":i[e].caption?i[e].caption:i[e].name,"data-type":"olap"===this.parent.dataType?l?"isMeasureFieldsAvail":t?"isMeasureAvail":i[e].type:i[e].type,"data-caption":i[e].caption?i[e].caption:i[e].name,"data-basefield":i[e].baseField,"data-baseitem":i[e].baseItem}}),d=(0,a.az)("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-drop-indicator"}),c=(0,a.az)("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-drop-indicator-last"}),p=this.createButtonDragIcon(i[e],h),u=this.createButtonText(i,e,s,o);if(h.appendChild(u),"all-fields"!==s){if(t||i[e].isNamedSet||i[e].isCalculatedField||(-1!==["filters","values"].indexOf(s)||o===e||"olap"===this.parent.dataType&&("pivotview"===this.parent.getModuleName()&&this.parent.enableVirtualization||"pivotfieldlist"===this.parent.getModuleName()&&void 0!==this.parent.pivotGridModule&&this.parent.pivotGridModule.enableVirtualization)||this.createSortOption(h,i[e].name,i[e]),"values"!==s&&o!==e&&this.createFilterOption(h,i[e].name,s,i[e]),"values"===s&&this.getTypeStatus(i,e,h)),i[e].isCalculatedField||"CalculatedField"===i[e].type){let t=(0,a.az)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("editCalculatedField")},className:"e-icons e-edit"});this.parent.allowCalculatedField&&this.parent.calculatedFieldModule&&i[e].showEditIcon?(0,a.IV)([t],Yr):(0,a.cn)([t],Yr),h.appendChild(t)}let l=(0,a.az)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("remove")},className:"e-icons e-remove"});"pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.showRemoveIcon&&i[e].showRemoveIcon?(0,a.IV)([l],Yr):(0,a.cn)([l],Yr):i[e].showRemoveIcon?(0,a.IV)([l],Yr):(0,a.cn)([l],Yr),h.appendChild(l),n.appendChild(d),n.appendChild(h),n.appendChild(c)}else n.appendChild(d),n.appendChild(h);r.appendChild(n);let g=new m.zx({enableRtl:this.parent.enableRtl,locale:this.parent.locale});g.isStringTemplate=!0,g.appendTo(h),this.unWireEvent(n,e===o&&"all-fields"!==s?"values":s,t),this.wireEvent(n,e===o&&"all-fields"!==s?"values":s,t),("pivotview"===this.parent.getModuleName()&&!this.parent.isAdaptive||"pivotfieldlist"===this.parent.getModuleName())&&(this.createDraggable(i[e],"pivotview"===this.parent.getModuleName()?u:p),h.querySelector(".e-draggable").ej2_instances[0].enableAutoScroll=!1)}}if("values"===s){for(let e of this.parentElement.querySelectorAll(".e-group-"+s))if(e.classList.contains(ph)&&this.parent.chartModule){let t=i.map(e=>({text:e.caption?e.caption:e.name,value:e.name})),s=this.parent;if(this.valueFiedDropDownList&&e.querySelector("."+uh))this.valueFiedDropDownList.dataSource=t,this.valueFiedDropDownList.value=s.chartSettings.enableMultipleAxis?t[0].value:s.chartModule.currentMeasure;else{let i=(0,a.az)("div",{className:uh});e.appendChild(i),this.valueFiedDropDownList=new p.NB({dataSource:t,enableRtl:this.parent.enableRtl,locale:this.parent.locale,value:s.chartSettings.enableMultipleAxis?t[0].value:s.chartModule.currentMeasure,width:200,fields:{value:"value",text:"text"},cssClass:"e-group-chart-values-drodown",change:e=>{e.e&&null!==e.e&&(s.chartSettings.value=e.value)}}),this.valueFiedDropDownList.isStringTemplate=!0,this.valueFiedDropDownList.appendTo(i)}}}else if("columns"===s){let e;for(let t of this.parentElement.querySelectorAll(".e-group-"+s))if(t.classList.contains(ch)&&this.parent.chartModule){let i=this.parent.chartModule.currentMeasure,s=this.parent.chartSettings.columnDelimiter?this.parent.chartSettings.columnDelimiter:"-",o=this.parent.chartSettings.columnHeader&&""!==this.parent.chartSettings.columnHeader?this.parent.chartSettings.columnHeader.split(s).join(" - "):"",l="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,r=l.pivotValues,n=this.parent.chartModule.getColumnTotalIndex(r),h=Object.keys(r),d=[],c=!1;for(let t of h){if(c)break;let s=Number(t);if(r[s][0]&&"row"===r[s][0].axis&&(0===this.parent.dataSourceSettings.rows.length||"grand sum"!==r[s][0].type)){let t=r[s][0],a="olap"===this.parent.dataType?l.tupRowInfo[t.ordinal]:void 0,h=Object.keys(r[s]);for(let l of h){let h=Number(l),p=r[s][h],u="olap"===this.parent.dataType&&a&&a.measureName?a.measureName:p.actualText;if(!n[p.colIndex]&&"value"===p.axis&&"header"!==t.type&&""!==u&&u===i){c=!0;let t="olap"===this.parent.dataType?p.columnHeaders.toString().split(/~~|::/).join(" - "):p.columnHeaders.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - ");d.push({value:t,text:t,title:{title:t}}),t===o&&(e=d.length)}}}}if(this.columnFieldDropDownList&&t.querySelector("."+gh))this.columnFieldDropDownList.dataSource=d,this.columnFieldDropDownList.value=void 0!==e?d[e-1].value:d[0].value;else{let i=(0,a.az)("div",{className:gh});t.appendChild(i),this.columnFieldDropDownList=new p.NB({dataSource:d,enableRtl:this.parent.enableRtl,locale:this.parent.locale,value:e?d[e-1].value:d[0]?d[0].value:"",width:"200",fields:{value:"value",text:"text",htmlAttributes:"title"},cssClass:"e-group-chart-columns-dropdown",change:e=>{if(e.e&&null!==e.e){let t=this.parent.chartSettings.columnDelimiter?this.parent.chartSettings.columnDelimiter:"-";this.parent.chartSettings.columnHeader=e.value.split(" - ").join(t)}}}),this.columnFieldDropDownList.isStringTemplate=!0,this.columnFieldDropDownList.appendTo(i)}}}}}createButtonText(e,t,i,s){let o,l,r,n;"filters"===i&&(r=this.updateButtontext(e[t].name)),n="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,void 0!==n.fieldList[e[t].name]&&(l=n.fieldList[e[t].name].aggregateType,l="DistinctCount"===l||"number"===n.fieldList[e[t].name].type&&"include"!==n.fieldList[e[t].name].type&&"exclude"!==n.fieldList[e[t].name].type?void 0===l?"Sum":n.fieldList[e[t].name].aggregateType:"Count");let h=e[t].caption?e[t].caption:e[t].name;return o=(0,a.az)("span",{attrs:{title:"filters"===i?"olap"===this.parent.dataType&&"CalculatedField"===n.fieldList[e[t].name].type?h:h+" ("+r+")":"olap"===this.parent.dataType?h:this.parent.dataSourceSettings.showAggregationOnValueField&&"values"===i&&"CalculatedField"!==l?this.parent.localeObj.getConstant(l)+" "+this.parent.localeObj.getConstant("of")+" "+h:h,tabindex:"-1","aria-disabled":"false",oncontextmenu:"return false;","data-type":s===t?"":l},className:"e-content "+("pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.allowDragAndDrop&&e[t].allowDragAndDrop?"":an:""),innerHTML:"filters"===i?"olap"===this.parent.dataType&&"CalculatedField"===n.fieldList[e[t].name].type?h:h+" ("+r+")":"olap"===this.parent.dataType?h:this.parent.dataSourceSettings.showAggregationOnValueField&&"values"===i&&"CalculatedField"!==l?this.parent.localeObj.getConstant(l)+" "+this.parent.localeObj.getConstant("of")+" "+h:h}),o}getTypeStatus(e,t,i){let s;s="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;let o=s.fieldList[e[t].name];"CalculatedField"!==o.aggregateType&&this.validateDropdown(o.type)&&this.createSummaryType(i,e[t].name,e[t])}validateDropdown(e){let t=this.parent.aggregateTypes;if("number"!==e)return t.indexOf("Count")>-1||t.indexOf("DistinctCount")>-1;for(let i=0;i<t.length;i++)if(this.parent.getAllSummaryType().indexOf(t[i])>-1)return!0;return!1}createSummaryType(e,t,i){let s=(0,a.az)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("format")},className:"e-icons e-dropdown-icon"});return"pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.showValueTypeIcon&&i.showValueTypeIcon?(0,a.IV)([s],Yr):(0,a.cn)([s],Yr):i.showValueTypeIcon?(0,a.IV)([s],Yr):(0,a.cn)([s],Yr),e.appendChild(s),s}createMenuOption(e){this.menuOption.render(e,this.parentElement),this.parent.pivotButtonModule=this}openCalculatedFieldDialog(e){let t=e.target.parentElement.id;"pivotview"===this.parent.getModuleName()?this.parent.isAdaptive&&this.parent.showFieldList&&this.parent.pivotFieldListModule&&!this.parent.pivotFieldListModule.isDestroyed?(this.parent.pivotFieldListModule.element.querySelector(".e-toggle-field-list").click(),this.parent.pivotFieldListModule.dialogRenderer.adaptiveElement.select(4),this.parent.pivotFieldListModule.calculatedFieldModule.updateAdaptiveCalculatedField(!0,t)):(this.parent.isAdaptive||(this.parent.calculatedFieldModule.buttonCall=!0),this.parent.notify(Vr,{edit:!0,fieldName:t})):"pivotfieldlist"===this.parent.getModuleName()&&(this.parent.isAdaptive?(this.parent.dialogRenderer.adaptiveElement.select(4),this.parent.calculatedFieldModule.updateAdaptiveCalculatedField(!0,t),this.parent.calculatedFieldModule.buttonCall=!0):(this.parent.dialogRenderer.fieldListDialog&&(this.parent.dialogRenderer.fieldListDialog.hide(),(0,a.cn)([this.parent.element.querySelector(".e-toggle-field-list")],Wr)),this.parent.notify(Vr,{edit:!0,fieldName:t}),this.parent.calculatedFieldModule&&(this.parent.calculatedFieldModule.buttonCall=!0)))}createDraggable(e,t){this.draggable=new a._l(t,{clone:!0,enableTailMode:!0,enableAutoScroll:!0,helper:this.createDragClone.bind(this),dragStart:this.onDragStart.bind(this),drag:this.onDragging.bind(this),dragStop:this.onDragStop.bind(this),abort:"pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.allowDragAndDrop&&e.allowDragAndDrop?"":".e-pivot-button":e.allowDragAndDrop?"":".e-pivot-button"})}createButtonDragIcon(e,t){let i=(0,a.az)("span",{attrs:{tabindex:"-1","aria-disabled":"false"}}),s=(0,a.az)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("drag")},className:"e-icons e-drag "+(e.allowDragAndDrop?"":an)});return i.appendChild(s),"pivotfieldlist"===this.parent.getModuleName()&&t.appendChild(i),i}createSortOption(e,t,i){let s,o,l;if(l="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.parent.allowDeferLayoutUpdate){s="";for(let e=0;e<this.parent.dataSourceSettings.sortSettings.length;e++)this.parent.dataSourceSettings.sortSettings[e].name===t&&(s="Descending"===this.parent.dataSourceSettings.sortSettings[e].order?$r:"")}else s="Descending"===l.fieldList[t].sort?$r:"";return o=(0,a.az)("span","None"===l.fieldList[t].sort?{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("sort")},className:Gr}:{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("sort")},className:"e-icons e-sort "+s}),this.parent.dataSourceSettings.enableSorting?"pivotview"===this.parent.getModuleName()?i.showSortIcon&&this.parent.groupingBarSettings.showSortIcon?(0,a.IV)([o],Yr):(0,a.cn)([o],Yr):i.showSortIcon?(0,a.IV)([o],Yr):(0,a.cn)([o],Yr):(0,a.cn)([o],Yr),e.appendChild(o),o}createFilterOption(e,t,i,s){let o,l;if(l="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.parent.allowDeferLayoutUpdate){o=tn;for(let e=0;e<this.parent.dataSourceSettings.filterSettings.length;e++)this.parent.dataSourceSettings.filterSettings[e].name===t&&(o=sn)}else l.fieldList[t].filter=null===l.fieldList[t].filter?[]:l.fieldList[t].filter,o=0===l.fieldList[t].filter.length?l.fieldList[t].isExcelFilter?sn:tn:sn;let r=(0,a.az)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("filter")},className:"e-btn-filter e-icons "+o});return(this.parent.dataSourceSettings.allowLabelFilter||this.parent.dataSourceSettings.allowValueFilter)&&"filters"!==i||this.parent.dataSourceSettings.allowMemberFilter?(0,a.IV)([r],Yr):(0,a.cn)([r],Yr),"pivotview"===this.parent.getModuleName()?((this.parent.dataSourceSettings.allowLabelFilter||this.parent.dataSourceSettings.allowValueFilter)&&"filters"!==i||this.parent.dataSourceSettings.allowMemberFilter)&&this.parent.groupingBarSettings.showFilterIcon&&s.showFilterIcon?(0,a.IV)([r],Yr):(0,a.cn)([r],Yr):s.showFilterIcon&&((this.parent.dataSourceSettings.allowLabelFilter||this.parent.dataSourceSettings.allowValueFilter)&&"filters"!==i||this.parent.dataSourceSettings.allowMemberFilter)?(0,a.IV)([r],Yr):(0,a.cn)([r],Yr),e.appendChild(r),r}updateButtontext(e){let t;t="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;let i,s=t.fieldList[e].filter.length,o=t.fieldList[e].filterType,l=t.fieldList[e].dateMember.length,a=t.fieldList[e].filter[0];if("olap"===this.parent.dataType)i=this.updateOlapButtonText(t,e,a,s);else if("include"===o)1===s?i=a:s>1&&(i=this.parent.localeObj.getConstant(s===l?"all":"multipleItems"));else if("exclude"===o){if(1===s)i=2===l?a!==t.fieldList[e].dateMember[0].actualText?a:t.fieldList[e].dateMember[0].actualText:this.parent.localeObj.getConstant("multipleItems");else if(s>1){let o,l=Object.keys(t.fieldList[e].members),a=t.fieldList[e].filter;if(s===l.length-1){e:for(o=0;o<l.length;o++)if(-1===a.indexOf(l[o])){i=l[o];break e}}else i=this.parent.localeObj.getConstant("multipleItems")}}else i=this.parent.localeObj.getConstant("all");return i}updateOlapButtonText(e,t,i,s){let o,l=e.fieldList[t].actualFilter;if(l.length>0){let o=e.fieldList[t].members,a=[];if(e.fieldList[t].filterMembers.length>0){let e={};for(let i of l)e[i]=i,o[i]&&(e=this.parent.pivotCommon.eventBase.getParentNode(t,i,e));let s=e?Object.keys(e):[];for(let t of s)o[t].isSelected&&(o[t].parent&&o[o[t].parent].isSelected||a.push(t));i=1===a.length?o[a[0]].caption:i}s=0===a.length?s:a.length}return 0===s?o=e.fieldList[t].allMember?e.fieldList[t].allMember:this.parent.localeObj.getConstant("all"):1===s?o=i:s>1&&(o=this.parent.localeObj.getConstant("multipleItems")),o}createDragClone(e){let t=(0,a.oq)(e.element,".e-pivot-button"),i=(0,a.az)("div",{id:this.parent.element.id+"_DragClone",className:"e-button-drag-clone"}),s=(0,a.az)("span",{className:"e-text-content",innerHTML:t.textContent});return i.appendChild(s),document.body.appendChild(i),i}onDragStart(e){let t=(0,a.oq)(e.element,".e-pivot-button"),i=document.getElementById(this.parent.element.id+"_DragClone"),s=br.getFieldInfo(t.getAttribute("data-uid"),this.parent),o={fieldName:s.fieldName,fieldItem:s.fieldItem,axis:s.axis,dataSourceSettings:br.getClonedDataSourceSettings(this.parent.dataSourceSettings),cancel:!1};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(kr,o,s=>{if(s.cancel)this.parent.isDragging=!1,this.draggable.intDestroy(e.event),(0,a.og)(i);else{let s;this.parent.isDragging=!0,s="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;let o=s.fieldList[t.getAttribute("data-uid")],l=[gn,mn,bn];if((0,a.cn)([t],yn),i&&"Popup"===("pivotfieldlist"===this.parent.getModuleName()&&this.parent.renderMode)&&(i.style.zIndex=(this.parent.dialogRenderer.fieldListDialog.zIndex+1).toString()),o&&"CalculatedField"===o.aggregateType)for(let e of l)(0,a.cn)([this.parentElement.querySelector("."+e)],fn);(0,a.xr)()&&e.bindEvents(e.dragElement)}})}onDragging(e){this.draggable.setProperties({cursorAt:{top:!(0,a.le)(e.event.targetTouches)||a.AR.isDevice?60:-20}})}onDragStop(e){this.parent.isDragging=!1,e.target&&e.element&&(0,a.oq)(e.element,".e-group-all-fields")&&!(0,a.oq)(e.target,".e-droppable")&&(e.cancel=!0);let t=(0,a.oq)(e.element,".e-pivot-button");(0,a.IV)([].slice.call(this.parentElement.querySelectorAll(".e-pivot-button")),yn),(0,a.IV)([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator")),rn);let i=[gn,mn,bn];for(let s of i)(0,a.IV)([this.parentElement.querySelector("."+s)],fn);this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close(),document.getElementById(this.parent.element.id+"_DragClone")&&(0,a.Od)(document.getElementById(this.parent.element.id+"_DragClone")),document.body.style.cursor="auto",this.isButtonDropped(e.target,t)&&!e.cancel&&(this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.nodeStateModified.onStateModified(e,t.id))&&(this.updateDataSource(),this.parent.axisFieldModule.render())}isButtonDropped(e,t){let i=(0,a.oq)(t,".e-droppable"),s=(0,a.oq)(e,".e-droppable"),o=!0;if(i&&i===s){let s,l=[].slice.call(i.querySelectorAll(".e-pivot-button")),r=(0,a.oq)(e,".e-pvt-btn-div"),n=-1;for(let e=0,i=l.length;e<i;e++)if(l[e].id===t.id&&(s=e),r){let t=r.querySelector(".e-pivot-button");l[e].id===t.id&&(n=e)}(s===n||s===l.length-1&&-1===n)&&((0,a.IV)([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator")),rn),o=!1)}return o}updateSorting(e){let t=(0,a.oq)(e.target,".e-pivot-button"),i=br.getFieldInfo(t?t.id:"",this.parent);if(!e.target.classList.contains(en)&&!e.target.classList.contains(on)&&!e.target.classList.contains(ln)&&t&&i.fieldItem&&(i.fieldItem.showSortIcon||(0,a.le)(i.fieldItem.showSortIcon))&&(this.parent instanceof yc||this.parent.groupingBarSettings.showSortIcon)&&this.parent.dataSourceSettings.enableSorting&&("olap"!==this.parent.dataType||!("pivotfieldlist"===this.parent.getModuleName()&&void 0!==this.parent.pivotGridModule&&this.parent.pivotGridModule.enableVirtualization||"pivotview"===this.parent.getModuleName()&&this.parent.enableVirtualization))){("pivotview"===this.parent.getModuleName()&&this.parent.enableValueSorting||"pivotfieldlist"===this.parent.getModuleName()&&void 0!==this.parent.pivotGridModule&&this.parent.pivotGridModule.enableValueSorting)&&(this.parent.enableValueSorting||this.parent.pivotGridModule.enableValueSorting)&&(e.target.classList.contains("e-pivot-button")?"rows"===e.target.parentElement.getAttribute("data-tag").split(":")[0]&&this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0):"rows"===e.target.parentElement.parentElement.getAttribute("data-tag").split(":")[0]&&this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0)),this.parent.pivotCommon.eventBase.updateSorting(e),this.parent.allowDeferLayoutUpdate&&"pivotfieldlist"===this.parent.getModuleName()||this.updateDataSource(!0);let t=this;t.parent instanceof yc&&t.axisField.render()}}updateDataSource(e){this.parent.allowDeferLayoutUpdate&&"pivotview"!==this.parent.getModuleName()?"pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView&&this.parent.pivotGridModule?("olap"===this.parent.dataType?this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule:this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.notify(Or,this),this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0)):this.parent.triggerPopulateEvent():this.parent.updateDataSource(e)}updateFiltering(e){let t=this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent;"pivotfieldlist"===t.getModuleName()?(0,n.yh)(t.fieldListSpinnerElement):t.showWaitingPopup(),t.mouseEventArgs=e,t.filterTargetID="pivotfieldlist"!==this.parent.pivotCommon.moduleName?this.parent.element:document.getElementById(this.parent.pivotCommon.parentID+"_Wrapper");let i=e.target.parentElement.id;if(t&&t.enableVirtualization&&(0,a.xr)()&&"pivot"===t.dataType){let e=this;t.interopAdaptor.invokeMethodAsync("PivotInteropMethod","fetchFieldMembers",i).then(t=>{let s=JSON.parse(t.dateMembers),o=[],l={},a={};for(let e=0;e<s.length;e++)o.push({formattedText:s[e].FormattedText,actualText:s[e].ActualText}),l[s[e].FormattedText]={},a[s[e].ActualText]={};e.parent.engineModule.fieldList[i].dateMember=o,e.parent.engineModule.fieldList[i].formattedMembers=l,e.parent.engineModule.fieldList[i].members=a,e.updateFilterEvents()})}else"Server"===t.dataSourceSettings.mode?this.parent.engineModule.fieldList[i].members&&Object.keys(this.parent.engineModule.fieldList[i].members).length>0?this.updateFilterEvents():t.getEngine("fetchFieldMembers",null,null,null,null,null,i):this.updateFilterEvents()}updateFilterEvents(){let e=this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent;this.parent.pivotCommon.eventBase.updateFiltering(e.mouseEventArgs),this.fieldName=e.mouseEventArgs.target.parentElement.id,this.parent.pivotCommon.filterDialog.dialogPopUp&&(this.dialogPopUp=this.parent.pivotCommon.filterDialog.dialogPopUp,this.parent.pivotCommon.filterDialog.dialogPopUp.close=this.removeFilterDialog.bind(this),this.bindDialogEvents()),"pivotfieldlist"===e.getModuleName()?(0,n.v3)(e.fieldListSpinnerElement):e.hideWaitingPopup()}bindDialogEvents(){this.parent.pivotCommon.filterDialog.allowExcelLikeFilter&&this.parent.pivotCommon.filterDialog.tabObj?(this.index=this.parent.pivotCommon.filterDialog.tabObj.selectedItem,this.updateDialogButtonEvents(),this.dialogPopUp.buttons=this.buttonModel(),this.dialogPopUp.dataBind(),this.parent.pivotCommon.filterDialog.tabObj.selected=this.tabSelect.bind(this)):this.parent.dataSourceSettings.allowMemberFilter&&(this.index=0,this.updateDialogButtonEvents())}buttonModel(){return[{buttonModel:{cssClass:"e-clear-filter-button"+(this.parent.pivotCommon.filterDialog.allowExcelLikeFilter?"":" e-disable"),iconCss:"e-icons e-clear-filter-icon",enableRtl:this.parent.enableRtl,content:this.parent.localeObj.getConstant("clearFilter"),disabled:!this.parent.pivotCommon.filterDialog.filterObject},click:this.ClearFilter.bind(this)},{buttonModel:{cssClass:cn,content:this.parent.localeObj.getConstant("ok"),isPrimary:!0},click:0===this.index?this.updateFilterState.bind(this,this.fieldName):this.updateCustomFilter.bind(this)},{click:this.parent.pivotCommon.filterDialog.closeFilterDialog.bind(this),buttonModel:{cssClass:pn,content:this.parent.localeObj.getConstant("cancel")}}]}tabSelect(e){this.index=e.selectedIndex,this.updateDialogButtonEvents(),(0,a.IV)([].slice.call(this.dialogPopUp.element.querySelectorAll(".e-selected-tab")),"e-selected-tab"),e.selectedIndex>0&&(0,a.cn)([this.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===e.selectedIndex&&this.parent.dataSourceSettings.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab"),0===e.selectedIndex?this.parent.pivotCommon.filterDialog.updateCheckedState():(this.dialogPopUp.buttons[0].buttonModel.disabled=!1,this.dialogPopUp.element.querySelector(".e-ok-btn").removeAttribute("disabled"))}updateDialogButtonEvents(){this.dialogPopUp.buttons=this.buttonModel(),this.dialogPopUp.dataBind()}updateCustomFilter(e){let t,i=this.dialogPopUp.element.querySelector(".e-selected-tab"),s=i.getAttribute("data-fieldname"),o=i.getAttribute("data-selectedField"),l=i.getAttribute("data-type"),r=i.getAttribute("data-measure"),n=i.getAttribute("data-operator"),h=i.getAttribute("data-value1"),d=i.getAttribute("data-value2"),c="value"===l?"Value":"date"===l?"Date":"number"===l?"Number":"Label",p={name:s,type:c,measure:r,condition:n,value1:"date"!==l||(0,a.xr)()?h:new Date(h),value2:"date"!==l||(0,a.xr)()?d:new Date(d)};if("olap"===this.parent.dataType){p.selectedField=o,this.removeDataSourceSettings(s,o,c);let e=this.parent.dataSourceSettings.filterSettings;for(let i of e)i.name===s&&i.selectedField===o&&(t=i)}else t=br.getFilterItemByName(s,this.parent.dataSourceSettings.filterSettings);if((0,a.le)(h)||""===h||["Between","NotBetween"].indexOf(n)>-1&&((0,a.le)(d)||""===d)){let e=c.toLowerCase()+((0,a.le)(h)||""===h?"_input_option_1":"_input_option_2"),t=(0,a.Ys)("#"+this.parent.element.id+"_"+e,i);return(0,a.cn)([t],eh),void t.focus()}let u={cancel:!1,filterSettings:p,dataSourceSettings:br.getClonedDataSourceSettings(this.parent.dataSourceSettings)};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(Rr,u,e=>{e.cancel||(p=e.filterSettings,t?(t=t.properties?t.properties:t,t.type=p.type,t.measure=p.measure,t.condition=p.condition,t.value1=p.value1,t.value2=p.value2,"olap"===this.parent.dataType&&(t.selectedField=p.selectedField)):this.parent.dataSourceSettings.filterSettings.push(p)),"Value"!==c&&(this.parent.lastFilterInfo=br.getFilterItemByName(s,this.parent.dataSourceSettings.filterSettings)),this.dialogPopUp.close(),e.cancel||(this.refreshPivotButtonState(s,!0),this.updateDataSource(!0))})}removeFilterDialog(){this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&(this.dialogPopUp.destroy(),setTimeout(this.setFocus.bind(this))),document.getElementById(this.parentElement.id+"_EditorTreeView")&&(0,a.Od)(document.getElementById(this.parentElement.id+"_EditorTreeView"))}setFocus(){if(this.parentElement){let e=[].slice.call(this.parentElement.querySelectorAll(".e-pivot-button"));for(let t of e)if(t.getAttribute("data-uid")===this.fieldName){t.focus();break}}}ClearFilter(e){let t=this.dialogPopUp.element,i=t.getAttribute("data-fieldname"),s=t.querySelector(".e-selected-tab");if(this.dialogPopUp.close(),"olap"===this.parent.dataType&&s){let e=s.getAttribute("data-selectedField");this.removeDataSourceSettings(i,e)}else this.removeDataSourceSettings(i);let o=br.getFilterItemByName(i,this.parent.dataSourceSettings.filterSettings);this.refreshPivotButtonState(i,!!o),this.updateDataSource(!0)}removeButton(e){let t=e.target,i=t.parentElement.id,s=br.getFieldInfo(i,this.parent),o={cancel:!1,fieldName:i,dataSourceSettings:br.getClonedDataSourceSettings(this.parent.dataSourceSettings),fieldItem:s.fieldItem,axis:s.axis};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(Ir,o,e=>{e.cancel||("true"===t.parentElement.getAttribute("isvalue")?(this.parent.setProperties({dataSourceSettings:{values:[]}},!0),"olap"===this.parent.dataType&&this.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[measures]")):(this.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(i),"olap"===this.parent.dataType&&0===this.parent.dataSourceSettings.values.length&&this.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[measures]")),"pivotfieldlist"===this.parent.getModuleName()&&this.parent.axisFieldModule.render(),this.updateDataSource())})}nodeStateModified(e){let t=(0,a.oq)(e.node,"li"),i=t.getAttribute("data-fieldname");if("all"===t.getAttribute("data-memberId"))this.memberTreeView.nodeChecked=null,"check"===e.action?this.memberTreeView.checkAll():this.memberTreeView.uncheckAll(),"olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.fieldList[i].isHierarchy&&this.updateNodeStates(this.memberTreeView.getAllCheckedNodes(),i,e.action),this.checkedStateAll(e.action),this.memberTreeView.nodeChecked=this.nodeStateModified.bind(this);else{if("olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.fieldList[i].isHierarchy){let t=this.memberTreeView.getAllCheckedNodes();this.updateNodeStates(t,i,e.action)}let s=this.parent.pivotCommon.currentTreeItemsPos[t.getAttribute("data-memberId")].index;this.parent.pivotCommon.currentTreeItems[s]&&(this.parent.pivotCommon.currentTreeItems[s].isSelected="check"===e.action,this.parent.pivotCommon.currentTreeItemsPos[t.getAttribute("data-memberId")].isSelected="check"===e.action)}this.parent.pivotCommon.filterDialog.updateCheckedState()}checkedStateAll(e){let t={};for(let i of this.parent.pivotCommon.searchTreeItems)i.isSelected="check"===e,t[i.htmlAttributes["data-memberId"]]=i.htmlAttributes["data-memberId"];for(let i of this.parent.pivotCommon.currentTreeItems)void 0!==t[i.htmlAttributes["data-memberId"]]&&(i.isSelected="check"===e,this.parent.pivotCommon.currentTreeItemsPos[i.htmlAttributes["data-memberId"]].isSelected="check"===e)}updateNodeStates(e,t,i){let s=this.parent.pivotCommon.engineModule.fieldList[t],o=s.members,l=s.currrentMembers;if(s.searchMembers.length>0){let i=Object.keys(l);for(let e of i)if(l[e]&&(l[e].isSelected=!1),o[e]&&(o[e].isSelected=!1,this.memberTreeView.element.querySelector('li[data-memberId="'+e+'"]'))){let i=this.memberTreeView.element.querySelector('li[data-memberId="'+e+'"]');i&&!i.querySelector("ul")&&this.parent.pivotCommon.eventBase.updateChildNodeStates(s.filterMembers,t,e,!1)}for(let a of e){if(o[a]&&this.memberTreeView.element.querySelector('li[data-memberId="'+a+'"]')){let e=this.memberTreeView.element.querySelector('li[data-memberId="'+a+'"]');e&&!e.querySelector("ul")&&(o[a].isSelected=!0,this.parent.pivotCommon.eventBase.updateChildNodeStates(s.filterMembers,t,a,!0))}l[a]&&(l[a].isSelected=!0)}}else{let i=Object.keys(o);for(let e of i)o[e].isSelected&&(o[e].isSelected=!1);for(let l of e)o[l]&&(o[l].isSelected=!0,this.parent.pivotCommon.eventBase.updateChildNodeStates(s.filterMembers,t,l,!0))}}updateFilterState(e,t){let i=!1,s={items:[],name:e,type:"Include"},o=this.parent.olapEngineModule;if("olap"===this.parent.dataType&&o&&!o.fieldList[e].isHierarchy){let t=o.fieldList[e].members,l=o.fieldList[e].currrentMembers;if(s.items=this.memberTreeView.getAllCheckedNodes(),s.levelCount=o.fieldList[e].levelCount,i=s.items.length!==this.memberTreeView.fields.dataSource.length,o.fieldList[e].searchMembers.length>0&&!i){let e=Object.keys(t).length,o=Object.keys(l).length;i=e!==o||e!==s.items.length}let a=s.items;for(let i of a)o.fieldList[e].searchMembers.length>0&&l[i]?l[i].isSelected=!0:t[i]&&(t[i].isSelected=!0)}else{for(let e of this.parent.pivotCommon.searchTreeItems)e.isSelected&&s.items.push(this.parent.pivotCommon.isDateField?e.name:e.htmlAttributes["data-memberId"]);i=s.items.length!==this.parent.pivotCommon.currentTreeItems.length}if("olap"===this.parent.dataType&&this.removeDataSourceSettings(e),this.parent.allowDeferLayoutUpdate){this.parent.engineModule.fieldList[s.name].filterType=s.type.toLowerCase(),this.parent.engineModule.fieldList[s.name].filter=[];for(let e=0;e<s.items.length;e++)this.parent.engineModule.fieldList[s.name].filter.push(s.items[e])}let l={filterSettings:s,dataSourceSettings:br.getClonedDataSourceSettings(this.parent.dataSourceSettings),cancel:!1};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(Rr,l,t=>{if(s=t.filterSettings,!t.cancel){if(br.getFilterItemByName(e,this.parent.dataSourceSettings.filterSettings))for(let t=0;t<this.parent.dataSourceSettings.filterSettings.length;t++)if(this.parent.dataSourceSettings.filterSettings[t].name===e){this.parent.dataSourceSettings.filterSettings.splice(t,1);break}this.parent.dataSourceSettings.filterSettings.push(s)}if(this.dialogPopUp.close(),!t.cancel){this.refreshPivotButtonState(e,i),i||this.removeDataSourceSettings(e),this.parent.lastFilterInfo=s,this.updateDataSource(!0);let t=this;t.parent instanceof yc&&t.axisField.render()}let o=[].slice.call(this.parentElement.querySelectorAll(".e-pivot-button"));for(let i of o)if(i.getAttribute("data-uid")===e){i.focus();break}})}refreshPivotButtonState(e,t){let i,s=[].slice.call(this.parentElement.querySelectorAll(".e-pivot-button"));for(let o of s)if(o.getAttribute("data-uid")===e){i=o.querySelector(".e-btn-filter");break}t?((0,a.IV)([i],tn),(0,a.cn)([i],sn)):((0,a.IV)([i],sn),(0,a.cn)([i],tn))}removeDataSourceSettings(e,t,i){let s=this.parent.dataSourceSettings.filterSettings;for(let o=0,l=s.length;o<l;o++)if("olap"===this.parent.dataType&&t){if(!i&&s[o].name===e&&s[o].selectedField===t){s.splice(o,1);break}i&&s[o].type!==i&&s[o].name===e&&(s.splice(o,1),l--,o--)}else if(s[o].name===e){if(s.splice(o,1),"olap"!==this.parent.dataType)break;l--,o--}}updateDropIndicator(e){if(this.parent.isDragging&&((0,a.IV)([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator-last")),rn),(0,a.IV)([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator")),rn),(0,a.oq)(e.target,".e-droppable"))){let t=(0,a.oq)(e.target,".e-pvt-btn-div");(0,a.cn)([t.querySelector(".e-drop-indicator")],rn)}}wireEvent(e,t,i){a.bi.add(e,"mouseover",this.updateDropIndicator,this),i||(-1===["filters","values"].indexOf(t)&&null!==e.querySelector(".e-pivot-button")&&a.bi.add(e.querySelector(".e-pivot-button"),"click",this.updateSorting,this),"values"!==t&&null!==e.querySelector(".e-btn-filter")&&a.bi.add(e.querySelector(".e-btn-filter"),"click",this.updateFiltering,this),"values"===t&&null!==e.querySelector(".e-dropdown-icon")&&a.bi.add(e.querySelector(".e-dropdown-icon"),"click",this.createMenuOption,this)),null!==e.querySelector(".e-edit")&&a.bi.add(e.querySelector(".e-edit"),"click",this.openCalculatedFieldDialog,this),null!==e.querySelector(".e-remove")&&a.bi.add(e.querySelector(".e-remove"),"click",this.removeButton,this)}unWireEvent(e,t,i){a.bi.remove(e,"mouseover",this.updateDropIndicator),i||(-1===["filters","values"].indexOf(t)&&null!==e.querySelector(".e-pivot-button")&&a.bi.remove(e.querySelector(".e-pivot-button"),"click",this.updateSorting),"values"!==t&&null!==e.querySelector(".e-btn-filter")&&a.bi.remove(e.querySelector(".e-btn-filter"),"click",this.updateFiltering),"values"===t&&null!==e.querySelector(".e-dropdown-icon")&&a.bi.remove(e.querySelector(".e-dropdown-icon"),"click",this.createMenuOption)),null!==e.querySelector(".e-edit")&&a.bi.remove(e.querySelector(".e-edit"),"click",this.openCalculatedFieldDialog),null!==e.querySelector(".e-remove")&&a.bi.remove(e.querySelector(".e-remove"),"click",this.removeButton)}addEventListener(){this.handlers={load:this.renderPivotButton},this.parent.isDestroyed||this.parent.on(Zr,this.handlers.load,this)}removeEventListener(){this.parent.isDestroyed||this.parent.off(Zr,this.handlers.load)}destroy(){this.menuOption&&this.menuOption.destroy(),this.valueFiedDropDownList&&!this.valueFiedDropDownList.isDestroyed&&(this.valueFiedDropDownList.destroy(),this.valueFiedDropDownList=null),this.columnFieldDropDownList&&!this.columnFieldDropDownList.isDestroyed&&(this.columnFieldDropDownList.destroy(),this.columnFieldDropDownList=null),this.memberTreeView&&!this.memberTreeView.isDestroyed&&(this.memberTreeView.destroy(),this.memberTreeView=null),this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&(this.dialogPopUp.destroy(),this.dialogPopUp=null),this.draggable&&!this.draggable.isDestroyed&&(this.draggable.destroy(),this.draggable=null),this.axisField&&(this.axisField=null),this.removeEventListener(),this.isDestroyed=!0}}class mc{constructor(e){this.parent=e}render(){(!this.parent.pivotButtonModule||this.parent.pivotButtonModule&&this.parent.pivotButtonModule.isDestroyed)&&new gc(this.parent),this.createPivotButtons()}createPivotButtons(){(0,a.le)(this.parent.dataSourceSettings.dataSource)&&(0,a.le)(this.parent.dataSourceSettings.url)&&this.parent.setProperties({dataSourceSettings:{columns:[],rows:[],values:[],filters:[]}},!0);let e=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],t=this.parent.dialogRenderer.parentElement;t.querySelector(".e-field-list-filters")&&(t.querySelector(".e-field-list-filters").querySelector(".e-axis-content").innerHTML=""),t.querySelector(".e-field-list-rows")&&(t.querySelector(".e-field-list-rows").querySelector(".e-axis-content").innerHTML=""),t.querySelector(".e-field-list-columns")&&(t.querySelector(".e-field-list-columns").querySelector(".e-axis-content").innerHTML=""),t.querySelector(".e-field-list-values")&&(t.querySelector(".e-field-list-values").querySelector(".e-axis-content").innerHTML="");let i=["rows","columns","values","filters"];for(let s=0,o=e.length;s<o;s++)if(e[s]){let t={field:e[s],axis:i[s].toString()};this.parent.notify(Zr,t)}}}class bc{constructor(e){this.parent=e,this.parent.dialogRenderer=new cc(this.parent),this.parent.treeViewModule=new pc(this.parent),this.parent.axisTableModule=new uc(this.parent),this.parent.axisFieldModule=new mc(this.parent)}render(){this.parent.dialogRenderer.render(),this.parent.isAdaptive||this.parent.treeViewModule.render(),this.parent.axisTableModule.render()}}var fc=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a};let yc=class extends a.wA{constructor(e,t){super(e,t),this.pivotChange=!1,this.isRequiredUpdate=!0,this.lastSortInfo={},this.lastFilterInfo={},this.lastAggregationInfo={},this.lastCalcFieldInfo={},this.isPopupView=!1,this.enableValueSorting=!1,this.request=new XMLHttpRequest,this.remoteData=[]}requiredModules(){let e=[];return this.allowCalculatedField&&e.push({args:[this],member:"calculatedField"}),e}getAllSummaryType(){return["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"]}preRender(){this.dataSourceSettings&&"SSAS"===this.dataSourceSettings.providerType?(this.olapEngineModule=new ic,this.dataType="olap"):(this.engineModule=new fr,this.dataType="pivot"),this.isAdaptive=a.AR.isDevice,this.globalize=new a.eC(this.locale),this.renderModule=new bc(this),this.defaultLocale={staticFieldList:"Pivot Field List",fieldList:"Field List",dropFilterPrompt:"Drop filter here",dropColPrompt:"Drop column here",dropRowPrompt:"Drop row here",dropValPrompt:"Drop value here",addPrompt:"Add field here",adaptiveFieldHeader:"Choose field",centerHeader:"Drag fields between axes below:",add:"add",drag:"Drag",filter:"Filter",filtered:"Filtered",sort:"Sort",remove:"Remove",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",CalculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",search:"Search",close:"Close",cancel:"Cancel",delete:"Delete",alert:"Alert",warning:"Warning",ok:"OK",allFields:"All Fields",formula:"Formula",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",clearCalculatedField:"Clear edited field info",editCalculatedField:"Edit calculated field",sortAscending:"Sort ascending order",sortDescending:"Sort descending order",sortNone:"Sort data order",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",enterValue:"Enter value",chooseDate:"Enter date",all:"All",multipleItems:"Multiple items",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",member:"Member",label:"Label",date:"Date",value:"Value",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",And:"and",Sum:"Sum",Count:"Count",DistinctCount:"Distinct Count",Product:"Product",Avg:"Avg",Median:"Median",Min:"Min",Max:"Max",Index:"Index",SampleStDev:"Sample StDev",PopulationStDev:"Population StDev",SampleVar:"Sample Var",PopulationVar:"Population Var",RunningTotals:"Running Totals",DifferenceFrom:"Difference From",PercentageOfDifferenceFrom:"% of Difference From",PercentageOfGrandTotal:"% of Grand Total",PercentageOfColumnTotal:"% of Column Total",PercentageOfRowTotal:"% of Row Total",PercentageOfParentTotal:"% of Parent Total",PercentageOfParentColumnTotal:"% of Parent Column Total",PercentageOfParentRowTotal:"% of Parent Row Total",MoreOption:"More...",Years:"Years",Quarters:"Quarters",Months:"Months",Days:"Days",Hours:"Hours",Minutes:"Minutes",Seconds:"Seconds",apply:"Apply",valueFieldSettings:"Value field settings",sourceName:"Field name :",sourceCaption:"Field caption",summarizeValuesBy:"Summarize values by",baseField:"Base field",baseItem:"Base item",example:"e.g:",editorDataLimitMsg:" more items. Search to refine further.",deferLayoutUpdate:"Defer Layout Update",null:"null",undefined:"undefined",groupOutOfRange:"Out of Range",fieldDropErrorAction:"The field you are moving cannot be placed in that area of the report",memberType:"Field Type",selectedHierarchy:"Parent Hierarchy",formatString:"Format",expressionField:"Expression",olapDropText:"Example: [Measures].[Order Quantity] + ([Measures].[Order Quantity] * 0.10)",customFormat:"Enter custom format string",numberFormatString:"Example: C, P, 0000 %, ###0.##0#, etc.",Measure:"Measure",Dimension:"Dimension",Standard:"Standard",Currency:"Currency",Percent:"Percent",Custom:"Custom",blank:"(Blank)",fieldTooltip:'Drag and drop fields to create an expression. And, if you want to edit the existing calculated fields! You can achieve it by simply selecting the field under "Calculated Members".',fieldTitle:"Field Name",QuarterYear:"Quarter Year",caption:"Field Caption",copy:"Copy",of:"of",group:"Group",removeCalculatedField:"Are you sure you want to delete this calculated field?",yes:"Yes",no:"No"},this.localeObj=new a.E7(this.getModuleName(),this.defaultLocale,this.locale),this.isDragging=!1,this.captionData=[],this.wireEvent()}frameCustomProperties(e,t){this.pivotGridModule&&this.pivotGridModule.updatePageSettings(!1);let i,s=this.pivotGridModule?this.pivotGridModule.pageSettings:this.pageSettings,o=this.pivotGridModule?this.pivotGridModule.localeObj:this.staticPivotGridModule?this.staticPivotGridModule.localeObj:this.localeObj,l=!this.pivotGridModule||this.pivotGridModule.allowDrillThrough||this.pivotGridModule.editSettings.allowEditing,a=this.pivotGridModule?this.pivotGridModule.enableValueSorting:void 0;return i="olap"===this.dataType?{mode:"",savedFieldList:t||void 0,savedFieldListData:e||void 0,pageSettings:s,enableValueSorting:a,isDrillThrough:l,localeObj:o}:{mode:"",savedFieldList:void 0,pageSettings:s,enableValueSorting:a,isDrillThrough:l,localeObj:o,clonedReport:this.clonedReport},i}render(){"pivot"===this.dataType&&this.dataSourceSettings.url&&""!==this.dataSourceSettings.url?"Server"===this.dataSourceSettings.mode?(this.guid=br.generateUUID(),this.getEngine("initialRender",null,null,null,null,null,null)):(this.request.open("GET",this.dataSourceSettings.url,!0),this.request.withCredentials=!1,this.request.onreadystatechange=this.onReadyStateChange.bind(this),this.request.setRequestHeader("Content-type","text/plain"),this.request.send(null)):this.initialLoad()}getEngine(e,t,i,s,o,l,a,r,n){this.currentAction=e,this.pivotGridModule&&this.pivotGridModule.updatePageSettings(!1);let h={pageSettings:this.pivotGridModule?this.pivotGridModule.pageSettings:void 0,enableValueSorting:this.pivotGridModule?this.pivotGridModule.enableValueSorting:void 0,enableDrillThrough:!this.pivotGridModule||this.pivotGridModule.allowDrillThrough||this.pivotGridModule.editSettings.allowEditing,locale:JSON.stringify(br.getLocalizedObject(this))};this.request.open("POST",this.dataSourceSettings.url,!0);let d={request:this.request,dataSourceSettings:JSON.parse(this.getPersistData()).dataSourceSettings,action:e,customProperties:{},internalProperties:h,drillItem:t,sortItem:i,aggregatedItem:s,calculatedItem:o,filterItem:l,memberName:a,fetchRawDataArgs:r,editArgs:n,hash:this.guid};this.trigger(Er,d,e=>{this.request=e.request,d.internalProperties=e.internalProperties,d.customProperties=e.customProperties,d.dataSourceSettings=e.dataSourceSettings,d.calculatedItem=e.calculatedItem,d.drillItem=e.drillItem,d.editArgs=e.editArgs,d.fetchRawDataArgs=e.fetchRawDataArgs,d.filterItem=e.filterItem,d.hash=e.hash,d.memberName=e.memberName,d.sortItem=e.sortItem}),this.request.withCredentials=!1,this.request.onreadystatechange=this.onSuccess.bind(this),this.request.setRequestHeader("Content-type","application/json"),this.request.send(JSON.stringify(d))}onSuccess(){if(this.request.readyState===XMLHttpRequest.DONE){try{let e=JSON.parse(this.request.responseText);if("fetchFieldMembers"===this.currentAction){let t=JSON.parse(e.members),i=[],s={},o={};for(let e=0;e<t.length;e++)i.push({formattedText:t[e].FormattedText,actualText:t[e].ActualText}),s[t[e].FormattedText]={},o[t[e].ActualText]={};this.engineModule.fieldList[e.memberName].dateMember=i,this.engineModule.fieldList[e.memberName].formattedMembers=s,this.engineModule.fieldList[e.memberName].members=o,this.pivotButtonModule.updateFilterEvents()}else{let t,i=br.formatFieldList(JSON.parse(e.fieldList));if(this.engineModule.fieldList){let e=Object.keys(this.engineModule.fieldList);for(let t=0;t<e.length;t++)this.engineModule.fieldList[e[t]]&&i[e[t]]&&(i[e[t]].dateMember=this.engineModule.fieldList[e[t]].dateMember,i[e[t]].formattedMembers=this.engineModule.fieldList[e[t]].formattedMembers,i[e[t]].members=this.engineModule.fieldList[e[t]].members)}this.engineModule.fieldList=i,this.engineModule.fields=JSON.parse(e.fields),this.engineModule.rowCount=JSON.parse(e.pivotCount).RowCount,this.engineModule.columnCount=JSON.parse(e.pivotCount).ColumnCount,this.engineModule.rowStartPos=JSON.parse(e.pivotCount).RowStartPosition,this.engineModule.colStartPos=JSON.parse(e.pivotCount).ColumnStartPosition,this.engineModule.rowFirstLvl=JSON.parse(e.pivotCount).RowFirstLevel,this.engineModule.colFirstLvl=JSON.parse(e.pivotCount).ColumnFirstLevel;let s=br.formatPivotValues(JSON.parse(e.pivotValue));for(let e=0;e<s.length;e++)if(s[e]&&s[e][0]&&"row"===s[e][0].axis){t=e;break}this.engineModule.headerContent=br.frameContent(s,"header",t,this),this.engineModule.pageSettings=this.pivotGridModule?this.pivotGridModule.pageSettings:void 0;let o=JSON.parse(e.dataSourceSettings).ValueSortSettings;this.engineModule.valueSortSettings={headerText:o.HeaderText,headerDelimiter:o.HeaderDelimiter,sortOrder:o.SortOrder,columnIndex:o.ColumnIndex},this.engineModule.pivotValues=s}}catch(e){this.engineModule.pivotValues=[]}"fetchFieldMembers"!==this.currentAction&&(this.initEngine(),this.calculatedFieldModule&&this.calculatedFieldModule.isRequireUpdate&&(this.calculatedFieldModule.endDialog(),this.calculatedFieldModule.isRequireUpdate=!1),this.pivotGridModule&&this.pivotGridModule.calculatedFieldModule&&this.pivotGridModule.calculatedFieldModule.isRequireUpdate&&(this.pivotGridModule.calculatedFieldModule.endDialog(),this.pivotGridModule.calculatedFieldModule.isRequireUpdate=!1))}}onReadyStateChange(){if(this.request.readyState===XMLHttpRequest.DONE){let t=[];if("CSV"===this.dataSourceSettings.type){let e=this.request.responseText.split(/\r?\n|\r/);for(let i=0;i<e.length;i++)(0,a.le)(e[i])||""===e[i]||t.push(e[i].split(","))}else try{t=JSON.parse(this.request.responseText)}catch(e){t=[]}(0,a.xr)()&&t&&t.length>0?this.remoteData=t:t&&t.length>0&&this.setProperties({dataSourceSettings:{dataSource:t}},!0),this.initialLoad()}}initialLoad(){this.trigger(yr,{dataSourceSettings:(0,a.xr)()?br.getClonedDataSourceSettings(this.dataSourceSettings):this.dataSourceSettings},e=>{(0,a.xr)()&&(e.dataSourceSettings.dataSource=this.dataSourceSettings.dataSource),this.dataSourceSettings=e.dataSourceSettings,(0,a.cn)([this.element],jr),this.enableRtl?(0,a.cn)([this.element],Hr):(0,a.IV)([this.element],Hr),this.isAdaptive?(0,a.cn)([this.element],qr):(0,a.IV)([this.element],qr),this.cssClass&&(0,a.cn)([this.element],this.cssClass),this.notify(Fr,{})}),(0,a.xr)()&&this.renderComplete()}wireEvent(){this.on(Fr,this.generateData,this),this.on(zr,this.fieldListRender,this)}unWireEvent(){this.pivotGridModule&&this.pivotGridModule.isDestroyed||(this.off(Fr,this.generateData),this.off(zr,this.fieldListRender))}getPersistData(){return this.addOnPersist(["dataSourceSettings"])}getModuleName(){return"pivotfieldlist"}onPropertyChanged(e,t){let i=!1;for(let s of Object.keys(e)){switch(s){case"locale":if((0,a.xr)())break;super.refresh();break;case"dataSourceSettings":if((0,a.le)(e.dataSourceSettings.dataSource)||((0,a.le)(this.savedDataSourceSettings)||(br.updateDataSourceSettings(this.staticPivotGridModule,this.savedDataSourceSettings),this.savedDataSourceSettings=void 0),e.dataSourceSettings.dataSource&&0===e.dataSourceSettings.dataSource.length&&!(0,a.le)(this.staticPivotGridModule)&&(this.savedDataSourceSettings=br.getClonedDataSourceSettings(this.staticPivotGridModule.dataSourceSettings),this.staticPivotGridModule.setProperties({dataSourceSettings:{rows:[]}},!0),this.staticPivotGridModule.setProperties({dataSourceSettings:{columns:[]}},!0),this.staticPivotGridModule.setProperties({dataSourceSettings:{values:[]}},!0),this.staticPivotGridModule.setProperties({dataSourceSettings:{filters:[]}},!0)),this.engineModule.fieldList=null,(0,a.le)(this.staticPivotGridModule)||(this.staticPivotGridModule.pivotValues=[]),this.initEngine()),br.isButtonIconRefesh(s,t,e)){if(this.isPopupView&&this.pivotGridModule&&this.pivotGridModule.showGroupingBar&&this.pivotGridModule.groupingBarModule){let e=br.cloneFieldSettings(this.dataSourceSettings.filters),t=br.cloneFieldSettings(this.dataSourceSettings.values),i=br.cloneFieldSettings(this.dataSourceSettings.rows),s=br.cloneFieldSettings(this.dataSourceSettings.columns);this.pivotGridModule.setProperties({dataSourceSettings:{rows:i,columns:s,values:t,filters:e}},!0),this.pivotGridModule.axisFieldModule.render()}else if(!this.isPopupView&&this.staticPivotGridModule&&!this.staticPivotGridModule.isDestroyed){let e=this.staticPivotGridModule;if(e.showGroupingBar&&e.groupingBarModule&&e.axisFieldModule.render(),e.showFieldList&&e.pivotFieldListModule){let t=br.cloneFieldSettings(e.dataSourceSettings.rows),i=br.cloneFieldSettings(e.dataSourceSettings.columns),s=br.cloneFieldSettings(e.dataSourceSettings.values),o=br.cloneFieldSettings(e.dataSourceSettings.filters);e.pivotFieldListModule.setProperties({dataSourceSettings:{rows:t,columns:i,values:s,filters:o}},!0),e.pivotFieldListModule.axisFieldModule.render(),e.pivotFieldListModule.treeViewModule.fieldTable&&!e.isAdaptive&&e.pivotFieldListModule.notify(Br,{})}}this.axisFieldModule.render(),this.treeViewModule.fieldTable&&!this.isAdaptive&&this.notify(Br,{})}break;case"aggregateTypes":this.axisFieldModule&&this.axisFieldModule.render(),this.pivotGridModule&&this.pivotGridModule.axisFieldModule&&(this.pivotGridModule.setProperties({aggregateTypes:e.aggregateTypes},!0),this.pivotGridModule.axisFieldModule.render());break;case"enableRtl":this.enableRtl?(0,a.cn)([this.element],Hr):(0,a.IV)([this.element],Hr),i=!0}i&&this.fieldListRender()}}initEngine(){if("pivot"===this.dataType){let e=(0,a.le)(this.dataSourceSettings.dataSource)?(0,a.le)(this.engineModule.data)?void 0:this.engineModule.data[0]:this.dataSourceSettings.dataSource[0];if(e&&this.pivotCommon){let t="[object Array]"==Object.prototype.toString.call(e);if(t&&"JSON"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidJSON"));if(!t&&"CSV"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidCSV"))}}let e={dataSourceSettings:br.getClonedDataSourceSettings(this.dataSourceSettings)},t=this.isPopupView?this.pivotGridModule:this;t.trigger(vr,e,e=>{if(br.updateDataSourceSettings(this,e.dataSourceSettings),"pivot"===this.dataType){if(this.dataSourceSettings.groupSettings&&this.dataSourceSettings.groupSettings.length>0){let e;if(e=(0,a.xr)()?this.engineModule.data:this.dataSourceSettings.dataSource,this.clonedDataSet=this.clonedDataSet?this.clonedDataSet:br.getClonedData(e),(0,a.xr)())this.clonedReport=this.clonedReport?this.clonedReport:(0,a.l7)({},this.dataSourceSettings,null,!0);else{let e=JSON.parse(this.getPersistData()).dataSourceSettings;e.dataSource=[],this.clonedReport=this.clonedReport?this.clonedReport:e}}let e=this.frameCustomProperties();e.enableValueSorting=this.staticPivotGridModule?this.staticPivotGridModule.enableValueSorting:this.enableValueSorting,"Server"!==this.dataSourceSettings.mode&&this.engineModule.renderEngine(this.dataSourceSettings,e,this.getValueCellInfo.bind(this)),this.pivotFieldList=this.engineModule.fieldList;const i=this;t.trigger(Sr,{pivotFieldList:this.pivotFieldList,pivotValues:this.engineModule.pivotValues},e=>{i.pivotFieldList=e.pivotFieldList,i.engineModule.pivotValues=(0,a.xr)()?this.engineModule.pivotValues:e.pivotValues,i.notify(zr,{}),i.trigger(Mr)})}else if("olap"===this.dataType){this.olapEngineModule.renderEngine(this.dataSourceSettings,this.frameCustomProperties(this.olapEngineModule.fieldListData,this.olapEngineModule.fieldList)),this.pivotFieldList=this.olapEngineModule.fieldList;const e=this;t.trigger(Sr,{pivotFieldList:this.pivotFieldList,pivotValues:this.olapEngineModule.pivotValues},t=>{e.pivotFieldList=t.pivotFieldList,e.olapEngineModule.pivotValues=(0,a.xr)()?this.olapEngineModule.pivotValues:t.pivotValues,e.notify(zr,{}),e.trigger(Mr)})}})}generateData(){this.pivotFieldList={},this.dataSourceSettings&&(this.dataSourceSettings.dataSource||this.dataSourceSettings.url)?""!==this.dataSourceSettings.url&&"olap"===this.dataType||this.dataSourceSettings.dataSource.length>0?("pivot"===this.dataType&&(this.engineModule.data=this.dataSourceSettings.dataSource),this.initEngine()):this.dataSourceSettings.dataSource instanceof r.hm&&("pivot"===this.dataType&&this.remoteData.length>0?(this.engineModule.data=this.remoteData,this.initEngine()):setTimeout(this.getData.bind(this),100)):(0,a.xr)()&&"pivot"===this.dataType&&this.engineModule.data&&this.engineModule.data.length>0?this.initEngine():(this.notify(zr,{}),this.trigger(Mr))}getValueCellInfo(e){let t=e;return this.trigger(Dr,t),t}getData(){this.dataSourceSettings.dataSource.executeQuery(new r.AE).then(this.executeQuery.bind(this))}executeQuery(e){this.engineModule.data=e.result,this.initEngine()}fieldListRender(){let e,t;this.element.innerHTML="","Popup"===this.renderMode&&this.dialogRenderer.fieldListDialog&&!this.dialogRenderer.fieldListDialog.isDestroyed&&(e=this.dialogRenderer.fieldListDialog.visible,this.dialogRenderer.fieldListDialog.destroy(),(0,a.Od)(document.getElementById(this.element.id+"_Wrapper"))),this.renderModule.render(),"Popup"===this.renderMode?(this.fieldListSpinnerElement=this.dialogRenderer.fieldListDialog.element,e&&this.dialogRenderer.fieldListDialog.show()):this.fieldListSpinnerElement=this.element.querySelector(".e-pivotfieldlist-wrapper"),(0,n.rj)(this.spinnerTemplate?{target:this.fieldListSpinnerElement,template:this.spinnerTemplate}:{target:this.fieldListSpinnerElement},this.createElement),t={pivotEngine:"olap"===this.dataType?this.olapEngineModule:this.engineModule,dataSourceSettings:this.dataSourceSettings,id:this.element.id,element:document.getElementById(this.element.id+"_Wrapper"),moduleName:this.getModuleName(),enableRtl:this.enableRtl,isAdaptive:this.isAdaptive,renderMode:this.renderMode,localeObj:this.localeObj,dataType:this.dataType},this.pivotCommon=new Th(t),this.pivotCommon.control=this,this.allowDeferLayoutUpdate&&(this.clonedDataSource=(0,a.l7)({},this.dataSourceSettings,null,!0),this.clonedFieldList=(0,a.l7)({},this.pivotFieldList,null,!0))}getFieldCaption(e){if(this.getFields(e),this.captionData.length>0){let e=this.captionData.length,t="olap"===this.dataType?this.olapEngineModule:this.engineModule;for(;e--;)if(this.captionData[e])for(let i of this.captionData[e])i&&t.fieldList[i.name]&&(t.fieldList[i.name].caption=i.caption?i.caption:i.name)}}getFields(e){this.captionData=[e.rows,e.columns,e.values,e.filters]}updateDataSource(e,t){this.pivotGridModule&&this.pivotGridModule.showWaitingPopup(),(0,n.yh)(this.fieldListSpinnerElement);let i=this,s=i.isPopupView?i.pivotGridModule:i,o=!1,l=i.pivotGridModule&&i.pivotGridModule.enableVirtualization?i.pivotGridModule.pageSettings:void 0,r=Object.keys(i.lastCalcFieldInfo).length>0,h=Object.keys(i.lastSortInfo).length>0,d=Object.keys(i.lastAggregationInfo).length>0,c=Object.keys(i.lastFilterInfo).length>0,p={dataSourceSettings:br.getClonedDataSourceSettings(i.dataSourceSettings)};s.trigger(vr,p,n=>{if(l&&(h||c||d||r)||(br.updateDataSourceSettings(i,n.dataSourceSettings),br.updateDataSourceSettings(i.pivotGridModule,n.dataSourceSettings)),(0,a.le)(t)){if("pivot"===i.dataType){let t=i.frameCustomProperties();if(h?(i.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),t.enableValueSorting=!1):t.enableValueSorting=i.staticPivotGridModule?i.staticPivotGridModule.enableValueSorting:i.enableValueSorting,t.savedFieldList=i.pivotFieldList,l&&(h||c||d||r)){let t={};if(h&&(i.pivotGridModule.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),(0,a.xr)()?t={key:"onSort",arg:i.lastSortInfo}:"Server"===s.dataSourceSettings.mode?s.getEngine("onSort",null,i.lastSortInfo,null,null,null,null):i.engineModule.onSort(i.lastSortInfo),i.lastSortInfo={}),c){if((0,a.xr)()){let e=window.sfBlazor.copyWithoutCircularReferences([i.dataSourceSettings.filterSettings],i.dataSourceSettings.filterSettings);t={key:"onFilter",arg:{lastFilterInfo:i.lastFilterInfo,filterSettings:e}}}else"Server"===s.dataSourceSettings.mode?s.getEngine("onFilter",null,null,null,null,i.lastFilterInfo,null):i.engineModule.onFilter(i.lastFilterInfo,i.dataSourceSettings);i.lastFilterInfo={}}if(d&&((0,a.xr)()?t={key:"onAggregation",arg:i.lastAggregationInfo}:"Server"===s.dataSourceSettings.mode?s.getEngine("onAggregation",null,null,i.lastAggregationInfo,null,null,null):i.engineModule.onAggregation(i.lastAggregationInfo),i.lastAggregationInfo={}),r&&((0,a.xr)()?t={key:"onCalcOperation",arg:{lastCalcFieldInfo:i.lastCalcFieldInfo,values:i.dataSourceSettings.values,calculatedFieldSettings:i.dataSourceSettings.calculatedFieldSettings}}:"Server"===s.dataSourceSettings.mode?s.getEngine("onCalcOperation",null,null,null,i.lastCalcFieldInfo,null,null):i.engineModule.onCalcOperation(i.lastCalcFieldInfo),i.lastCalcFieldInfo={}),(0,a.xr)()){let s=window.sfBlazor.copyWithoutCircularReferences([t.arg],t.arg);i.pivotGridModule.interopAdaptor.invokeMethodAsync("PivotInteropMethod",t.key,s).then(t=>{0!==t?(i.pivotGridModule.updateBlazorData(t,i.pivotGridModule),i.getFieldCaption(i.dataSourceSettings),i.enginePopulatedEventMethod(i,e,o),i.calculatedFieldModule&&i.calculatedFieldModule.isRequireUpdate&&(i.calculatedFieldModule.endDialog(),i.calculatedFieldModule.isRequireUpdate=!1)):this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("CSV"===i.dataSourceSettings.type?"invalidCSV":"invalidJSON"))})}}else if((0,a.xr)()&&l){let s=window.sfBlazor.copyWithoutCircularReferences([i.dataSourceSettings.properties],i.dataSourceSettings.properties);i.pivotGridModule.interopAdaptor.invokeMethodAsync("PivotInteropMethod","renderEngine",{dataSourceSettings:s,customProperties:t}).then(t=>{0!==t?(i.pivotGridModule.updateBlazorData(t,i.pivotGridModule),i.getFieldCaption(i.dataSourceSettings),i.enginePopulatedEventMethod(i,e,o)):this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("CSV"===i.dataSourceSettings.type?"invalidCSV":"invalidJSON"))})}else"Server"===i.dataSourceSettings.mode?(h?s.getEngine("onSort",null,i.lastSortInfo,null,null,null,null):d?s.getEngine("onAggregation",null,null,i.lastAggregationInfo,null,null,null):r?s.getEngine("onCalcOperation",null,null,null,i.lastCalcFieldInfo,null,null):c?s.getEngine("onFilter",null,null,null,null,i.lastFilterInfo,null):s.getEngine("onDrop",null,null,null,null,null,null),i.lastSortInfo={},i.lastAggregationInfo={},i.lastCalcFieldInfo={},i.lastFilterInfo={}):i.engineModule.renderEngine(i.dataSourceSettings,t,i.getValueCellInfo.bind(i))}else o=i.updateOlapDataSource(i,h,r,o);(0,a.xr)()&&l||i.getFieldCaption(i.dataSourceSettings)}else i.axisFieldModule.render(),i.isRequiredUpdate=!1;(0,a.xr)()&&l||i.enginePopulatedEventMethod(i,e,o)})}enginePopulatedEventMethod(e,t,i){(e.isPopupView?e.pivotGridModule:e).trigger(Sr,{dataSourceSettings:e.dataSourceSettings,pivotFieldList:"pivot"===e.dataType?e.engineModule.fieldList:e.olapEngineModule.fieldList,pivotValues:"pivot"===e.dataType?e.engineModule.pivotValues:e.olapEngineModule.pivotValues},s=>{let o=e.dataSourceSettings.dataSource;(0,a.xr)()&&s.dataSourceSettings.dataSource instanceof Object&&(s.dataSourceSettings.dataSource=o),e.dataSourceSettings=s.dataSourceSettings,e.pivotCommon.dataSourceSettings=e.dataSourceSettings,e.pivotFieldList=s.pivotFieldList,"olap"===e.dataType?(e.olapEngineModule.pivotValues=(0,a.xr)()?e.olapEngineModule.pivotValues:s.pivotValues,e.pivotCommon.engineModule=e.olapEngineModule):(e.engineModule.pivotValues=(0,a.xr)()?e.engineModule.pivotValues:s.pivotValues,e.pivotCommon.engineModule=e.engineModule),t||!e.treeViewModule.fieldTable||e.isAdaptive||e.notify(Br,{}),e.isRequiredUpdate?(e.allowDeferLayoutUpdate&&(e.clonedDataSource=(0,a.l7)({},e.dataSourceSettings,null,!0),e.clonedFieldList=(0,a.l7)({},e.pivotFieldList,null,!0)),e.updateView(e.pivotGridModule)):this.isPopupView&&e.allowDeferLayoutUpdate&&(e.pivotGridModule.engineModule=e.engineModule,e.pivotGridModule.setProperties({dataSourceSettings:e.dataSourceSettings.properties},!0),e.pivotGridModule.notify(Or,e),(0,n.v3)(e.fieldListSpinnerElement)),this.isPopupView&&e.pivotGridModule&&e.pivotGridModule.allowDeferLayoutUpdate&&!e.isRequiredUpdate&&((0,n.v3)(e.fieldListSpinnerElement),e.pivotGridModule.hideWaitingPopup()),e.isRequiredUpdate=!0,!e.pivotGridModule||i?(0,n.v3)(e.fieldListSpinnerElement):e.pivotGridModule.fieldListSpinnerElement=e.fieldListSpinnerElement})}updateOlapDataSource(e,t,i,s){let o=e.frameCustomProperties(e.olapEngineModule.fieldListData,e.olapEngineModule.fieldList);return o.savedFieldList=e.pivotFieldList,i||t?(e.olapEngineModule.savedFieldList=e.pivotFieldList,e.olapEngineModule.savedFieldListData=e.olapEngineModule.fieldListData,i?(e.olapEngineModule.updateCalcFields(e.dataSourceSettings,e.lastCalcFieldInfo),e.lastCalcFieldInfo={},s=!e.olapEngineModule.dataFields[e.lastCalcFieldInfo.name],e.pivotGridModule&&e.pivotGridModule.hideWaitingPopup()):e.olapEngineModule.onSort(e.dataSourceSettings)):e.olapEngineModule.renderEngine(e.dataSourceSettings,o),s}update(e){(0,a.xr)()&&void 0!==e&&(e=(0,a.s8)("#"+e.ID,dc)),e&&(this.clonedDataSet=e.clonedDataSet,(0,a.xr)()&&!this.isPopupView?br.updateDataSourceSettings(this,br.getClonedDataSourceSettings(e.dataSourceSettings)):this.setProperties({dataSourceSettings:e.dataSourceSettings},!0),this.engineModule=e.engineModule,this.olapEngineModule=e.olapEngineModule,this.dataType=e.dataType,this.pivotFieldList="olap"===this.dataType?e.olapEngineModule.fieldList:e.engineModule.fieldList,this.isPopupView?this.pivotGridModule=e:this.staticPivotGridModule=e,this.getFieldCaption(e.dataSourceSettings),this.pivotCommon.engineModule="olap"===this.dataType?this.olapEngineModule:this.engineModule,this.pivotCommon.dataSourceSettings=this.dataSourceSettings,this.pivotCommon.control=this,this.treeViewModule.fieldTable&&!this.isAdaptive&&this.notify(Br,{}),this.axisFieldModule.render(),!this.isPopupView&&this.allowDeferLayoutUpdate&&(this.clonedDataSource=(0,a.l7)({},this.dataSourceSettings,null,!0),this.clonedFieldList=(0,a.l7)({},this.pivotFieldList,null,!0)))}updateView(e){if((0,a.xr)()&&void 0!==e&&(e=(0,a.s8)("#"+e.ID,dc)),e){e.clonedDataSet=this.clonedDataSet,(0,a.xr)()?br.updateDataSourceSettings(e,br.getClonedDataSourceSettings(this.dataSourceSettings)):e.setProperties({dataSourceSettings:this.dataSourceSettings},!0),e.engineModule=this.engineModule,e.olapEngineModule=this.olapEngineModule,e.dataType=this.dataType,this.pivotChange||(e.pivotValues="olap"===this.dataType?this.olapEngineModule.pivotValues:this.engineModule.pivotValues);let t={dataSourceSettings:br.getClonedDataSourceSettings(e.dataSourceSettings),pivotValues:e.pivotValues};e.trigger("fieldListRefreshed",t),this.isPopupView||(this.staticPivotGridModule=e,e.isStaticRefresh=!0),e.enableVirtualization&&(0,a.xr)()?e.renderPivotGrid():e.dataBind()}}triggerPopulateEvent(){(this.isPopupView?this.pivotGridModule:this).trigger(Sr,{dataSourceSettings:this.dataSourceSettings,pivotFieldList:"olap"===this.dataType?this.olapEngineModule.fieldList:this.engineModule.fieldList,pivotValues:"olap"===this.dataType?this.olapEngineModule.pivotValues:this.engineModule.pivotValues},e=>{this.dataSourceSettings=e.dataSourceSettings,this.pivotFieldList=e.pivotFieldList,"olap"===this.dataType?this.olapEngineModule.pivotValues=(0,a.xr)()?this.olapEngineModule.pivotValues:e.pivotValues:this.engineModule.pivotValues=(0,a.xr)()?this.engineModule.pivotValues:e.pivotValues})}destroy(){this.unWireEvent(),this.engineModule&&(this.engineModule.fieldList={},this.engineModule.rMembers=null,this.engineModule.cMembers=null,this.engineModule.valueMatrix=null,this.engineModule.indexMatrix=null,this.engineModule={}),this.olapEngineModule&&(this.olapEngineModule.fieldList={},this.olapEngineModule={}),this.pivotFieldList&&(this.pivotFieldList={}),this.captionData&&(this.captionData=null),this.contextMenuModule&&this.contextMenuModule.destroy(),this.treeViewModule&&this.treeViewModule.destroy(),this.pivotButtonModule&&this.pivotButtonModule.destroy(),this.pivotCommon&&this.pivotCommon.destroy(),this.dialogRenderer&&this.dialogRenderer.destroy(),this.calculatedFieldModule&&this.calculatedFieldModule.destroy(),super.destroy(),this.contextMenuModule&&(this.contextMenuModule=null),this.treeViewModule&&(this.treeViewModule=null),this.pivotButtonModule&&(this.pivotButtonModule=null),this.pivotCommon&&(this.pivotCommon=null),this.dialogRenderer&&(this.dialogRenderer=null),this.calculatedFieldModule&&(this.calculatedFieldModule=null),this.axisFieldModule&&(this.axisFieldModule=null),this.axisTableModule&&(this.axisTableModule=null),this.renderModule&&(this.renderModule=null),this.clonedDataSet&&(this.clonedDataSet=null),this.clonedFieldList&&(this.clonedFieldList=null),this.localeObj&&(this.localeObj=null),this.defaultLocale&&(this.defaultLocale=null),this.element.innerHTML="",(0,a.IV)([this.element],jr),(0,a.IV)([this.element],Hr),(0,a.IV)([this.element],qr)}};fc([(0,a.Zz)({},Zh)],yc.prototype,"dataSourceSettings",void 0),fc([(0,a.Z9)("Popup")],yc.prototype,"renderMode",void 0),fc([(0,a.Z9)()],yc.prototype,"target",void 0),fc([(0,a.Z9)("")],yc.prototype,"cssClass",void 0),fc([(0,a.Z9)(!1)],yc.prototype,"allowCalculatedField",void 0),fc([(0,a.Z9)(!1)],yc.prototype,"showValuesButton",void 0),fc([(0,a.Z9)(!1)],yc.prototype,"allowDeferLayoutUpdate",void 0),fc([(0,a.Z9)(1e3)],yc.prototype,"maxNodeLimitInMemberEditor",void 0),fc([(0,a.Z9)(!0)],yc.prototype,"loadOnDemandInMemberEditor",void 0),fc([(0,a.Z9)()],yc.prototype,"spinnerTemplate",void 0),fc([(0,a.Z9)(["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"])],yc.prototype,"aggregateTypes",void 0),fc([(0,a.ju)()],yc.prototype,"load",void 0),fc([(0,a.ju)()],yc.prototype,"enginePopulating",void 0),fc([(0,a.ju)()],yc.prototype,"memberFiltering",void 0),fc([(0,a.ju)()],yc.prototype,"enginePopulated",void 0),fc([(0,a.ju)()],yc.prototype,"onFieldDropped",void 0),fc([(0,a.ju)()],yc.prototype,"fieldDrop",void 0),fc([(0,a.ju)()],yc.prototype,"fieldDragStart",void 0),fc([(0,a.ju)()],yc.prototype,"aggregateCellInfo",void 0),fc([(0,a.ju)()],yc.prototype,"memberEditorOpen",void 0),fc([(0,a.ju)()],yc.prototype,"calculatedFieldCreate",void 0),fc([(0,a.ju)()],yc.prototype,"aggregateMenuOpen",void 0),fc([(0,a.ju)()],yc.prototype,"fieldRemove",void 0),fc([(0,a.ju)()],yc.prototype,"dataBound",void 0),fc([(0,a.ju)()],yc.prototype,"created",void 0),fc([(0,a.ju)()],yc.prototype,"destroyed",void 0),fc([(0,a.ju)()],yc.prototype,"beforeServiceInvoke",void 0),yc=fc([a.Zl],yc);const vc="Count",Sc="Median",xc="Sum",wc="DistinctCount",Cc="Product",Mc="SampleStDev",Tc="PopulationStDev",Lc="SampleVar",Ac="PopulationVar",Dc="CalculatedField";yc.Inject(class{constructor(e){this.isFormula=!1,this.isRequireUpdate=!1,this.parent=e,this.existingReport=null,this.parent.calculatedFieldModule=this,this.removeEventListener(),this.addEventListener(),this.parentID=this.parent.element.id,this.dialog=null,this.inputObj=null,this.treeObj=null,this.droppable=null,this.menuObj=null,this.newFields=null,this.isFieldExist=!0,this.formulaText=null,this.fieldText=null,this.formatText=null,this.formatType=null,this.fieldType=null,this.parentHierarchy=null,this.isEdit=!1,this.currentFieldName=null,this.confirmPopUp=null}getModuleName(){return"calculatedField"}keyActionHandler(e){let t=e.currentTarget.querySelector(".e-hover.e-node-focus");if(t)switch(e.action){case"moveRight":case"shiftE":"pivot"===this.parent.dataType&&this.displayMenu(t);break;case"delete":"LI"===t.tagName&&!t.querySelector(".e-list-icon.e-format")&&!t.querySelector(".e-list-icon").classList.contains(".e-icons")&&t.querySelector("."+nh)&&t.querySelector("."+nh).classList.contains("e-list-icon")&&this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),{},!0,t);break;case"enter":let e=t.getAttribute("data-field"),i=t.getAttribute("data-type"),s=(0,a.Ys)("#"+this.parentID+"droppable",this.dialog.element);"pivot"===this.parent.dataType?""===s.value?s.value=i===Dc?t.getAttribute("data-uid"):'"'+i+"("+e+')"':""!==s.value&&(s.value=i===Dc?s.value+t.getAttribute("data-uid"):s.value+'"'+i+"("+e+')"'):(this.parent.olapEngineModule&&this.parent.olapEngineModule.fieldList[e]&&this.parent.olapEngineModule.fieldList[e].isCalculatedField&&(e=this.parent.olapEngineModule.fieldList[e].tag),""===s.value?s.value=e:""!==s.value&&(s.value=s.value+e))}}fieldClickHandler(e){let t=(0,a.oq)(e.event.target,"li");(e.event.target.classList.contains(Hn)||e.event.target.classList.contains(Kn)||e.event.target.classList.contains($n)||e.event.target.classList.contains(nh))&&(this.parent.isAdaptive?"olap"===this.parent.dataType&&this.parent.isAdaptive&&("LI"===t.tagName&&t.querySelector(".e-list-edit-icon").classList.contains(Kn)&&e.event.target.classList.contains(Kn)?(this.isEdit=!0,this.currentFieldName=t.getAttribute("data-field"),this.fieldText=t.getAttribute("data-caption"),this.formulaText=t.getAttribute("data-formula"),this.formatType=t.getAttribute("data-formatString"),this.formatText="Custom"===this.formatType?t.getAttribute("data-customString"):null,this.fieldType=t.getAttribute("data-membertype"),this.parentHierarchy="Dimension"===this.fieldType?t.getAttribute("data-hierarchy"):null,(0,a.cn)([t.querySelector(".e-list-edit-icon")],$n),(0,a.IV)([t.querySelector(".e-list-edit-icon")],Kn),this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)):"LI"===t.tagName&&t.querySelector(".e-list-edit-icon").classList.contains($n)&&e.event.target.classList.contains($n)?(this.isEdit=!1,this.fieldText=this.formatText=this.formulaText=this.currentFieldName=null,this.parentHierarchy=this.fieldType=this.formatType=null,(0,a.cn)([t.querySelector(".e-list-edit-icon")],Kn),(0,a.IV)([t.querySelector(".e-list-edit-icon")],$n)):"LI"===t.tagName&&t.querySelector("."+nh).classList.contains("e-icons")&&e.event.target.classList.contains(nh)&&this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),{},!0,e.node)):this.displayMenu(t,e.node,e.event.target))}accordionClickHandler(e){if(e.item&&-1!==e.item.iconCss.indexOf("e-list-icon")&&(0,a.oq)(e.originalEvent.target,".e-acrdn-header-icon")){let t=(0,a.oq)(e.originalEvent.target,".e-acrdn-header").querySelector("."+On),i=t.getAttribute("data-field"),s=br.getFieldByName(i,this.parent.dataSourceSettings.formatSettings),o=(0,a.oq)(e.originalEvent.target,".e-acrdn-header-icon");o.querySelector(".e-edit")&&e.originalEvent.target.classList.contains(Kn)?(this.isEdit=!0,this.currentFieldName=this.fieldText=i,this.formulaText=this.parent.engineModule.fieldList[i].formula,this.formatText=s?s.format:"",(0,a.cn)([o.querySelector(".e-list-icon")],$n),(0,a.IV)([o.querySelector(".e-list-icon")],Kn),this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)):o.querySelector(".e-edited")&&e.originalEvent.target.classList.contains($n)?(this.isEdit=!1,this.fieldText=this.formatText=this.formulaText=this.currentFieldName=null,(0,a.cn)([o.querySelector(".e-list-icon")],Kn),(0,a.IV)([o.querySelector(".e-list-icon")],$n)):o.querySelector("."+nh)&&e.originalEvent.target.classList.contains(nh)&&this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),{},!0,t)}}accordionCreated(){let e=this.accordion.element.querySelectorAll(".e-acrdn-item");for(let t=0;t<e.length;t++)if(e[t].querySelector(".e-edit")||e[t].querySelector(".e-edited")){let i=(0,a.az)("span",{className:"e-list-icon e-remove-report e-icons"});(0,a.R3)([i],e[t].querySelector(".e-acrdn-header-icon"))}}clearFormula(){this.treeObj&&this.treeObj.element.querySelector("li")&&((0,a.IV)(this.treeObj.element.querySelectorAll("li"),"e-active"),this.displayMenu(this.treeObj.element.querySelector("li")))}displayMenu(e,t,i){let s=!i||i.classList.contains(Kn),o=!i||i.classList.contains($n);if("pivot"!==this.parent.dataType||!e.querySelector(".e-list-icon.e-format")||!e.querySelector(".e-list-icon.e-format").classList.contains(Gr)||e.querySelector(".e-list-icon").classList.contains($n)||e.querySelector(".e-list-icon").classList.contains(nh)||e.querySelector(".e-list-icon").classList.contains(Kn)||"LI"!==e.tagName){if("LI"===e.tagName&&(e.querySelector(".e-edit")&&e.querySelector(".e-edit").classList.contains("e-list-icon")&&s||"olap"===this.parent.dataType&&e.getAttribute("data-type")===Dc&&e.classList.contains("e-active")&&(i&&!i.classList.contains(nh)||!i))){this.isEdit=!0;let t=e.getAttribute("data-field"),i=e.getAttribute("data-caption");this.currentFieldName=t,this.inputObj.value=i,this.inputObj.dataBind();let s=e.getAttribute("data-formatString"),o=this.dialog.element,l=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Custom_Format_Element",o),c.g3);if("olap"===this.parent.dataType){let t=e.getAttribute("data-membertype"),i=e.getAttribute("data-hierarchy"),r=e.getAttribute("data-formula"),n=e.getAttribute("data-customString"),h=(0,a.Ys)("#"+this.parentID+"_FieldNameTitle",o),d=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Member_Type_Div",o),p.NB),c=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Hierarchy_List_Div",o),p.NB),u=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Format_Div",o),p.NB);h.innerHTML=this.parent.localeObj.getConstant("caption"),(0,a.Ys)("#"+this.parentID+"droppable",document).value=r,d.readonly=!0,d.value=t,d.dataBind(),"Dimension"===t&&(c.value=i),""!==s&&(u.value=s,u.dataBind()),l.value=n}else l.value=s,(0,a.cn)(this.treeObj.element.querySelectorAll(".e-edited"),Kn),(0,a.IV)(this.treeObj.element.querySelectorAll(".e-edited"),$n),(0,a.cn)([e.querySelector(".e-list-icon")],$n),(0,a.IV)([e.querySelector(".e-list-icon")],Kn),e.querySelector(".e-edited").setAttribute("title",this.parent.localeObj.getConstant("clearCalculatedField")),(0,a.Ys)("#"+this.parentID+"droppable",document).value=e.getAttribute("data-uid");l.dataBind()}else if("LI"===e.tagName&&(e.querySelector(".e-edited")&&e.querySelector(".e-edited").classList.contains("e-list-icon")&&o||"olap"===this.parent.dataType&&!e.classList.contains("e-active"))){this.isEdit=!1,this.inputObj.value="",this.inputObj.dataBind();let t=this.dialog.element,i=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Custom_Format_Element",t),c.g3);if(i.value="",i.dataBind(),"olap"===this.parent.dataType){let e=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Hierarchy_List_Div",t),p.NB),i=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Format_Div",t),p.NB),s=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Member_Type_Div",t),p.NB);(0,a.Ys)("#"+this.parentID+"_FieldNameTitle",t).innerHTML=this.parent.localeObj.getConstant("fieldTitle"),e.index=0,e.dataBind(),i.index=0,i.dataBind(),s.index=0,s.readonly=!1,s.dataBind()}else(0,a.cn)(this.treeObj.element.querySelectorAll(".e-edited"),Kn),(0,a.IV)(this.treeObj.element.querySelectorAll(".e-edited"),$n),e.querySelector(".e-edit").setAttribute("title",this.parent.localeObj.getConstant("edit"));(0,a.Ys)("#"+this.parentID+"droppable",document).value=""}else if("LI"===e.tagName&&e.querySelector("."+nh)&&e.querySelector("."+nh).classList.contains("e-list-icon")&&!s&&!o){let e=(0,a.Ys)("#"+this.parentID+"droppable",document),i={name:this.isEdit?this.currentFieldName:this.inputObj.value,caption:this.inputObj.value,formula:e.value};this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),i,!0,t)}}else this.menuObj&&!this.menuObj.isDestroyed&&this.menuObj.destroy(),this.curMenu=e.querySelector(".e-list-text"),this.openContextMenu(e)}removeCalcField(e){let t,i=this.parent.dataSourceSettings,s=e.getAttribute("data-field"),o=i.calculatedFieldSettings;if("pivot"===this.parent.dataType)if(this.parent.isAdaptive){let t=parseInt(e.getAttribute("id").split(this.parentID+"_")[1],10);"number"==typeof t&&this.accordion.removeItem(t)}else this.treeObj.removeNodes([e]);for(let r=0;r<o.length;r++)if(o[r]&&o[r].name===s){o.splice(r,1);break}if("olap"===this.parent.dataType){t=this.parent.olapEngineModule;let i=t.fieldListData?t.fieldListData:[];for(let e of Object.keys(i))if(i[e].name===s){let t=parseInt(e,10);if("number"==typeof t){i.splice(t,1);break}}let l=this.treeObj.getNode(e).parentID;this.treeObj.removeNodes([e]),o.length<=0&&this.treeObj.removeNodes([l])}else t=this.parent.engineModule;if(t.fields)for(let r=0;r<t.fields.length;r++)if(t.fields[r]===s){t.fields.splice(r,1);break}t.savedFieldList&&t.savedFieldList[s]&&delete t.savedFieldList[s],t.fieldList&&t.fieldList[s]&&delete t.fieldList[s];let l=i.formatSettings;for(let r=0;r<l.length;r++)if(l[r]&&l[r].name===s){l.splice(r,1);break}let a=[i.values,i.rows,i.columns,i.filters];for(let r=0,n=a.length;r<n;r++)for(let e=0,t=a[r].length;e<t;e++)if(a[r][e].name===s){a[r].splice(e,1);break}this.isEdit&&this.currentFieldName===s&&(this.isEdit=!1,this.inputObj.value="",this.currentFieldName=this.formatText=this.fieldText=this.formatType=null,this.formulaText=this.fieldType=this.parentHierarchy=null),this.parent.allowDeferLayoutUpdate&&"pivotfieldlist"===this.parent.getModuleName()||this.parent.updateDataSource(),this.removeErrorDialog()}openContextMenu(e){let t=e.getAttribute("data-field"),i="number"!==this.parent.engineModule.fieldList[t].type?"string":"number",s="string"===i?this.getValidSummaryType().slice(0,2):this.getValidSummaryType(),o={cancel:!1,fieldName:t,aggregateTypes:[...this.getMenuItems(i)]};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(Pr,o,t=>{if(!t.cancel){let i=[],o=[];for(let e of t.aggregateTypes)s.indexOf(e)>-1&&-1===i.indexOf(e)&&(i.push(e),o.push({id:this.parent.element.id+"Calc_"+e,text:this.parent.localeObj.getConstant(e)}));this.createMenu(o,e);let l=e.getBoundingClientRect(),a=window.scrollY||document.documentElement.scrollTop;this.menuObj.open(l.top+a,this.parent.enableRtl?l.left-100:l.left+150)}})}selectContextMenu(e){if(null!==e.element.textContent){let t=(0,a.oq)(this.curMenu,".e-list-item").getAttribute("data-caption");(0,a.oq)(this.curMenu,".e-list-item").setAttribute("data-type",e.element.id.split("_").pop()),this.curMenu.textContent=t+" ("+e.element.textContent+")",(0,a.cn)([this.curMenu.parentElement.parentElement],["e-node-focus","e-hover"]),this.curMenu.parentElement.parentElement.setAttribute("tabindex","-1"),this.curMenu.parentElement.parentElement.focus()}}createMenu(e,t){let i,s={cssClass:this.parentID+"calculatedmenu",items:e,enableRtl:this.parent.enableRtl,locale:this.parent.locale,select:this.selectContextMenu.bind(this),onClose:()=>{this.treeObj.element.focus(),(0,a.cn)([t],["e-hover","e-node-focus"])}};i=(0,a.Ys)("#"+this.parentID+"CalcContextmenu",document)?(0,a.Ys)("#"+this.parentID+"CalcContextmenu",document):(0,a.az)("ul",{id:this.parentID+"CalcContextmenu"}),this.dialog.element.appendChild(i),this.menuObj=new d.xV(s),this.menuObj.isStringTemplate=!0,this.menuObj.appendTo(i)}applyFormula(){let e=this,t=!1;(0,a.IV)([document.getElementById(this.parentID+"ddlelement")],eh),this.newFields=(0,a.l7)([],this.parent.dataSourceSettings.calculatedFieldSettings,null,!0);let i={fieldName:this.isEdit?this.currentFieldName:this.inputObj.value,calculatedField:this.getCalculatedFieldInfo(),calculatedFieldSettings:br.cloneCalculatedFieldSettings(this.parent.dataSourceSettings.calculatedFieldSettings),cancel:!1};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger("calculatedFieldCreate",i,i=>{if(i.cancel)this.endDialog(),this.parent.lastCalcFieldInfo={},this.isFormula=!1;else{let s=i.calculatedField;if(!this.isEdit)if("olap"===e.parent.dataType){let i=s.name;e.parent.olapEngineModule.fieldList[i]&&"CalculatedField"!==e.parent.olapEngineModule.fieldList[i].type&&(t=!0)}else for(let i of Object.keys(e.parent.engineModule.fieldList))s.name&&s.name===i&&"CalculatedField"!==e.parent.engineModule.fieldList[i].aggregateType&&(t=!0);if(t)return void e.parent.pivotCommon.errorDialog.createErrorDialog(e.parent.localeObj.getConstant("error"),e.parent.localeObj.getConstant("fieldExist"));this.existingReport=(0,a.l7)({},this.parent.dataSourceSettings,null,!0);let o=this.parent.dataSourceSettings;if((0,a.le)(s.name)||""===s.name||(0,a.le)(s.caption)||""===s.caption||!s.formula||""===s.formula)(0,a.le)(s.name)||""===s.name||(0,a.le)(s.caption)||""===s.caption?(this.inputObj.value="",(0,a.cn)([document.getElementById(this.parentID+"ddlelement")],eh),document.getElementById(this.parentID+"ddlelement").focus()):this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("invalidFormula"));else{let t;if("olap"===this.parent.dataType){if(t={name:s.name,formula:s.formula,formatString:s.formatString},(0,a.le)(s.hierarchyUniqueName)||(t.hierarchyUniqueName=s.hierarchyUniqueName),this.isFieldExist=!1,this.isEdit){for(let l=0;l<o.calculatedFieldSettings.length;l++)if(o.calculatedFieldSettings[l].name===t.name&&this.isEdit){o.calculatedFieldSettings[l].hierarchyUniqueName=s.hierarchyUniqueName,this.parent.olapEngineModule.fieldList[t.name].caption=s.caption,o.calculatedFieldSettings[l].formatString=t.formatString,o.calculatedFieldSettings[l].formula=t.formula,t=o.calculatedFieldSettings[l],this.isFieldExist=!0;break}let e=[o.rows,o.columns,o.values,o.filters],i=!1;for(let o of e){for(let e of o)if(e.isCalculatedField&&null!==t.name&&e.name===t.name&&this.isEdit){e.caption=s.caption,this.isFieldExist=!0,i=!0;break}if(i)break}}else for(let i=0;i<o.calculatedFieldSettings.length;i++)if(o.calculatedFieldSettings[i].name===t.name)return void this.createConfirmDialog(e.parent.localeObj.getConstant("alert"),e.parent.localeObj.getConstant("confirmText"),s);this.isFieldExist||o.calculatedFieldSettings.push(t),this.parent.lastCalcFieldInfo=t}else{t={name:s.name,caption:s.caption,type:"CalculatedField"};let i={name:s.name,formula:s.formula};if((0,a.le)(s.formatString)||(i.formatString=s.formatString),this.isFieldExist=!0,this.isEdit){for(let e=0;e<o.values.length;e++)if(o.values[e].type===Dc&&null!==t.name&&o.values[e].name===t.name&&this.isEdit)for(let i=0;i<o.calculatedFieldSettings.length;i++)o.calculatedFieldSettings[i].name===t.name&&(o.values[e].caption=s.caption,this.currentFormula=o.calculatedFieldSettings[i].formula,o.calculatedFieldSettings[i].formula=s.formula,this.parent.engineModule.fieldList[t.name].caption=s.caption,this.updateFormatSettings(o,t.name,s.formatString),this.isFieldExist=!1)}else for(let l=0;l<o.values.length;l++)if(o.values[l].type===Dc&&o.values[l].name===t.name){for(let i=0;i<o.calculatedFieldSettings.length;i++)if(o.calculatedFieldSettings[i].name===t.name)return void this.createConfirmDialog(e.parent.localeObj.getConstant("alert"),e.parent.localeObj.getConstant("confirmText"),s);this.isFieldExist=!1}this.isFieldExist&&(o.values.push(t),o.calculatedFieldSettings.push(i),this.updateFormatSettings(o,t.name,s.formatString)),this.parent.lastCalcFieldInfo=i}this.addFormula(o,t.name)}}})}getCalculatedFieldInfo(){let e,t=(0,a.Ys)("#"+this.parentID+"droppable",document),i=this.parent.isAdaptive?this.parent.dialogRenderer.adaptiveElement.element:this.dialog.element,s=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Custom_Format_Element",i),c.g3);if(e={name:this.isEdit?this.currentFieldName:this.inputObj.value,caption:this.inputObj.value,formula:t.value},"olap"===this.parent.dataType){let t=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Format_Div",i),p.NB),o=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Member_Type_Div",i),p.NB),l=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Hierarchy_List_Div",i),p.NB);e.formatString="Custom"===t.value?s.value:t.value,"Dimension"===o.value&&(e.hierarchyUniqueName=l.value)}else e.formatString=s.value;return e}updateFormatSettings(e,t,i){let s={name:t,format:i,useGrouping:!0},o=!1;for(let l=0;l<e.formatSettings.length;l++)if(e.formatSettings[l].name===t){if("undefined"===i||void 0===i||""===i){e.formatSettings.splice(l,1),o=!0;break}{let t=e.formatSettings[l].properties?e.formatSettings[l].properties:e.formatSettings[l];t.format=i,e.formatSettings.splice(l,1,t),o=!0;break}}o||""===i||e.formatSettings.push(s)}addFormula(e,t){this.isFormula=!0,this.field=t,(0,a.xr)()||"Server"===this.parent.dataSourceSettings.mode?br.updateDataSourceSettings(this.parent,br.getClonedDataSourceSettings(e)):this.parent.setProperties({dataSourceSettings:e},!0),"pivotfieldlist"===this.parent.getModuleName()&&this.parent.allowDeferLayoutUpdate&&(this.parent.isRequiredUpdate=!1);try{this.parent.updateDataSource(!1);let e="pivotfieldlist"===this.parent.getModuleName()&&this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent;(0,a.xr)()&&e&&e.enableVirtualization||!e||"Server"===e.dataSourceSettings.mode?this.isRequireUpdate=!0:this.endDialog(),"pivotfieldlist"===this.parent.getModuleName()&&"Fixed"===this.parent.renderMode&&this.parent.allowDeferLayoutUpdate&&(this.parent.pivotChange=!0)}catch(i){this.showError()}}endDialog(){if(this.isEdit=!1,this.dialog)this.dialog.close();else{this.inputObj.value="",this.currentFieldName=this.formatText=this.fieldText=this.formatType=null,this.formulaText=this.fieldType=this.parentHierarchy=null;let e=this.parent.isAdaptive?this.parent.dialogRenderer.parentElement:this.dialog.element;if(this.parent.dialogRenderer.parentElement.querySelector("."+Nn).value="",(0,a.Ys)("#"+this.parentID+"droppable",this.parent.dialogRenderer.parentElement).value="",(0,a.Ys)("#"+this.parentID+"Custom_Format_Element",this.parent.dialogRenderer.parentElement).value="","olap"===this.parent.dataType){let t=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Custom_Format_Element",e),c.g3),i=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Format_Div",e),p.NB),s=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Member_Type_Div",e),p.NB),o=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Hierarchy_List_Div",e),p.NB);i.index=0,i.dataBind(),s.index=0,s.readonly=!1,s.dataBind(),o.index=0,o.enabled=!1,o.dataBind(),t.enabled=!1,t.dataBind()}}}showError(){if(this.parent.engineModule.fieldList[this.field]&&delete this.parent.engineModule.fieldList[this.field],this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("invalidFormula")),(0,a.xr)()?br.updateDataSourceSettings(this.parent,br.getClonedDataSourceSettings(this.existingReport)):this.parent.setProperties({dataSourceSettings:this.existingReport},!0),this.isEdit){let e=this.parent.dataSourceSettings.calculatedFieldSettings;for(let t=0;e&&t<e.length;t++)if(e[t].name===this.field){e[t].formula=this.currentFormula;break}}else if(this.parent.engineModule.fields)for(let e=0;e<this.parent.engineModule.fields.length;e++)if(this.parent.engineModule.fields[e]===this.field){this.parent.engineModule.fields.splice(e,1);break}this.parent.lastCalcFieldInfo={},this.parent.updateDataSource(!1),this.isFormula=!1}getFieldListData(e){let t=[];if("olap"===this.parent.dataType){t=br.getClonedData(e.olapEngineModule.fieldListData?e.olapEngineModule.fieldListData:[]);for(let e of t)e.spriteCssClass&&(e.spriteCssClass.indexOf("e-attributeCDB-icon")>-1||e.spriteCssClass.indexOf("e-level-members")>-1)?e.hasChildren=!0:e.spriteCssClass&&e.spriteCssClass.indexOf("e-namedSetCDB-icon")>-1?e.hasChildren=!1:e.spriteCssClass&&e.spriteCssClass.indexOf("e-calcMemberGroupCDB")>-1&&(e.expanded=this.isEdit)}else for(let i of e.engineModule.fieldList?Object.keys(e.engineModule.fieldList):[]){let s=null,o=null;o="number"===e.engineModule.fieldList[i].type&&"include"!==e.engineModule.fieldList[i].type&&"exclude"!==e.engineModule.fieldList[i].type||"DistinctCount"===e.engineModule.fieldList[i].aggregateType?void 0!==e.engineModule.fieldList[i].aggregateType?e.engineModule.fieldList[i].aggregateType:xc:vc,s=this.parent.localeObj.getConstant(o),t.push({index:e.engineModule.fieldList[i].index,name:e.engineModule.fieldList[i].caption+" ("+s+")",type:o,icon:Hn+" "+Gr,formula:e.engineModule.fieldList[i].formula,field:i,caption:e.engineModule.fieldList[i].caption?e.engineModule.fieldList[i].caption:i})}return t}fieldDropped(e){e.cancel=!0;let t=(0,a.Ys)("#"+this.parentID+"droppable",this.dialog.element);(0,a.IV)([t],"e-copy-drop"),(0,a.IV)([e.draggedNode.querySelector(".e-list-text")],yn);let i=e.draggedNode.getAttribute("data-field");if("olap"===this.parent.dataType)if(this.parent.olapEngineModule.fieldList[i]&&this.parent.olapEngineModule.fieldList[i].isCalculatedField&&(i=this.parent.olapEngineModule.fieldList[i].tag),e.target.id===this.parentID+"droppable"&&""===t.value)t.value=i,t.focus();else if(e.target.id===this.parentID+"droppable"&&""!==t.value){let e,s=t.value,o=t.selectionStart,l=s.substring(o,s.length),a=s.substring(0,o);e=a+i,t.value=a+i+l,t.focus(),t.setSelectionRange(e.length,e.length)}else e.cancel=!0;else{let s=e.draggedNode.getAttribute("data-type");if(e.target.id===this.parentID+"droppable"&&""===t.value)t.value=s===Dc?e.draggedNodeData.id.toString():'"'+s+"("+i+')"',t.focus();else if(e.target.id===this.parentID+"droppable"&&""!==t.value){let o,l=t.selectionStart,a=t.value,r=a.substring(0,l),n=a.substring(l,a.length);s===Dc?(o=r+e.draggedNodeData.id.toString(),t.value=r+e.draggedNodeData.id.toString()+n):(o=r+'"'+s+"("+i+')"',t.value=r+'"'+s+"("+i+')"'+n),t.focus(),t.setSelectionRange(o.length,o.length)}else e.cancel=!0}}createDialog(){if(null!==(0,a.Ys)("#"+this.parentID+"calculateddialog",document))for((0,a.Od)((0,a.Ys)("#"+this.parentID+"calculateddialog",document));!(0,a.le)(document.querySelector("."+this.parentID+"calculatedmenu"));)(0,a.Od)(document.querySelector("."+this.parentID+"calculatedmenu"));this.parent.element.appendChild((0,a.az)("div",{id:this.parentID+"calculateddialog",className:"e-pivot-calc-dialog-div "+("olap"===this.parent.dataType?"e-olap-calc-dialog-div":"")}));let e=[{click:this.applyFormula.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.cancelClick.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}];if("olap"===this.parent.dataType){let t={click:this.clearFormula.bind(this),buttonModel:{cssClass:"e-calc-clear-btn",content:this.parent.localeObj.getConstant("clear")}};e.splice(0,0,t)}this.dialog=new n.Vq({allowDragging:!0,position:{X:"center",Y:"center"},buttons:e,close:this.closeDialog.bind(this),beforeOpen:this.beforeOpen.bind(this),open:()=>{(0,a.Ys)("#"+this.parentID+"ddlelement",this.dialog.element)&&(0,a.Ys)("#"+this.parentID+"ddlelement",this.dialog.element).focus()},animationSettings:{effect:"Zoom"},width:"25%",isModal:!1,closeOnEscape:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,showCloseIcon:!0,header:this.parent.localeObj.getConstant("createCalculatedField"),target:document.body}),this.dialog.isStringTemplate=!0,this.dialog.appendTo("#"+this.parentID+"calculateddialog")}cancelClick(){this.dialog.close(),this.isEdit=!1}beforeOpen(e){this.dialog.element.querySelector(".e-dlg-header").setAttribute("title",this.parent.localeObj.getConstant("createCalculatedField"))}closeDialog(e){"pivotfieldlist"===this.parent.getModuleName()&&(this.parent.axisFieldModule.render(),"Fixed"!==this.parent.renderMode&&((0,a.cn)([this.parent.element.querySelector(".e-toggle-field-list")],Wr),this.parent.dialogRenderer.fieldListDialog.show())),this.treeObj.destroy(),this.dialog.destroy(),this.newFields=null,this.menuObj&&!this.menuObj.isDestroyed&&this.menuObj.destroy(),(0,a.Od)(document.getElementById(this.parentID+"calculateddialog")),(0,a.le)(document.querySelector("."+this.parentID+"calculatedmenu"))||(0,a.Od)(document.querySelector("."+this.parentID+"calculatedmenu"));let t="pivotview"===this.parent.getModuleName()||"pivotfieldlist"===this.parent.getModuleName()&&"Fixed"===this.parent.renderMode?0:500;this.buttonCall&&(this.buttonCall=!1,setTimeout(this.setFocus.bind(this),t))}setFocus(){let e;if("pivotview"===this.parent.getModuleName()&&this.parent.element?e=this.parent.element:document.getElementById(this.parent.element.id+"_Wrapper")&&(e=document.getElementById(this.parent.element.id+"_Wrapper")),e){let t=[].slice.call(e.querySelectorAll(".e-pivot-button"));for(let e of t)if(e.getAttribute("data-uid")===this.currentFieldName){e.focus();break}}}renderDialogElements(){let e=(0,a.az)("div",{id:this.parentID+"outerDiv",className:("olap"===this.parent.dataType?"e-olap-calc-outer-div ":"")+"e-pivot-calc-outer-div"}),t=(0,a.az)("div",{id:this.parentID+"Olap_Tree_Div",className:"e-olap-field-tree-div"}),i=(0,a.az)("div",{id:this.parentID+"Olap_Calc_Div",className:"e-olap-calculated-div"});if("pivotfieldlist"===this.parent.getModuleName()&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+qn)&&this.parent.isAdaptive){let t=(0,a.az)("div",{id:this.parentID+"accordDiv",className:"e-pivot-accord"});e.appendChild(t);let i=(0,a.az)("div",{id:this.parentID+"buttonDiv",className:Un}),s=(0,a.az)("button",{id:this.parentID+"addBtn",innerHTML:this.parent.localeObj.getConstant("add"),className:"e-pivot-add-button",attrs:{type:"button"}}),o=(0,a.az)("button",{id:this.parentID+"cancelBtn",innerHTML:this.parent.localeObj.getConstant("cancel"),className:"e-pivot-cancel-button",attrs:{type:"button"}});i.appendChild(o),i.appendChild(s),e.appendChild(i)}else{if(!this.parent.isAdaptive&&"olap"===this.parent.dataType){let e=(0,a.az)("div",{className:"e-pivot-field-name-title",id:this.parentID+"_FieldNameTitle",innerHTML:this.parent.localeObj.getConstant("fieldTitle")});i.appendChild(e)}let s=(0,a.az)("div",{id:this.parentID+"outerDiv",className:"e-pivot-calc-input-div"}),o=(0,a.az)("input",{id:this.parentID+"ddlelement",attrs:{type:"text"},className:Nn});s.appendChild(o),"olap"!==this.parent.dataType||this.parent.isAdaptive?e.appendChild(s):i.appendChild(s);let l=(0,a.az)("div",{id:this.parentID+"control_wrapper",className:Yn});if(!this.parent.isAdaptive){let t=(0,a.az)("div",{className:"e-pivot-all-field-title",innerHTML:this.parent.localeObj.getConstant("olap"===this.parent.dataType?"allFields":"formulaField")});if("olap"===this.parent.dataType){let e=(0,a.az)("div",{className:"e-pivot-all-field-title-wrapper"});e.appendChild(t);let i=(0,a.az)("span",{attrs:{tabindex:"0","aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("fieldTooltip")},className:"e-icons e-info"});e.appendChild(i),new n.u({content:this.parent.localeObj.getConstant("fieldTooltip"),position:this.parent.enableRtl?"RightCenter":"LeftCenter",target:".e-info",offsetY:-10,locale:this.parent.locale,enableRtl:this.parent.enableRtl,width:220}).appendTo(e),l.appendChild(e)}else e.appendChild(t)}let r=(0,a.az)("div",{className:Gn+"-outer-div"});if(l.appendChild(r),r.appendChild((0,a.az)("div",{id:this.parentID+"tree",className:Gn})),"olap"!==this.parent.dataType||this.parent.isAdaptive?e.appendChild(l):t.appendChild(l),!this.parent.isAdaptive){let t=(0,a.az)("div",{className:"e-pivot-formula-title",innerHTML:this.parent.localeObj.getConstant("olap"===this.parent.dataType?"expressionField":"formula")});"olap"===this.parent.dataType?i.appendChild(t):e.appendChild(t)}let h=(0,a.az)("textarea",{id:this.parentID+"droppable",className:qn+" e-control e-textbox e-input",attrs:{placeholder:this.parent.localeObj.getConstant(this.parent.isAdaptive?"dropTextMobile":"olap"===this.parent.dataType?"olapDropText":"dropText")}});if("olap"!==this.parent.dataType||this.parent.isAdaptive?e.appendChild(h):i.appendChild(h),this.parent.isAdaptive){let t=(0,a.az)("div",{id:this.parentID+"buttonDiv",className:Un}),i=(0,a.az)("button",{id:this.parentID+"okBtn",innerHTML:this.parent.localeObj.getConstant("apply"),className:Wn,attrs:{type:"button"}});t.appendChild(i),e.appendChild(t)}if("olap"===this.parent.dataType){if(!this.parent.isAdaptive){let e=(0,a.az)("div",{className:"e-olap-member-title",innerHTML:this.parent.localeObj.getConstant("memberType")});i.appendChild(e)}let s=(0,a.az)("div",{id:this.parentID+"Member_Type_Div",className:Zn});if(this.parent.isAdaptive?e.appendChild(s):i.appendChild(s),!this.parent.isAdaptive){let e=(0,a.az)("div",{className:"e-olap-hierarchy-title",innerHTML:this.parent.localeObj.getConstant("selectedHierarchy")});i.appendChild(e)}let o=(0,a.az)("div",{id:this.parentID+"Hierarchy_List_Div",className:_n});if(this.parent.isAdaptive?e.appendChild(o):i.appendChild(o),!this.parent.isAdaptive){let e=(0,a.az)("div",{className:Xn,innerHTML:this.parent.localeObj.getConstant("formatString")});i.appendChild(e)}let l=(0,a.az)("div",{id:this.parentID+"Format_Div",className:Bn});this.parent.isAdaptive?e.appendChild(l):i.appendChild(l);let r=(0,a.az)("div",{id:this.parentID+"custom_Format_Div",className:"e-olap-calc-custom-format-div"}),n=(0,a.az)("input",{id:this.parentID+"Custom_Format_Element",attrs:{type:"text"},className:zn});if(r.appendChild(n),i.appendChild(r),this.parent.isAdaptive?e.appendChild(r):i.appendChild(r),"pivotfieldlist"===this.parent.getModuleName()&&null===this.parent.dialogRenderer.parentElement.querySelector("."+qn)&&this.parent.isAdaptive){let t=e.querySelector("."+Wn);e.appendChild(t)}else e.appendChild(t),e.appendChild(i)}else{let t=(0,a.az)("div",{id:this.parentID+"custom_Format_Div",className:"e-pivot-calc-custom-format-div"});if(!this.parent.isAdaptive){let e=(0,a.az)("div",{className:Xn,innerHTML:this.parent.localeObj.getConstant("formatString")});t.appendChild(e)}let i=(0,a.az)("input",{id:this.parentID+"Custom_Format_Element",attrs:{type:"text"},className:zn});t.appendChild(i),this.parent.isAdaptive?e.insertBefore(t,(0,a.Ys)("#"+this.parentID+"buttonDiv",e)):e.appendChild(t)}}return e}renderAdaptiveLayout(e){let t=this.parent.dialogRenderer.adaptiveElement;if(e){if((0,a.Ys)("#"+this.parentID+"droppable",t.element)&&(this.formulaText=(0,a.Ys)("#"+this.parentID+"droppable",document).value,this.fieldText=this.inputObj.value),t.element.querySelector("."+Zn)){let e=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Member_Type_Div",t.element),p.NB);this.fieldType=e.value}if(t.element.querySelector("."+_n)){let e=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Hierarchy_List_Div",t.element),p.NB);this.parentHierarchy="Dimension"===this.fieldType?e.value:null}if(t.element.querySelector("."+Bn)){let e=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Format_Div",t.element),p.NB);this.formatType=e.value}if(t.element.querySelector("."+zn)){let e=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Custom_Format_Element",t.element),c.g3);this.formatText="olap"===this.parent.dataType?"Custom"===this.formatType?e.value:null:e.value}}else this.currentFieldName=this.formulaText=this.fieldText=this.formatText=null,this.fieldType=this.formatType=this.parentHierarchy=null;this.renderMobileLayout(t)}updateAdaptiveCalculatedField(e,t){let i=this.parent.dialogRenderer.adaptiveElement.element;this.isEdit=e;let s=e?"pivot"===this.parent.dataType?this.parent.engineModule.fieldList[t]:this.parent.olapEngineModule.fieldList[t]:{id:null,caption:null,formula:null,fieldType:"Measure",formatString:"pivot"===this.parent.dataType?null:"Standard",parentHierarchy:null};if(this.currentFieldName=s.id,(0,a.Ys)("#"+this.parentID+"droppable",document)&&(this.formulaText=(0,a.Ys)("#"+this.parentID+"droppable",document).value=s.formula,this.fieldText=this.inputObj.value=s.caption,this.inputObj.dataBind()),i.querySelector("."+Zn)){let t=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Member_Type_Div",i),p.NB);this.fieldType=t.value=s.fieldType,t.readonly=!!e,t.dataBind()}if(i.querySelector("."+_n)){let e=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Hierarchy_List_Div",i),p.NB);"Dimension"===this.fieldType?this.parentHierarchy=e.value=s.parentHierarchy:(this.parentHierarchy=null,e.index=0),e.dataBind()}if(i.querySelector("."+Bn)){let e=["Standard","Currency","Percent"],t=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Format_Div",i),p.NB);this.formatType=t.value=e.indexOf(s.formatString)>-1?s.formatString:"Custom"}if(i.querySelector("."+zn)){let e=(0,a.s8)((0,a.Ys)("#"+this.parentID+"Custom_Format_Element",i),c.g3),o=br.getFieldByName(t,this.parent.dataSourceSettings.formatSettings);this.formatText=e.value="pivot"===this.parent.dataType?o?o.format:null:"Custom"===this.formatType?s.formatString:null,e.dataBind()}}createOlapDropElements(){let e=this.parent.isAdaptive?this.parent.dialogRenderer.parentElement:this.dialog.element,t=[],i=[],s=[],o=["Measure","Dimension"],l=["Standard","Currency","Percent","Custom"];for(let a of o)t.push({value:a,text:this.parent.localeObj.getConstant(a)});for(let a of l)i.push({value:a,text:this.parent.localeObj.getConstant(a)});let r=br.getClonedData(this.parent.olapEngineModule.fieldListData);for(let a of r)a.spriteCssClass&&(a.spriteCssClass.indexOf("e-attributeCDB-icon")>-1||a.spriteCssClass.indexOf("e-hierarchyCDB-icon")>-1)&&s.push({value:a.id,text:a.caption});let n=new p.NB({dataSource:t,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:null!==this.fieldType?this.fieldType:t[0].value,readonly:this.isEdit,cssClass:Vn,width:"100%",change:e=>{h.enabled="Dimension"===e.value,this.fieldType=e.value,this.formulaText=(0,a.Ys)("#"+this.parentID+"droppable",document).value,h.dataBind()}});n.isStringTemplate=!0,n.appendTo((0,a.Ys)("#"+this.parentID+"Member_Type_Div",e));let h=new p.NB({dataSource:s,enableRtl:this.parent.enableRtl,locale:this.parent.locale,allowFiltering:!0,enabled:"Dimension"===n.value,filterBarPlaceholder:this.parent.localeObj.getConstant("example")+" "+s[0].text.toString(),fields:{value:"value",text:"text"},value:null!==this.parentHierarchy&&"Dimension"===n.value?this.parentHierarchy:s[0].value,cssClass:Vn,width:"100%",change:e=>{this.parentHierarchy=e.value,this.formulaText=(0,a.Ys)("#"+this.parentID+"droppable",document).value}});h.isStringTemplate=!0,h.appendTo((0,a.Ys)("#"+this.parentID+"Hierarchy_List_Div",e));let d=new p.NB({dataSource:i,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:null!==this.formatType?this.formatType:i[0].value,cssClass:Vn,width:"100%",change:e=>{u.enabled="Custom"===e.value,this.formatType=e.value,this.formulaText=(0,a.Ys)("#"+this.parentID+"droppable",document).value,u.dataBind()}});d.isStringTemplate=!0,d.appendTo((0,a.Ys)("#"+this.parentID+"Format_Div",e));let u=new c.g3({placeholder:this.parent.localeObj.getConstant("customFormat"),locale:this.parent.locale,enableRtl:this.parent.enableRtl,value:null!==this.formatText&&"Custom"===d.value?this.formatText:null,enabled:"Custom"===d.value,change:e=>{this.formatText=e.value,this.formulaText=(0,a.Ys)("#"+this.parentID+"droppable",document).value}});u.isStringTemplate=!0,u.appendTo("#"+this.parentID+"Custom_Format_Element")}createTreeView(){this.treeObj=new d.LQ("olap"===this.parent.dataType?{fields:{dataSource:this.getFieldListData(this.parent),id:"id",text:"caption",parentID:"pid",iconCss:"spriteCssClass"},allowDragAndDrop:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,nodeDragStart:this.dragStart.bind(this),nodeDragging:e=>{e.event.target&&e.event.target.classList.contains(qn)?((0,a.IV)([e.clonedNode],fn),(0,a.cn)([e.event.target],"e-copy-drop")):((0,a.cn)([e.clonedNode],fn),(0,a.IV)([e.event.target],"e-copy-drop"),e.dropIndicator="e-no-drop",(0,a.cn)([e.clonedNode.querySelector("."+Gr)],"e-icon-expandable"),(0,a.IV)([e.clonedNode.querySelector("."+Gr)],"e-list-icon"))},nodeClicked:this.fieldClickHandler.bind(this),nodeSelected:e=>{e.node.getAttribute("data-type")===Dc?this.displayMenu(e.node):((0,a.IV)([e.node],"e-active"),e.cancel=!0)},nodeDragStop:this.fieldDropped.bind(this),drawNode:this.drawTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),sortOrder:"None"}:{fields:{dataSource:this.getFieldListData(this.parent),id:"formula",text:"name",iconCss:"icon"},allowDragAndDrop:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,nodeCollapsing:this.nodeCollapsing.bind(this),nodeDragStart:this.dragStart.bind(this),nodeClicked:this.fieldClickHandler.bind(this),nodeDragStop:this.fieldDropped.bind(this),drawNode:this.drawTreeNode.bind(this),keyPress:e=>{39===e.event.keyCode&&(e.cancel=!0)},sortOrder:"Ascending"}),this.treeObj.isStringTemplate=!0,this.treeObj.appendTo("#"+this.parentID+"tree")}updateNodeIcon(e){if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-icon-expandable.e-process")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-icon")>-1){let t=e.node.querySelector(".e-list-icon");(0,a.IV)([t],"e-folderCDB-icon"),(0,a.cn)([t],"e-folderCDB-open-icon")}else if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-icon-expandable")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-open-icon")>-1){let t=e.node.querySelector(".e-list-icon");(0,a.IV)([t],"e-folderCDB-open-icon"),(0,a.cn)([t],"e-folderCDB-icon")}else{let t=this.treeObj.fields.dataSource,i=t,s=[];for(let o of i)o.pid===e.nodeData.id.toString()&&s.push(o);if(0!==s.length)return;this.parent.olapEngineModule.calcChildMembers=[],this.parent.olapEngineModule.getCalcChildMembers(this.parent.dataSourceSettings,e.nodeData.id.toString()),s=this.parent.olapEngineModule.calcChildMembers,this.parent.olapEngineModule.calcChildMembers=[];for(let o of s)o.pid=e.nodeData.id.toString(),o.hasChildren=!1,o.spriteCssClass="e-level-members",o.caption=""===o.caption?this.parent.localeObj.getConstant("blank"):o.caption,t.push(o);this.treeObj.addNodes(s,e.node)}}nodeCollapsing(e){e.cancel=!0}dragStart(e){let t=!1,i=e.clonedNode;i&&("olap"===this.parent.dataType&&(i.querySelector(".e-calc-dimension-icon,.e-calc-measure-icon,.e-measure-icon")||i.querySelector(".e-dimensionCDB-icon,.e-attributeCDB-icon,.e-hierarchyCDB-icon")||i.querySelector(".e-level-members,.e-namedSetCDB-icon"))||"pivot"===this.parent.dataType&&e.event.target.classList.contains(ln))&&(t=!0),t?((0,a.cn)([e.draggedNode.querySelector(".e-list-text")],yn),(0,a.cn)([i],"e-pivot-calc"),i.style.zIndex=(this.dialog.zIndex+1).toString(),i.style.display="inline"):e.cancel=!0}drawTreeNode(e){if("olap"===this.parent.dataType){e.node.querySelector(".e-measure-icon")&&(e.node.querySelector(".e-list-icon").style.display="none");let t=e.nodeData;e.node.setAttribute("data-field",t.id),e.node.setAttribute("data-caption",t.caption);let i=e.node.querySelector(".e-text-content");if(e.nodeData&&e.nodeData.type===Dc&&i&&e.node.querySelector(".e-list-icon.e-calc-member")){e.node.setAttribute("data-type",t.type),e.node.setAttribute("data-membertype",t.fieldType),e.node.setAttribute("data-hierarchy",t.parentHierarchy?t.parentHierarchy:""),e.node.setAttribute("data-formula",t.formula);let s,o=["Standard","Currency","Percent"];s=t.formatString?o.indexOf(t.formatString)>-1?t.formatString:"Custom":"",e.node.setAttribute("data-formatString",s),e.node.setAttribute("data-customString","Custom"===s?t.formatString:"");let l=(0,a.az)("span",{className:nh+" e-icons e-list-icon"});if(i.classList.add("e-calcfieldmember"),this.parent.isAdaptive){let e=(0,a.az)("span",{className:"e-list-edit-icon"+(this.isEdit&&this.currentFieldName===t.id?" e-edited ":" e-edit ")+Gr}),s=(0,a.az)("div",{className:"e-list-header-icon"});s.appendChild(e),s.appendChild(l),i.appendChild(s)}else i.appendChild(l)}if(this.parent.isAdaptive){let t=e.node.querySelector(".e-text-content");if(e.node&&e.node.querySelector(".e-list-icon")&&t){let i=e.node.querySelector(".e-list-icon");t.insertBefore(i,e.node.querySelector(".e-list-text"))}e.node&&e.node.querySelector(".e-calcMemberGroupCDB,.e-measureGroupCDB-icon,.e-folderCDB-icon")&&(e.node.querySelector(".e-checkbox-wrapper").style.display="none"),e.node&&e.node.querySelector(".e-level-members")&&(e.node.querySelector(".e-list-icon").style.display="none")}}else{let t=e.nodeData.field;e.node.setAttribute("data-field",t),e.node.setAttribute("data-caption",e.nodeData.caption),e.node.setAttribute("data-type",e.nodeData.type);let i=br.getFieldByName(t,this.parent.dataSourceSettings.formatSettings);e.node.setAttribute("data-formatString",i?i.format:"");let s=(0,a.az)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("dragField")},className:Gr+" e-drag"}),o=(0,a.az)("div",{className:" e-iconspace"});(0,a.Ce)([s],e.node.querySelector(".e-text-content")),(0,a.R3)([o,e.node.querySelector("."+Hn)],e.node.querySelector(".e-text-content")),this.getMenuItems(this.parent.engineModule.fieldList[t].type).length<=0?(0,a.IV)([e.node.querySelector("."+Hn)],Gr):e.node.querySelector("."+Hn).setAttribute("title",this.parent.localeObj.getConstant("format")),this.parent.engineModule.fieldList[t].aggregateType===Dc&&(e.node.querySelector("."+Hn).setAttribute("title",this.parent.localeObj.getConstant("remove")),(0,a.cn)([e.node.querySelector("."+Hn)],nh),(0,a.cn)([e.node.querySelector(".e-iconspace")],[Kn,Gr,"e-list-icon"]),e.node.querySelector(".e-edit").setAttribute("title",this.parent.localeObj.getConstant("edit")),e.node.querySelector(".e-edit").setAttribute("aria-disabled","false"),e.node.querySelector(".e-edit").setAttribute("tabindex","-1"),(0,a.IV)([e.node.querySelector("."+Hn)],Hn),(0,a.IV)([e.node.querySelector(".e-iconspace")],"e-iconspace"))}}createTypeContainer(e){let t=(0,a.az)("div",{id:this.parentID+"control_wrapper",className:Yn}),i=this.getMenuItems(this.parent.engineModule.fieldList[e].type);for(let s=0;s<i.length;s++){let o=(0,a.az)("input",{id:this.parentID+"radio"+e+i[s],attrs:{type:"radio","data-ftxt":e,"data-value":i[s]},className:"e-pivot-calc-radio"});t.appendChild(o)}return t}getMenuItems(e,t){let i=(0,a.le)(t)?this.parent.aggregateTypes:t,s=[],o=this.getValidSummaryType();for(let l=0;l<i.length;l++)o.indexOf(i[l])>-1&&s.indexOf(i[l])<0&&((i[l]!==vc&&i[l]!==wc||"number"===e)&&"number"!==e||s.push(i[l]));return s}getValidSummaryType(){return[vc,wc,xc,"Avg",Sc,"Min","Max",Cc,Mc,Tc,Lc,Ac]}getAccordionData(e){let t=[],i=Object.keys(e.engineModule.fieldList);for(let s=0,o=i.length;s<o;s++){let e=i[s];t.push({header:"<input id="+this.parentID+"_"+s+" class="+On+' type="checkbox" data-field='+e+" data-caption="+this.parent.engineModule.fieldList[e].caption+" data-type="+this.parent.engineModule.fieldList[e].type+"/>",content:this.parent.engineModule.fieldList[e].aggregateType===Dc||this.getMenuItems(this.parent.engineModule.fieldList[e].type).length<1?"":this.createTypeContainer(e).outerHTML,iconCss:this.parent.engineModule.fieldList[e].aggregateType===Dc?"e-list-icon "+(this.isEdit&&this.currentFieldName===e?"e-edited":"e-edit"):""})}return t}renderMobileLayout(e){e.items[4].content=this.renderDialogElements().outerHTML,e.dataBind(),"olap"===this.parent.dataType&&this.parent.isAdaptive&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+qn)&&this.createOlapDropElements();let t=new m.zx({cssClass:jn,isPrimary:!0,locale:this.parent.locale,enableRtl:this.parent.enableRtl});if(t.isStringTemplate=!0,t.appendTo("#"+this.parentID+"cancelBtn"),t.element&&(t.element.onclick=this.cancelBtnClick.bind(this)),null!==this.parent.dialogRenderer.parentElement.querySelector("."+qn)&&this.parent.isAdaptive){let e=new m.zx({cssClass:jn+" e-outline",isPrimary:!0,locale:this.parent.locale,enableRtl:this.parent.enableRtl});if(e.isStringTemplate=!0,e.appendTo("#"+this.parentID+"okBtn"),this.inputObj=new c.g3({placeholder:this.parent.localeObj.getConstant("fieldName"),locale:this.parent.locale,enableRtl:this.parent.enableRtl,change:e=>{this.fieldText=e.value,this.formulaText=(0,a.Ys)("#"+this.parentID+"droppable",document).value}}),this.inputObj.isStringTemplate=!0,this.inputObj.appendTo("#"+this.parentID+"ddlelement"),"pivot"===this.parent.dataType){let e=new c.g3({locale:this.parent.locale,enableRtl:this.parent.enableRtl,placeholder:this.parent.localeObj.getConstant("numberFormatString"),change:e=>{this.formatText=e.value,this.formulaText=(0,a.Ys)("#"+this.parentID+"droppable",document).value}});e.isStringTemplate=!0,e.appendTo("#"+this.parentID+"Custom_Format_Element"),null!==this.formatText&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+zn)&&(this.parent.dialogRenderer.parentElement.querySelector("."+zn).value=this.formatText,e.value=this.formatText)}null!==this.formulaText&&null!==(0,a.Ys)("#"+this.parentID+"droppable",this.parent.dialogRenderer.parentElement)&&((0,a.Ys)("#"+this.parentID+"droppable",this.parent.dialogRenderer.parentElement).value=this.formulaText),null!==this.fieldText&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+Nn)&&(this.parent.dialogRenderer.parentElement.querySelector("."+Nn).value=this.fieldText,this.inputObj.value=this.fieldText),e.element&&(e.element.onclick=this.applyFormula.bind(this))}else if(this.parent.isAdaptive){let e=new m.zx({cssClass:jn,isPrimary:!0,locale:this.parent.locale,enableRtl:this.parent.enableRtl});e.isStringTemplate=!0,e.appendTo("#"+this.parentID+"addBtn"),"olap"===this.parent.dataType?(this.treeObj=new d.LQ({fields:{dataSource:this.getFieldListData(this.parent),id:"id",text:"caption",parentID:"pid",iconCss:"spriteCssClass"},showCheckBox:!0,autoCheck:!1,sortOrder:"None",enableRtl:this.parent.enableRtl,locale:this.parent.locale,nodeClicked:this.fieldClickHandler.bind(this),drawNode:this.drawTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),nodeSelected:e=>{(0,a.IV)([e.node],"e-active"),e.cancel=!0}}),this.treeObj.isStringTemplate=!0,this.treeObj.appendTo("#"+this.parentID+"accordDiv")):(this.accordion=new d.UQ({items:this.getAccordionData(this.parent),enableRtl:this.parent.enableRtl,locale:this.parent.locale,expanding:this.accordionExpand.bind(this),clicked:this.accordionClickHandler.bind(this),created:this.accordionCreated.bind(this)}),this.accordion.isStringTemplate=!0,this.accordion.appendTo("#"+this.parentID+"accordDiv"),this.updateType()),e.element&&(e.element.onclick=this.addBtnClick.bind(this))}}accordionExpand(e){if(0===e.element.querySelectorAll(".e-radio-wrapper").length){let t=Object.keys(this.parent.engineModule.fieldList);for(let i=0,s=t.length;i<s;i++){let s,o=t[i],l="number"!==this.parent.engineModule.fieldList[o].type?[vc,wc]:[xc,vc,"Avg",Sc,"Min","Max",wc,Cc,Mc,Tc,Lc,Ac];if(o===e.element.querySelector("[data-field").getAttribute("data-field"))for(let t=0;t<l.length;t++)s=new m.EU({label:this.parent.localeObj.getConstant(l[t]),name:"AggregateType"+o,checked:e.element.querySelector("[data-type").getAttribute("data-type")===l[t],change:this.onChange.bind(this),locale:this.parent.locale,enableRtl:this.parent.enableRtl}),s.isStringTemplate=!0,s.appendTo("#"+this.parentID+"radio"+o+l[t])}}}onChange(e){let t=e.event.target.parentElement.querySelector(".e-label").innerText,i=e.event.target.closest(".e-acrdn-item").querySelector("[data-field").getAttribute("data-caption");e.event.target.closest(".e-acrdn-item").querySelector(".e-label").innerText=i+" ("+t+")",e.event.target.closest(".e-acrdn-item").querySelector("[data-type").setAttribute("data-type",e.event.target.getAttribute("data-value"))}updateType(){let e=Object.keys(this.parent.engineModule.fieldList);for(let t=0,i=e.length;t<i;t++){let i=e[t],s=null;s="number"===this.parent.engineModule.fieldList[i].type&&"include"!==this.parent.engineModule.fieldList[i].type&&"exclude"!==this.parent.engineModule.fieldList[i].type||"DistinctCount"===this.parent.engineModule.fieldList[i].aggregateType?void 0!==this.parent.engineModule.fieldList[i].aggregateType?this.parent.engineModule.fieldList[i].aggregateType:xc:vc;let o=new m.Jg({label:this.parent.engineModule.fieldList[i].caption+" ("+this.parent.localeObj.getConstant(s)+")",locale:this.parent.locale,enableRtl:this.parent.enableRtl});o.isStringTemplate=!0,o.appendTo("#"+this.parentID+"_"+t),(0,a.Ys)("#"+this.parentID+"_"+t,document).setAttribute("data-field",i),(0,a.Ys)("#"+this.parentID+"_"+t,document).setAttribute("data-type",s)}}cancelBtnClick(){this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)}addBtnClick(){let e="",t=null,i=null;if("pivot"===this.parent.dataType){let s=document.querySelectorAll(".e-accordion .e-check");for(let o=0;o<s.length;o++)if(t=s[o].parentElement.querySelector("[data-field]").getAttribute("data-field"),i=s[o].parentElement.querySelector("[data-field]").getAttribute("data-type"),-1===i.indexOf(Dc))e=e+'"'+i+"("+t+')"';else for(let i=0;i<this.parent.dataSourceSettings.calculatedFieldSettings.length;i++)if(this.parent.dataSourceSettings.calculatedFieldSettings[i].name===t){e+=this.parent.dataSourceSettings.calculatedFieldSettings[i].formula;break}}else{let t=this.treeObj.getAllCheckedNodes(),i=this.parent.olapEngineModule;for(let s of t)e+=i.fieldList[s]&&i.fieldList[s].type===Dc?i.fieldList[s].tag:s}this.formulaText=null!==this.formulaText?this.formulaText+e:e,this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)}createCalculatedFieldDialog(e){if(this.parent.isAdaptive&&"pivotfieldlist"===this.parent.getModuleName())this.renderAdaptiveLayout(!e||void 0===e.edit||e.edit),this.isEdit=e&&void 0!==e.edit?e.edit:this.isEdit;else if(!this.parent.isAdaptive){if(this.isEdit=!(!e||void 0===e.edit)&&e.edit,this.renderDialogLayout(),e&&e.edit){let t=this.treeObj.element.querySelector('li[data-field="'+e.fieldName+'"]');if(t)if((0,a.cn)([t],["e-active","e-node-focus"]),t.setAttribute("aria-selected","true"),t.id=this.treeObj.element.id+"_active","pivot"===this.parent.dataType){let e={event:{target:t.querySelector(".e-list-icon.e-edit.e-icons")}};this.fieldClickHandler(e)}else this.displayMenu(t)}this.dialog.element.style.top=parseInt(this.dialog.element.style.top,10)<0?"0px":this.dialog.element.style.top}}renderDialogLayout(){if(this.newFields=(0,a.l7)([],this.parent.dataSourceSettings.calculatedFieldSettings,null,!0),this.createDialog(),this.dialog.content=this.renderDialogElements(),this.dialog.refresh(),this.inputObj=new c.g3({placeholder:this.parent.localeObj.getConstant("fieldName"),locale:this.parent.locale,enableRtl:this.parent.enableRtl}),this.inputObj.isStringTemplate=!0,this.inputObj.appendTo("#"+this.parentID+"ddlelement"),"pivot"===this.parent.dataType){let e=new c.g3({placeholder:this.parent.localeObj.getConstant("numberFormatString"),locale:this.parent.locale,enableRtl:this.parent.enableRtl});e.isStringTemplate=!0,e.appendTo("#"+this.parentID+"Custom_Format_Element")}"olap"!==this.parent.dataType||this.parent.isAdaptive||this.createOlapDropElements(),this.createTreeView(),this.droppable=new a.bK((0,a.Ys)("#"+this.parentID+"droppable")),this.keyboardEvents=new a.nv(this.parent.calculatedFieldModule.dialog.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:{moveRight:"rightarrow",enter:"enter",shiftE:"shift+E",delete:"delete"},eventName:"keydown"})}createConfirmDialog(e,t,i,s,o){let l=(0,a.az)("div",{id:this.parentID+"_ErrorDialog",className:un});this.parent.element.appendChild(l),this.confirmPopUp=new n.Vq({animationSettings:{effect:"Fade"},allowDragging:!1,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:s?this.removeCalcField.bind(this,o):this.replaceFormula.bind(this,i),buttonModel:{cssClass:"e-ok-btn e-flat e-primary",content:this.parent.localeObj.getConstant(s?"yes":"ok"),isPrimary:!0}},{click:this.removeErrorDialog.bind(this),buttonModel:{cssClass:pn,content:this.parent.localeObj.getConstant(s?"no":"cancel"),isPrimary:!0}}],header:e,content:t,isModal:!0,visible:!0,closeOnEscape:!0,target:document.body,close:this.removeErrorDialog.bind(this)}),this.confirmPopUp.isStringTemplate=!0,this.confirmPopUp.appendTo(l)}replaceFormula(e){let t=this.parent.dataSourceSettings;if("olap"===this.parent.dataType){for(let i=0;i<t.calculatedFieldSettings.length;i++)if(t.calculatedFieldSettings[i].name===e.name){(0,a.le)(e.hierarchyUniqueName)||(t.calculatedFieldSettings[i].hierarchyUniqueName=e.hierarchyUniqueName),t.calculatedFieldSettings[i].formatString=e.formatString,t.calculatedFieldSettings[i].formula=e.formula,this.parent.lastCalcFieldInfo=t.calculatedFieldSettings[i];break}}else for(let i=0;i<t.values.length;i++)if(t.values[i].type===Dc&&t.values[i].name===e.name)for(let s=0;s<t.calculatedFieldSettings.length;s++)t.calculatedFieldSettings[s].name===e.name&&(t.calculatedFieldSettings[s].formula=e.formula,this.parent.lastCalcFieldInfo=t.calculatedFieldSettings[s],this.updateFormatSettings(t,e.name,e.formatString));this.addFormula(t,e.name),this.removeErrorDialog()}removeErrorDialog(){document.getElementById(this.parentID+"_ErrorDialog")&&(0,a.Od)(document.getElementById(this.parentID+"_ErrorDialog").parentElement)}addEventListener(){this.parent.isDestroyed||this.parent.on(Vr,this.createCalculatedFieldDialog,this)}removeEventListener(){this.parent.isDestroyed||this.parent.off(Vr,this.createCalculatedFieldDialog)}destroy(){this.removeEventListener()}});const Rc=["cellTemplate"];var Ic=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a},Pc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const kc=["aggregateCellInfo","aggregateMenuOpen","beforeExport","beforeServiceInvoke","beginDrillThrough","calculatedFieldCreate","cellClick","cellSelected","cellSelecting","chartSeriesCreated","conditionalFormatting","created","dataBound","destroyed","drill","drillThrough","editCompleted","enginePopulated","enginePopulating","fetchReport","fieldDragStart","fieldDrop","fieldListRefreshed","fieldRemove","hyperlinkCellClick","load","loadReport","memberEditorOpen","memberFiltering","newReport","numberFormatting","onFieldDropped","onPdfCellRender","removeReport","renameReport","saveReport","toolbarClick","toolbarRender"],Ec=[];let Fc=(()=>{let e=class extends dc{constructor(e,t,i,s){super(),this.ngEle=e,this.srenderer=t,this.viewContainerRef=i,this.injector=s,this.element=this.ngEle.nativeElement,this.injectedModules=this.injectedModules||[];try{let e=this.injector.get("PivotViewGroupingBar");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(o){}try{let e=this.injector.get("PivotViewFieldList");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(a){}try{let e=this.injector.get("PivotViewCalculatedField");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(r){}try{let e=this.injector.get("PivotViewConditionalFormatting");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(n){}try{let e=this.injector.get("PivotViewVirtualScroll");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(h){}try{let e=this.injector.get("PivotViewDrillThrough");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(d){}try{let e=this.injector.get("PivotViewToolbar");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(c){}try{let e=this.injector.get("PivotViewPivotChart");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(p){}try{let e=this.injector.get("PivotViewPDFExport");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(u){}try{let e=this.injector.get("PivotViewExcelExport");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(g){}try{let e=this.injector.get("PivotViewNumberFormatting");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(m){}try{let e=this.injector.get("PivotViewGrouping");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(b){}this.registerEvents(kc),this.addTwoWay.call(this,Ec),(0,l.sO)("currentInstance",this,this.viewContainerRef),this.context=new l.VZ}ngOnInit(){this.context.ngOnInit(this)}ngAfterViewInit(){this.context.ngAfterViewInit(this)}ngOnDestroy(){this.context.ngOnDestroy(this)}ngAfterContentChecked(){this.context.ngAfterContentChecked(this)}};return e.\u0275fac=function(t){return new(t||e)(o.Y36(o.SBq),o.Y36(o.Qsj),o.Y36(o.s_b),o.Y36(o.zs3))},e.\u0275cmp=o.Xpm({type:e,selectors:[["ejs-pivotview"]],contentQueries:function(e,t,i){if(1&e&&o.Suo(i,Rc,5),2&e){let e;o.iGM(e=o.CRH())&&(t.cellTemplate=e.first)}},inputs:{aggregateTypes:"aggregateTypes",allowCalculatedField:"allowCalculatedField",allowConditionalFormatting:"allowConditionalFormatting",allowDataCompression:"allowDataCompression",allowDeferLayoutUpdate:"allowDeferLayoutUpdate",allowDrillThrough:"allowDrillThrough",allowExcelExport:"allowExcelExport",allowGrouping:"allowGrouping",allowNumberFormatting:"allowNumberFormatting",allowPdfExport:"allowPdfExport",cellTemplate:"cellTemplate",chartSettings:"chartSettings",chartTypes:"chartTypes",currencyCode:"currencyCode",dataSourceSettings:"dataSourceSettings",displayOption:"displayOption",editSettings:"editSettings",enableHtmlSanitizer:"enableHtmlSanitizer",enablePersistence:"enablePersistence",enableRtl:"enableRtl",enableValueSorting:"enableValueSorting",enableVirtualization:"enableVirtualization",exportAllPages:"exportAllPages",gridSettings:"gridSettings",groupingBarSettings:"groupingBarSettings",height:"height",hyperlinkSettings:"hyperlinkSettings",loadOnDemandInMemberEditor:"loadOnDemandInMemberEditor",locale:"locale",maxNodeLimitInMemberEditor:"maxNodeLimitInMemberEditor",maxRowsInDrillThrough:"maxRowsInDrillThrough",pivotValues:"pivotValues",showFieldList:"showFieldList",showGroupingBar:"showGroupingBar",showToolbar:"showToolbar",showTooltip:"showTooltip",showValuesButton:"showValuesButton",spinnerTemplate:"spinnerTemplate",toolbar:"toolbar",toolbarTemplate:"toolbarTemplate",tooltipTemplate:"tooltipTemplate",width:"width"},outputs:{aggregateCellInfo:"aggregateCellInfo",aggregateMenuOpen:"aggregateMenuOpen",beforeExport:"beforeExport",beforeServiceInvoke:"beforeServiceInvoke",beginDrillThrough:"beginDrillThrough",calculatedFieldCreate:"calculatedFieldCreate",cellClick:"cellClick",cellSelected:"cellSelected",cellSelecting:"cellSelecting",chartSeriesCreated:"chartSeriesCreated",conditionalFormatting:"conditionalFormatting",created:"created",dataBound:"dataBound",destroyed:"destroyed",drill:"drill",drillThrough:"drillThrough",editCompleted:"editCompleted",enginePopulated:"enginePopulated",enginePopulating:"enginePopulating",fetchReport:"fetchReport",fieldDragStart:"fieldDragStart",fieldDrop:"fieldDrop",fieldListRefreshed:"fieldListRefreshed",fieldRemove:"fieldRemove",hyperlinkCellClick:"hyperlinkCellClick",load:"load",loadReport:"loadReport",memberEditorOpen:"memberEditorOpen",memberFiltering:"memberFiltering",newReport:"newReport",numberFormatting:"numberFormatting",onFieldDropped:"onFieldDropped",onPdfCellRender:"onPdfCellRender",removeReport:"removeReport",renameReport:"renameReport",saveReport:"saveReport",toolbarClick:"toolbarClick",toolbarRender:"toolbarRender"},features:[o.qOj],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0}),Ic([(0,l.YS)(),Pc("design:type",Object)],e.prototype,"cellTemplate",void 0),e=Ic([(0,l.jm)([l.VZ]),Pc("design:paramtypes",[o.SBq,o.Qsj,o.s_b,o.zs3])],e),e})(),Oc=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[s.ez]]}),e})();const Nc=["aggregateCellInfo","aggregateMenuOpen","beforeServiceInvoke","calculatedFieldCreate","created","dataBound","destroyed","enginePopulated","enginePopulating","fieldDragStart","fieldDrop","fieldRemove","load","memberEditorOpen","memberFiltering","onFieldDropped"],zc=[];let _c=(()=>{let e=class extends yc{constructor(e,t,i,s){super(),this.ngEle=e,this.srenderer=t,this.viewContainerRef=i,this.injector=s,this.element=this.ngEle.nativeElement,this.injectedModules=this.injectedModules||[],this.registerEvents(Nc),this.addTwoWay.call(this,zc),(0,l.sO)("currentInstance",this,this.viewContainerRef),this.context=new l.VZ}ngOnInit(){this.context.ngOnInit(this)}ngAfterViewInit(){this.context.ngAfterViewInit(this)}ngOnDestroy(){this.context.ngOnDestroy(this)}ngAfterContentChecked(){this.context.ngAfterContentChecked(this)}};return e.\u0275fac=function(t){return new(t||e)(o.Y36(o.SBq),o.Y36(o.Qsj),o.Y36(o.s_b),o.Y36(o.zs3))},e.\u0275cmp=o.Xpm({type:e,selectors:[["ejs-pivotfieldlist"]],inputs:{aggregateTypes:"aggregateTypes",allowCalculatedField:"allowCalculatedField",allowDeferLayoutUpdate:"allowDeferLayoutUpdate",cssClass:"cssClass",dataSourceSettings:"dataSourceSettings",enablePersistence:"enablePersistence",enableRtl:"enableRtl",loadOnDemandInMemberEditor:"loadOnDemandInMemberEditor",locale:"locale",maxNodeLimitInMemberEditor:"maxNodeLimitInMemberEditor",renderMode:"renderMode",showValuesButton:"showValuesButton",spinnerTemplate:"spinnerTemplate",target:"target"},outputs:{aggregateCellInfo:"aggregateCellInfo",aggregateMenuOpen:"aggregateMenuOpen",beforeServiceInvoke:"beforeServiceInvoke",calculatedFieldCreate:"calculatedFieldCreate",created:"created",dataBound:"dataBound",destroyed:"destroyed",enginePopulated:"enginePopulated",enginePopulating:"enginePopulating",fieldDragStart:"fieldDragStart",fieldDrop:"fieldDrop",fieldRemove:"fieldRemove",load:"load",memberEditorOpen:"memberEditorOpen",memberFiltering:"memberFiltering",onFieldDropped:"onFieldDropped"},features:[o.qOj],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0}),e})();_c=function(e,t,i,s){var o,l=arguments.length,a=l<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(l<3?o(a):l>3?o(t,i,a):o(t,i))||a);return l>3&&a&&Object.defineProperty(t,i,a),a}([(0,l.jm)([l.VZ]),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:paramtypes",t)}(0,[o.SBq,o.Qsj,o.s_b,o.zs3])],_c);var Bc=i(1094),Zc=i(7353);let Vc=(()=>{class e{ngOnInit(){this.pivotData=[{Sold:31,Amount:52824,Country:"France",Products:"Mountain Bikes",Year:"FY 2015",Quarter:"Q1"},{Sold:51,Amount:86904,Country:"France",Products:"Mountain Bikes",Year:"FY 2015",Quarter:"Q2"},{Sold:90,Amount:153360,Country:"France",Products:"Mountain Bikes",Year:"FY 2015",Quarter:"Q3"},{Sold:25,Amount:42600,Country:"France",Products:"Mountain Bikes",Year:"FY 2015",Quarter:"Q4"},{Sold:27,Amount:46008,Country:"France",Products:"Mountain Bikes",Year:"FY 2016",Quarter:"Q1"}],this.dataSourceSettings={dataSource:this.pivotData,expandAll:!1,columns:[{name:"Year",caption:"Production Year"},{name:"Quarter"}],values:[{name:"Sold",caption:"Units Sold"},{name:"Amount",caption:"Sold Amount"}],rows:[{name:"Country"},{name:"Products"}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-pivot-view"]],decls:4,vars:1,consts:[["id","PivotView","height","350",3,"dataSourceSettings"],["pivotview",""]],template:function(e,t){1&e&&(o.TgZ(0,"h2"),o._uU(1,"Tabla Pivot View"),o.qZA(),o._UZ(2,"ejs-pivotview",0,1)),2&e&&(o.xp6(2),o.Q6J("dataSourceSettings",t.dataSourceSettings))},directives:[Fc],styles:[""]}),e})(),jc=[{taskID:1,taskName:"Planning",startDate:new Date("02/03/2017"),endDate:new Date("02/07/2017"),progress:100,duration:5,priority:"Normal",approved:!1,isInExpandState:!0,subtasks:[{taskID:2,taskName:"Plan timeline",startDate:new Date("02/03/2017"),endDate:new Date("02/07/2017"),duration:5,progress:100,priority:"Normal",approved:!1},{taskID:3,taskName:"Plan budget",startDate:new Date("02/03/2017"),endDate:new Date("02/07/2017"),duration:5,progress:100,approved:!0},{taskID:4,taskName:"Allocate resources",startDate:new Date("02/03/2017"),endDate:new Date("02/07/2017"),duration:5,progress:100,priority:"Critical",approved:!1},{taskID:5,taskName:"Planning complete",startDate:new Date("02/07/2017"),endDate:new Date("02/07/2017"),duration:0,progress:0,priority:"Low",approved:!0}]},{taskID:6,taskName:"Design",startDate:new Date("02/10/2017"),endDate:new Date("02/14/2017"),duration:3,progress:86,priority:"High",isInExpandState:!1,approved:!1,subtasks:[{taskID:7,taskName:"Software Specification",startDate:new Date("02/10/2017"),endDate:new Date("02/12/2017"),duration:3,progress:60,priority:"Normal",approved:!1},{taskID:8,taskName:"Develop prototype",startDate:new Date("02/10/2017"),endDate:new Date("02/12/2017"),duration:3,progress:100,priority:"Critical",approved:!1},{taskID:9,taskName:"Get approval from customer",startDate:new Date("02/13/2017"),endDate:new Date("02/14/2017"),duration:2,progress:100,approved:!0},{taskID:10,taskName:"Design Documentation",startDate:new Date("02/13/2017"),endDate:new Date("02/14/2017"),duration:2,progress:100,approved:!0},{taskID:11,taskName:"Design complete",startDate:new Date("02/14/2017"),endDate:new Date("02/14/2017"),duration:0,progress:0,priority:"Normal",approved:!0}]},{taskID:12,taskName:"Implementation Phase",startDate:new Date("02/17/2017"),endDate:new Date("02/27/2017"),priority:"Normal",approved:!1,duration:11,subtasks:[{taskID:13,taskName:"Phase 1",startDate:new Date("02/17/2017"),endDate:new Date("02/27/2017"),priority:"High",approved:!1,duration:11,subtasks:[{taskID:14,taskName:"Implementation Module 1",startDate:new Date("02/17/2017"),endDate:new Date("02/27/2017"),priority:"Normal",duration:11,approved:!1,subtasks:[{taskID:15,taskName:"Development Task 1",startDate:new Date("02/17/2017"),endDate:new Date("02/19/2017"),duration:3,progress:"50",priority:"High",approved:!1},{taskID:16,taskName:"Development Task 2",startDate:new Date("02/17/2017"),endDate:new Date("02/19/2017"),duration:3,progress:"50",priority:"Low",approved:!0},{taskID:17,taskName:"Testing",startDate:new Date("02/20/2017"),endDate:new Date("02/21/2017"),duration:2,progress:"0",priority:"Normal",approved:!0},{taskID:18,taskName:"Bug fix",startDate:new Date("02/24/2017"),endDate:new Date("02/25/2017"),duration:2,progress:"0",priority:"Critical",approved:!1},{taskID:19,taskName:"Customer review meeting",startDate:new Date("02/26/2017"),endDate:new Date("02/27/2017"),duration:2,progress:"0",priority:"High",approved:!1},{taskID:20,taskName:"Phase 1 complete",startDate:new Date("02/27/2017"),endDate:new Date("02/27/2017"),duration:0,priority:"Low",approved:!0}]}]},{taskID:21,taskName:"Phase 2",startDate:new Date("02/17/2017"),endDate:new Date("02/28/2017"),priority:"High",approved:!1,duration:12,subtasks:[{taskID:22,taskName:"Implementation Module 2",startDate:new Date("02/17/2017"),endDate:new Date("02/28/2017"),priority:"Critical",approved:!1,duration:12,subtasks:[{taskID:23,taskName:"Development Task 1",startDate:new Date("02/17/2017"),endDate:new Date("02/20/2017"),duration:4,progress:"50",priority:"Normal",approved:!0},{taskID:24,taskName:"Development Task 2",startDate:new Date("02/17/2017"),endDate:new Date("02/20/2017"),duration:4,progress:"50",priority:"Critical",approved:!0},{taskID:25,taskName:"Testing",startDate:new Date("02/21/2017"),endDate:new Date("02/24/2017"),duration:2,progress:"0",priority:"High",approved:!1},{taskID:26,taskName:"Bug fix",startDate:new Date("02/25/2017"),endDate:new Date("02/26/2017"),duration:2,progress:"0",priority:"Low",approved:!1},{taskID:27,taskName:"Customer review meeting",startDate:new Date("02/27/2017"),endDate:new Date("02/28/2017"),duration:2,progress:"0",priority:"Critical",approved:!0},{taskID:28,taskName:"Phase 2 complete",startDate:new Date("02/28/2017"),endDate:new Date("02/28/2017"),duration:0,priority:"Normal",approved:!1}]}]},{taskID:29,taskName:"Phase 3",startDate:new Date("02/17/2017"),endDate:new Date("02/27/2017"),priority:"Normal",approved:!1,duration:11,subtasks:[{taskID:30,taskName:"Implementation Module 3",startDate:new Date("02/17/2017"),endDate:new Date("02/27/2017"),priority:"High",approved:!1,duration:11,subtasks:[{taskID:31,taskName:"Development Task 1",startDate:new Date("02/17/2017"),endDate:new Date("02/19/2017"),duration:3,progress:"50",priority:"Low",approved:!0},{taskID:32,taskName:"Development Task 2",startDate:new Date("02/17/2017"),endDate:new Date("02/19/2017"),duration:3,progress:"50",priority:"Normal",approved:!1},{taskID:33,taskName:"Testing",startDate:new Date("02/20/2017"),endDate:new Date("02/21/2017"),duration:2,progress:"0",priority:"Critical",approved:!0},{taskID:34,taskName:"Bug fix",startDate:new Date("02/24/2017"),endDate:new Date("02/25/2017"),duration:2,progress:"0",priority:"High",approved:!1},{taskID:35,taskName:"Customer review meeting",startDate:new Date("02/26/2017"),endDate:new Date("02/27/2017"),duration:2,progress:"0",priority:"Normal",approved:!0},{taskID:36,taskName:"Phase 3 complete",startDate:new Date("02/27/2017"),endDate:new Date("02/27/2017"),duration:0,priority:"Critical",approved:!1}]}]}]}];const Hc=[{path:"pivot-view",component:Vc},{path:"tree-grid",component:(()=>{class e{constructor(){this.data=[]}ngOnInit(){this.data=jc,this.sortSettings={columns:[{field:"taskName",direction:"Ascending"},{field:"taskID",direction:"Descending"}]},this.pageSettings={pageSize:6,currentPage:4}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-tree-grid"]],decls:8,vars:7,consts:[["childMapping","subtasks",3,"dataSource","treeColumnIndex","sortSettings","allowFiltering","allowSorting","allowPaging","pageSettings"],["ngClass","phy-grilla","field","taskID","headerText","Task ID","textAlign","Right","width","90"],["field","taskName","headerText","Task Name","textAlign","Left","width","180"],["field","startDate","headerText","Start Date","textAlign","Right","format","yMd","width","90"],["field","duration","headerText","Duration","textAlign","Right","width","80"]],template:function(e,t){1&e&&(o.TgZ(0,"h2"),o._uU(1,"Tabla Tree Grid"),o.qZA(),o.TgZ(2,"ejs-treegrid",0),o.TgZ(3,"e-columns"),o._UZ(4,"e-column",1),o._UZ(5,"e-column",2),o._UZ(6,"e-column",3),o._UZ(7,"e-column",4),o.qZA(),o.qZA()),2&e&&(o.xp6(2),o.Q6J("dataSource",t.data)("treeColumnIndex",1)("sortSettings",t.sortSettings)("allowFiltering",!0)("allowSorting",!0)("allowPaging",!0)("pageSettings",t.pageSettings))},directives:[Bc.lz,Bc.SR,Bc.NQ,Bc.iK,Bc.fM,s.mk],styles:[""]}),e})()}];let qc=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[Zc.Bz.forChild(Hc)],Zc.Bz]}),e})(),Gc=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[s.ez,qc,Bc.nv,Oc]]}),e})()}}]);